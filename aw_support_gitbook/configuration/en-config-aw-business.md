---
title: "EN CONFIG A+W Business"
category: "configuration"
product: "A+W Business"
doc_type: "Configuration"
language: "EN"
tags: ["CONFIG", "A+W Business"]
version: "1.0"
last_updated: "2025-12-10"
description: "Configuration   A+W Business v6                               english                         -INTERNAL- Change history  Date        Edited by      Comments                                                     Version 2017-03-02 A.Noll          Reporting Service with Crystal Reports (Beta)3.10.           13.02.0122                             Transferring stock items with quantity specification Range   13.02.0130 2017-03-09 S.Weil                            of numbers for stock movements7.10"
source_file: "EN-CONFIG-A+W Business.pdf"
---


# EN CONFIG A+W Business

    Configuration


A+W Business v6




                          english




                    -INTERNAL-
Change history

Date        Edited by      Comments                                                     Version
2017-03-02 A.Noll          Reporting Service with Crystal Reports (Beta)3.10.           13.02.0122

                           Transferring stock items with quantity specification Range   13.02.0130
2017-03-09 S.Weil
                           of numbers for stock movements7.10.
2017-04-10 S.Weil          Status management per user(-group) 2.10                      13.03.0031

2017-05-29 S.Weil          EDI import of payments/complaints 6.4.5                      13.03.0080

2017-05-31 S.Weil          EDI import of payments/complaints 1.3                        13.03.0082

2017-07-31 S.Weil          Resubmission of orders 2.11                                  13.03.0136

2017-08-01 D.Langsdorf     Modify fonts 17.17                                           13.03.0138

2017-08-01 A.Münch         Product classifiers 1.9 and extension of print variables 3   13.03.0138

2017-08-08 D.Langsdorf     Reporting Service with Crystal Reports 3.10.                 13.04.0000

2017-08-14 S.Weil          A+W Smart Delivery8.4.                                       13.04.0000

2017-09-28 S.Weil/A.Noll   Integration Allgeier ECM scanview® 19.                       13.04.0000

                           FAQ chapter for reporting service with Crystal Reports       13.04.0072
2017-11-02 A.Noll
                           3.10.10
2017-11-10 A.Münch         Turning shapes 2.12                                          13.04.0080

2017-11-16 A.Noll          Configuration of the available printer 3.10.1                13.04.0087

2017-11-23 D.Langsdorf     Set Crystal Report of the datasource location 3.10.2         13.04.0092

2017-12-04 A.Münch         Processings on shape 9916.13                                 13.04.0000

2017-12-04 A.Münch         DXF import from version 6 16.14                              13.04.0000

2017-12-06 S.Weil          Hotkey per Customizing in dialogs 10.8.1                     13.04.0086

2017-12-11 A.Münch         openTrans 2.1 and credit notes 6.9                           13.04.0112

2018-02-05 D.Langsdorf     Crystal report mail extensions 3.10.1                        13.04.0136

2018-01-15 A.Münch         Tracing Delivery Date Calculation 2.7                        13.04.0146

2018-02-24 S.Weil          A+W Smart Delivery II – Rack Reporting 8.5.                  13.04.0185

2018-03-01 A.Münch         Exchange Service 23                                          13.04.0195

2018-03-14 S.Weil          Management of down payments / eCommerce orders20.8           13.04.0202




A+W Software GmbH                EN-CONFIG-A+W Business.docx                                 2
Date         Edited by     Remarks                                                        Version
2018-04-17 A.Münch         eCommerce with OMS information20.9                             13.04.0235

2018-04-17 D.Langsdorf     EDI P.O. import, cancel and update with SGG OMS 20.9           13.04.0235

2018-05-23 S.Weil          Connection to SGG Glass4U system 22                            13.04.0272

2018-09-12 D. Langsdorf    Addition of production transfer "late change" 4.16             13.04.0403

                           New function "udf_ClearStatistics" to delete the system        13.04.0410
2018-09-18 A. Noll
                           logbook, stock logbook, rack history
2018-09-26 S. Weil         Filling the purchase pool via workflow formula10.21            13.04.0405

2018-09-27 D. Langsdorf    Expansion of price calculation context 5.5.2                   13.04.0419

2018-01-30 D. Langsdorf    Capacitative transfer to production 4                          13.04.0538

2019-03-07 A. Noll         Addition "Problems and Solutions" for Crystal3.10.8            13.04.0571

2019-03-27 A. Noll         Customizing for Crystal Reports 3.10.7                         13.04.0591

2019-04-10 A. Noll         Saving CAD files in the database                               13.04.0600

                           Addition production transfer "Fileless OrderXML" interface     13.04.0618
2019-04-26 D. Niemczyk
                           4.14.13

2019-05-16 A. Noll         iTOE 2.14                                                      13.04.0637

2019-06-06 A. Noll         Form printing with Reporting Service via formula 10.26         13.04.0659

             D. Niemczyk- Define freight cost surcharge in company parameters for         13.04.0699
2019-07-18
             Brunnbauer Logistics Optimizer 8.3.2
2019-07-19 D. Langsdorf    Location-spanning lite barcodes with goods receipt 4.17        13.04.0700

                           Exchange Service Workflow Export of the debtors + creditors 13.04.0705
2019-10-25 D. Langsdorf
                           via file and Webservice 12.6                                13.04.0800

2019-07-24 D. Langsdorf    'Paid' status for incoming invoices from Allgeier DMS 19.3.1   13.04.0706

2019-10-23 D. Langsdorf    CAM credit management interface (SEMCO) 12.7                   13.04.0797

             D. Niemczyk- Define freight cost surcharge (Logistics Optimizer) 8.3.3       13.04.0811
2019-11-05
             Brunnbauer
2019-11-06 A. Noll         Avalara tax calculation 5.12                                   13.04.0812

             D. Niemczyk- Logistic Optimizer Multisite Mode (SEMCO) 8.3.4                 13.04.0813
2019-11-07
             Brunnbauer
             D. Niemczyk-                                                                 13.04.0820
2019-11-14                Smart Delivery - Breakage reports 8.4.1
             Brunnbauer
2019-11-15 A.Noll/S.Weil DOP generation and mail via Reporting Service (DMS) 1.4.8        13.04.0821

2019-11-19 A. Noll         PO export via the Dorma Web Service 6.5                        13.04.0824
                           Generation of PDFs for DMS transfer with Crystal Reports       13.04.0824
2019-11-26 S. Weil
                           3.10.12
             A. Noll                                                                      13.04.0848
2019-12-11                 User-defined column in number manager10.30
             S.Weil

A+W Software GmbH                    EN-CONFIG-A+W Business.docx                               3
Date         Edited by      Remarks                                                      Version
2020-04-29 A. Noll          Breaking Change: Reporting Service with its own setup 3.10.1 13.04.0988
                            Reporting Service: Print job with user name and print job      13.04.0988
2020-04-29 A. Noll
                            number 3.10.13
2020-05-08 S. Weil          Document check (dual control principle) 2.15                   13.04.0996

2020-06-25 A. Noll          European Article Numbers (EAN) 2.16                            13.04.1046
                            Reporting Service: Employee's sender when sending forms        13.04.1060
2020-07-10 A. Noll
                            3.10.14
                            Reporting Service: Dimensioning type of muntins in Crystal     13.04.1101
2020-08-20 A. Noll
                            Reports form printing 3.10.15
2020-09-02 A. Noll          Reporting Service: Send file attachments via mail 3.10.16      13.04.1115
                            Reporting Service: Individual cover letter for mail dispatch   13.04.1115
2020-09-02 A. Noll
                            3.10.17
2020-11-25 A. Noll          Reporting Service: Output in PDF file 3.10.18                  13.04.0937

2020-11-25 A. Noll          Reporting Service: Repeat printing 3.10.19                     13.04.1196
                            Reporting Service: Customizing for PDF file name when          13.04.1260
2021-01-29 A. Noll
                            printing via CR 3.10.21 and 3.10.22
                            Reporting Service: Separate PDF files in the mail attachment   13.04.1279
2021-02-18 A. Noll
                            3.10.23
             S. Weil
2021-03-04                  IG construction prices 5.13                                    13.04.1294
             D. Langsdorf
2021-04-06 D. Langsdorf     Limit quantities for parameterized macros 5.14                 13.04.1326

2021-04-27 D. Langsdorf     Expanded workbench (light) 4.14.14                             13.04.1342

2021-09-06 A. Noll          Reporting Service: carbon copy function 3.10.24                13.04.1469

2021-10-11 D. Langsdorf     Reporting Service: printing of QR code 3.10.25                 13.04.1474

2021-10-19 D. Langsdorf     Reporting Service: saving of the login data in CR 3.10.26      13.04.1498

2022-01-12 D. Langsdorf     Feedback Service (MQTT Broker API) 24                          13.04.1559

2022-02-15 S. Weil          Management tool Crystal Reports forms 3.11                     13.04.1585

2022-04-06 D. Langsdorf     Customizing of the product description 10.31                   14.04.1619
                            Reporting Service: Timeouts in case of several network         13.04.1650
2022-04-27 D. Langsdorf
                            adapters 3.10.27
2022-11-10 D. Langsdorf     Addition of SN.INI for DXF import and iTOE 16.16 16.17         13.04.1777

2022-11-16 D. Langsdorf     Customizing of the iTOE rules 2.14.3                           13.04.1781

29.11.2022 D. Langsdorf     Smart Companion Backend Services 25                            13.04.1791

2022-11-30 S. Weil          Entry help postal code/city in document entry 2.17             13.04.1791

2023-01-23 S. Weil          Integration Allianz Trade (Euler/Hermes) Restful API 25        13.04.1830

28.02.2023 A. Noll          Reporting Service change of the date data type 3.13            13.04.1831
                            Case examples for mounting type with iTOE/DXF import           13.04.2201
2024-05-06 D. Langsdorf
                            16.18

A+W Software GmbH                  EN-CONFIG-A+W Business.docx                                  4
Date        Edited by     Remarks                                                     Version
05/21/2024 S. Weil        Due date calculation mode 2.18                              13.04.2214

07/01/204   A. Noll       Electronic invoice for the Polish market (Comarch/KSeF) 2.19 13.04.2250
07.10.2024 I. Deker       Fibu-WebService via customizing (Beta not released) 12.8    13.04.2333
                          Crystal Report+Workflow Mailversand Office365 (oauth2)      13.04.2339
2025-01-07 D. Langsdorf
                          3.15
2024-10-23 A. Noll        EDI interface (Multiuser extensions) 6.2                    13.04.2346

2024-12-11 I. Deker       FinAc Workflow Implementation 12.9                          2450-04-13

2025-04-14 D. Langsdorf   Electronic invoices (XRechnung, ZUGFeRD)                    2495-04-13




A+W Software GmbH               EN-CONFIG-A+W Business.docx                                 5
Table of Contents
1.   Master Data _______________________________________________ 18
     1.1. CE code (SGG)                                          18
                  Master Data                                                                      18
                  Import of CE master data                                                         19
                  Product Master Data                                                              21
                  Partner Master Data                                                              22
                  Determining the CPIP code                                                        23
     1.2.   Expansion of the CE labeling                                                           26
                  General                                                                          26
                  Master Data                                                                      26
                  Import and AIS (workflow)                                                        28
                  Document recording                                                               28
     1.3.   E-mail notification for missing CPIP code                                 29
     1.4.   Construction Products Regulation / Sending of Declarations of Performance 31
                  Configuration                                                                    32
                  Automated creation of a declaration of performance                               34
                  Master data for connection to A+W SLT                                            35
                  Item entry                                                                       37
                  Form printing                                                                    38
                  General information                                                              40
                  Customizing the form                                                             41
                  Generation and sending of the declaration of performance via Reporting Service   42
                  Transfer of the declaration of performance to Allgeier scanView DMS system       44
     1.5.   Customer calendar                                                                      45
     1.6.   Duplicate documents                                                                    49
                  Master Data                                                                      49
                  Document recording                                                               49
     1.7.   Supply types                                                                           49
                  Settings and their meaning                                                       49
     1.8.   Article Import                                                                         53
                  BMECat                                                                           53
                  B2B Article Import                                                               54
     1.9.   Product classifiers                                                                    56

2.   Documents ________________________________________________ 62
     2.1. Active entry support of edgework                      62
     2.2. Assigning fittings to processings                     63
                  Master Data                                                                      63
                  Processing text                                                                  64
                  Entry                                                                            64
                                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL


                  Inserting and exchanging                                                         66
                  Finished products                                                                66
     2.3.   Checking spacers with LeCheck                                                          67
                  Preconditions                                                                    67
                  Type                                                                             71
     2.4.   Invoice management / Project management                                                72
                  The four different modes                                                         72
                  Standard mode                                                                    72
                  Invoice management                                                               72
                  Invoice management with allocated orders                                         72
                  Extended Project Management                                                      74
     2.5.   Product Exchange Groups                                                                76
                  General information                                                              76
                  Set-up                                                                           76
                  Application                                                                      79



                                                                                                        6
     2.6.   Generation of partial deliveries                                    81
                  Per ready report / goods receipt                              81
                  Per rack                                                      85
     2.7.   Delivery date calculation                                           87
                  A+W Capacity                                                  88
                  A+W Business Capacity Planner                                 91
     2.8. TPS/LSG invoices                                                      92
     2.9. User-defined text fields in the document header                       93
     2.10. Status management per user(-group)                                   94
     2.11. Resubmission of orders                                               96
     2.12. Turning of shapes in the document entry                              99
     2.13. Saving of TOE files of the CAD Designer (Shapes) in the database    101
                  Extracting the CAD files from the database with T-SQL        101
     2.14. Integrated Technical Order Entry (iTOE)                             104
                  Restrictions and configuration                               107
                  Shape rotation                                               107
                  Rules with workflow formula                                  107
     2.15. Document check (dual control principle)                             108
     2.16. European article numbers (EANs) for variants and stock dimensions   110
     2.17. Entry help postal code/city in document entry                       111
     2.18. Due date calculation mode                                           112
     2.19. Electronic invoice for the Polish market (Comarch/KSeF)             115
                  Lead-up                                                      118
                  Send                                                         118
                  Receipt                                                      118
                  Confirmation                                                 118

3.   Form printing _____________________________________________ 120
     3.1. Document view variables                                120
                  Header                                                       120
                  Item variables                                               122
                  BOM variables                                                123
     3.2.   Form printing variables                                            124
                  Header                                                       124
                  Item variables                                               130
                  Footer variables                                             135
                  BOM variables                                                136
                  BOM parameters: (STx_PARAM)                                  139
                  Bit vector structure                                         140
                  Parameters for bent glass (STx_GEBOGEN)                      142
     3.3.   Print dimensioned sketches on forms                                143
     3.4.   Printing of production sketches from version 3.3                   144
                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL



     3.5.   Print server installation                                          144
                  Installation of server and client                            144
                  Configuration of the master data                             144
                  Sending emails via PDF mailer                                145
                  The PDF mailer form                                          146
     3.6.   Form printing in the DMS system (Saperion)                         146
     3.7.   Portuguese certification                                           148
                  Introduction                                                 148
                  Company Master Data                                          148
                  Invoice printing                                             149
                  Cancel invoice                                               152
                  SAFT-PT export                                               153
     3.8. E-mail sending per document type                                     154
     3.9. ActiveFax connection                                                 155
     3.10. Print service with Crystal Reports                                  156

                                                                                     7
                  Installation and configuration                                          156
                  Creation of the Crystal Reports                                         169
                  Creation of Subreports                                                  181
                  Special action report fields                                            187
                  Architecture of the Print Service                                       191
                  Adaptations of existing customizing formulas                            192
                  Customizing in the reporting service with Crystal Reports               193
                  Form printing via workflow formula                                      195
                  Function reference                                                      195
                   FAQ                                                                    196
                   Known problems and their solutions                                     201
                   PDF file generation for the DMS archiving with Crystal Reports         210
                   User name and print job number in the printer queue                    211
                   Employee's sender when sending forms                                   211
                   Dimension type of muntin drilling points                               212
                   Send file attachments via e-mail                                       212
                   Individual cover letter for mail dispatch                              215
                   Output in PDF file                                                     216
                   Reprint                                                                217
                   Not supported RTF tags                                                 218
                   PDF file names in mails                                                218
                   Customizing for mail subject line and PDF file name                    218
                   Separate PDF files in the mail attachment                              220
                   Carbon copy function / watermark                                       222
                   Print QR codes                                                         224
                   Saving the login data in the Crystal Report                            226
                   HOSTNAMEHOSTNAME                                                       228
                   Timeouts in case of several network adapters                           228
     3.11. Management tool Crystal Reports forms                                          231
                  Preparation and important notes                                         231
                  Introduction                                                            232
                  Creating a report group                                                 232
                  Optimizing a report group                                               234
                  Optimizing Crystal Report                                               234
     3.12. PDF generation in form printing                                                237
                  Settings                                                                237
                  Form management change of the date data type in the Reporting Service   239
     3.13. Stopping the reporting service                                                 241
     3.14. Crystal Report+Workflow mail with Office365 + OAuth2                           243
                  Saving of the tokens                                                    244
                  Configuration OAuth2 in Azure (Office365)                               245
                  Tracing                                                                 247
                  Workflow mail in A+W Business                                           248
     3.15. EI = electronic invoice (XRechnung, ZUGFerd)                                   249
                  Introduction/requirements/architecture                                  249
                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL



                  Export management                                                       251
                  Master data                                                             252

4.   Production _______________________________________________ 254
     4.1. Transfer to production                                254
                  Types                                                                   254
                  Programs                                                                254
                  Configuration                                                           258
                  Automatic transfer to production                                        273
                  Item-related transfer to production and barcode registration            274
     4.2.   Production release                                                            278
     4.3.   Cancellation                                                                  278
     4.4.   Optimization of quotations                                                    279
     4.5.   Production Feedback                                                           279
                  A+W Capacity message after scheduling (CompleteScheduling)              279


                                                                                                8
                  Scheduling and completion reports                                  280
                  File-based production report                                       281
                  File-less report                                                   291
     4.6.   Production overview                                                      294
                  Registration point overview                                        294
                  Online production overview                                         295
     4.7.   Capacity overview                                                        297
     4.8.   Production orders                                                        298
                  Installation                                                       298
                  Definition of work orders                                          299
                  Completion report for work orders                                  303
                  Completion report for work orders and withdrawal of raw material   304
                  Use of BOM elements in a production order                          306
     4.9. Linking of master data                                                     307
     4.10. Surplus                                                                   311
     4.11. Notification of order information and receipt of goods                    313
     4.12. Miscellaneous                                                             314
     4.13. STST archiving                                                            315
     4.14. Transfer to production (OrderXML) and feedback                            316
                  General                                                            316
                  Standard transfer                                                  316
                  Illustrated standard transfer process                              317
                  Status allocation in DEMO44                                        318
                  Cancellation of transfer to production                             318
                  Order transfer to capacity planning                                319
                  Illustrated process: transfer to capacity planning                 321
                  Automatic transfer to production                                   322
                  Production Feedback                                                322
                    Initial status process of an order                               322
                    Transfer of customer's language via OrderXML                     323
                    Type codes for file annex types                                  324
                    Fileless OrderXML transfer                                       325
                    Expanded workbench (light)                                       331
     4.15. Production preview                                                        332
     4.16. Transfer of non-production-relevant changes                               334
     4.17. Location-spanning lite barcodes with goods receipt                        336

5.   Price calculation ___________________________________________ 342
     5.1. Surcharge type for miscellaneous surcharges on replacement sheets 342
     5.2. Automatic transport surcharge on all IG items                     343
     5.3. Change miscellaneous surcharge calculation                        344
     5.4. Correction of original sales prices                               345
     5.5. Pricing by formula                                                346
                                                                                               A+W Software GmbH - Configuration A+W Business - INTERNAL




                  Syntax                                                             346
                  Pricing context                                                    347
                  Documentation of functions                                         347
                  Customizing quantity limits for pricing                            348
     5.6.   Calculation of and Search for Average Purchase Costs                     348
                  Functions up to ALFAK Version 4.1                                  348
                  Functions up to ALFAK Version 2007                                 349
                  Functions starting from ALFAK Version 2008                         349
     5.7.   Imputed freight costs                                                    352
     5.8.   Down payments                                                            352
                  Operation                                                          352
     5.9.   Shape edge surcharges                                                    353
                  Introduction and the problem                                       353
                  Setting up shape edge price surcharges                             354


                                                                                           9
                  Creation of shape edge qualities                                        355
                  Order entry pricing                                                     356
                  Effects on production transfer                                          357
                  Setting up Business Capacity Planning                                   359
     5.10. Wastage rates for price calculation                                            360
                  Management dialog                                                       360
                  Document archiving and copying                                          361
     5.11. Energy Surcharge                                                               362
                  Rounding Parameters                                                     362
                  Defining an Energy Surcharge Article                                    363
                  Entering the Energy Surcharge Article in Company Parameters             364
                  Activating the Surcharge in Customer/Supplier Data                      366
                  Order entry                                                             367
                  Recalculation after a Change of Price                                   368
                  Changes in Version 4.1                                                  369
     5.12. Tax calculation by Avalara Tax Service                                         369
     5.13. IG construction prices                                                         373
     5.14. Limit quantities for parameterized macros                                      375

6.   Purchase ________________________________________________ 377
     6.1. Transfer to purchasing                               377
                  Executing the P.O. transfer                                             377
                  Repeated P.O. transfer after item changes                               377
                  Status points overview                                                  377
                  Purchase order for Georgian bars                                        378
     6.2.   EDI Interface                                                                 379
                  Preparations and settings                                               379
                  Customers                                                               379
                  Selection of external documents                                         381
                  Multi-user operation                                                    382
                  Checking the reference article                                          383
                  Creating the documents                                                  383
                  Customizing function for scheduling the files                           383
                  DXF shape recognition                                                   384
                  Progress indicator/options                                              384
                  Import in background                                                    385
                  Processing parameter check                                              385
                  KLAES – XML / Internorm EDI interface version                           385
                  Internorm interface                                                     386
                  EDI import of payments/complaints                                       387
     6.3.   Export of purchase orders                                                     389
     6.4.   PO export via the Dorma Web Service                                           393
     6.5.   Additional functions                                                          396
                  Copy external products:                                                 396
                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL



                  Edge reduction for Georgian bars in customer data as from Version 3.3   396
     6.6.   Electronic document exchange                                                  397
                  Order confirmation and invoice                                          397
                  Dispatch notifications                                                  401
     6.7.   Export of invoices                                                            401
                  Preparations                                                            401
     6.8.   openTrans 2.1 and credit notes                                                401
                  Notification                                                            403
                  Generation of repurchases                                               403
                  Message to production                                                   406
                  Configuration in A+W Production                                         407
     6.9.   Change of the order quantities in case of under or oversupply of purchased parts
                                                                                        408
                  Configuration in A+W Production                                         409



                                                                                                10
7.    Stock ___________________________________________________ 410
      7.1. Configuration examples                               410
      7.2. Availability on stock and replacement time           414
      7.3. Goods received and shipped in boxes                  419
      7.4. Combined stock mode and XTV/XOPT report              420
      7.5. Stock initialization                                 420
      7.6. Stockkeeping: Boxes with BOM                         421
                   Installation                                           421
                   Master data definition                                 421
                   Product Master Data                                    421
                   Prices                                                 422
                   Stock sizes                                            423
                   Stock management                                       425
                   Item entry                                             426
      7.7.   Hegla Warehouse Incorporation                                428
                   Preconditions                                          428
                   Configuration                                          428
                   Effects                                                428
                   Types of booking                                       429
      7.8.   Stock evaluation according to FIFO/LIFO                      432
                   Set-up                                                 433
                   Initial evaluation                                     433
                   Evaluation in stock statistics                         435
                   Re-initialization of the stock evaluation              436
                   Change to the PCH in the stock management              436
                   Change to goods receipt                                436
      7.9. Customizing the availability for stored goods                  437
      7.10. Stock transactions                                            439
                   Transferring stock items with quantity specification   439
                   Range of numbers for stock movements                   439

8.    Shipping ________________________________________________ 442
      8.1. Loading list                                         442
                   Operation                                              442
      8.2.   Rack management                                              444
                   Rack load in rack history                              444
                   Sheet shipping rack allocation                         444
                   Resubmission of racks                                  445
      8.3.   A+W Logistics Optimizer Integration                          447
                   Logistics Service Settings                             448
                   Settings/operation in A+W Business                     450
                   Start barcode for break scanning                       452
                   Multisite mode                                         452
                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL



      8.4.   A+W Smart Delivery                                           457
                   Breakage report                                        460
      8.5.   A+W Smart Delivery – rack reporting                          463

9.    Statistics ________________________________________________ 465
      9.1. Quotation evaluation / Statistics                      465
                   Document recording                                     465
                   Quotation statistics                                   466
                   Printing of quotation statistics                       466

10.   Customizing ______________________________________________ 468
      10.1. Introduction                                         468
      10.2. Enable Customising                                   468
      10.3. Formula management                                   469


                                                                                11
      10.4. Formula allocation                                         470
      10.5. Control elements                                           470
      10.6. Tables                                                     472
      10.7. Window                                                     472
      10.8. Customizing Buttons                                        473
                  Hotkey in dialogs                                     474
      10.9. Form printing                                              474
      10.10. Program formula allocation                                475
      10.11. Functions and Variables                                   476
      10.12. Syntax                                                    477
      10.13. Customizer                                                480
      10.14. Rights 481
      10.15. Parameter transfer from formula to formula                481
      10.16. Variable and function reference                           482
      10.17. Size formulae                                             494
      10.18. Text Customizing                                          495
      10.19. EDI Customizing                                           496
      10.20. P.O. Transfer                                             497
      10.21. Filling the purchase pool via workflow formula            498
      10.22. Tax calculation                                           500
      10.23. Cash discount date calculation                            506
      10.24. Data container for customizing data                       507
      10.25. Sending the declaration of performance                    512
      10.26. Form printing via the reporting service                   513
      10.27. OrderXML transfer via the import service                  515
      10.28. Breakage transfer from the Logistic Service               516
      10.29. Examples                                                  516
      10.30. User-defined column in number manager                     534
      10.31. Creating a product description from BOM                   537
      10.32. iTOE rules                                                538

11.   Workflow ________________________________________________ 540
      11.1. Introduction                                                540
      11.2. Schematic display                                           541
      11.3. Transfer to ALCIM Capacity Planning                         543
      11.4. Report status from ALCIM Capacity Planning                  543
      11.5. Printout after ALCIM Capacity Planning                      543
      11.6. Status reduction due to an error in ALCIM Capacity Planning 543
      11.7. Check for ordered elements                                  543
                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




      11.8. Release for production in ALFAK                             544
      11.9. Release for production in ALCIM                             544
      11.10. Management                                                 544
      11.11. Workflow Tasks                                             545
      11.12. Report from ALCIM Capacity Planning                        546
      11.13. Change of order after release for production               547
      11.14. Automatic transfer to production                           550
      11.15. Notifying the Service Monitor                              550
      11.16. EDI orders                                                 550
      11.17. Notification at order entry                                550
      11.18. Managing the production status in table BW_LOCK_KAPA       551
      11.19. Structural order changes                                   551


                                                                              12
      11.20. Availability on stock                                              551
      11.21. Automatic transfer to statistics, archives, or document deletion   552
      11.22. Constants and functions used                                       555
                   Constants                                                    555
                   Functions                                                    556

12.   Interfaces to Financial Accounting _______________________________ 561
      12.1. Brilliant                                                    561
      12.2. Datev                                                        561
      12.3. Varial                                                       562
      12.4. eGecko                                                       564
      12.5. Customizing of the Transfer to Financial Accounting          566
                  Customising items                                             566
                  Variables and functions used                                  568
                  Customer category w_fktDKP                                    569
                  Format functions                                              571
                  UDF functions for manipulating/adding fields                  573
      12.6. Export debtors and creditors in the workflow                        574
                  With file                                                     574
                  With Webservice (eGecko)                                      574
      12.7. CAM credit management interface                                     576
      12.8. Fibu-WebService via customizing (Beta not released)                 581
                  Overview                                                      581
                  Functions                                                     581
                  Trace notes                                                   584
      12.9. FinAc - workflow functionality                                      585
                  Overview                                                      585
                  Workflow execution                                            585
                  Functioning and special functions                             586
                  Sample implementation                                         587

13.   Databases _______________________________________________ 588
      13.1. Replication                                         588
                  Activating replication                                        589
                  Defaults                                                      597
                  Known Problems                                                597
      13.2. SQL Server Migration                                                598
                  Database Connection                                           598
                  Limitations                                                   599
                  SQL Server setup                                              599
                  Migrating an existing database                                600
                  Time required                                                 603
                  Tips and tricks                                               603
                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL



                  Note with activated change monitoring                         604
      13.3. SQLBase Settings                                                    604

14.   Capacity planning __________________________________________ 606
      14.1. Description                                            606
      14.2. Master data                                            606
                  Work types                                                    606
                  Allocations:                                                  607
                  Machine types                                                 608
                  Machines                                                      608
                  Default times                                                 608
                  Product areas                                                 608
                  Transition time/matrix                                        608
                  Calendar                                                      608
      14.3. Scheduling                                                          609

                                                                                      13
                  Programs                                                        609
      14.4. Updating the old capacity planning to Patch July 2011                610
      14.5. Configuring ALCIM with ALFAK capacity planning and OrderXML          615
      14.6. Customizing variables for machines, dwell days, priorities to be used for
            scheduling                                                           618
      14.7. Calculation of time costs for quotes                                 620
      14.8. Capacity information by customer                                     620

15.   Production data collection (barcoding) ____________________________ 623
      15.1. Introduction                                                  623
      15.2. Settings                                                      624
                  Scanner                                                         624
                  Master Data                                                     625
                  Interface Service                                               627
                  Capacity planning                                               627
      15.3. Functions                                                            628
                  Login                                                           629
                  Receipt of goods                                                629
                  Completion and breakage report                                  630
                  Stock booking                                                   632
                  Racks                                                           639
                  Miscellaneous                                                   642
      15.4. Barcodes                                                             643
                  Printing barcodes                                               646
      15.5. Booking history                                                      646

16.   A+W CAD Designer (Shapes) ___________________________________ 648
      16.1. Print dimensioned sketches                              648
      16.2. Copy SN files                                           648
                  Rectangles and standard shapes:                                 649
                  Shape 99 (free shape, Shaping Nesting file):                    650
                  Shape 98 (shape based on template):                             651
      16.3. Edge processing via SN4                                              651
      16.4. Bug Fixes                                                            652
      16.5. Handling of notches and cut-outs in SN4                              652
      16.6. Template input                                                       653
                  Prerequisite                                                    653
                  Procedure                                                       653
      16.7. Automatic Variables for Template Input                               655
                  Drilled hole                                                    656
                  Edge cut-out                                                    656
      16.8. Other essential SN.INI settings                                      657
                                                                                             A+W Software GmbH - Configuration A+W Business - INTERNAL



      16.9. Settings in EDGE.INI                                                 657
      16.10. 24 Bit color depth and RDP 6.1                                      657
      16.11. Configuration of the page view                                      657
      16.12. Turning shapes                                                      658
      16.13. Processings on shape 99                                             659
      16.14. New DXF import starting with version 6                              660
      16.15. Horizontal display of the dimensioning                              662
      16.16. Places after the decimal point for iTOE and DXF import              663
      16.17. Shape rotation in the iTOE and DXF import                           663
      16.18. Case examples for mounting types in the iTOE                        664
                   Header part representatives as commercial processing           664
                   Shift of the processing to sub-lites                           664
                   CAD decides                                                    665



                                                                                        14
      16.19. Processing restrictions                                                        665
      16.20. DXF import conversion of the dimensions                                        665

17.   Miscellaneous _____________________________________________ 666
      17.1. Euro conversion                                                                  666
      17.2. Extended CommonBase in ALFAK and ERP elements                                    671
      17.3. English table views                                                              683
      17.4. Convert thickness from Inch to mm                                                683
      17.5. Copy documents between two databases                                             685
      17.6. Spacer Text                                                                      686
      17.7. Processing text                                                                  687
      17.8. Predefined password                                                              687
      17.9. Licence management                                                               688
      17.10. Registration and unregistration of COM objects                                  688
      17.11. Dispatch - referencing/rack allocation                                          688
      17.12. Transfer to statistics, archiving, and deletion of documents(old)               690
      17.13. Archiving and deleting of documents                                             692
      17.14. Export ALFAKTrösch Controlling                                                 693
      17.15. Adapt the script for statistics and transfer to archives after updating to a higher
             ALFAK2000 version                                                               693
      17.16. Japanese version                                                                693
      17.17. Changing the report fonts                                                       694
      17.18. Interface demon                                                                 694
      17.19. Script management /Update from 3.1 or 3.2 to 4.1                                695
      17.20. Script management - documentation on tables and columns                         695
      17.21. Changing the user registration in version 4.1                                   695
      17.22. AWDoor (doorart) as from ALFAK2006                                              696
      17.23. Contribution margin analysis                                                    699
      17.24. Monitoring of changes                                                           699
      17.25. Hotkeys for Document Recording                                                  702
      17.26. Colored item lines in the item recording                                        706
      17.27. Performance measurement in document entry                                       707
      17.28. Configuration Europool                                                          709

18.   Integration A+W Sharepoint DMS ________________________________ 712
      18.1. Master data / utilities                                   712
      18.2. Form management – OM commands                             715
      18.3. Indexing and path from registration                       716
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL



19.   Integration of Allgeier ECM scanview® _____________________________ 717
      19.1. Master Data                                                   717
      19.2. Connection to scanview® Webservice                            719
      19.3. Status - updating POs                                         720
                   Incoming invoice status paid and partially paid                          722
      19.4. Display from the document entry                                                 722
                   Display from number manager                                              722
                   Display from document data                                               723

20.   SGG eCommerce ___________________________________________ 724
      20.1. Overview                                            724
      20.2. Installation                                        724
      20.3. Update database                                     724


                                                                                                   15
      20.4. Set-up of FTP server and web service                             724
      20.5. EDI import from an index with article referencing                725
      20.6. Transfer of changes to customer base                             726
      20.7. Transferring of order changes                                    727
      20.8. Management of down payments / eCommerce orders                   728
                   Credit Limit Check                                        728
                   eCommerce order reference                                 728
                   Import of eCommerce order without surcharge calculation   728
      20.9. eCommerce with OMS information                                   729
                   EDI Import - Purchase Orders with Order Reference         731
                   EDI Import - Document Cancellation                        731
                   EDI Import - Modification of Documents                    732

21.   SGG OMS ________________________________________________ 733
      21.1. Requirements                                       733
                   Setup Launcher                                            733
                   Older ESB / infrastructure                                733
                   SQL Server instance                                       733
      21.2. Server Installation                                              733
                   Setup Packages                                            733
      21.3. Client Installation                                              736
                   Setup Packages                                            736
      21.4. Installation of the SGG ATP Call                                 738
      21.5. Database Update                                                  739
      21.6. Set-up and use of the ATP query                                  739
                   Two new formulas must be created                          739
                   Set-up of the ATP query                                   740
                   Status point for ATP query                                740
                   Type                                                      741
                   Use of the dialog                                         742
                   Logging                                                   743
      21.7. Phase II (transfer to Purchasing and EDI export)                 745
                   Installation                                              745
                   Configuration                                             745
                   Use                                                       750
      21.8. Phase III (transfer of status changes to OMS)                    751
                   Installation                                              751
                   Configuration                                             751
                   Description                                               752
                   Status allocation                                         752
      21.9. Phase IV (transfer from ASN)                                     753
                   Installation                                              753
                   Configuration                                             753
                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL



                   Description                                               754

22.   Connection to the SGG Glass4U system ____________________________ 756
      22.1. A+W Business to Glass4U                                     756
      22.2. Glass4U to ERP Webservice (A+W Business)                    760
                   erpSettings – Structure                                   761
                   deliveryInfo – Structure                                  762
                   Notes / Restrictions                                      762

23.   Exchange Service (Workflow Execution) ____________________________ 763
      23.1. Installation                                                 763
      23.2. Prerequisites                                                763
      23.3. Set-up on the infrastructure web                             763
      23.4. Exchange Service configuration                               766


                                                                                   16
      23.5. Settings in A+W Business                                           767
      23.6. Reworking                                                          770
      23.7. Tracing                                                            771

24.   Feedback Service (MQTT Broker API) ______________________________ 774
      24.1. Installation                                                775
      24.2. Configuration                                               775
                  AWBusiness                                                    775
                  Infrastructure configuration                                  776
                  Testing and monitoring                                        777
      24.3. Basic knowledge                                                    778
                  MQTT Topics                                                   778
                  Subscribing to topics                                         779
      24.4. Delivery date update                                               780
                  Delivery date update in A+W Business                          782
                  MQTT Topic 4 expansion of dispatch                            783

25.   SGG Integration Allianz Trade (Euler/Hermes) Restful API ________________ 785
      25.1. Company data                                                        786
                  Formula example                                               786
                  Territories (finan.)                                          787
      25.2. Customer (financial data)                                          788
      25.3. Document entry (totals)                                            790

26.   Smart Companion Backend Services ______________________________ 791
      26.1. Receipt of goods                                          796
      26.2. Outgoing goods                                            797
      26.3. Inventory                                                 797

27.   Table of Figures ____________________________________________ 798

28.   Table directory ____________________________________________ 806




                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                      17
1. Master Data
1.1. CE code (SGG)
This documentation describes which settings are to be made in ALFAK to start up the CE marking
features.     The documentation is based on the development specification
SPEZ_060504_CE_SGG_118652.doc.
Basically, you have to make sure before the start-up that all update scripts have been run as well
as a complete update of the ALFAK version.
The aim of the described function is to calculate a so-called CPIP code at document entry and print
it on the forms. The customer who receives these forms, e.g. in the shape of an order confirmation,
can use this code for asking SGG for the corresponding CE code.
Apart from determining the CPIP code, the system checks a couple of restrictions and informs the
user of the result. The system will reject or prevent entries which are invalid due to the rules for
CPIP creation which we are going to describe later on.

           Master Data
Switches in company data
Tick the checkbox CPIP creation on tab 6.Pricing in company data.




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 1: Company data, option CPIP creation is active




                                                                                                  18
          Import of CE master data
To teach the system the rules for CPIP calculation some files have to be imported into the database.
These files are supplied by SGG and can be imported into ALFAK master data via menu item CE code
– Settings. There are six files which are listed below:
CPIP Code:              When configuring product master data, this file is used to check whether
                        an article includes a valid CPIP code. Furthermore this file suggests the type
                        of certification if a valid CPIP code was allocated to the article.
IG search data:         This file contains all information for determining the CPIP code for IG.
                        These data control the behavior of order entry.
Size restrictions:      At order entry, this file will tell the user whether the current item exceeds
                        CE-relevant size restrictions.
Standard values:         Settings which are not preset for the IG unit will be preset by standard
                        settings from this file in order to determine the CPIP code in search data.
LG – search data:       This file contains all information for determining the CPIP – Code for
                        laminated safety glass. These data control the behavior of order entry.
LG – search data:       This file contains all information for determining the CPIP – Code for single-
                        sheet safety glass.
Use the 'folder' buttons to select the required file for the import. After that, click on the Load
button. Import begins; the data will be saved in the database. Saving the data in the database can
take some time depending on the size of the file.
The import can be repeated anytime, e.g. in order to import updated files. Depending on the mode
(see fig. 2), the program will delete all old data before importing the new files, or it updates the
existing data. The updated data will not be checked any further.
The import can also be run as a workflow task. This is done by means of the function
df_ImportCEFile which is described in detail in the customizing documentation.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                    19
Fig. 2: Settings dialog for importing CE master data

When all files have been imported, the data can be displayed in the administration dialogs where
they can be amended if necessary; individual records can be deleted or added. All administration
dialogs can be found in the ALFAK master data program in menu CE codes; their operation matches
that of the ALFAK standard functions.




                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                              20
           Product Master Data
The next step in master data configuration is to define the CPIP codes for every CE-relevant article
in product master data. When you have chosen a product, the CE relevance, the certification type,
the product type and the CPIP code can be entered on tab Inventory/Purchasing in product master
data. Later on we are going to describe how these data influence the definition of the CPIP code at
document entry.




Fig. 3: CPIP data in product master data

When you enter the CPIP code the program will check whether this is a valid code. It will check if
the previously imported file CPIP code contains the given code. If not, an error report appears and
the entries cannot be saved. If the record exists however, the corresponding entry is preset in
combo box Certification, and saving will be possible.
                                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL



Valid entries for the certification type are 0 – self-explanatory, 1 – certified, 2 – certified with size
restrictions. Chapter 3.1 The rules further down in the table shows the effects of the corresponding
settings.




                                                                                                       21
           Partner Master Data
Master data for customers and suppliers have to be configured next. Open partner management
and tick the checkbox CPIP creation on tab 9. Production for all partners for whom the CPIP code
shall be determined at document entry,




Fig. 4: Partner master data




                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                              22
           Determining the CPIP code
The Rules
The specification describes the rules according to which the CPIP codes will be determined at
document entry. They are listed in the table below.
 Certification -           0 - self-explanatory                   1 - certificated / 2 - certificated with
                                                                  size restrictions
 Product type
 General         can get a CPIP code but does not have must get a CPIP code
                 to
                                                       CE relevant components must not
                 CE relevant components must not be be deleted
                 deleted
 Single annealed Replacing or adding CE-relevant Replacing or adding CE-relevant
 LG              elements will remove the CPIP code    elements is not permitted
 Insulated Glass After replacing a CE relevant While the certification type self-
                 component the search for a CPIP code explanatory permits to save the
                 will be restarted                     item if no CPIP has been found or
                                                       has been removed, saving is not
                 Replacing CE-relevant elements which permitted here.
                 are not checked by the IG CPIP search
                 will remove the CPIP code
Tab. 1: Rules for CPIP creation

         1.1.5.1.        Document recording
While a new item is entered, the system checks whether CPIP creation is enabled in the partner's
document header. If so, the CPIP code for a CE relevant article is copied from the product to the
item. This is visible at item entry on tab 6. Further details. Here, you can also disable the search and
the restriction check for the current item. You only need to untick the checkbox CE flag. Once
disabled, the code cannot be enabled again. You would have to enter the current item again to do
so.




                                                                                                             A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                       23
Fig. 5: CPIP code at item entry

For IG, the CPIP code is not defined by copying from product master data but by searching in the
previously imported search data. All relevant elements of the IG unit and the corresponding CPIP
code have been defined there.
If a rule is violated by adding, replacing or changing a component, a corresponding error report
appears. If it is clear right from start that an element cannot be deleted or replaced, the
corresponding action cannot be executed at all. The entry menu and the corresponding menus are
disabled in this case.

         1.1.5.2.        Form printing
Printing the data requires an amendment of the corresponding forms. The print program offers the
following variables for the form.
                                                                                                                 A+W Software GmbH - Configuration A+W Business - INTERNAL



 Variable        Data             Description
                 type
 CE_CPIP         String           CPIP item code
 CE_FLAG         Number           CPIP check active (0 = disabled, 1 = active)
 CE_LEVEL        Number           Certification type (0 = self-explanatory, 1 = certified, 2 = certified with
                                  size restriction
Tab. 2: Form variables




                                                                                                            24
         1.1.5.3.        Transfer to production
The data will be transferred to ALCIM during export. In the transfer to production settings please
make sure that interface version 2.3 has been selected. The following text records are defined for
the CE data.
 Field name        Record type            Description
 CE_CPIP           Text    type           CPIP item code
                   5100
 CE_FLAG           Text    type           CPIP check active (0 = disabled, 1 = active)
                   5101
 CE_LEVEL          Text    type           Certification type (0 = self-explanatory, 1 = certified, 2 = certified
                   5102                   with size restriction

 POS_TEXT3         Text        type Naviglas Code
                   5103
Tab. 3: Transfer to production - fields




                                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                               25
1.2. Expansion of the CE labeling

           General
The determination of the CE data has been expanded to include a logic for the determination of the
CPIP codes for TG and LG. Two new management dialogs have been added for this purpose. These
are the TG search data and LG search data dialogs.

           Master Data
The CPIP codes for the LG glass are stored on the TG search data dialog. Here, two values must
always be entered. The first value is the CPIP code for the TG without the processing heat soak test;
the second value is the CPIP code with the heat soak test. The CPIP code without heat soak test
must always be entered in the master data for the TG. During item recording, this is replaced if
necessary, depending on whether or not the heat soak is included in the item.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 6: Toughened glass search data dialog

The management dialog for the LG search data is very similar to that for the IGU search data. There,
the data for the components in the LG are recorded and a CPIP code resulting from this lamination.
CPIP codes can be stored for LG sheets with a maximum of 10 sheets. If necessary, to store LG
search data, the remaining 20 coating pages on the Master data > Products > General > Coating
side must be created. If these are missing, an appropriate error message will be displayed and it is
not possible to enter anything on the dialog.



                                                                                                   26
Fig. 7: Laminated glass search data dialog 1




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 8: Laminated glass search data dialog 2

On the Master data > CE labeling > Settings dialog, a new default value for the intermediate layers,
the foil in the LG, has been created. This value is used as default for the determination of the CPIP
code for the LG in the document recording.




                                                                                                   27
         Import and AIS (workflow)

         Document recording
In the search for the CPIP code for an item, the document recording proceeds as follows: First it is
checked whether there is a TG present. Here it does not matter whether the TG was recorded in
the BOM or as main product. For this TG, the CPIP code is read from its master data and entered
for the BOM element or the main item. Then there is a check as to whether a processing of the type
heat soak is attached to the TG. If this is the case, the TG search data table is consulted to see
whether there is an entry for the CPIP code of the TG. If this is the case, the CPIP code of the TG is
replaced by the one from the TG search data with heat soak. This method is used for all TG sheets
in the item.
After that, the search for LG sheets begins. The basis for this are the results of the TG search. The
LG is analyzed and with the current product structure, there is a search in the table of the TG search
data for an existing data record. If a hit is found here, the TG is assigned the CPIP code found. Here
too it applies that the search is conducted both for all LG sheets in the BOM as well as in the main
item.
The results of the LG and TG searches are then used as a basis for the determination of the CPIP
codes for the insulated glass. Nothing about its search logic has changed.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                    28
1.3. E-mail notification for missing CPIP code

If during item entry (e.g. Documents>Order>Order>Item) no CPIP code is found for the inserted or
changed product combination, an e-mail can be sent after leaving the item entry. The receiver can
be informed via this e-mail, that the mentioned product combination(s) have no CPIP code(s).


The customizing – formula should be written as follows:
!
********************************************************************************
***********
! ***************** Used variables;
! ***************** g_sUdv[0] = Mail subject ;
! ***************** g_lsUdv[0] = Mail body with missing CPIP codes ;


Set g_sUdv[0] = 'Missing CPIP codes';
Set g_lsUdv[0] = udf_GetMissingCPIPCodeString(w_fktDoc);


If SalStrLength(g_lsUdv[0]) > 0;
         udf_SendMail ( 'mailserver.a-w.intra', '', '', 'sebastian.weil@a-w.com',
                         'sebastian.weil@a-w.com', '', g_sUdv[0], g_lsUdv[0], '' );
EndIf;
!
********************************************************************************
***********
                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               29
The formula must be defined for the event Hide window of the item entry:




The e-mail content looks as follows:


Order 187776
Item 1
4 PLANICLEAR 4 (*)                     :M101004
99006 6          MMEA                  :01
4 PLANICLEAR 4 (*)                     :M101004




                                                                                A+W Software GmbH - Configuration A+W Business - INTERNAL




Item 2

                                                                           30
4 PLANICLEAR 4 (*)                       :M101004
99008 8           MMEA                   :01
4 PLANICLEAR 4 (*)                       :M101004



The order is specified, the item(s) and the BOM structure of the product. If the CPIP codes exist for
the BOM components, you can assume that the code for the main product is missing.



In addition, the user now also has the opportunity to assign the CPIP code manually. If this is the
case, the field in the Item entry on tab 6.Add-on is marked in red and a check and the searching for
a CPIP code is no longer executed.



If you have sent the e-mail notification, the user has the opportunity to enter the missing CPIP codes
into the basic data in relatively timely fashion. This is why the invoicing has been adjusted. If in the
print program (e.g. Documents>Order>Print order) an invoice is printed and the CPIP code for the
order item to be printed was not assigned manually, the CPIP code search routine is executed. If a
CPIP code is found, it is saved in the order item.




1.4. Construction Products Regulation / Sending of Declarations of
   Performance
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




For the implementation of the construction products regulation, it is necessary that a declaration
of performance be included with every product. The declaration of performance is stored as a file
in the system in various languages for a declaration of performance number. The declaration of
performance number is then initially entered in the product master data for the affected products.
It is then taken over into the order and can then be output during form printing and sent as an e-
mail. Each customer receives a declaration of performance just once. If the same item is delivered
again, the same declaration of performance will not be sent again. The declaration of performance
number can also be output on the forms. To do this, the affected forms for the customer must be
adjusted.




                                                                                                      31
           Configuration
First, the functionality must be activated in the company master data. To do this, a checkmark is
placed in the "Sending of declarations of performance" checkbox on the company master data
dialog on tab 4.Documents. The default declaration of performance number can also be entered
here. It is sent in the case that there is no declaration of performance present for a product but the
product should include a declaration of performance.
There must also be a check placed in this checkbox if the program A+W SLT is used for the
calculation of technical values. If the program A+W SLT is installed on the network, a check must be
placed in the "Network" checkbox and the path to the program entered in the field below.




Fig. 9: Activating sending of the declaration of performance

Before declarations of performance can be stored in the system, the path to the file attachments
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL



should be checked (Master data > Company > Company data > Tab 4.Documents). Here a path must
be set so that the system can store the documents with the declarations of performance on a data
medium. \dop is added to the path entered here and this is where the declarations of performance
that are created with the management program are stored. The automatically generated
declarations of performance are also stored there.




                                                                                                    32
Fig. 10: The declarations of performance are also stored in the path to the file attachments

For mail sending, the settings on the tab "1.Client" must also be made. In the "General settings for
sending mail" group, at least the mail server, port, and sender's address must be entered.
The management of the documents for the declaration of performance and the declaration of
performance number is taken care of on the "Master data > Products > General > Declaration of
performance management" dialog. There, one or more documents are attached with the
declaration of performance to a declaration of performance number. Only one document per
language can be attached. The documents can be selected using drag & drop or using the file dialog.
The program copies the documents independently into the folder that was stored in the company
master data.
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  33
Fig. 11: Management program for declarations of performance


           Automated creation of a declaration of performance
If the generation of the declaration of performance should be done automatically, the individual
characteristics must be entered on the "Technical values" dialog (Master data > Texts > Technical
values). These are language-dependent so that the appropriate translation of the characteristic can
be specified in the declaration of performance for foreign-speaking customers. If the user already
has completed declarations of performance, this information is not required.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 12: Naming of the technical values




                                                                                                 34
The characteristics entered here are available later on the management dialogs of the declaration
of performance and the product master data. The "Apply" column controls whether the value is
deleted or retained for the change of the product structure. The setting can be overridden in the
product management.
Finally, for the generation of a unique number for the declaration of performance, an entry must
be made in the number ranges. There, as usual, a prefix and number range are stored, which may
not overlap.




Fig. 13: The declaration of performance in the number ranges


           Master data for connection to A+W SLT
So that the technical values can be calculated correctly by A+W SLT, it is necessary to create some
master data. First, in the market partner master data, a supplier must be created for A+W SLT. This
supplier serves only to be able to reference the item number for the items of A+W SLT in the B2B
references. For coated glass, the external item number of the glass and that of the coating must be
stored separated by a semicolon (e.g. "uni-g-0001;uni-p-0002"). The coating side is then
determined automatically during the calculation of the technical values.
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




After that, the interface type A+W SLT is entered in the program B2B > Supplier > Supplier. The path
is set similarly in which the interface file should be generated. Then with the program B2B > Supplier
> Products, the references from the individual item numbers to those of A+W SLT are entered.
If these settings are all made, then later on, in the item recording, the technical values of a product
can be calculated completely automatically at the touch of a button by A+W SLT.




                                                                                                     35
Fig. 14: Settings for the B2B supplier "A+W SLT"




                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 15: The item references for A+W SLT




                                                   36
           Item entry
The declaration of performance in the item recording is either found on tab 10.Technical values or
it can be shown in the item table using the table properties.




Fig. 16: Declaration of performance in item recording

For the recording of an item with a declaration of performance, first its declaration of performance
number and also possibly values in stored technical values are taken over from the item master
data. In order to be able to assign other declarations of performance to an item automatically for
changed product structures, depending on a product structure rule, each product structure is
assigned a unique number. The management is generally done on a configuration dialog via
"Utilities > System > Declaration of performance > Product structure."




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 17: The rules for product structure




                                                                                                  37
If the product structure is changed in the item recording and a declaration of performance number
has not yet been assigned for the product structure, the declaration of performance number is
removed from the item. If you enter a declaration of performance number in the item recording
manually, the system saves this declaration of performance for the current product structure in the
database. Starting at this point in time, for all following items with the same product structure, the
system will automatically always find this declaration of performance and assign it to the item.
In order to have a missing declaration of performance pointed out, it is possible to activate the
"Message in case of missing declaration of performance" option in the item recording options. If a
declaration of performance is required for a product and if no declaration of performance is present
for the current product structure, then a warning message appears when saving the item. The item
is saved nevertheless.
The technical values of the product can also be edited in the item on the tab 10.Technical values. If
the product structure has already been saved previously with a declaration of performance and
with technical values, then these are loaded automatically and they can no longer be changed
manually.
If in the company master data, the option for connection to A+W SLT is active, the product structure
can also be transferred to A+W SLT for the calculation of the technical values. The required master
data must be entered as described in Chapter 1.4.3.




Fig. 18: A+W SLT and declaration of performance on the ribbon of the item recording

In order to start the calculation of the technical values by A+W SLT, you must only click he "A+W
SLT" button in the item recording. This starts the transfer to A+W SLT and the results of the
calculations made there are taken over into the current item. After that, a declaration of
performance must be created. This is done by clicking the "Declaration of performance" button.
Thus, using the settings of the number range (see chapter 1.4.2), a new number is created for the
declaration of performance and all technical values are saved under it. This guarantees that if the
same product structure is entered again, the same data will be taken over into the item
If the option "Message in case of missing declaration of performance" is activated, and it is
attempted to save the items, a dialog appears in which you can choose on how to proceed. The
user has 3 possibilities there. You can choose not to create a declaration of performance, then the
default declaration of performance from the company master data is used for the specified product
structure, which is never questioned again. Or you create the declaration of performance now,
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




item entry changes to the Technical values tab for this purpose. The last possibility is the automatic
generation of the declaration of performance shortly before printing the form. In this process, the
transfer to A+W SLT is started for the respective forms shortly before print out and the data of A+W
SLT is saved directly in the corresponding items. The print out of the form and transmission of the
declaration of performance by e-mail is described in the next chapter.




           Form printing
If a form with activated sending for the declaration of performance is printed out, all available
declarations of performance for the item printed are sent via e-mail to the mail address stored in

                                                                                                    38
the order. The system stores per customer starting with which declarations of performance were
already sent and it does not send any duplicates. Customers with the code "Divers" are an
exception; the declaration of performance is always sent.
If there is no declaration of service for an item, one is generated automatically before sending using
the technical values stored in the item. The report "dop.qrp" is used for this. In this report, all values
from the item and the associated designations are sent in the appropriate language. Then the
report is sent to the PDF mailer stored in the employee master data; the declaration of performance
is then generated as PDF file.




Fig. 19: The gotmaxx PDF mailer in the employee master data

                                                                                                             A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                        39
           General information
For all management dialogs, the user rights can be assigned as usual. The item recording has
received two new sub-rights for the declarations of performance, which you can access via the main
program element of order recording.




Fig. 20: New sub-rights of item recording for the declaration of performance

Thus it is possible to specify in the item entry whether a user is authorized to create new
declarations of performance for a product and to change technical values. If no right to change
technical values is in place, the user can enter the code "npd", which means "no performance
defined."
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




If the declaration of performance is automatically created before form printout, the name of the
declaration of performance is created on the basis of the system text 1011 and the placeholders
that exist there. The placeholders can also be set up for the spacer texts, i.e. for instance <p2> for
the product structure or <pn> for the article number. All available placeholders are described in
chapter 26.4 Rahmentexte in the configuration instructions.




                                                                                                    40
           Customizing the form
The form dop.qrp is located in the report folder in the installation directory in the report subfolder.
After the change, it should be stored in a customer-specific path.
The topmost four lines are the control characters for the PDF export
@@df……@@ = directory for PDF files
@@sf……@@ = file name (without extension .pdf)
@@od0@@           = deactivate output dialog (do not show)
@@sv@@            = save PDF file directly
Values that begin with D_NAME, D_VALUE, D_UNIT or D_SPEC refer to values from the technical
parameters. The value next to the entry designates the number of the characteristic.
Ex.: D_NAME_12 is the name ‚ U-value of the glazing ‘, D_VALUE_12 is the current value of the
characteristic, D_SPEC_12 is the stored specification of the characteristic, and D_UNIT_12 is the
stored unit of the characteristic.
For other values, the following table applies

 S_PDF_PATH                           Directory for DOP documents (<Attachments>/Dop)
 S_PDF_FILE                           File name without ending .pdf (<LENR>_<SPRACHE>)
 M_NAME1                              Client name 1
 M_NAME2                              Client name 2
 M_NAME3                              Client name 3
 M_STRASSE                            Client street
 M_LAND                               Client country
 M_PLZ                                Client postal code
 M_ORT                                Client city
 T_LENR                               System text 1000
 T_LENR_SHORT                         System text 1001
 T_MANUFACTURER                       System text 1002
 T_ATTORNEY                           System text 1003
 T_SYSTEM                             System text 1004
 T_VALUES                             System text 1005
 T_NAMES                              System text 1006
 T_VALUE                              System text 1007
 T_SPEC                               System text 1008
 T_FOOTER                             System text 1009
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




 T_CONFIRMATION                       System text 1010
 F_LENR                               Name of the declaration of performance from item recording
Tab. 4: Construction products regulation - formula values




                                                                                                     41
         Generation and sending of the declaration of performance via
         Reporting Service
The prerequisite for the generation and sending with the Reporting Service and Crystal Reports is
first the installation and configuration of the A+W Infrastructure Service. In the configuration via
Infrastructure Web, the access data for the mail server must be entered since the sending is done
directly in the Reporting Service via SMTP.
As soon as a document is sent for printing via the print program to the Reporting service and the
sending of the declaration of performance is active in this form, the Reporting Service creates the
declaration of performance shortly before the actual printing of the document. This process can be
seen on the Tool dialog of the Reporting Service. Essentially, the same configuration must be done
as is described in the previous chapters for normal printing via Gupta Report.
The most important difference is the form via which the declaration of performance is created. This
must be created in the form management for the print code "1297 – Declaration of performance“.
Attention must be paid that here only a standard form for the declaration of performance is
created. The printing must always only be done with this one; other forms will not be used. As in
the screenshot below, as report group, the value "006 – Declaration of Performance“ must be
entered together with the language appropriate for the report.




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




If the declaration of performance should be transferred to the DMS system, this can be activated
accordingly on tab Options 1.




                                                                                                  42
For sending via mail, the settings are on tab Options 2. The subject line can contain the value <LENR>
as placeholder and are replaced with the number of the declaration of perfomance during
generation. The subject line also corresponds to the name of the PDF file that is transfered in the
attachment to the mail.
In the mail text, a complex HTML page can be specified that serves as letter. An example of this is
present in the installation folder of the Crystal Report forms (AWBodySample_XX.htm). The content
of this file can be transferred with a text editor to the corresponding system text.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                    43
An example for the report of the declaration of performance is also in the installation folder of the
Crystal Reports forms (R0006DEDE_DOP.RPT)

         Transfer of the declaration of performance to Allgeier scanView DMS
         system

The declarations of performance will be created during the print process, regardless of whether
with the Gupta Reporting Engine or with the AWSOA Infrastructure Reporting Service, in the file
attachment path (subdirectory dop).
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




With activated DMS archiving in the form management, the declaration of performance PDF file
will be transferred immediately into the transfer directory for the DMS transfer. This directory will
be stored in the company data (tab 12.Printing).




                                                                                                   44
The AWSOA Exchange Service monitors this directory (definition in the AWSOA Infrastructure Web)
and detects using the file name which document type is the one in question. If there is a declaration
of performance PDF for the Exchange Service, the declaration of performance number and the time
when the file was created are determined. This information and the file itself are then transferred
to the Allgeier scanView DMS system. If the transfer was successful, then the file is deleted from
the transfer directory. The original PDF file remains in the file attachment directory.



1.5. Customer calendar
Customer master data include a customer calendar. Accessible via: Master data > Partners >
Customer > Calendar. This calendar serves to enter periods during which a customer does not
accept payments. The graphical user interface consists of two sections. On the right there is a table
listing all customers showing at least one entry in the customer calendar. The left side contains the
section ‚Identification’ and a list. Section ‘Identification’ shows both customer information and the
corresponding year. The list shows all days of a certain year.
Calendar function
Checkboxes can be used to mark days on which a customer does not accept payments. These marks
can either be made by directly clicking on the checkbox, or by selecting several table lines. If several
lines have been marked, you have to activate a context menu by means of a right mouse click. The
context menu offers several options.


                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                      45
Fig. 21: Customer calendar 1

Click on “Omit payment” to tick all tagged lines. Click on „Do not omit payment“ to untick the
marked lines. Selecting the last option, “Data transfer”, opens another dialog. This dialog can be
used to transfer the selected dates to other customer’s calendars. Please note that only the
selected data will be applied to other customer’s calendars, not the entire calendar. To transfer the
entire calendar, select all table lines of the source calendar.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                   46
Fig. 22: Customer calendar 2

    •    Transfer options
The option controlling the transfer should a due date belong to a period in which the customer does
not accept payments, is controlled by an entry in customer master data. Accessible via Master data
> Partners > Customer > Finance > Due date calculation > Due date postponement. There are four
options. The transfer type is therefore controlled only by this entry.
Option 0: No transfer - there will be no transfer.
Option 1: Semi-split – due dates will be split into half. One due date belongs to a certain period
               before the original due date while another due date belongs to a certain period
               after the original due date.
Option 2: Shift by period – due dates will be postponed by a certain period.
Option 3: matches option 2 + an allowance
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL



The example below shall help to understand the meaning of the individual options.
    •    Print program
The logic of these options is important for the print program because when calculating due dates,
it accesses the entries in the customer calendar, and includes them in its calculations. The user
should not worry about the amendments in the print program because the additional function is
run in the background and does not affect the program operation. The only thing that needs to be
considered is that when you choose option 3, a surcharge will be added in field „Due date shift” on
the invoice.
All due dates and partial payments for invoices exist in report (rechn.qrp). The variables are called:
Due dates:
DATUM_VALUTA_SPLIT1, DATUM_VALUTA_SPLIT2, DATUM_VALUTA_SPLIT3,


                                                                                                     47
DATUM_VALUTA_SPLIT4, DATUM_VALUTA_SPLIT5, DATUM_VALUTA_SPLIT6
DATUM_VALUTA_SPLIT7
Partial payments:
SU_BETR_BRUTTO_SPLIT1, SU_BETR_BRUTTO_SPLIT2, SU_BETR_BRUTTO_SPLIT3,
SU_BETR_BRUTTO_SPLIT4, SU_BETR_BRUTTO_SPLIT5, SU_BETR_BRUTTO_SPLIT6 and
SU_BETR_BRUTTO_SPLIT7
    •   Bank receipt program
Program ‚bank receipts’ works as before. The logic has changed with regard to the creation of
reports but this does not influence the original layout of the report. Everything happens in the
background so that the user is not faced with any new operations.
ATTENTION: The bank receipt program must not be used for creating receipts for invoices issued
by the old print program. Ignoring this hint will unvariably lead to errors!
    •   Description of options
Example:
Invoice amount 300 Euro
Invoice date 10.07.2009
Customer does not accept payments in August (01.08.2009 - 31.08.2009)


Example 1: Payment term 30 days => Due date 10-08-2009
Option 1: Semi-split – due dates will be split into half. One due date belongs to a certain period
before the original due date while another due date belongs to a certain period after the original
due date.
Due date 1: 10.07.2009 => 150€
Due date 2: 10.09.2009 => 150€
Option 2: Shift by period – due dates will be postponed by a certain period.
Due date : 10.09.2009 => 300€
Option 3: matches option 2 + an allowance
Due date : 10.09.2009 => 303€ (300€ + 1%)


Example 2: Payment term 30-60 days
Due date 1: 10.08.2009
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




Due date 2 :10.09.2009
Option 1: Semi-split – due dates will be split into half. One due date belongs to a certain period
before the original due date while another due date belongs to a certain period after the original
due date.
Due date 1: 10.07.2009 => 75€
Due date 2: 10.09.2009 => 225€
Option 2 Shift by period – due dates will be postponed by a certain period.
Due date : 10.09.2009 => 300€
Option 3 matches option 2 + an allowance



                                                                                                     48
Due date : 10.09.2007 => 303€ (300€ + 1%)


Example 3: Payment term 30-60-90 days
Due date 1: 10.08.2009
Due date 2: 10.09.2009
Due date 3: 10.10.2009
Option 1: Semi-split – due dates will be split into half. One due date belongs to a certain period
before the original due date while another due date belongs to a certain period after the original
due date.
Due date 1: 10.07.2009 => 50€
Due date 2: 10.09.2009 => 150€
Due date 3: 10.10.2009 => 100€
Option 2 Shift by period – due dates will be postponed by a certain period.
Due date 1: 10.09.2009 => 200€
Due date 2: 10.10.2009 => 100€
Option 3 matches option 2 + an allowance
Due date 1: 10.09.2009 => 201€ (200€ + 1%)
Due date 2: 10.10.2000 => 100€


1.6. Duplicate documents

         Master Data
System utilities include the management program for product structure filters and document filters;
document filters can be distinguished by document type. If the product structure filter needs to be
changed, this must be updated for all documents. Press this button in administration. ATTENTION:
This may take some time and should therefore be done only in stand-alone operation.
Status points 160 and 161 have to be defined in status allocation. The lock status of item 160 makes
sure that the search for duplicates is executed only up to a certain status. After this, the changes
are no longer relevant (a useful status could be Transfer to Production)!

         Document recording
When you leave item entry (only after amendments), all documents will be checked regarding
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




duplicates; status point 160 or 161 will be allocated depending on the outcome. In the header entry,
menu ‚Functions' can be used to start function ‚Show duplicates`. This report will show the
duplicates.


1.7. Supply types

         Settings and their meaning
In connection with the master data link between ALFAK and ALCIM (i.e. product master data are
managed in Alfak only; changes are transferred to Alcim for synchronisation) for the Evolution
system, several menus and logics were changed in Alfak.



                                                                                                     49
This includes the replacement of the existing logic and control via P.O. and stock codes by parallel
management in alcim-conforming supply type. The supply type does not replace the above-
mentioned codes. It only serves for display purposes in the transfer to production menus, and
master data link. It also means that all program sections depending on purchase and stock codes
still work as before.
When Alfak 4.0 is used (no matter if this is an Evolution version), the supply type fields in product
master data and documents are filled via script, from purchase and stock codes.
This is done as follows:
 Procurement             ALCIM Description         ALFAK Code                     Purchase       Stock Cd
 type                                                                             Flg
 0                       ‘Production‘              `In-house production'          0              0
 2                       ‘Stock‘                   `Stock withdrawal'             0              1
 102                     ‘Stock‘                   'Stock withdrawal incl. 0                     2
                                                   cutting`
 9                       ‘P.O.‘                    P.O.                           1              0
 109                     ‘P.O.‘                    'P.O. (complete)'              2              0
Tab. 5: Purchase and stock code

This allocation can be defined and managed per document (type 1-5), and separately for product
master data (type 0).
This changes the transfer to production. In the element record, field 58 (supply type) could not be
filled with totally correct values so far. Mostly, a zero was transmitted which told Alcim that the
supply type had to be defined by means of its own master data.
In Alfak 4.0, the supply type defined in Alfak will be transferred. Exeptions exists. For products, only
P.O. 9 or Stock 2 are valid, depending on whether the supply type is 9 or 109
For non-products: For supply type 102, production 0 will always be transferred; otherwise, the
actual supply type. If this number is over 9, only the last digit will be transferred (e.g. 109 -> 9). This
is possible because of sophisticated distinctions in Alfak which have no meaning in Alcim.
The possibility to define the supply type via Alcim if Alfak should transfer a zero, will no longer
work.The possibility to define the supply type via Alcim if Alfak should transfer a zero, will no longer
work.
Via script, we have preset different float, toughened, and laminated glass types with supply type 1
                                                                                                              A+W Software GmbH - Configuration A+W Business - INTERNAL



As this caused problems in the glass production, we have changed the supply type for toughened
and laminated glass from 1 to 0 This does not make a difference for the ALFAK-internal variables
P.O. and stock code. In both cases, these are 0.
For a smooth and correction operation, all scrips up to (currently) 20040408a.sql are necessary.
Even if the customer does not use Evolution. The supply types are now part of Alfak in general!
If you update a dealer to 4.0 Evolution for instance, laminated glass might be set to 0 = Production
so that - if this dealer cuts his own glass - the necessary information on jumbos and tables could
not be passed on.
These sheets have to/can be manually reset to 1 = cutting in the program, or in SqlTalk.
After this, the dialogs on jumbos and table-jumbo allocation will be accessible.



                                                                                                         50
Note: e.g. for (laminated glass, product type = 3); for toughened glass, this must be changed to 2 In
a second step, the documents will be changed
STORE PROC_TEMP
PROCEDURE: PROC_TEMP STATIC
Local Variables
                  Sql Handle: hSqlCur1
                  Sql Handle: hSqlCur2
                  Sql Handle: hSqlCur3
                  Sql Handle: hSqlCur4
                  Number: nInd
                  Number: nBA_PRODUKT
                  String: sProdArtVSG
Actions
                  On Procedure Startup
                                 Call SqlConnect(hSqlCur1)
                                 Call SqlConnect(hSqlCur2)
                                 Call SqlConnect(hSqlCur3)
                                 Call SqlConnect(hSqlCur4)
                  On Procedure Execute
                        Call SqlPrepareAndExecute ( hSqlCur1, 'SELECT BEZ FROM
KA_PRODUKTART WHERE PRD_NR = 3 INTO :sProdArtVSG' )
                                 Call SqlFetchNext ( hSqlCur1, nInd )


                         Call SqlPrepareAndExecute ( hSqlCur1, 'UPDATE BA_PRODUKTE SET
FER_BESCHAFFARTNR = 1 WHERE BA_PRODUKTART = :sProdArtVSG AND FER_BESCHAFFARTNR =
0‘ )


                         Call SqlPrepare ( hSqlCur3, 'UPDATE BA_STUKL SET
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




FER_BESCHAFFARTNR = 1 WHERE BOM_PRODUKT = :nBA_PRODUKT AND FER_BESCHAFFARTNR =
0' )
                         Call SqlPrepare ( hSqlCur4, 'UPDATE BA_LAGMA SET
FER_BESCHAFFARTNR = 1 WHERE BA_PRODUKT = :nBA_PRODUKT AND FER_BESCHAFFARTNR = 0'
)
                        Call SqlPrepareAndExecute ( hSqlCur1, 'SELECT BA_PRODUKT
FROM BA_PRODUKTE WHERE BA_PRODUKTART = :sProdArtVSG INTO :nBA_PRODUKT' )
                                 While SqlFetchNext ( hSqlCur1, nInd )
                                                 Call SqlExecute ( hSqlCur3 )
                                                 Call SqlExecute ( hSqlCur4 )


                                                                                                   51
            On Procedure Close
                          Call SqlDisconnect(hSqlCur1)
                          Call SqlDisconnect(hSqlCur2)
                          Call SqlDisconnect(hSqlCur3)
                          Call SqlDisconnect(hSqlCur4)
;
EXECUTE PROC_TEMP;
ERASE PROC_TEMP;
UPDATE BW_AUFTR_POS SET FER_BESCHAFFARTNR = 1 WHERE PROD_PRODART = 3 AND
@MOD(POS_BIT/524288, 2)!=1 AND FER_BESCHAFFARTNR = 0;
UPDATE BW_ANGEB_POS SET FER_BESCHAFFARTNR = 1 WHERE PROD_PRODART = 3 AND
@MOD(POS_BIT/524288, 2)!=1 AND FER_BESCHAFFARTNR = 0;
UPDATE BW_ANFR_POS SET FER_BESCHAFFARTNR = 1 WHERE PROD_PRODART = 3 AND
@MOD(POS_BIT/524288, 2)!=1 AND FER_BESCHAFFARTNR = 0;
UPDATE BW_BEST_POS SET FER_BESCHAFFARTNR = 1 WHERE PROD_PRODART = 3 AND
@MOD(POS_BIT/524288, 2)!=1 AND FER_BESCHAFFARTNR = 0;
UPDATE BW_GUTSCH_POS SET FER_BESCHAFFARTNR = 1 WHERE PROD_PRODART = 3 AND
@MOD(POS_BIT/524288, 2)!=1 AND FER_BESCHAFFARTNR = 0;
UPDATE BA_MAKRO_POS SET FER_BESCHAFFARTNR = 1 WHERE PROD_PRODART = 3 AND
@MOD(POS_BIT/524288, 2)!=1 AND FER_BESCHAFFARTNR = 0;UPDATE BA_MAKRO_POS SET
FER_BESCHAFFARTNR = 1 WHERE PROD_PRODART = 3 AND @MOD(POS_BIT/524288, 2)!=1 AND
FER_BESCHAFFARTNR = 0;


UPDATE BW_AUFTR_STKL SET FER_BESCHAFFARTNR = 1 WHERE STL_PRODART = 3 AND
@MOD(STL_BIT/524288, 2)!=1 AND FER_BESCHAFFARTNR = 0;
UPDATE BW_ANGEB_STKL SET FER_BESCHAFFARTNR = 1 WHERE STL_PRODART = 3 AND
@MOD(STL_BIT/524288, 2)!=1 AND FER_BESCHAFFARTNR = 0;
UPDATE BW_ANFR_STKL SET FER_BESCHAFFARTNR = 1 WHERE STL_PRODART = 3 AND
@MOD(STL_BIT/524288, 2)!=1 AND FER_BESCHAFFARTNR = 0;
UPDATE BW_BEST_STKL SET FER_BESCHAFFARTNR = 1 WHERE STL_PRODART = 3 AND
                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL



@MOD(STL_BIT/524288, 2)!=1 AND FER_BESCHAFFARTNR = 0;
UPDATE BW_GUTSCH_STKL SET FER_BESCHAFFARTNR = 1 WHERE STL_PRODART = 3 AND
@MOD(STL_BIT/524288, 2)!=1 AND FER_BESCHAFFARTNR = 0;
UPDATE BA_MAKRO_STKL SET FER_BESCHAFFARTNR = 1 WHERE STL_PRODART = 3 AND
@MOD(STL_BIT/524288, 2)!=1 AND FER_BESCHAFFARTNR = 0;




                                                                             52
1.8. Article Import

           BMECat
Importing files in the format BMECat (standardized format of the Fraunhofer Institute) is carried
out via the external BMECat importer. This is called up from the A + W business MDI functions
menu. This program imports articles from manufacturers Dorma, Schlechtendahl, KL_Megla,
Provitris, Pauli and SWS.
Settings
The settings for importing the articles can be made as follows in the company master data using
tab 16: (> Company> Company data master data). Other settings can be set as follows:




Fig. 23 Company data

Pattern/template item
Since not all the relevant data for an item is going to be available in the import file, a sample item
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




must be created for the product installation. For this item, all values must be entered that do not
come with the import file (e.g. procurement type, product group...). This item needs to be selected
for import.
Product prefix
The product prefix determines the match codes for the imported products. When importing, the
external number for that article from the import file is appended to this prefix. Different prefixes
should be chosen for each manufacturer. The product prefix also determines which products can
no longer be used. Since at the start of the import, all products with this prefix will be
decommissioned, and upon importing each product, the article is re-enabled, then all items that
are not in the import file remain after import remain deactivated.
Pricing List/Code


                                                                                                    53
Entering the pricing list and price key determines which tariff prices will be applied to the imported
product.
Creating Product Numbers/Variations
This specification determines which number a new item should inserted at. If an item that was not
previously in the database is imported, then the next number available right above the entered
number will be used. The same applies to creating prices for variations.
Importing abbreviations, product info and images
These options control whether the corresponding values for articles should be filled in:
    •    Brief description: The short name of the article can be filled out with the values from the
         import file using this option.
    •    Product Info: this option lets you fill in the product info for an article from the import file.
    •    Images: If an archive of product images still exists in addition to the import file, then in the
         option activated, they are transmitted to the product images folder. The image file name
         must be entered in the import file and it must exist in the digital photo archive.
Import
When importing a new file, the manufacturer's existing products are first blocked.
Decommissioning is carried out for all products that begin with the article prefix that has been
entered. Thereafter, the import file is read and the products with their variations are determined.
Next, the products with variants and prices are imported. The left window shows the import
progress. During the import of an item, the message "Item XXX is being processed..." appears. This
text changes to "Item XXX imported successfully" if the import of the item was completed without
errors.

           B2B Article Import
Importing items from other formats is done via the master data> B2B> Product Import menu item.
An import is possible for the following manufacturers:
    •    Dorma
    •    Bohle
    •    Pauli
    •    Velux
    •    Roto
    •    Roto2004
    •    Wolff
    •    SWS
                                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL




    •    BET 2000
    •    Schlechtendahl
This should be the preferred method meanwhile for manufacturers for whom import files exist in
the BMECat.
Settings
The following settings must be entered before importing:




                                                                                                       54
Fig. 24 Article import

Matchcode prefix
All of a manufacturer's products are created using the match code prefix that has been created
here. The manufacturer's product numbers are attached to the prefix.
The product type, product group, WGR, WGR statistics, procurement type, type of stock
booking
These values are used to create new articles and to update all imported articles.
Year, code, first price table for product colors
The tariff rate and the table numbers for newly created prices can be determined using these
values.
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




sketches
Drawings can also be imported for articles.
Import
When importing a new file, the manufacturer's existing products are first blocked.
Decommissioning is carried out for all products that begin with the article prefix that has been
entered. Thereafter, the import file is read and the products with their variations are determined.
Next, the products with variants and prices are imported. The table on the right tracks import
progress.




                                                                                                 55
1.9. Product classifiers


Starting with the version 13.03.138, freely-definable product classifiers are available for products.
The definition of the usable classifiers can be undertaken in the master data:




Since the classifiers are saved in an XML column, the classifier name should not contain any special
characters. Umlauts are allowed, however. Blank spaces in classifier names are replaced in the
database with an underscore. However, this is filtered out in the display.

After the definition, the values for the classifiers for products can be entered.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                   56
If a value in the classifiers appears in red, this means that the classifier is no longer defined in the
master data. The classifiers can only be created on the main product level. However, the classifiers
are taken over into the BOM during entry. That is, if for the float glass 104 the classifier "Suitable
for IG" is entered with the value "Yes," then all products that contain the product 104 in the BOM
will take over this classifier if they are selected in the item entry. In the item entry, the values for
the classifiers can be overwritten:




                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                      57
Search

In the product search and in the order search, it is possible to search for classifiers.

In the product search, a new tab ("by classifiers") appears, on which a search can be performed
using up to 5 different classifiers. In addition, in the lower area of the search dialog, there is an
option whether the classifier entered must only be present in the main product or also in the BOM.




In the order search, on the tabs "Item-related" and "BOM-related" it is possible to search by the
classifiers:




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                   58
If a classifier is selected, the selection list is filled with the values that are stored in the products.
The filling of the values from the documents cannot be executed due to performance reasons.
Printing
In the form printing and the document view, the classifiers can be transferred to the report (see
Chapter 3. Print variables).

For the item, the variables F_PRCL_XXX (whereby XXX is the classifier name) and BOM elements the
variables F_STX_PRCL_XXX (whereby the first X is the number of the BOM element) are used. If the
classifier contains a blank space, this must be replaced with an underscore in the variable name.
Customizing
Should the classifier be used in a customizing, the value of a classifier can be read with the following
command (in the example, "Name" and "Age" are the names of the classifiers):
-- Insert records to the XML
insert into [SYSADM].[XMLTEXT] (CLASSIFIERS) values('<Name>Müller</Name><Age>43</Age>');
insert into [SYSADM].[XMLTEXT] (CLASSIFIERS) values('<Name>Meier</Name><Age>43</Age>');
insert into [SYSADM].[XMLTEXT] (CLASSIFIERS) values('<Name>Fritz</Name><Age>44</Age>');
insert into [SYSADM].[XMLTEXT] (CLASSIFIERS) values('<Name>Max</Name><Age>46</Age>');
-- Select the XML colnum
SELECT Id, CLASSIFIERS.value('(/Name)[1]','varchar(100)') AS Name,
CLASSIFIERS.value('(/Age)[1]','Int') AS Age FROM SYSADM.XMLTEXT;
-- Select the XML colnum with condition in where
SELECT Id, CLASSIFIERS.value('(/Name)[1]','varchar(100)') AS Name,
CLASSIFIERS.value('(/Age)[1]','Int') AS Age FROM SYSADM.XMLTEXT
WHERE CLASSIFIERS.value('(/Name)[1]','varchar(100)')='Müller';



For access to the production classifier in the item or BOM from customizing code, the function
udf_GetClassificator() is used.
m_Pos[m_nCurItemIdx].udf_GetClassificator( 'Supplier', m_sUdv[0], g_sqlUdv[0])

Changing of the product classifiers is currently not implemented.


Crystal Report
                                                                                                             A+W Software GmbH - Configuration A+W Business - INTERNAL




In Crystal Reports, the following notation can be used to print the classifiers:




                                                                                                        59
60
A+W Software GmbH - Configuration A+W Business - INTERNAL
61
A+W Software GmbH - Configuration A+W Business - INTERNAL
2. Documents
2.1. Active entry support of edgework

To simplify and speed up the entry of edgework, a new functionality has been added to processing
entry that has to be activated in the company master data.




With this option, the presence of more than one edgework on one edge is prevented, e.g. as a result
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL



of incorrect entry. Tempered glass manufacturers set up their glass in the master data with one
edgework. If you wished to enter a different edgework than the original edgework in the master
data, i.e. arrissing, e.g. by replacing it with polishing, you used to have to remove the arrissing
manually and then enter polishing.
This is no longer necessary with this option. Edgework entry makes sure that there can only be one
edgework per edge. If an edge is marked, edgework entry automatically disables all other
edgeworks that apply to the same edge. If no more edges are marked for edgework, edgework
entry will remove these excessive edgeworks automatically. This deletion is performed when
returning to item entry.
If, for instance, a manually added edgework for TG is removed, and an edgework has already been
entered in the master data of the TG, this edgework is transferred fully automatically from the


                                                                                                 62
master data into the item. This only happens with TG, since each edge for this type of product must
always be processed before tempering.


2.2. Assigning fittings to processings
This functionality enables the creation of e.g. studio doors by means of the simply entry of fittings.
During assignment, left and right side mounting is always differentiated. This setting can be changed
during subsequent entry.
This functionality is currently only practical for shapes with four edges, as the reference point also
has to be specified during assignment.

            Master Data
Before the new functionality can be put to use, assignments for the fittings have to be created in
the master data. For this, use the dialog under Master data > Products > Articles > Fitting allocation:




                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 25 Fitting processing allocation



       1     Selected fitting.




                                                                                                     63
      2   Enter a mounting type here for the allocation. You can either select an existing one or
          enter a new one. It must be ensured that, if possible, the same mounting type is used
          to simplify subsequent exchangeability.
      3   With the priority, the sequence in which the allocations are selected is determined. If
          the fitting is entered in the BOM, the next unused allocation is always entered.
          Priorities must start with the number 1 and be consecutive!
      4   With the hinge side, it is determined whether the allocation is to be used for a left-sided
          or right-sided door. The setting "Both" is only used for searching.
      5   Here it can be stipulated whether the fittings should be changed when changing the
          hinge side. This is e.g. important for locks, as a left lock and a right lock are usually two
          different articles.
      6   The list of processings that are to be added with the fittings into the BOM is shown here.
          We recommend using macros to keep the number of processings as low as possible.
          The Insert and Delete functions can be used to add or remove processings. The
          sequence can be changed with the two center buttons.
      7   Here you can define parameters for the fitting currently selected in the processing list.
          These values overwrite the values from the master data if the processing is to be added
          to the BOM together with the fitting. The dimension fields support size formulas. We
          recommend the use of size formulas.


    It must be ensured that a left-sided and right-sided definition are always created, as otherwise
    the exchange of hinge side would not work properly in document entry.


          Processing text
The new placeholder <18> is available for all processings. This placeholder is replaced with the
mounting type when a processing is to be inserted in the BOM with a fitting. If the processing has
been inserted without a fitting, the parameter is deleted when replacing. The parameter can
therefore be added to all processing without any risk (if desired).

          Entry
To enter a fitting, simply enter the product number in the product field in processing entry. The
fitting is then entered in the BOM with its processings and the entry mask switches to fitting mode.
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                      64
Fig. 26 Fitting entry



       1     Current mounting type. The mounting type can be changed by pressing F4. The list only
             shows the mounting types that do not yet exist in the BOM for this fitting. If a different
             mounting type is selected, the processings in the BOM are exchanged with the new
             assignment.
       2     Current version. Here you can select the fitting variant by pressing F4. The default
             variant is always selected during entry.
       3     Current hinge side. Here you can define for which direction the fittings are to be
             mounted. This setting applies for all fittings, and all allocations are exchanged in the
             event of one change. If exchange articles are defined, they are also exchanged.
                                                                                                                A+W Software GmbH - Configuration A+W Business - INTERNAL




       4     With "share variant" you can exchange the variants of all fittings. As long as the fittings
             have the same variant, it is shown here. When opening the list, all variants are visible
             that apply to all fittings.
       5     The BOM shows the fittings and the corresponding processings. The processings are
             always added below the fitting in order to obtain a better overview.


Now further fittings can be added by pressing the New button. The allocations are entered based
on their priority in ascending order. If no further allocations exist, the fitting is inserted in the BOM,
but no processings. This can be determined in fitting entry by the fact that there is no area available
in the list for a fitting. Existing fittings can also be exchanged with other fittings. To do so, the fitting


                                                                                                           65
has to be selected and a new product number has to be entered. If multiple mounting types are set
up for a fitting, they can also be changed in fitting entry.

            Inserting and exchanging
A fitting can either be exchanged by entering a new article number or via product search. If the
product search is opened for an article, the option "Only articles with allocation" can be used to
select all fittings that comply with the current hinge side and that have the same mounting type as
the current fitting. The mounting type can also be set to "All" if the fitting and the mounting type
are to be exchanged all at once.




Fig. 27 Product search for fittings


            Finished products
The entry of fittings with the processing can also be used in product management to create
respective templates. They can be used in order entry (including exchange). Here it must be
observed that the size formulas are calculated in product management. However the calculated
values are replaced in document entry by the size formulas from the allocation.
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  66
2.3. Checking spacers with LeCheck

            Preconditions
    1. To enable the spacer check, first enable rule number 5087 in the spacer restrictions dialog.
    2. The rule should only be enabled for product class TPS
    3. If the item cannot be produced with TPS spacers, the alternative spacer is suggested.




Fig. 28: LeCheck - Precondition


                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 67
Since LeCheck also checks the sealing depth, either the item cutback or the cutback per edge must
be entered for the order.




Fig. 29: LeCheck - Back cut




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               68
Fig. 30: LeCheck - Sealing depth

For LeCheck, this value is reduced by the spacer width defined in product management. The
resulting sealing depth is transferred to LeCheck.




                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                       69
Fig. 31: LeCheck - Product management

Since even quotations shall be checked, the processing parameters (e.g. radius of rounded
corners) must be filled in for the processing steps to be checked (e.g. rounded corners) in the
quotation.

LeCheck must be properly installed by a member of the ALCIM team first. The LeCheck.ini to be
used must include the details of the TPS line.




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  70
           Type
If an item with a TPS spacer is entered (quotation, order, complaint), the LeCheck check is made
under the following conditions when the item is saved:
    1. The item will be produced
    2. The item includes a TPS spacer
    3. One of the following conditions applies:
           a. The item includes a shape that is not 0
           b. The item includes steps
           c. The item includes one of the following processing steps: Cut-out corner, rounded
               corners, cut-off corner, internal cut-out, ticket window, notch, arch-shaped notch,
               SN Macro
Process:
    1. The        check        creates        a      file     in        the      user     directory
       (%APPDATA%\A+W\Techsoft\ProcessAWISO.dat). The format is described in document
       \\JUPITER\DOKU_DocuWare\XOPT_XOPTS\Tools\AWISO.doc. If the item includes at least one of the
       above processing steps, a SN file is created as well.
    2. After                         that,                        the                      program
       %ALLUSERSPROFILE%\A+W\Techsoft\ProcessAWISO\ProcessAWISO.bat is loaded. An
       error report will be issued if this program does not exist. The path containing the output
       file (%APPDATA%\A+W\Techsoft\ProcessAWISO.dat) is transferred as an argument to the
       program.
    3. After running the program, the value in fifth position (separated by semicolon) is checked
       in the LECHECK.OUT report file. If this shows 1, the check was successful. If this digit is 0,
       the item cannot be produced by the TPS line. Since the program cannot handle multiple
       users, the call may have to be repeated three times, in intervals of three seconds. If the
       check is still impossible after three attempts, the user is informed of the error.
    4. If the check is successful, the item can be saved. Otherwise, the program suggests the
       alternative spacer. If the user rejects this, the item will not be saved. The item must be
       changed in that case, and the check repeated if required.
Possible errors:
    1. Program %ALLUSERSPROFILE%\A+W\Techsoft\ProcessAWISO\ProcessAWISO.bat does not
       exist.
    2. The sealing depth cannot be determined (see requirements).
    3. No output file can be created.
    4. The file containing the LeCheck test result does not exist.
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL



    5. Internal LeCheck error.
    6. The check cannot be made even at the third attempt.
    The files used for the check are saved in zipped archives in directory
    %ALLUSERSPROFILE%\A+W\Techsoft\ProcessAWISO\SAVE. Zipped archives will be deleted
    after sixty days.




                                                                                                   71
2.4. Invoice management / Project management

           The four different modes
Version 3.3.359 offers four different modes of invoice management. These are activated by the key
file in ALFAK2000 Please make sure that only one of the modes is active, or one of the following
combinations: 1+2 or 1+3 or 4+2 or 4+3
Modes 1+4 and 2+3 must not be active simultaneously.
      1.   Standard mode (module 122060 item 8)
      2.   Invoice management (module 122800 item 80) (only DMS, Australia)
      3.   Invoice management with allocated orders (module 122062 item 120) (SGG)
      4.   Extended project management (module 122064 Pos 121) (made for the Spanish market)

           Standard mode
This is the original project management used by ALFAK2000 so far. We therefore refrain from
detailed explanations.

           Invoice management
Invoice management is a version that was specially created for DMS; it has been part of ALFAK2000
since version 3.0.

           Invoice management with allocated orders
This mode allows to allocate an overall order to a project. In this overall order, only products will
be used for the individual items, without detailed information on the product structure. Based on
this overall order, claims will be specified, defining the percentage, quantity, or amount presently
required. These claims will be transferred to financial accounting by a special mode. No invoices
will be created. When the overall order has been completely fulfilled, and the project is finished,
the overall order will be invoiced.
The user creates work orders and allocates these to the project. Purchase orders created for these
work orders will also be allocated to the project. These purchase orders can be created manually,
or via automatic transfer to purchasing. Both types of purchase orders can be listed separately. No
invoices will be issued for work orders.
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                   72
Fig. 32: Invoice management with allocated orders

First, enter the overall order with the document type „Overall order“ at order entry. Now, define
the project in invoice management, and allocate the overall order.




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 33: Creating a project in invoice management




                                                                                               73
The second tab of invoice management shows the items of the overall order. It also shows how
many items have been claimed so far. Click the right mouse key on the table to view a history of
the claims for this overall order.
To define a claim, select function „Issue request invoice“. The dialog shows all items of the overall
order, plus the claimed totals. You can enter a claim for a certain percentage of an item, or the
claimed quantity. Alternatively, you can enter the amount. Once you have chosen one of the three
options, this cannot be changed for the following claims for this item.
Printing of forms now offers some new variables for the document types „Claim“ and „Overall
order“ which are briefly described below.
CONTR_CLAIM_TYPE                Claim type (percentage, quantity, or amount)
CONTR_CLAIMED_ACT Quantity for the actual claim
CONTR_CLAIMED_PREV              Quantity of previous claims
CONTR_AMNT_ACT                  Amount of the actual claim
CONTR_AMNT_PREV                 Amount of previous claims
CONTR_PAID_AMNT                 Total claims paid
CONTR_CURRENT_AMNT              Amount to be paid at present
CONTR_MWST_AMNT                 VAT for the present claim
CONTR_BRUTTO_AMNT               Gross amount of the present claim
CONTR_FI_NETTO_GES Net amount of the corresponding overall order
CONTRACT_ORDER_ID Number of the corresponding overall order
Please make sure to use the product description from the overall order when you print the claim!
The forms are based on the reports claim.qrp for claims, and contract.qrp for the overall order.
Tab Allocated orders shows the allocated orders and credit notes and the items involved. Credit
notes are shown in red.
Tab Allocated P.O.s shows the purchase orders. Checkbox „Order-related P.O.s“ allows to switch
between P.O.s automatically created via transfer to purchasing, and manually entered P.O.s.

         Extended Project Management
The general conditions for a project are defined per product or product group. First, enter a
customer project and define a sales representative and payment terms. At order entry, this
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL



information is imported into the order when the project is allocated to the order. Tab Allocated
orders shows the orders allocated to the project.




                                                                                                   74
Fig. 34: Project totals

Tab Totals shows the accumulated amounts for the project. In connection with the data on tab
Scheduled quantities, this list shows how far the limits for every product and product group have
been reached. When the limit of a product or product group has been reached or even exceeded,
the appropriate entries will appear at the top of the list, in red.
The information shown on these two tabs can be printed. This information is printed for all projects
selected in the dialog in QBE mode.
The project totals will be updated automatically during order entry.
Once a project has been tagged as completed, no further orders can be entered.
When you leave item entry, tab Totals in project management gives an overview of the project
progress.                                                                                              A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  75
2.5. Product Exchange Groups

         General information
This function can prevent any glass, spacers or film from being installed in insulating glass and
laminated glass that are not designed for or are not suitable for these products.

         Set-up
To enable the new functionality, the "Use Production Exchange Rules for use BOM Exchange"
option must be activated in the company master data on tab 5:




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




Next, exchange groups can be defined:




                                                                                               76
Glass, spacers and films will now be added to the exchange groups:




                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                     77
Now, glass, spacer and film exchange groups can be defined for insulating glass and laminated glass
in the product's BOM:




This definition then stipulates that in item input and in the alternatives the first BOM item can only
be replaced by products in the "Heat insulation" exchange group. Consequently, based on the data
created above, only 1204, 1205 or 1206 products could replace the first glass in the BOM. Entering
a product that is not in the defined group will be rejected with an error message. Furthermore, only
products that have the defined exchange group can be searched for in the product.

                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                    78
         Application
The exchange group is checked before a replacement is made if that product is detected in the item
input and an attempt has then been made to replace an element. If no exchange group was
specified for the BOM item or the new BOM element from the matching exchange group is
associated with the BOM element, then the element can be replaced. If this is not the case, then
the user will receive an error message indicating this and the exchange will not be performed:




If the search dialog is opened for an item in the exchange group, then only those products in this
exchange group will be indicated. The exchange group can also be used as search criteria for items
that are not associated with an exchange group:                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                79
                                                            Fig. 35 Selection




80
A+W Software GmbH - Configuration A+W Business - INTERNAL
2.6. Generation of partial deliveries

           Per ready report / goods receipt

Master Data

At the beginning, a new status Ready for delivery note printing (status should be less than delivery
note printing) should be defined in the status management. Then, the new status point 855 – Ready
for delivery note printing (arrived in the database via script) of the newly-created status Ready for
delivery note printing must be assigned in the status assignment as User status. The status point
102 – Delivery note printing thus requires the status Ready for delivery note printing as Minimum
status.

So that the module can determine whether an order is already produced and ready, in the company
data management on tab 7.Stock / PCH / EDI, the registration point starting at which an order is
ready for dispatch/finished, is allocated. Furthermore, it is possible to define here whether a goods
receipt of purchased parts (purchase orders) also travels via a registration point or whether the
purchased parts must be checked in purchasing (booking of goods receipt).




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL



Fig. 36 Company data - Allocation of the registration points



Documents

The screen table Documents contains all documents of the current number manager.
Orders/purchase orders that have been reported completely ready or whose goods receipt is not
complete are depicted in green and the Ready % column contains a value of 100%.




                                                                                                   81
Fig. 37 - Document produced

Orders/purchase orders that have not been reported completely ready or whose goods receipt is
not complete are depicted in red and the Ready % column contains a value less than 100%.




Fig. 38 - Document not produced

If a document is selected in the screen table, then all items are displayed in the detail table. In the
detail table, the original item quantity, the partially-delivered quantity, the quantity reported
produced, and the partial delivery quantity (quantity reported ready - partially-delivered quantity)
are displayed.

These can be edited item by item, that is, with this quantity, the user can define how much of the
quantity reported ready should be delivered partially.




                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 39 Document is ready for partial delivery


                                                                                                     82
The user also sees directly via the table column Ready for part. del. % how much of the
order/purchase order can be partially delivered.

If, for example, due to technical problems there is no report from production (fileless reporting
must be active) and the order must be delivered, in the table the order (< 100%) can be set to
delivery (table column Complete) to be set and the document status is thus adjusted accordingly.




Fig. 40 - Document report complete

Before the partial deliveries are created, a target number manager should be defined. If the
program creates the partial delivery, it includes all item quantities ready, whereas the uncompleted
ones remain in the original order. However this depends on whether or not the option Do not delete
partial delivery item in the company data is active.

Furthermore, the user can override the AV area from the original order for the partial delivery if
desired. The partial delivery gets a new status Ready for delivery note printing. The delivery note
printing must have the new status as minimum status (see 0).

If the partial delivery has been created, the user is asked whether the delivery note should be
printed.
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  83
Fig. 41 Delivery note printing starts automatically

However, it is also possible to call up the print program manually.




Fig. 42 Start delivery note printing manually

                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                      84
           Per rack
As an additional functionality, the generation of partial deliveries per rack was implemented in the
module. On the new tab Per rack, the user has the opportunity to display the rack-order
assignments by Number manager. In contrast to this, you can also filter your selection by Customer.
Additional selection possibilities are a limitation by Deliv. Date and Status.




Fig. 43 Rack order assignments

The rack orders are loaded on the upper screen table. Here, the user has information about which
orders are on which rack. Both the delivery date and status of the order as well as the percentage
values, how much of the rack order is ready and how much of the order was already delivered are
displayed in the table.


If you click an assignment, all order items that are stored on the rack are loaded into the lower
screen table. In the table, the item status, the product with its dimensions, and the quantities are
displayed. The original item quantity (original), the quantity on the rack, and the already partially-
delivered quantity are displayed.


In order to generate a partial delivery now, the rack must be marked with a double-click on the row
header, that is, the complete rack is always partially delivered. However, not all orders per rack are
combined into a partial delivery (one order = one partial delivery).
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 44 Marking the rack-order assignments for partial delivery


                                                                                                    85
The user has, before he generates the partial delivery, the opportunity to override the order header
fields Deliv. Date, Route, Truck, and Driver. For this, you must activate the appropriate option, at
which point the data field (the selection box) can be edited. A target number manager should also
be selected. At the start of the program, the same number manager is set as in the selection criteria.




Fig. 45 Overwriting header fields

If the partial delivery has been created, the user is asked whether the delivery note should be
printed. If this should happen at a later point in time, you can also call the print program via the
menu function.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                    86
2.7. Delivery date calculation
It is now possible to calculate the earliest possible delivery date for an order or quotation using the
capacity planning. Here it must be heeded that the delivery date calculated is only a snapshot since
the capacities calculated are not reserved. Therefore, the delivery date can still shift if other orders
are then scheduled and thus take up capacities that were necessary for the previous delivery date
calculation.
The delivery date calculation can be executed from the order or quotation entry by clicking the
button next to Delivery. For this, the document must be saved.




Fig. 46 Delivery date calculation                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                      87
          A+W Capacity
The delivery date calculation with A+W Capacity is done asynchronously by the AWSOA Planning
Service. This schedules a transferred document in the capacity planning and returns the delivery
date calculated.
The connection is made via the AWSOA.Commercial.Export.ComProxy, which awaits the response
of the service so that the user can keep working with the program, because delivery date calculation
for orders with a lot of items can take quite a while. If you click the button, a dockable window
opens, which displays the progress of the ongoing date calculation(s). After one or several
calculations have been completed, the user can take over the date calculated into the order.
Furthermore, in case of error, the messages from the service are displayed there.
In order to use the functionality, the AWSOA infrastructure services must be installed and
configured. Furthermore, the license 149 must be enabled and the OrderXML version must be at
least 5.3; otherwise the button is hidden. The OrderXML can be set on a subdialog of the company
master data on tab 13.Production.
The import in the planning service uses the settings for the OrderXML import. Therefore, the MZO
must be set up in advance in the production system.




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 47 OrderXML Version




                                                                                                  88
Participating components:




The tracing is set up in the A+W Protocolling Config Tool:




                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




The Commercial Export COM service is responsible for setting the tracing for all components. The
associated file has the name Commercial.ExportComProxy_<DATE>.awtrc. The OrderXML
generated can also be viewed in the file.




                                                                                              89
The import in thje A+W Planning Import Service can be traced in the following trace settings:




The tracing for all components for the Planning Import Service can be set here. The associated
files have the following name: Planning.ImportService._<DATE>.awtrc and
Planning.ImportService.NET_<DATE>.awtrc. The import messages from the production
system can be viewed in the file.                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 90
           A+W Business Capacity Planner
Delivery date calculation is also possible with A+W Business Capacity Planning. Here a document is
scheduled and if the current delivery date cannot be adhered to, there is an attempt to find the
next day until a suitable date has been found.
A particularity here is that orders are actually scheduled and thus capacities are assigned; however
this does not apply for quotations. The delivery date calculated and the time costs are written back
to the document in question.
Prerequisite for this functionality is a set-up A+W Business Capacity Planning.




Fig. 48 Delivery date calculation 2

The scheduling is done in A+W Business. The tracing can be done in the trace file of the running
A+W Business.
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  91
2.8. TPS/LSG invoices
Documents > Order > TPS invoice




TPS invoice
The TPS/LSG invoice serves the internal charging of services between 2 sites and was implemented
exclusively for Fandel.
An order with TPS will be produced by Europane since a TPS line only exists there. For this order,
an incoming invoice is generated, which includes the entire item, plus a surcharge for the assembly
of the IGU. The price calculation is done using the conditions for the supplier Europane.
At the same time, an outgoing invoice is generated for Europane for the glass and the cutting of the
basis glass. Some of the glass is cut by Fandel. Products ordered are always invoiced since the order
was placed by Fandel.
If the machine is placed in production areas 8 and 10, this is the criterion that carries out the
charging.
LSG invoices
Cut glass that is not in a TPS IGU must be invoiced from site 2 to Fandel. For this, as 3rd charging,
outgoing invoices for LSG are generated. The price is to be taken for the conditions for Fandel and
also its energy surcharges. Processings on simple glass that are made on the Europane units must
also be taken over.
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL



The Europane units are:
    •   901 – PCH LSG cutting 1
    •   902 – PCH LSG cutting 2
    •   905 – PCH LSG manual cutting
    •   907 – PCH KBF 1




                                                                                                   92
Status Points

770 - TPS invoice created
The incoming invoice for the TPS IGU was created

790 - TPS invoices invoice
The outgoing invoice for the basis glass cutting was created

795 – LSG charging
The outgoing invoice for LSG was created

796 - LSG invoice checked
Order does not include any LSG charging

800 - TPS invoice checked
Order does not include any TPS charging



2.9. User-defined text fields in the document header
In the document header on the 3.Addition tab, there are three user-defined text fields available:




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




The leading text of the fields can be defined with the system texts 2000, 2001 and 2002. By default
after the database update, the designations are Textfield 1, Textfield 2 and Textfield 3.
The new fields can be used on the forms in document printing and document display (USER_FIELD1,
USER_FIELD2 and USER_FIELD3).




                                                                                                    93
2.10. Status management per user(-group)

Under Master Data >Company a new management dialog Status management per employee
(group) was implemented.




Fig. 49 - Status Administration per employee (group)

 Effective immediately, you can now define four status areas per employee and/or employee group
that can be assigned to one of the five document types Quotation, Order, Credit, Inquiry or Purchase
order.

In order to select data, the user has the opportunity to filter by employee (group) and/or the
document type.
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  94
Fig. 50 - Defining status areas




If you would now like to make a manual status change, e.g. under Documents>Order>NM
order>Functions>Status change, these status areas serve to check the current document status.
Depending on whether or not the document status is in one of the four areas, a status change is
possible or not permitted.




Fig. 51 - Manual status change not permitted
                                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                             95
2.11. Resubmission of orders

The resubmission of documents (e.g. Documents > Order > Resubmission) has been enhanced. Up
to now, only quotations could be fixed for resubmission. Effective immediately, in the company
master data (Master Data > Company > Company data) on tab 10.System, you can define the lead
days for the resubmission of an order.




Fig. 52: Company data: lead days for resubmission of orders

Depending on the setting here, the presentation date will be calculated during entry of an order.
For this, for orders there is now the new data field Presentation in the document entry (Documents
> Order > Order).
                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                96
Fig. 53: Order entry presentation date



The date entered is compared to the current date when A+W Business starts up and there is a check
of whether documents for resubmission exist. The user then has the choice whether or not the
documents should be displayed. If so, the resubmission dialog opens.




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 54: Resubmission of orders



                                                                                               97
The already familiar functionalities are available to the user here, e.g. the assignment of transfer to
archive or the authorization to delete. The display of alternative orders under Functions >
Alternatives and the printing of the data records present in the screen table has also been adjusted
for orders.




Fig. 55: Resubmission of alternative orders




                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 56: Printing of orders




                                                                                                     98
2.12. Turning of shapes in the document entry
Starting with Version 13.4.80, it is possible to turn shapes in the document entry. So that the new
feature is active, the following switch must be activated in the company master data:




Then in the shape/[processing entry, the angles of rotation 90, 180 and 270 degrees are available.
The turning can be applied for the shapes with shape numbers smaller than 137 except for 0, 24,
98, 99, 60, 61, and 81 (these shapes are symmetrical or free shapes):




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Sense of pattern


                                                                                                 99
The sense of pattern is not turned. That is, if glass is turned by 90°, the sense of structure does not
change. It is assumed that the sense of structure refers to the turned shape.
Effects
    •     The printout is done with the turned form, that is, the customer sees the shape turned.
    •     For the production transfer, for directional glass and a turning of 90 or 270 degrees, the
          structure is turned since the turning is not known in the production system.
    •     The same applies for the export via the EDI interface.
    •     In the production manager, the turning is considered during optimization.
    •     The checking of the dimensions is also done with the turned dimensions for 90 or 270
          degrees.
Caution: ERP Webservice and production manager must be updated, since otherwise for directional
glass the sheet will be cut incorrectly.




                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                   100
2.13. Saving of TOE files of the CAD Designer (Shapes) in the
   database
The files of the CAD Designer (Shapes) have also been stored in the database since version
13.04.0637, insofar as these are files from the technical order entry (iTOE). These TOE files have as
file name behind the automatically generated batch number also the abbreviation "_TOE" (e.g.
0023145_TOE.SN). This has the advantage that the database is sufficient for describing the item
completely. As soon as the database is available, all TOE files also exist.
The system behavior is such that for access to a TOE file that is specified in a shape set, first there
is a check whether the file exists. If so, then everything goes as previously and the file is displayed.
If the file does not exist, the system checks whether a there is a file in the database and creates the
file. From that moment, everything goes as previously. Attention must be paid that the path to the
CAD files in the company master data has been entered correctly.
Another advantage is that the saving of the TOE file happens in the same transaction as the saving
of the item itself. Thus, the file always corresponds to the state of the item.
The file is stored in the database in the shape table (BW_xxxx_MODELL) in the SN column. Because
this is a BLOB column, it is not possible to output the data with Management Studio. However, it is
possible to create a stored procedure with T-SQL that generates the CAD files.

          Extracting the CAD files from the database with T-SQL
The following script creates a stored procedure in the database and can be executed with "exec
save2file“.
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE PROC [dbo].[save2file]
AS

declare @ObjectToken INT
declare @TheContent VARBINARY(MAX)
declare @Save2File VARCHAR(255)
declare @id intdeclare @id int
declare @FileName varchar(255)
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL



DECLARE TheCursor CURSOR FAST_FORWARD FOR
SELECT MOD_SN_NAME, SN
FROM SYSADM.BW_AUFTR_MODELL WHERE ID = 60000072 AND POS_NR = 1

OPEN TheCursor
FETCH NEXT FROM TheCursor INTO @FileName, @TheContent

WHILE @@FETCH_STATUS = 0
      BEGIN
            SET @Save2File = 'C:\Temp\' + @FileName
            PRINT @Save2File

                EXEC sp_OACreate 'ADODB.Stream', @ObjectToken OUTPUT


                                                                                                    101
                EXEC sp_OASetProperty @ObjectToken, 'Type', 1
                EXEC sp_OAMethod @ObjectToken, 'Open'
                EXEC sp_OAMethod @ObjectToken, 'Write', NULL, @TheContent
                EXEC sp_OAMethod @ObjectToken, 'SaveToFile', NULL, @Save2File, 2
                EXEC sp_OAMethod @ObjectToken, 'Close'
                EXEC sp_OADestroy @ObjectToken

                FETCH NEXT FROM TheCursor INTO @FileName, @TheContent
        END

CLOSE TheCursor
DEALLOCATE TheCursor
GO



In the script, the path for the output (@Save2File) and the select statement for the selection of the
shape must be adjusted for the given requirements.
Here, the TOE files are created by the database server, therefore it is important that the path must
always be defined from the database server. This means that the path C:\Temp\ is not that of the
client, but the path on the database server. If error messages occur during execution, the
authorizations for executing the OLE automation functions probably do not exist. This can be
achieved for the database server with a right-click on the server instance in Management Studio
and selection of the "Facets" function.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 102
In the dialog that opens, on the "Facet" combo box, the entry "Surface Area Configuration" is
selected and both marked switched "OleAutomationEnabled" and "XPCmdShellEnabled" are set to
True.




                                                                                                A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                          103
2.14. Integrated Technical Order Entry (iTOE)
For start-up of the TOE, the scripts 20180810a.sql, 20190516a.sql and 20190516m.sql are
absolutely necessary. Furthermore, the module (module number 159) requires a license. Microsoft
SQL Server 2016 is required as the database system!
At the start, master data is not absolutely necessary, the system is "self-learning." After each
import, the articles that correspond to no rules are displayed and they can be created there during
the comparison and also changed.




Figure: The rule editor



The master data consists of rules with which it is specified which article should be transferred to
the BOM during the comparison. These rules can either be created at the beginning in the rule
editor (Master Data > Products > Articles > iTOE rules) or defined during the import. The rules are
processed in the sequence of the specified priority.
In the processing entry, the comparison can be started either with a DXF file import or with the
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




"iTOE" button on the ribbon (<CTRL>+<SHIFT>+<X>). In the CAD Designer, you make the changes
to the glass unit and take over the data about the menu element "File > Save with File" or "File >
Save without File" from there. With this, either an SN file (called TOE file below) should be created
in the BOM or not. If an SN file is created, the comparison independently inserts a shape set if it
does not exist yet and links the TOE file created. You can recognize the TOE files from their file
names in the form XXXX_TOE.SN. Whereby the number at the front is determined by the number
ranges of the SN files.
As soon as the changes have been applied, A+W Business displays the result of the rule check on a
dialog.




                                                                                                 104
Figure: The result of the product comparison

If a product was found for each processing, it will be displayed as in the example. If for a processing
no rules applies, you can see this from the line with the dark background and from the fact that the
article number is missing. Now with the "Edit rule" button, you can change directly to the rule editor
in order to create the appropriate rule. Already-created rules can also be changed with this button.
After you exit the rule editor, there is always a new comparison and the changes you just made to
the rules display their effects immediately.
If you confirm the result of the product comparison, the complete BOM is generated in the
processing entry and provided with the appropriate prices. The system compares changes that are
now made in the processing entry with the TOE file. Changing properties that are not a component
of the A+W processing type catalog are lost in the process. Such changes have to be made in the
CAD Designer. For example, if a drilling row has series dimensions. These series dimensions would
be deleted as soon as one of the participating drillings is changed in the processing entry.

iTOE rules with priority

Application example with correct creation of rules
LAMI and TGH and a corner cut-out:
Rule 1: Corner cut-out polished on TGH (prio 2 with edge quality "polished")
Rule 2: Corner cut-out on TGH arrissed prio 3 with edge quality "arrissed")
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




Rule 3: Corner cut-out on TGH without edge quality ( prio. 4 with edge quality "not defined")
In this case, the program goes through the rules and processes them using the existing priority
starting with 0 as well as
reacts to the manual settings made during import on the DXF import dialg with regard to the
selected edge qualities.
In the example described above, we assume that the user would like to map case 2 and selects
corner cut-out on TGH arrissed accordingly (checked combo box in Figure 1)
Here, the program finds rule 2 and selects it because it is the first one found where all criteria are
met.




                                                                                                   105
Rule1 is checked as 1., but it is skipped since the edge quality does not match the manual selection
on the DXF import dialog.
Application example with incorrect creation of rules.
LAMI and TGH and a corner cut-out:
Rule 1: Corner cut-out polished on TGH (prio 2 with edge quality "polished")
Rule 2: Corner cut-out on TGH arrissed prio 3 with edge quality "arrissed")
Rule 3: Corner cut-out on TGH without edge quality (prio 1 with edge quality "not defined")
In the example described above, we assume that the user selects nothing on the import dialog when
making the corner cut-out on TGH (figure below)




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




Here, the program finds rule 3 and selects it. (2. Figure below)
In this example, the program actually always selects rule 3 since it is created with the highest
priority and through the creation "without consideration of edge qualities" is always correct,
regardless of what the user selects during DXF import.




                                                                                                106
         Restrictions and configuration
For processings that have an edge quality (drillings, cut-outs), during the DXF import, the edge
quality must always be defined on the import dialog; the iTOE rule must consider the edge quality
and then select the product that corresponds to the edge quality. In A+W Business, the edge quality
is not saved in the order; instead, it always comes from the base product. IF no quality is defined,
the one from the master data processing is always used.

         Shape rotation
See the SN.INI configuration under 16.17 shape rotation in the iTOE and DXF import

         Rules with workflow formula
A formula can be stored as condition in the rule editor. Chapter 10.32 exmplains how this is to be
implemented.




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                107
2.15. Document check (dual control principle)


The user can use the context menu to call up the check of the order from an existing number
manager. The call is only possible for single documents.




Fig. 57: Number manager context menu


Now a dialog opens on which all items with their complete BOM are displayed. However, no
production BOM breakdown is displayed. The user can check the data and mark each item as "OK."
Separate tabs have been developed for checking header and item texts, which contain an overview
table and a display of the actual text. In the item table on tab "1. Header/item data", the line header
indicates whether an item text exists.

Double-clicking on the item line takes you directly to the tab.

                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 58: Document check incl. header and item texts



                                                                                                   108
Fig. 60: Header text                             Fig. 59: Item text

                                                                                                    If
 all items (marked with an X in the example) were found to be "OK," the check flags are written to
 the items after pressing "Execute." The order is then set to the user status of the new status point
 "167 - Check performed" and a history entry is written.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 61: Marking the checked order items
 Fig. 62: New order status "check performed"




                                                                                                  109
The user can exit the check at any time. The items already checked are displayed again in case of
another call. The new status of the order is visible in the number manager; thus, no new ID is
required in the number manager. If a correction has to be made, then the user goes into the
document entry via the context menu and makes the correction. Then he calls up the check again
and marks it after successful checking of the item as OK (checkmark on the screen table). Now the
status is incremented if the order has been checked completely.
In the screen table, it is possible to attach a customizing as you can do in the number manager
(user-defined field) in order to reload particular information (see 10.30) !




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 63: Customizing in table in order to reload order information


2.16. European article numbers (EANs) for variants and stock
   dimensions
In order to be able to use the EAN for variants and stock dimensions, the scripts 20200616a.sql and
20200616aa.sql for the archive are required. In the management programs for the variants and the
stock dimensions, the fields for the EAN can then be edited and saved.


                                                                                               110
The EANs entered there are saved during item entry in the item and in the BOM. If for an item there
is an entry for the variant and one for the stock dimensions, the EAN of the variant always wins.
The EAN can be output with the reports for Crystal Reports. The fields for this are
{R0001deDE_PositionenErweiterung.EAN},      {R0001deDE_AuftragsStueckliste.EAN} and
{R0001enUS_OrderItemsExtension.EAN}, {R0001enUS_OrderBillOfMaterial}.
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




The transfer to production is done with the OrderXML Version 5.5 and higher.




2.17. Entry help postal code/city in document entry
A new database table called KA_POSTAL has been developed, in which data (postal coede directory)
can be imported from an Excel or CSV file via DB script. Such postal code directories are relatively
easy to find on the Internet.
Ex.: https://www.suche-postleitzahl.org/downloads


                                                                                                111
If there are data records in the table, both the postal code and the city are in the header entry
selection boxes, which fill in their content automatically during entry. As long as the header entry
is open, the contents are retained. The selection boxes also contain only the entries that suit the
user's entry. If a place is selected, then the associated postal code is loaded into the selection box
and displayed. The same thing works the other way around.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




2.18. Due date calculation mode
You can set the due date calculation for every single customer. Calculation will be based on the
invoice date stated in the order. Only mode 11 is based on the delivery date. The mode defines how
due dates should be calculated for this customer. When you select a mode, a short text appears
along with the calculation. The following calculation modes are available:



                                                                                                  112
0: Date of issue: The invoice is due immediately.
1: Date of issue + payment term: By default this is invoice date + 30 days but other payment terms
can be entered if required.
2: Date of issue + payment term rounded to 1. Date of payment or month's end: If a date of
payment is defined, the due date is calculated from the rounded total of date of issue + payment
term. If no date of payment is defined, the date will be rounded to the month's end.
3: Date of issue + payment term, rounded to the 15th day of the month or end of month: Like 2,
rounded to the 15th day of the month or to month's end.
4: Date of issue + payment term rounded to the 10th or 20th day of month, or end of the month:
Like 2, rounded to the 10th or 20th of the month, or to month's end.
5: Date of issue + payment term + end of month: Payment term will be added to the date of issue
and then rounded to month's end.
                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




6: Date of issue + month's end + payment term rounded to first payment date: Like 5, rounded to
the first payment date.
7: Date of issue + payment term, rounded to first, second, or third payment date: Like 5, rounded
to the next payment date in line.
8: Date of issue + payment term depending on the second payment date, rounded to the first or
third payment date: Like 5, rounded to the first or third payment date.
11: Due date = delivery date + payment term: Delivery date + payment term.


Warning:



                                                                                               113
With mode 5 and 6, the value in the Gross days field (payment term) should be divisible by 30. 30
Days = 1 Month, 60 Days = 2 Months, 90 Days = 3 Months, by which the 1st reference date will be
increased.




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                              114
2.19. Electronic invoice for the Polish market (Comarch/KSeF)
To start up the interface to the service provider Comarch and its reporting of the KSeF ID, the latest
version of the following components is required:
    -   A+W Business 6 (incl. Update Script 20240328a.sql)
    -   AWSOA Commercial 6 B2B Services
    -   AWSOA Infrastructure 6 Services
Initially the access data for the Comarch WebService is required, which must be stored in A+W
business in the company master data on the tab "16.Miscellaneous".




In addition, it must be entered per customer whether electronic invoicing should be executed. In
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL



the customer master data, there is a selection box for this on the tab "2.Orders".




                                                                                                  115
The next step is the definition of the workflow through the suitable storage of user, minimum, and
lock status in the various status points used for electronic invoicing. The status points are created
by the script 20240328a.sql. The status to be used must be created manually, however, so that it
fits the client's workflow. The affected status points are:
    -   480 - lead-up electronic invoice (form print)
    -   485 - send electronic invoice (customizing/workflow task)
    -   490 - receipt electronic invoice (customizing/workflow task)
    -   495 - confirmation of electronic invoice (customizing/workflow task)



                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 116
                                                   Sets status point 480 - lead-up
                                                          electronic invoice

 Form printing dialog
     (eInvoice)                                                                                                         Get the order/invoice data




                                                                                                   AWB
  Selection according to minimum status of the
          status point 485,490 and 495




                                                 Sets status point 485 - Send electronic invoice
ExchangeService (Workflow)
                                                                                                              InvoiceService


                                                                                                         SendInvoices
udf_InvoicesSend
                                                                                                               Opentrans


udf_InvoicesGet                                                                                          GetInvoices
                                                  Sets status point 490 – Receive electronic
                                                              invoice + KSeF ID


udf_InvoicesUpdate



udf_InvoicesCommit                                                                                       CommitInvoices




                                                    Sets status point 495 – Confirmation
                                                              electronic invoice




                                                                                                                          Comarch

                                                                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                                                          117
          Lead-up
The status point 480 is used to create the invoice in A+W Business and is the beginning of the invoice
creation. All functions are executed for this as for normal invoice printing, but for the actual printing
out or mail dispatch of the document. The function is started in form printing on the tab
"6.Electronic invoice".




The tab is only active if the form printing is in "invoice" mode. After that, pressing "OK" or "Enter"
will start the lead-up.

          Send
The customizing function "udf_InvoicesSend" is used to send the invoice to the Comarch
WebService. The function determines all orders whose status is between the minimum and lock
status of the status point 485 and sends it via the invoice service. Preferably a workflow task is used
for this, which is executed cyclically by the exchange service.

          Receipt
                                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL




To save the KSeF ID in the documents of an invoice, it must be queried cyclically by the Comarch
WebService. This happens with the help of two customizing formulas. The call of
"udf_InvoicesGet(sXML)" delivers all invoice documents known to the Comarch WebService. Then
the updating of the orders in A+W Business is started via the customizing formula
"udf_InvoicesUpdate(sXML)". All documents in A+W Business that are in the appropriate status
range for the status point 490 are thus updated. The KSeF ID is displayed in the history and it is
stored in the database in the column BW_AUFTR_KOPF_EX.E_INVOICE_ID.

          Confirmation
The customizing function "udf_InvoicesCommit" is used to communicate the successful updating
in the database to the Comarch WebService. It sends all invoices whose documents are in the


                                                                                                     118
appropriate status range of status point 495 to the Comarch WebService. The transfer of the invoice
data is thus complete.
All customizing formulas are in the formula folder of the A+W Business installation in the
"ExchangeService" subfolder.
They are called "workflow_e_invoice_send.txt", "workflow_e_invoice_receive.txt" and
"workflow_e_invoice_commit.txt".




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               119
3. Form printing
3.1. Document view variables
The report variables available in the document view are listed below.

             Header
  Variable                         Type           Description

  F_ID                             Number         Order number
  F_AH_IDENT                       Number         Customer #
  F_AH_KOPF                        String         Customer's title
  F_AH_NAME1                       String         Customer name 1
  F_AH_NAME2                       String         Customer name 2
  F_AH_NAME3                       String         Customer name 3
  F_AH_STRASSE                     String         Customer's street address
  F_AH_ORT                         String         Customer location
  F_AH_PLZ                         String         Customer's post code
  F_AH_LAND                        String         Customer's country
  F_AH_TELEFON                     String         Customer's phone number
  F_AH_FAX                         String         Customer's fax number
  F_AL_IDENT                       Number         Shipping address customer number
  F_AL_KOPF                        String         Shipping address customer's title
  F_AL_NAME1                       String         Shipping address - customer name 1
  F_AL_NAME2                       String         Lieferadresse Kundenname 2
  F_AL_NAME3                       String         Shipping address - customer name 3
  F_AL_STRASSE                     String         Shipping address - customer's street address
  F_AL_ORT                         String         Shipping address - customer's location
  F_AL_PLZ                         String         Shipping address - customer's post code
  F_AL_LAND                        String         Shipping address - customer's country
  F_AR_IDENT                       Number         Invoice address - customer number
  F_AR_KOPF                        String         Invoice address - customer's title
  F_AR_NAME1                       String         Invoice address -customer name 1
  F_AR_NAME2                       String         Invoice address -customer name 2
  F_AR_NAME3                       String         Invoice address -customer name 3
  F_AR_STRASSE                     String         Invoice address - customer's street address
  F_AR_ORT                         String         Invoice address - customer's location
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




  F_AR_PLZ                         String         Invoice address - customer's post code
  F_AR_LAND                        String         Invoice address - customer's country
  F_DATUM_RECHNUNG                 DateTime       Invoice date
  F_DATUM_BEST                     DateTime       P.O. date
  F_DATUM_ERF                      DateTime       Date of entry
  F_DATUM_LIEFER_TAT               DateTime       Actual delivery date
  F_DATUM_LIEFER_PLAN              DateTime       Scheduled delivery date
  F_DATUM_LIEFERWUNSCH             String         Requested delivery (e.g. immediately)
  F_DATUM_PROD1                    DateTime       IG production date
  F_DATUM_PROD2                    DateTime       LG production date
  F_DATUM_PROD3                    DateTime       TG production date
  F_OR_BEARBEITER                  String         Person in charge



                                                                                                 120
  F_OR_FACHBERATER                       String       Consultant
  F_OR_ADIENST                           String       Salesman
  F_OR_TOUR                              String       Dispatch route
  F_OR_LIEFERBED                         String       Delivery terms
  F_OR_VERPACKUNG                        String       Packing type
  F_OR_SPERRKZ                           String       Lock code
  F_FI_BETR_NETTO                        Number       Net amount excluding VAT
  F_FI_BETR_BRUTTO                       Number       Gross amount and VAT
  F_FI_MWST1_BASIS                       Number       Basic VAT amount 1
  F_FI_BETR_MWST1                        Number       VAT amount 1
  F_FI_MWST2_BASIS                       Number       Basic VAT amount 2
  F_FI_BETR_MWST2                        Number       VAT amount 2
  F_FI_BETR_BRUTTO                       Number       Gross amount and VAT
  F_FI_ZAHLBED                           String       Payment terms
  F_FI_ZAHLWEG                           String       Payment mode
  F_FI_WAEHRUNG                          String       Currency
  F_BEST_TEXT1                           String       Purchase text 1
  F_BEST_TEXT2                           String       Purchase text 2
  F_FI_MWST1                             Number       VAT % 1
  F_FI_MWST2                             Number       VAT % 2
  F_FI_UST_ID                            String       VAT ID
  F_AH_PLZ_POSTFACH                      String       Post code for P.O. box
  F_AH_POSTFACH                          String       P.O. box
  F_AR_PLZ_POSTFACH                      String       Invoice address - post code for P.O. box
  F_AR_POSTFACH                          String       Invoice address - P.O. box
  F_SU_STUECK                            Number       Total quantity
  F_SU_STUECK_ISO                        Number       Total IG units
  F_SU_LFM_REAL                          Number       Total circumference, exact
  F_SU_LFM_FAKT                          Number       Total circumference, rounded
  F_SU_QM_REAL                           Number       Total surface, exact
  F_SU_QM_FAKT                           Number       Total surface, rounded
  F_SU_GEWICHT                           Number       Total weight of goods
  F_STATUS                               Number       State
  F_NR_RECHNUNG                          Number       Invoice number
  F_KOPFTEXT                             String/RTF   Document text (from 2012 RTF field)
  F_AH_HAUPT_AUFTR                       Number       Main order number for partial shipment
  F_DOK_TYP                              String       Document type
  LADELISTE_NR                           Number       Cargo list number
  LADELISTE_SPEDITEUR                    String       Forwarder's cargo list
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




  LADELISTE_BEMERKUNG                    String       Cargo list - notes
  LADELISTE_DATUM                        DateTime     Cargo list - date
  LADELISTE_ANZTEILE                     Number       Cargo list - number of packaging units
  LADELISTE_GESGEWICHT                   Number       Cargo list - total weight
  LADELISTE_LIEFTEXT                     String       Cargo list - shipping text
  LADELISTE_VERSENDER                    String       Cargo list - sender name 1
  LADELISTE_VERSENDER2                   String       Cargo list - sender name 2
  F_PRIORITAET                           String       Order priority
  USER_FIELD1                            String       User-defined field 1
  USER_FIELD2                            String       User-defined field 2
  USER_FIELD3                            String       User-defined field 3
Tab. 6: Document view - main variables



                                                                                                 121
           Item variables
Variable                    Type         Description

F_PROD_BEZ1                 String       Product name 1
F_PROD_BEZ2                 String       Product name 2
F_PROD_BEZ3                 String       Product name 3
F_PP_MENGE                  String       Item quantity
F_PP_BREITE                 String       Width
F_PP_HOEHE                  String       Height
F_POS_KOMMISSION            String       Customer consignment
F_POS_KUNDENPOS             String       Customer's item number
F_PROD_KURZ_BEZ             String       Product short name
F_PROD_FARBE                String       Product color for articles
F_PROD_MEEINHEIT            String       Quantity unit
F_PROD_PRODART              Number       Product type
F_PROD_PRODGRP              Number       Product group
F_PR_EINHEIT                String       Price unit
F_PR_LISTE                  String       Price year
F_PR_SCHLUESSEL             String       Price key
F_PP_QM                     Number       Surface per piece
F_PP_QM_FAKT                Number       Surface per piece (rounded)
F_PP_LFM                    Number       Circumference per piece
F_PP_LFM_FAKT               Number       Circumference per piece (rounded)
F_PP_GEWICHT                Number       Weight per piece
F_PP_DICKE                  String       Glazing thickness
F_FI_PREIS_ME               Number       Price per price unit
F_FI_RABATT1                Number       Discount
F_FI_BRUTTO                 Number       Glass unit price prior to discount deduction
F_FI_NETTO                  Number       Glass unit price after deduction of discount, without BOM
                                         items
F_FI_NETTO_GES              Number       Glass unit price multiplied by quantity
F_FI_POS_STK                Number       Total item unit price including surcharges and processing
                                         referring to one piece
F_FI_POS_GES                Number       Total item price including surcharges and processing, for
                                         total item quantity
F_EK_POS_GES                Number       Total item cost
F_POS_TEXT1                 String       Item text 1
                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL



F_POS_TEXT2                 String       Item text 2
F_POS_TEXT3                 String       Item text 3
F_POS_TEXT4                 String       Item text 4
F_POS_TEXT5                 String       Item text 5
F_CE_CPIP                   String       CPIP Code
F_TEXT1                     String/RTF   Item text before item (from2012 RTF text)
F_TEXT2                     String/RTF   Item text after item (from2012 RTF text)
F_PRODTEXT                  String/RTF   Product text (from 2012 RTF text)
F_REF                       String       Document reference
F_AB                        String       Supplier OC no.
F_REFERENZ                  String       P.O. reference
F_GEL_MENGE                 Number       Quantity delivered
F_PROD_STRUKTSEITE          String       Pattern side


                                                                                               122
  F_REKLA_ORT                            String   Cause of complaint
  F_REKLA_GRUND                          String   Reason for complaint
  F_PROD_ID                              Number   Product number
  F_FI_ZUBASIS                           Number   Basic surcharge (amount)
  F_ISO_AUFBAU_KEYNR                     Number   Unique IG structure number
  F_LIORDER_NR                           Number   LIORDER production number
  F_LIORDER_VSG                          String   LIORDER production number for LG
  F_POS_REFERENZ                         String   Product reference number (e.g. DORMA product number)
  F_VPOS_NR                              String   Virtual item number
  F_PROD_ID_MCODE                        String   Product matchcode (master data)

  From ALFAK 2008 on:

  F_REF_BEST_ID                          String   Reference for the previous P.O. number (only for orders and
                                                  quotations). For credit notes, this field shows the invoice
                                                  number of the order on which the credit note is based
  F_REF_BEST_POS                         String   Reference for the previous P.O. item number (only for
                                                  orders and quotations)
  F_REF_AUSLIEF_AUFTR_ID                 String   Reference for shipping order number. For credit notes, this
                                                  field shows the number of the order on which the credit note
                                                  is based
  F_REF_AUSLIEF_AUFTR_POS                String   Reference for the shipping item number. For credit notes,
                                                  this field shows the order item on which the credit note is
                                                  based
  F_REF_ENDKUNDE_BEST_ID                 String   Reference for the customer's P.O. number (not for credit
                                                  notes)
  F_REF_ENDKUNDE_BEST_POS                String   Reference for the customer's item number (not for credit
                                                  notes)
  F_PRCL_XXX                             String   Value of product classifiers with names XXX
Tab. 7: Document view - item variables


             BOM variables
  Variable                               Type     Description

  F_STL_BEZ                              String   Product Description
  F_STL_FARBE                            String   Product color
  F_STL_KURZ_BEZ                         String   Product short name
  F_STL_PRODART                          Number   Product type
  F_STL_PRODGRP                          Number   Product group
  F_STL_MENGE                            String   Quantity
                                                                                                                 A+W Software GmbH - Configuration A+W Business - INTERNAL



  F_STL_BREITE                           String   Width
  F_STL_HOEHE                            String   Height
  F_PP_DICKE                             String   Thickness
  F_STL_LFM                              Number   Scope
  F_STL_LFM_FAKT                         Number   Circumference, rounded
  F_STL_QM                               Number   Area
  F_STL_QM_FAKT                          Number   Surface (rnd.)
  F_STL_PR_EINHEIT                       String   Price unit
  F_STL_PR_RABATT                        Number   Discount
  F_STL_PREIS_OFFEN                      Number   explicit price
  F_STL_BETR_NETTO                       Number   Net amount
  F_STL_BETR_BRUTTO                      Number   Gross amount
  F_STL_NETTO_GES                        Number   Total Price


                                                                                                          123
  F_STL_PREIS_ME                      Number      Price per price unit
  F_PARAM_MODELL                      String      Shape parameter
  F_PARAM_BEARB                       String      Processing parameters
  F_SPR_DIRECTION1                    Number      Georgian bar direction
  F_SPR_MENGE1                        Number      Number of bars
  F_SPR_DIRECTION2                    Number      Georgian bar direction
  F_SPR_MENGE2                        Number      Number of bars
  F_PARAM_SPROSSE                     String      Muntin parameters
  F_STL_STRUKTSEITE                   String      Pattern side
  F_BOM_PRODUKT                       Number      Product number
  F_STL_LIORDER_NR                    Number      LIORDER production number
  F_STL_LIORDER_VSG                   String      LIORDER production number for LG
  F_STL_REFERENZ                      String      Product reference number (e.g. DORMA product number)
  F_BOM_PRODUKT_MCODE                 String      Product matchcode (master data)
  F_STX_PRCL_XXX                      String      Value of product classifiers with names XXX
Tab. 8: Document view BOM variables


3.2. Form printing variables
The report variables available for printing documents are listed below.

             Header
  Variable                            Type        Description

  AB_DATUM                            Date/Time   Order confirmation date
  AB_LIEFERANT_DAT                    String      Supplier's order confirmation date
  AH_ANREDE                           String      Customer address (Mr, Mrs, etc.)
  AH_ANREDE                           String      Customer company
  AH_FAX                              String      Customer's fax number
  AH_HAUPT_AUFTR                      Number      Main order number
  AH_IDENT                            Number      Customer #
  AH_KOPF                             String      Customer's company name
  AH_LAND_NAME                        String      Country
  AH_LAND                             String      Customer's country
  AH_LIEFER_KZ                        Number      Delivery code for shipping address
  AH_LIEFERANT                        Number      Supplier number in order header
  AH_LIEFERANT_NAME1                  String      Supplier name 1 in order header
  AH_LIEFERANT_NAME2                  String      Supplier name 2 in order header
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




  AH_LIEFERANT_ORT                    String      Supplier's location in order header
  AH_LIEFERANT_PLZ                    String      Supplier's post code in order header
  AH_LIEFERANT_STRASSE                String      Supplier's street in order header
  AH_MAIL                             String      Email address acc. to document header
  AH_MCODE                            String      Customer's short name
  AH_NAME1...AH_NAME3                 String      Customer name
  AH_PARTNER                          String      Customer's contact
  AH_PLZ                              String      Customer's post code
  AH_PLZ_POSTFACH                     String      Post code (post box)
  AH_POSTFACH                         String      Customer's post box
  AH_PROVINZ                          String      Customer county/state
  AH_STRASSE                          String      Customer's street address



                                                                                                     124
AH_TELEFON           String      Customer's phone number
AL_ANREDE            String      Address (shipping address)
AL_FAX               String      Fax number (shipping address)
AL_IDENT             Number      Customer number (shipping address)
AL_KOPF              String      Address (shipping address)
AL_LAND_NAME         String      Country
AL_LAND              String      Country (shipping address)
AL_NAME1             String      Shipping address - name 1
AL_NAME2             String      Shipping address - name 2
AL_NAME3             String      Shipping address - name 3
AL_ORT               String      City (shipping address)
AL_PARTNER           String      Customer's contact for delivery
AL_PLZ               String      Post code (shipping address)
AL_PROVINZ           String      County/state (shipping address)
AL_STRASSE           String      Shipping address - street
AL_TELEFON           String      Phone number for alternative Shipping address
AR_ANREDE            String      Address (invoice address)
AR_FAX               String      Fax number (invoice address)
AR_IDENT             Number      Customer number (invoice address)
AR_KOPF              String      Address (invoice address)
AR_LAND_NAME         String      Country
AR_LAND              String      Country (invoice address)
AR_NAME1             String      Invoice name 1
AR_NAME2             String      Invoice name 2
AR_NAME3             String      Invoice name 3
AR_ORT               String      City (invoice)
AR_PARTNER           String      Customer's contact (invoice)
AR_PLZ               String      Post code (invoice address)
AR_PLZ_POSTFACH      String      Post code and post box (invoice address)
AR_POSTFACH          String      Post code (invoice address)
AR_PROVINZ           String      County/state (invoice address)
AR_STRASSE           String      Street of the invoice address
AR_TELEFON           String      Phone number (invoice address)
AUFTR_REF            Number      Original order number (for partial shipments)
BANK_NAME            String      Customer's bank name (form option 1)
BEST_TEXT1           String      Purchase text 1
BEST_TEXT2           String      Purchase text 2
BRUTTO_TAGE          Number      Gross days (payment terms)
CONTR_BRUTTO_AMNT    Number      Gross amount of the present claim
                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




CONTR_CURRENT_AMNT   Number      Amount to be paid at present
CONTR_FI_NETTO_GES   Number      Net amount of the corresponding overall order
CONTR_MWST_AMNT      Number      VAT for the present claim
CONTR_PAID_AMNT      Number      Total claims paid
CONTRACT_ORDER_ID    Number      Number of the corresponding overall order
DATUM_AB             Date/Time   Order confirmation (printout date)
DATUM_ANLIEFERUNG    Date/Time   Delivery date
DATUM_BEST           Date/Time   Purchase date
DATUM_ERF            Date Time   Input date of the order
DATUM_FAELLIGK       Date/Time   Due date
DATUM_LIEFER_TAT     Date Time   Actual shipping date
DATUM_LIEFERSCHEIN   Date Time   Delivery note date



                                                                                 125
DATUM_LIEFERWUNSCH    String      Delivery request
DATUM_PROD1...3       Date/Time   Production date IG, laminated glass, toughened glass
DATUM_RECHNUNG        Date/Time   Invoice date
DATUM_SKONTO          Date/Time   Cash discount date
DATUM_VALUTA_SPLIT1   Date/Time   1nd due date (for graduated due dates)
DATUM_VALUTA_SPLIT2   Date/Time   2nd due date (for graduated due dates)
DATUM_VALUTA_SPLIT3   Date/Time   3rd due date (for graduated due dates)
DATUM_VALUTA_SPLIT4   Date/Time   4th due date (for graduated due dates)
DATUM_VALUTA_SPLIT5   Date/Time   5nd due date (for graduated due dates)
DEBKRED_KTO           String      Debtor/creditor account (form option 1)
DOC_SU_GEWICHT        Number      Total weight (for the document)
DOC_SU_LFM_FAKT       Number      Total linear meters - invoiced (for the document)
DOC_SU_LFM_REAL       Number      Total linear meters - actual (for the document)
DOC_SU_QM_FAKT        Number      Total square meters - invoiced (for the document)
DOC_SU_QM_REAL        Number      Total square meters - actual (for the document)
DOC_SU_SPRLFM_FAKT    Number      Total linear meters of Georgian bars - invoiced per document
DOC_SU_SPRLFM_REAL    Number      Total linear meters of Georgian bars - actual per document
DOC_SU_STUECK         Number      Total quantity (for the document)
DOC_SU_QM_FAKT_TPS    Number      Total square meters of TPS - invoiced (for the document)
DOK_TYP               String      Document type
Print item            Number      Print item acc. to management of forms
FAXHEADER             Number      Fax header for fax dispatch
FER_LINIE             Number      Production line
FI_BETR_BRUTTO        Number      Gross amount and VAT
FI_BETR_BRUTTO_FW     Number      Gross item amount in foreign currency
FI_BETR_FESTPR_FW     Number      Fixed document price in foreign currency
FI_BETR_FESTPREIS     Number      Fixed document price
FI_BETR_MWST1         Number      Tax amount 1
FI_BETR_MWST2         Number      Tax amount 2
FI_BETR_MWST3         Number      Tax amount 3
FI_BETR_MWST4         Number      Tax amount 4
FI_BETR_MWST5         Number      Tax amount 5
FI_BETR_MWST1_FW      Number      Tax amount 1 in foreign currency
FI_BETR_MWST2_FW      Number      Tax amount 2 in foreign currency
FI_BETR_MWST3_FW      Number      Tax amount 3 in foreign currency
FI_BETR_MWST4_FW      Number      Tax amount 4 in foreign currency
FI_BETR_MWST5_FW      Number      Tax amount 5 in foreign currency
FI_BETR_NETTO         Number      Net document amount
FI_BETR_NETTO_FW      Number      Net document amount in foreign currency
                                                                                                 A+W Software GmbH - Configuration A+W Business - INTERNAL




FI_BETR_SKONTO        Number      Cash discount
FI_BRUTTO             Number      Gross document amount
FI_BRUTTO_FW          Number      Gross document amount in foreign currency
FI_KOPF_RABATT        Number      Main discount (document)
FI_MWST1              Number      VAT % 1
FI_MWST2              Number      VAT % 2
FI_MWST3              Number      VAT % 3
FI_MWST4              Number      VAT % 4
FI_MWST5              Number      VAT % 5
FI_MWST1_BASIS        Number      Basic VAT amount 1
FI_MWST2_BASIS        Number      Basic VAT amount 2
FI_MWST3_BASIS        Number      Basic VAT amount 3



                                                                                          126
FI_MWST4_BASIS                Number   Basic VAT amount 4
FI_MWST5_BASIS                Number   Basic VAT amount 5
FI_MWST1_BASIS_FW             Number   Basic VAT amount 1 in foreign currency
FI_MWST2_BASIS_FW             Number   Basic VAT amount 2 in foreign currency
FI_MWST3_BASIS_FW             Number   Basic VAT amount 3 in foreign currency
FI_MWST4_BASIS_FW             Number   Basic VAT amount 4 in foreign currency
FI_MWST5_BASIS_FW             Number   Basic VAT amount 5 in foreign currency
FI_MWST1_ID                   Number   VAT ID 1
FI_MWST2_ID                   Number   VAT ID 2
FI_MWST3_ID                   Number   VAT ID 3
FI_MWST4_ID                   Number   VAT ID 4
FI_MWST5_ID                   Number   VAT ID 5
FI_SKONTO_BASIS               Number   Basic cash discount amount
FI_SKONTO_BASIS_FW            Number   Basic cash discount amount in foreign currency
FI_UST_ID                     String   VAT ID
FI_VALUTAKURS                 Number   Exchange rate
FI_WAEHRUNG                   String   Currency used for calculating the item
FI_ZAHL_TAG1...FI_ZAHL_TAG3   Number   Payment days 1-3
FI_ZAHLBED                    String   Payment terms
FI_ZAHLWEG                    String   Method of payment
SITENO                        Number   Subsidiary number
FIRMA_FAX                     String   Company's fax number
FIRMA_NAME1                   String   Company name 1
FIRMA_NAME2                   String   Company name 2
FIRMA_NAME3                   String   Company name 3
FIRMA_ORT                     String   Company location
FIRMA_PLZ                     String   Post code (headquarters)
FIRMA_STRASSE                 String   Street address (headquarters)
FIRMA_TLF1                    String   Company's phone number
FIRMA_UST_ID                  String   Company's VAT ID
FIRMA_STEUER_NR               String   Company's tax ID
FORM_PATH                     String   Path for the forms in the INI file (w/o backslash at the end)
FREMD_KEY                     String   Foreign key
KO_FAXVERSAND                 Number   Flag for faxing the document
KO_KSCHUTZ                    Number   Edgework code
KO_MASSEINH                   Number   Measurement imperial/metric
KO_NETTOPREISE                Number   Flag for output of net prices
KO_OBJEKT_KUNDE               String   Customer's project name
KO_OBJEKT_LIEF                String   Supplier's project name
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




KO_TEILFAK                    Number   Partial invoicing flag
Copies                        Number   Number of document copies
KPF_TEXT_KZ0...KPF_TEXT_KZx   String   Text code for customized headers
KPF_TEXT0...KPF_TEXTx         String   Customized headers
KPF_TEXT_RTF0…KPF_TEXT_RTFx   RTF      Customized RTF headers (from 2012 on)
Loading list                  Number   Print loading list
LAUF_PROD1                    Number   Production job number IG
MAIL_BETREFF                  String   Reference line for email dispatch
MAIL_FILE                     String   Name of PDF file for emailing without file suffix
MAILHEADER                    Number   Defines whether the email header shall be printed (for
                                       emailing via PDF-Mailer)
MEMO                          String   Memo field of the document
MOD_DRUCK                     Number   Shape printing flag


                                                                                                127
MOD_LOGO                   Object   Bitmap field for the shape on the form
MODUS                      Number   1=Quotation,2=Order,3=Credit note,4=Inquiry, 5=Purchase
                                    order
NR_AUFTRAG                 Number   Order number
NR_LIEFERSCHEIN            Number   Delivery note #
LS_NUMMERN                 String   Delivery note numbers including prefix for printing invoices,
                                    and numbering per page
PRAEFIX_LIEFERSCHIEN       String   Delivery note prefix for numbering per page
PRAEFIX_RECHNUNG           String   Invoice prefix for numbering per page
NR_RECHNUNG                Number   Invoice number
OCR                        String   OCR code for customers for invoice printing
OR_ADIENST                 String   Salesman 1
OR_AVBEREICH               String   Order area for the order
OR_AVBEREICH_FK            String   External code for OM area
OR_AWTOUR                  String   Alternative route
OR_BEARBEITER              String   Author of this order
OR_FACHBERATER             String   Consultant for this order
OR_FACHBERATER_DURCHWAHL   String   Consultant's extension
OR_FACHBERATER_MAIL        String   Consultant's email address
OR_FACHBERATER_FAX         String   Consultant's fax number
OR_FAHRER                  String   Driver delivering this order
OR_GESCHART                String   Business type of this order
OR_GRUPPE                  String   Customer group
OR_LIEFERBED               String   Delivery terms for this order
OR_LKW                     String   Truck name
OR_MANDANT                 Number   Site
OR_SPERRKZ                 String   Lock code for the document
OR_SPRACH_BASIS            Number   Native language number (0)
OR_SPRACH_ID               Number   Language number for the document
OR_TOUR                    String   Route name
OR_VERPACKUNG              String   Packing type
OR_ZOLLTOUR                String   Customs route name
PMNT_AMOUNT                String   Deposit amount (SGG)
PMNT_CURRENCY              String   Deposit currency (SGG)
PMNT_DATE                  String   Deposit date (SGG)
PMNT_MODE                  String   Deposit payment type (SGG)
PMNT_REMARK                String   Deposit remarkes (SGG)
PMNT_REST_AMOUNT           String   Balance minus deposits (SGG)
PMNT_STATUS                String   Deposit status (SGG)
                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL



PMNT_SUM_AMOUNT            String   Total deposit amount (SGG)
PMNT_TIME                  String   Deposit time (SGG)
PMNT_USER                  String   Deposit made by (SGG)
PRIORITY                   String   Production transfer priority
SEITE                      Number   Actual number of pages of the document
SEITEN                     Number   Actual number of pages of the document after change of
                                    form layout
SKONTOSATZ1                Number   Cash discount rate 1
SKONTOSATZ2                Number   Cash discount rate 2
SKONTOSATZ3                Number   Cash discount rate 3
SKONTOTAGE1                Number   Cash discount days 1
SKONTOTAGE2                Number   Cash discount days 2
Cash discount days         Number   Cash discount days 3



                                                                                             128
SQL_USER                  String   Database login name
STATUS                    Number   Document status
STEUERNUMMER              String   Customer's tax number
SU_BETR_BRUTTO_SPLIT1     Number   1st instalment on due date 1 (gross)
SU_BETR_BRUTTO_SPLIT2     Number   2nd instalment on due date 2 (gross)
SU_BETR_BRUTTO_SPLIT3     Number   3rd instalment on due date 3 (gross)
SU_BETR_BRUTTO_SPLIT4     Number   4th instalment on due date 4 (gross)
SU_BETR_BRUTTO_SPLIT5     Number   5st instalment on due date 5 (gross)
SU_BETR_EK1               Number   Material costs
SU_BETR_EK2               Number   Time costs
SU_SPRLFM_FAKT            Number   Total linear meters of Georgian bars (invoiced)
SU_SPRLFM_REAL            Number   Total linear meters of Georgian bars (actual)
TEXT_FUSS                 String   Definable text (form footer)
TEXT_FUSS_RTF             RTF      Definable text in form footer (from 2012 RTF field)
TEXT_KOPF                 String   Definable text (form header)
TEXT_KOPF_RTF             RTF      Definable text in form header (from 2012 RTF field)
TEXT_NR0...TEXT_NRx       String   Job number for customized headers
WH_DRUCK                  Number   Flag for repeated printout
ZAHL_BLZ                  String   Bank code (acc. to form option 1)
ZAHL_KTN                  String   Account number (acc. to form option 1)
KOPF_RESTERROR            String   Bit        vector       for       restriction       violations
                                   Collects all restriction violations for the item
                                   1.      =       max.       purchase        size     exceeded
                                   2.         =         max.         stocksize         exceeded
                                   3.         =        min.        sizes           not       met
                                   4.          =        max.          surface          exceeded
                                   5. = max. aspect ratio exceeded

SU_BETR_BRUTTO_STR        String   Gross amount in words
SU_BETR_BRUTTO_FW_STR     String   Foreign currency amount in words
ZUSCHLAG_BIT_STRING       String   Bit vector of surcharges (explanation on tab Bit vectors)
OR_ADIENST2               String   Salesman 2 (as from 4.0 case 101086 )
TLF2                      String   Customer's second phone number (via form option 'Read
                                   customer data (bank account)')
SU_UEBERTRAG              Number   Item     amounts      carried    over    to     next    page
                                   (only without Keep Group on Page of GRUPPENBEZ)
KZ_POSTFACH               Number   Defines whether the post pox address shall be used (via form
                                   option 'Read customer data (bank account)')
PRT_CLASSxxx              String   Classifier value (xxx = classifier no. without zeros) Is enabled
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL


                                   by form option; classifier notes have to start with <Print>
PREV_INVOICE_NET          Number   Net amount of last month's invoice (form option 'previous
                                   invoice data')
PREV_INVOICE_TAX1         Number   Tax amount 1 of last month's invoice (form option 'previous
                                   invoice data')
PREV_INVOICE_TAX2         Number   Tax amount 2 of last month's invoice (form option 'previous
                                   invoice data')
PREV_PAYMENTTYPE          String   Payment method of last month's invoice (form option
                                   'previous invoice data')
CUST_RECEIVABLES          Number   Customer's receivables (form option 'previous invoice data')
TEXT1, TEXT2, ...TEXT10   String   Variable text from management of forms
TEXT1_RTF,…TEXT10_RTF     RTF      Variable text from management of forms
KO_OBJEKT_KUNDE_NR        Number   Customer's project number
KO_OBJEKT_LIEF_NR         Number   Supplier's project number



                                                                                               129
   DOC_NR_C39                              String      Barcode            with        order           number
                                                       Structure: *Oxxxxxxxx* whereby x= 8digit order number
                                                       with heading zeros

   TRANSPORT_ID                            Number      Brazilian taxation: forwarder's ID
   TRANSPORT_RESPONSE                      Number      Brazilian taxation: responsibility
   TRANSPORT_NAME1                         String      Brazilian taxation: forwarder's name
   TRANSPORT_STRASSE                       String      Brazilian taxation: forwarder's street address
   TRANSPORT_ORT                           String      Brazilian taxation: forwarder's location
   TRANSPORT_PROVINZ                       String      Brazilian taxation: forwarder's state
   TRANSPORT_UST_ID                        String      Brazilian taxation: tax number of the state in which the
                                                       forwarder is located
   TRANSPORT_STEUERNUMMER                  String      Brazilian taxation: government's tax number
   VALOR_UNITARIO_MODE                     Number      Valor Unitario mode (0=in price unit, 1= in units)
   COPYCOUNTER                             Number      Copy counter (0=Original, 1= first copy,….)
   FIRMA_CERT_CODE                         String      Company's certification code
   HASH_CODE                               String      Digital signature/hash code of the document (digits 1, 11, 21
                                                       and 31, separated by -)
  ANLIEFERZEIT                             String      Delivery time window (from – to)
  USER_FIELD1                              String      User-defined field 1
  USER_FIELD2                              String      User-defined field 2
  USER_FIELD3                              String      User-defined field 3
Tab. 9: Printing of forms - header variables


              Item variables
   Variable                                Type        Description

   AB_DATUM0                               Date/Time   Supplier's order confirmation date for a customer's item
   AB_LIEFERANT_DAT                        String      Supplier's order confirmation date
   AB_LIEFERANT0                           String      Supplier's order confirmation for a customer's item
   AGGREGATE                               String      Time management: machines sorted by process sequence
   AH_HAUPT_AUFTR                          Number      Main order number for partial shipments
   ALTERNATIV                              Number      Alternative item number
   AUFTR_REF                               Number      Order reference for partial shipment
   BA_PRODUKT_INFO                         String      Article info (form option:read product data)
   BEARBTEXT                               String      Text showing all processing steps for an article
   CE_CPIP                                 String      CPIP code (SGG only)
   CE_FLAG                                 Number      CPIP check active (0 = disabled, 1= active) (SGG only)
   CE_KZ                                   String      CE code
                                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL


   CE_LEVEL                                Number      CPIP level (0=self-explanatory, 1=certified, 2=certified with
                                                       size restriction) (SGG only)
   CONTR_AMNT_ACT                          Number      Amount of the actual claim
   CONTR_AMNT_PREV                         Number      Amount of previous claims
   CONTR_CLAIM_TYPE                        String      CONTR_CLAIM_TYPE                      Claim          type
                                                       (percentage, quantity, or amount)
   CONTR_CLAIMED_ACT                       Number      Quantity for the actual claim
   CONTR_CLAIMED_PREV                      Number      Quantity of previous claims
   DOC_POS_C39                             String      Barcode       with     order     and      item    number
                                                       Structure: *Cxxxxxxxxppp* whereby x=8-digit order number
                                                       with heading zeros and p=3-digit item number with heading
                                                       zeros
   EAN                                     String      EAN number as per product master data
   EINHZAEHLER                             Number      Numbering of unit labels



                                                                                                                130
EK_POS_GES                 Number   Total purchase price of the item
EK_POS_STK                 Number   Cost per piece
EK_PREIS_ME                Number   Cost per price unit
EK_PREIS_ME_GES            Number   Cost per price unit including implicit Bills of material
EK_ZEIT_STK                Number   Labour cost per piece acc. to capacity planning
FER_BESCHAFFARTNR          Number   Supply type number
FER_BESCHICH_SEITE         Number   Coated side of main product
FER_GEST_TYP               String   Rack type and rack number from production feedback
FER_KSCHUTZ                Number   Edgework code
FER_KZ_BESCHICHTET         Number   Coating code acc. to product master data
FER_LAUF1                  Number   Production job number
FER_LINIE                  Number   Production line
FER_RAHMENNR               Number   Spacer text numberSpacer text number
FER_RAHMENTEXT             String   Spacer text numberSpacer text number
FER_STRUKTURSEITE          Number   Pattern side
FER_STRUKTURVERL           Number   Sense of pattern
FER_UVRAND                 Number   UV edgework code
FI_BRUTTO                  Number   Gross item price
FI_BRUTTO_FW               Number   Gross item price in foreign currency
FI_KZ_STEUER               Number   Tax code
FI_NETTO                   Number   Net amount (article)
FI_NETTO_FW                Number   Net amount (article) in foreign currency
FI_NETTO_GES               Number   Total amount net
FI_NETTO_GES_FW            Number   Total amount net in foreign currency
FI_POS_GES                 Number   Total item price
FI_POS_GES_BEM             String   Remarks/reason for price change
FI_POS_GES_BIT             Number   Price change report not printed (1= not printed)
FI_POS_GES_FW              Number   Total item price in foreign currency
FI_POS_GES_MAN             Number   Total item price without manual presetting
FI_POS_GES_RAB             Number   Total item price without discount and individual price
FI_POS_STK                 Number   Total item price
FI_POS_STK_FW              Number   Total item price in foreign currency
FI_PREIS_ME                Number   Article's price quantity unit
FI_PREIS_ME_FW             Number   Article price per price unit in foreign currency
FI_PREIS_ME_FW_SHEET1..3   Number   Price per quantity unit for 1st and 3rd sheet of IG unit (in
                                    foreign currency)
FI_PREIS_ME_GES            Number   Price per price unit including implicit Price per price unit
                                    including implicit Bills of material
FI_PREIS_ME_GES_FW         Number   Price per price unit including implicit Price per price unit
                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL



                                    including implicit BOM in foreign currency
FI_PREIS_ME_GES_FWNET      Number   Net price per quantity unit in foreign currency including
                                    replacement sheets (IG)
FI_PREIS_ME_GESNET         Number   Net price per quantity unit including replacement sheets (IG)
FI_PREIS_ME_SHEET1..3      Number   Price per quantity unit for 1st and 3rd sheet of IG unit
FI_RABATT_SHEET1..3        Number   Discount for 1st and 3rd sheet of IG unit
FI_RABATT1                 Number   Article discount
FI_ZUBASIS                 Number   Basic surcharge (amount)
FORMGRUPPE                 Number   Form group for split printout
GAS[1-n]                   String   Name of 1.-n. gas
GEL_MENGEx                 Number   Delivered quantity (goods received) for P.O. (x = 0-x P.O.
                                    references)
GLAS_BS[1-n]               Number   Coated side of IG sheets
GLAS_SS[1-n]               Number   Patterned side of IG sheets


                                                                                             131
GLAS_SV[1-n]               Number   Sense of pattern of IG sheets
GLAS[1-n]_BESCH            Number   Coating code of IG sheets acc. to product master data
GLASBEZ[1-n]               String   Glass name 1-n
GROUP                      Number   Internal group number
GRUPPE_BIS                 Number   End of group - item number
GRUPPE_EQUAL               Number   Flag for printing identical, consecutive items
GRUPPE_LFM_FAKT            Number   Total circumference for a group
GRUPPE_NETTO               Number   Net group price
GRUPPE_NETTO_FW            Number   Net group prices in foreign currency
GRUPPE_PRINT               Number   Print subtotal
GRUPPE_QM_FAKT             Number   Total surface of the group
GRUPPE_STK                 Number   Total quantity for a group
GRUPPE_VON                 Number   Start of group - item number
ISO_AUFBAU_KEYNR           Number   Unique IG structure number
KISTE_INHALT               Number   Box contents
KOSTENART                  String   Cost type
KOSTENSTELLE               String   Cost center
KUNDE_NAME                 String   Customer name of P.O. forms from P.O. transfer
KZ_AUTOZUSCHN              Number   Code 'automatic cutting - main product'
KZ_AUTOZUSCHN[1-n]         Number   Code 'automatic cutting - 1st-nth glass'
KZ_BESTELLUNG              Number   P.O. code: 0=in-house production/glass supplied,
                                    1=purchased article, 2=article completely purchased
KZ_LAGER                   Number   Stockkeeping code : 0=own production, 1=stock product
KZ_SERIE                   Number   Serial code
LAG_LAGER_BEZ              String   Warehouse name
LAG_LAGER_ID               Number   Stock product name
LAGER_IDENT                String   Stock ID number
LIEFERANT_NAME             String   Supplier name for this item (only if form option 'print
                                    references' is active)
LIEFERANT_NR               Number   Supplier number for this item (only if form option 'print
                                    references' is active)
MAKRO_NAME                 String   Name of the selected macro (from 2006)
MOD_SN_TEMPLATE            String   Template name of SN file (from 2009)
MOD_SN_NAME                String   Shaping+Nesting file name
OR_FACHBERATER_DURCHWAHL   String   Consultant's extension
OR_SPRACH_BASIS            Number   Native language
OR_SPRACH_ID               Number   Language in which the document shall be printed
POS_BIT                    Number   Modification bit for this item
POS_BIT_STRING             String   1. string with manual amendment flags
                                                                                                A+W Software GmbH - Configuration A+W Business - INTERNAL



POS_BIT2_STRING            String   2. string with manual amendment flags
POS_BIT3_STRING            String   3. string with manual amendment flags
POS_GRUPPE                 Number   Item group of counter pane
POS_KOMMISSION             String   Item reference text
POS_KUNDENPOS              String   Customer item
POS_NR                     Number   Item number
POS_PREIS_BIT_STRING       String   Bit vector for pricing information
POS_REF                    Number   Item number of original item (for partial shipment)
ITM_REFERENCE              String   Product reference number (DORMA product number)




                                                                                          132
POS_RESTERROR           String   Bit vector for restriction violations

                                 Digit                        =                      violation
                                 1.       =        max.      purchase       size    exceeded
                                 2.           =         max.        stocksize       exceeded
                                 3.          =         min.        size         not       met
                                 4.           =         max.         surface        exceeded
                                 5. = max. aspect ratio exceeded
POS_STATUS              Number   Item status
POS_STTXT_NR            Number   Text number
POS_TEXT                String    Item text
POS_TEXT1               String   Item text 1
POS_TEXT2               String   Item text 2
POS_TEXT3               String   Item text 3
POS_TEXT4               String   Item text 4
POS_TEXT5               String   Item text 5
POS_VERPACKUNG          String   Packing type
PP_BREITE               Number   Article width in mm
PP_BREITE_INCH          String   Article width in inch
PP_DICKE                Number   Article thickness in mm
PP_DICKE_INCH           String   Article thickness in inch
PP_FALZ                 Number   Tight size
PP_GEWICHT              Number   Article weight in kg
PP_GEWICHT_TARA         Number   Article tara
PP_HOEHE                Number   Article height in mm
PP_HOEHE_INCH           String   Article height in inch
PP_LFM                  Number   Article - lin.m.
PP_LFM_FAKT             Number   Article - lin.m. invoiced
PP_MENGE                Number   Article quantity
PP_ORIG_MENGE           Number   Original item quantity
PP_ORIG_MENGE_TEIL      Number   Original item quantity (partial shipment)
PP_PLANSTK              Number   Default quantity
PP_QM                   Number   Article surface in sqm
PP_QM_FAKT              Number   Article surface, invoiced
PP_TEILGEL_MENGE        Number   Partially shipped item quantity
PP_TEILGEL_MENGE_TEIL   Number   Partially shipped item quantity (partial shipment)
PR_EINHEIT              String   Price unit
PR_EINHEIT_ID           Number   Price unit ID
PR_GRUPPE               String   Diff. customer price group
PR_LISTE                String   Item price list
                                                                                                 A+W Software GmbH - Configuration A+W Business - INTERNAL




PR_QM                   Number   Price per sqm
PR_SCHLUESSEL           String   Price code for this item
PROD_DES1               String   Article descript. 1
PROD_DES2               String   Article descript. 2
PROD_DES3               String   Article descript. 3
PROD_FARBE              String   Article color
PROD_ID                 Number   Product Code
PROD_KMB                String   Product group combination - discount
PROD_KMB_STAT           String   Product group combination - statistics
PROD_KOMONR             Number   KOMO number quality code
PROD_KURZ_BEZ           String   Product short name
PROD_LAGERORT           Number   Warehouse number



                                                                                          133
PROD_MCODE              String   Product matchcode
PROD_MEEINHEIT          String   Article - quantity unit
PROD_MEEINHEIT_ID       Number   Product quantity unit ID
PROD_PRODART            Number   Product type this article belongs to
PROD_PRODGRP            Number   Product group this article belongs to
PROD_WGR                String   Product group discounts
PROD_WGR_STAT           String   Product group statistics
REF_AUSLIEF_AUFTR_ID    String   Reference for shipping order number. For credit notes, this
                                 field shows the number of the order on which the credit note
                                 is based
REF_AUSLIEF_AUFTR_POS   String   Reference for the shipping item number. For credit notes,
                                 this field shows the order item on which the credit note is
                                 based
REF_BEST_ID             String   Reference for the previous P.O. number (only for orders and
                                 quotations). For credit notes, this field shows the invoice
                                 number of the order on which the credit note is based
REF_BEST_POS            String   Reference for the previous P.O. item number (only for
                                 orders and quotations)
REF_ENDKUNDE_BEST_ID    String   Reference for the customer's P.O. number (not for credit
                                 notes)
REF_ENDKUNDE_BEST_POS   String   Reference for the customer's item number (not for credit
                                 notes)
REF_ID0                 Number   From P.O. number' allocated to the order item after transfer
                                 to purchasing
REF_ID1                 Number   To P.O. number' allocated to the order item after transfer to
                                 purchasing
REF_POS0                Number   From P.O. item' allocated to the order item after transfer to
                                 purchasing
REF_POS1                Number   To P.O. item' allocated to the order item after transfer to
                                 purchasing
REF_POS1                Number   To P.O. item' allocated to the order item after transfer to
                                 purchasing
REKLA_GRUND             String   Reason for complaint
REKLA_ORT               String   Complaint place
SZR[1-n]                String   Name of spacer 1-n
SZR[1-n]FARBE           String   Color of spacer 1-n
TEXT_BEZ1               String   Text before item
TEXT_BEZ1_RTF           RTF      RTF texts before item (from 2012)
TEXT_BEZ2               String   Text after item
TEXT_BEZ2_RTF           RTF      RTF texts after item (from 2012)
TEXT_PROD               String   Product-related text
                                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL




TEXT_PROD_RTF           RTF      Product-related RTF texts (from 2012)
VERSK_DRUCK             Number   1=print dimensioned sketch
VPOS_NR                 String   Virtual item number (sub-items 1 / 1.1 / 1.2 / 1.3 etc.)
ZWPRODENDE              Date     End of production (time management)
ZWPRODSTART             Date     Start of production (time management)
PROD_GESTELLNR          String   Production rack number
POS_BETR_MWST[1-5]      Number   Item tax 1-5
POS_BETR_MWST[1-5]_FW   Number   Item tax - foreign currency 1-5
POS_ITEM_MWST[1-5]      Number   Item's tax share 1-5
POS_ITEM_MWST[1-5]_FW   Number   Item's tax share (foreign currency) 1-5
POS_MWST[1-5]_BASIS     Number   Tax basis 1-5
POS_MWST[1-5]           Number   Tax rate 1-5



                                                                                            134
   TAX_IVA                                    Number   IVA percentage for ICMS
   FI_PREIS_ME_TAX                            Number   Price per quantity unit including tax
   PP_MENGE_GES                               Number   Total item quantity
   FI_PREIS_ME_GES                            Number   Price per price unit for the complete item
   FI_POS_GES_TAX                             Number   Total item price including tax
   TAX_CST                                    String   CST code
   TAX_CFOP                                   String   CFOP code
   TAX_NCM                                    String   NCM code
   POS_PRCL_XXX                               String   Value of product classifier with name XXX
Tab. 10: Printing of forms - item variables


              Footer variables
   Variable                                   Type     Description

   DOC_SU_GEWICHT                             Number   Total weight of goods per document
   DOC_SU_LFM_FAKT                            Number   Total circumference (rounded) per document
   DOC_SU_LFM_REAL                            Number   Total circumference (exact) per document
   DOC_SU_QM_FAKT                             Number   Total surface (rounded) per document
   DOC_SU_QM_REAL                             Number   Total surface (exact) per document
   DOC_SU_STUECK                              Number   Total quantity per document
   DOC_SU_QM_FAKT_TPS                         Number   Total TPS surface per document
   DOC_SU_GEWICHT_TPS                         Number   Total TPS weight per document
   LAST_PAGE                                  Number   Flag for last page of form
   SU_BETR_BRUTTO                             Number   Total gross amounts
   SU_BETR_BRUTTO_FW                          Number   Total gross amounts in foreign currency
   SU_BETR_BRUTTO_STR                         String   Gross amount as string
   SU_BETR_MWST1                              Number   Total VAT 1
   SU_BETR_MWST2                              Number   Total VAT 2
   SU_BETR_MWST3                              Number   Total VAT 3
   SU_BETR_MWST4                              Number   Total VAT 4
   SU_BETR_MWST5                              Number   Total VAT 5
   SU_BETR_MWST1_FW                           Number   Total VAT 1 in foreign currency
   SU_BETR_MWST2_FW                           Number   Total VAT 2 in foreign currency
   SU_BETR_MWST3_FW                           Number   Total VAT 3 in foreign currency
   SU_BETR_MWST4_FW                           Number   Total VAT 4 in foreign currency
   SU_BETR_MWST5_FW                           Number   Total VAT 5 in foreign currency
   SU_BETR_NETTO                              Number   Total net amounts
   SU_BETR_NETTO_FW                           Number   Total net order amount in foreign currency
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL



   SU_BETR_SKONTO                             Number   Total cash discount 1
   SU_BETR_SKONTO_FW                          Number   Total cash discount 1 in foreign currency
   SU_BETR_SKONTO2                            Number   Total cash discount 2
   SU_BETR_SKONTO2_FW                         Number   Total cash discount 2 in foreign currency
   SU_BETR_SKONTO3                            Number   Total cash discount 3
   SU_BETR_SKONTO3_FW                         Number   Total cash discount 3 in foreign currency
   SU_BETR_SKONTOSATZ1                        Number   Total cash discount rate 1
   SU_BETR_SKONTOSATZ2                        Number   Total cash discount rate 2
   SU_BETR_SKONTOSATZ3                        Number   Total cash discount rate 3
   SU_BRUTTO_WERT                             Number   Gross value without surcharges
   SU_BRUTTO_WERT_FW                          Number   Gross value in foreign currency
   SU_GEWICHT                                 Number   Total weight
   SU_LFM_FAKT                                Number   Total lin.m. invoiced


                                                                                                    135
  SU_MWST1_BASIS                            Number         Total VAT basis 1
  SU_MWST2_BASIS                            Number         Total VAT basis 2
  SU_MWST3_BASIS                            Number         Total VAT basis 3
  SU_MWST4_BASIS                            Number         Total VAT basis 4
  SU_MWST5_BASIS                            Number         Total VAT basis 5
  SU_MWST1_BASIS_FW                         Number         Total VAT basis 1 in foreign currency
  SU_MWST2_BASIS_FW                         Number         Total VAT basis 2 in foreign currency
  SU_MWST3_BASIS_FW                         Number         Total VAT basis 3 in foreign currency
  SU_MWST4_BASIS_FW                         Number         Total VAT basis 4 in foreign currency
  SU_MWST5_BASIS_FW                         Number         Total VAT basis 5 in foreign currency
  SU_QM_FAKT                                Number         Total sqm invoiced for the order
  SU_QM_REAL                                Number         Actual total sqm for an order
  SU_LFM_REAL                               Number         Actual total linear meters for an order
  SU_STUECK                                 Number         Total quantity for the document
  SU_EINFACHGLAS                            Number         Number of single annealed sheets (item only)
  SU_ESG                                    Number         Number of toughened sheets (item only)
  SU_VSG                                    Number         Number of laminated sheets (item only)
  SU_ISOEINH                                Number         Total IG per order
  AUSW_GESTELLE                             String         Comma-separated string of own, off-site racks
  FREMD_GESTELLE                            String         Comma-separated string of off-site, external racks
Tab. 11: Printing of forms - footer variables


             BOM variables
  Variable                               Type        Description

  FI_PREIS_ME_SHEET1...FI_PREIS_M        Number      Price per quantity unit for glass 1 + glass 2
  E_SHEET2
  FI_RABATT_SHEET1...FI_RABATT_S         Number      Discounts for glass 1 + glass 2
  HEET2
  MOD_PO_PR_BETR_BRUTTO                  Number      Shape - gross price
  MOD_PO_PR_BETR_BRUTTO_FW               Number      Shape - gross price in foreign currency
  MOD_PO_PR_BETR_NETTO                   Number      Shape - net price
  MOD_PO_PR_BETR_NETTO_FW                Number      Shape - net price in foreign currency
  MOD_PO_PR_NETTO_GES                    Number      Shape - net total
  MOD_PO_PR_NETTO_GES_FW                 Number      Shape - net total in foreign currency
  MOD_PO_PR_PREIS_ME                     Number      Shape price per price unit
  MOD_PO_PR_PREIS_ME_FW                  Number      Shape price per price unit in foreign currency
  MOD_PO_PR_RABATT                       Number      Shape discount
  MOD_PO_PR_EINHEIT                      String      Shape - price unit
                                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL



  MOD_ITEM_MWST1                         Number      BOM Tax 1 share (only if option is set)
  MOD_ITEM_MWST1_FW                      Number      BOM Tax 1 share in foreign currency (only if option is set)
  MOD_ITEM_MWST2                         Number      BOM Tax 2 share (only if option is set)
  MOD_ITEM_MWST2_FW                      Number      BOM Tax 2 share in foreign currency (only if option is set)
  MODELLBEZ                              String      Model name
  MODELLPARAM                            String      Shape parameters (height, width, height 1 etc.)
  MOD_BIT_STRING                         String      1. string with manual amendment flags
  MOD_BIT2_STRING                        String      2. string with manual amendment flags
  MOD_BIT3_STRING                        String      3. string with manual amendment flags
  MOD_PREIS_BIT_STRING                   String      Bit vector for pricing information
  1nd grid
  SP1_PO_PR_BETR_BRUTTO                  Number      Gross Georgian bar price (1nd grid)
  SP1_PO_PR_BETR_BRUTTO_FW               Number      Gross Georgian bar price in foreign currency (1nd grid)


                                                                                                                   136
SP1_PO_PR_BETR_NETTO        Number   Net Georgian bar price (1nd grid)
SP1_PO_PR_BETR_NETTO_FW     Number   Net Georgian bar price in foreign currency (1nd grid)
SP1_PO_PR_NETTO_GES         Number   Total net Georgian bar price (1nd grid)
SP1_PO_PR_NETTO_GES_FW      Number   Total net Georgian bar price in foreign currency (1nd grid)
SP1_PO_PR_PREIS_ME          Number   Georgian bar price per price unit (1nd grid)
SP1_PO_PR_PREIS_ME_FW       Number   Georgian bar price per price unit in foreign currency (1nd grid)
SP1_PO_PR_RABATT            Number   Georgian bar discount (1nd grid)
SP1_PO_PR_EINHEIT           String   Georgian bar price unit (1nd grid)
SP1_ITEM_MWST1              Number   BOM Tax 1 share (only if option is set - 1nd grid)
SP1_ITEM_MWST1_FW           Number   BOM Tax 1 share in foreign currency (only if option is set - 1nd
                                     grid)
SP1_ITEM_MWST2              Number   BOM Tax 2 share (only if option is set - 1nd grid)
SP1_ITEM_MWST2_FW           Number   BOM Tax 2 share in foreign currency (only if option is set - 1nd
                                     grid)
SPRO_SZR1                   Number   Grid in 0=main item, 1=1. AIR, 2=2. AIR (1nd grid)
SPR1_ERFASSUNGSTYP          Number   Input type 0=Standard bar, 1=template bar (1nd grid)
SPR_BER_KZ1(2)              Number   Drill holes: 0=drill point-symm.; 1=field-symm.; 2=drill point-
                                     asymm.; 3=field-assym. (1. grid) ATTENTION: only for vertical
                                     bars, the first parameter is the vertical bar
SPR1_ASSYM_MASSE            String   Horizontal bar: drill point-asymmetrical sizes as string
SPR2_ASSYM_MASSE            String   Vertical bar: drill point-asymmetrical sizes as string
SPR1_ASSYM_MASSE_INCH       String   Horizontal bar: drill point-asymmetrical sizes as string ( in inch )
                                     (1st grid)
SPR2_ASSYM_MASSE_INCH       String   Vertical bar: drill point-asymmetrical sizes as string ( in inch ) (1st
                                     grid)
KZ_SPR_KONSTR1(2)           Number   Georgian bars: 0=Standard; 1=T bar on top; 2=T bar at the bottom
                                     (1. grid) ATTENTION: only for vertical bars, the first parameter is
                                     the vertical bar
SPROANZ1                    Number   No. of horizontal bars (1nd grid)
SPROANZ2                    Number   No. of vertical bars (1nd grid)
SPROBEZ1                    String   Georgian bar name 1 (1nd grid)
SPROBEZ2                    String   Georgian bar name 2 (1nd grid)
SPROFARBE1                  String   Georgian bar color - horizontal (1nd grid)
SPROFARBE2                  String   Georgian bar color - vertical (1nd grid)
SPR_BREITE1                 Number   Georgian bar width - horizontal (1nd grid)
SPR_BREITE_INCH1            String   Georgian bar width in inch, horizontal (1nd grid)
SPR_BREITE2                 Number   Georgian bar width vertical (1nd grid)
SPR_BREITE_INCH2            String   Georgian bar width in inch, vertical (1nd grid)
SPR_DICKE1                  Number   Georgian bar thickness horizontal (1nd grid)
SPR_DICKE_INCH1             String   Georgian bar thickness in inch, horizontal (1nd grid)
                                                                                                               A+W Software GmbH - Configuration A+W Business - INTERNAL



SPR_DICKE2                  Number   Georgian bar thickness vertical (1nd grid)
SPR_DICKE_INCH2             String   Georgian bar thickness in inch, vertical (1nd grid)
SPR_BIT_STRING1             String   1st string with manual amendment flags (1nd grid)
SPR_BIT2_STRING1            String   2nd string with manual amendment flags (1nd grid)
SPR_BIT3_STRING1            String   3st string with manual amendment flags (1nd grid)
SPR_PREIS_BIT_STRING1       String   Bit vector for pricing information (1nd grid)
SPR_BIT_STRING2             String   1st string with manual amendment flags (1nd grid)
SPR_BIT2_STRING2            String   2nd string with manual amendment flags (1nd grid)
SPR_BIT3_STRING2            String   3st string with manual amendment flags (1nd grid)
SPR_PREIS_BIT_STRING2       String   Bit vector for pricing information (1nd grid)
2nd grid
SP11_PO_PR_BETR_BRUTTO      Number   Gross Georgian bar price (2nd grid)
SP11_PO_PR_BETR_BRUTTO_FW   Number   Gross Georgian bar price in foreign currency (2nd grid)


                                                                                                        137
SP11_PO_PR_BETR_NETTO      Number   Net Georgian bar price (2nd grid)
SP11_PO_PR_BETR_NETTO_FW   Number   Net Georgian bar price in foreign currency (2nd grid)
SP11_PO_PR_NETTO_GES       Number   Total net Georgian bar price (2nd grid)
SP11_PO_PR_NETTO_GES_FW    Number   Total net Georgian bar price in foreign currency (2nd grid)
SP11_PO_PR_PREIS_ME        Number   Georgian bar price per price unit (2nd grid)
SP11_PO_PR_PREIS_ME_FW     Number   Georgian bar price per price unit in foreign currency (2nd grid)
SP11_PO_PR_RABATT          Number   Georgian bar discount (2nd grid)
SP11_PO_PR_EINHEIT         String   Georgian bar price unit (2nd grid)
SP11_ITEM_MWST1            Number   BOM Tax 1 share (only if option is set - 2nd grid)
SP11_ITEM_MWST1_FW         Number   BOM Tax 1 share in foreign currency (only if option is set - 2nd
                                    grid)
SP11_ITEM_MWST2            Number   BOM Tax 2 share (only if option is set - 2nd grid)
SP11_ITEM_MWST2_FW         Number   BOM Tax 2 share in foreign currency (only if option is set - 2nd
                                    grid)
SPRO_SZR11                 Number   Grid in 0=main item, 1=1. AIR, 2=2. AIR (2nd grid)
SPR11_ERFASSUNGSTYP        Number   Input type 0=Standard bar, 1=template bar (2nd grid)
SPR_BER_KZ11(22)           Number   Drill holes: 0=drill point-symm.; 1=field-symm.; 2=drill point-
                                    asymm.; 3=field-assym. ATTENTION: only for vertical bars, the first
                                    parameter is the vertical bar
SPR11_ASSYM_MASSE          String   Horizontal bar: drill point-asymmetrical sizes as string (1st grid)
SPR22_ASSYM_MASSE          String   Vertical bar: drill point-asymmetrical sizes as string (2nd grid)
SPR11_ASSYM_MASSE_INCH     String   Horizontal bar: drill point-asymmetrical sizes as string ( in inch )
                                    (2st grid)
SPR22_ASSYM_MASSE_INCH     String   Vertical bar: drill point-asymmetrical sizes as string ( in inch ) (2nd
                                    grid)
KZ_SPR_KONSTR11(22)        Number   Georgian bars: 0=Standard; 1=T bar on top; 2=T bar at the bottom
                                    (2nd grid) ATTENTION: only for vertical bars, the first parameter is
                                    the vertical bar
SPROANZ11                  Number   No. of horizontal bars (2nd grid)
SPROANZ22                  Number   No. of vertical bars (2nd grid)
SPROBEZ11                  String   Georgian bar name 1 (2nd grid)
SPROBEZ22                  String   Georgian bar name 2 (2nd grid)
SPROFARBE11                String   Georgian bar color - horizontal (2nd grid)
SPROFARBE22                String   Georgian bar color - vertical (2nd grid)
SPR_BREITE11               Number   Georgian bar width - horizontal (2nd grid)
SPR_BREITE_INCH11          String   Georgian bar width in inch, horizontal (2nd grid)
SPR_BREITE22               Number   Georgian bar width vertical (2nd grid)
SPR_BREITE_INCH22          String   Georgian bar width in inch, vertical (2nd grid)
SPR_DICKE11                Number   Georgian bar thickness horizontal (2nd grid)
SPR_DICKE_INCH11           String   Georgian bar thickness in inch, horizontal (2nd grid)
                                                                                                              A+W Software GmbH - Configuration A+W Business - INTERNAL



SPR_DICKE22                Number   Georgian bar thickness vertical (2nd grid)
SPR_DICKE_INCH22           String   Georgian bar thickness in inch, vertical (2nd grid)
SPR_BIT_STRING11           String   1st string with manual amendment flags (2nd grid)
SPR_BIT2_STRING11          String   2nd string with manual amendment flags (2nd grid)
SPR_BIT3_STRING11          String   3st string with manual amendment flags (2nd grid)
SPR_PREIS_BIT_STRING11     String   Bit vector for pricing information (2nd grid)
SPR_BIT_STRING22           String   1st string with manual amendment flags (2nd grid)
SPR_BIT2_STRING22          String   2nd string with manual amendment flags (2nd grid)
SPR_BIT3_STRING22          String   3st string with manual amendment flags (2nd grid)
SPR_PREIS_BIT_STRING22     String   Bit vector for pricing information (2nd grid)

SPR_FELDANZAHL             Number   Number of fields
SPRO_PARAM                 String   Georgian bar parameters (see BOM parameter description)


                                                                                                       138
  NOPPEN_KZ                             Number    Georgian bar felts (-1=small bars, 0=no, 1=yes)

  STx_AUTOZUSCHN                        Number    Code 'automatic cutting'
  STx_BEZ                               String    BOM name
  STx_MENGE                             Number    Number of BOM elements
  STx_PARAM                             String    BOM parameter string for product type, width, height, quantity,
                                                  sense of pattern, shape parameters.
  STx_PR_BETR_BRUTTO                    Number    Gross BOM amount
  STx_PR_BETR_BRUTTO_FW                 Number    Gross BOM amount in foreign currency
  STx_PR_BETR_NETTO                     Number    Net BOM amount
  STx_PR_BETR_NETTO_FW                  Number    Net BOM amount in foreign currency
  STx_PR_EINHEIT                        String    BOM price unit
  STx_PR_MEEINHEIT                      String    BOM quantity unit
  STx_PR_MEEINHEIT                      String    BOM quantity unit
  STx_PR_NETTO_GES                      Number    Total net BOM amount
  STx_PR_NETTO_GES_FW                   Number    Total net BOM amount in foreign currency
  STx_PR_PREIS_ME                       Number    BOM price per quantity unit
  STx_PR_PREIS_ME_FW                    Number    BOM price per quantity unit in foreign currency
  STx_PR_PREISDRUCK                     Number    Print BOM price
  STx_PR_RABATT                         Number    Discount on BOM
  STx_EK_NETTO_GES                      Number    Total cost for this BOM
  STx_ITEM_MWST1                        Number    BOM Tax 1 share (only if option is set)
  STx_ITEM_MWST1_FW                     Number    BOM Tax 1 share in foreign currency (only if option is set)
  STx_ITEM_MWST2                        Number    BOM Tax 2 share (only if option is set)
  STx_ITEM_MWST2_FW                     Number    BOM Tax 2 share in foreign currency (only if option is set)
  STxSCHKZ                              Number    Sheet code: 0=no sheet processed;1=1st sheet processed; 2=2nd
                                                  sheet processed; 3=3rd sheet processed.
  GLAS1_BESCH...GLAS2_BESCH             Number    Coating code for both IG sheets: 1=coated
  STxKZ_BESTELLUNG                      Number    BOM purchasing code
  STx_FER_BESCHAFFARTNR                 Number    Supply type number of this BOM
  STx_AGGREGATE                         String    Time management: machines sorted by process sequence (glass
                                                  only)
  STx_BIT_STRING                        String    1. string with manual amendment flags
  STx_BIT2_STRING                       String    2. string with manual amendment flags
  STx_BIT3_STRING                       String    3. string with manual amendment flags
  STx_GEBOGEN                           String    Parameter string for curved glass (structure see tab 'curved glass')

  STx_PREIS_BIT_STRING                   String   Bit vector for pricing information
  SZR1_RUECKSCHNITT                      String   Cutback per edge in airspace 1 (00/00/00/00/-/-/-/-)
                                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL



  SZR1_RUECKSCHNITT_INCH                 String   Cutback per edge in airspace 1 (00/00/00/00/-/-/-/-) in inch
  SZR2_RUECKSCHNITT                      String   Cutback per edge in airspace 2 (00/00/00/00/-/-/-/-)
  SZR2_RUECKSCHNITT_INCH                 String   Cutback per edge in airspace 2 (00/00/00/00/-/-/-/-) in inch
  SPR_SKIZZE                             Object   Georgian bar sketch/pattern
  STx_BOMID                              Number   ID of respective BOM element
  STx_PROD                               Number   Product number of respective BOM element
  STx_BESCHAFFART_BEZ                    String   Procurement type
  STx_PRCL_XXX                           String   Value of product classifier with name XXX
Tab. 12: Printing of forms - BOM variables


          BOM parameters: (STx_PARAM)
  If the product type is not 12 (shape/step)



                                                                                                                  139
  Displacement           Length            Description
  0                      3                 Product type
  3                      15                Width
  18                     15                Height
  33                     5                 Quantity
  38                     1                 Sense of pattern
  39                     10                Sqm invoiced
  49                     10                Lin.m. invoiced
  59                     20                Quantity unit
  79                     3                 Product group
  82                     40                Color
  122                    15                Width Inch
  137                    15                Height Inch
  152                    1                 Coated side
  153                    1                 Pattern side
Tab. 13: Printing of forms - BOM parameters

   Georgian bar parameters SPRO_PARAM

  Displacement           Length              Description
  0                      10                  Lin.m. of Georgian bars for this item
  10                     10                  Price per lin.meter
Tab. 14: Printing of forms - Georgian bar parameters

   If the product type is 12 (shape/step)

  Displacement           Length              Description
  0                      3                   Product type
  3                      80                  Shape/step parameters
Tab. 15: Printing of forms - shape parameters


            Bit vector structure
   POS_BIT_STRING and STx_BIT_STRING
   Position of the bit in the string, starting from the right!
   1. Sales price list
   2. Sales price code
   3. Sales price unit
   4. Sales price per quantity unit
   5. Change of basic product (2x replacement)
   6. Sales discount
                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL



   7. Purchase price list
   8. Purchase price code
   9. Purchase price unit
   10. Purchase price per quantity unit
   11. Purchase discount
   12. Product group
   13. Product group - statistics
   14. Performance
   15. Shape width and height
   16. BOM width and height
   17. BOM quantity
   18. Sales BOM quantity
   19. Purchase BOM quantity


                                                                                     140
  20. Supply type
  21. <internal>
  22. Product name 1 or BOM name
  23. Product name 2 or BOM short name
  24. Product name 3 or processing remarks
  25. Cutback
  26. Commission rate 1
  27. Commission rate 2
  28. Sales price relevant
  29. Purchase price relevant
  30. Spacer text
  31. Weight
Tab. 16: Bit vectors

  ZUSCHLAG_BIT_STRING
  Position of the bit in the string, starting from the right!
  1. Pattern
  2. Edge stripping
  3. Maximum surface
  4. Maximum aspect ratio
  5. Edge protection
  6. free
  7. free
  8. Weight, rounded
  9. Transport
  10. Shipping fee
  11. Express surcharge
  12. Recycling
  13. Special discount 1
  14. Special discount 2
  15. Special discount 3
  16. Special discount 4
  17. Rack 1
  18. Monthly invoice
  19. AIR
  20. Invoicing
  21. Deposit
  22. Special discount 5
  23. Special discount 6
                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL



  24. Special discount 7
  25. Special discount 8
  26. Felt pads
  27. Shortfall
  28. Rack 2
  29. Energy
  30. Special discount 9
  31. Special discount 10
Tab. 17: Surcharge bits

   POS_BIT2_STRING und STx_BIT2_STRING
   Position of the bit in the string, starting from the right!
   1. Thickness



                                                                 141
  2. Minimum quantity
  3. VAT code
  4. Insurance product
  5. Item text 1
  6. Item text 2
  7. Item text 3
  8. Item text 4
  9. Item text 5
  10. Total item price - sales
  11. Total item price - purchasing
  12. Production costs (PCC)
  13. Minimum quantity calculation switched off
  14. Individual price calculation switched off
  15. Miscellaneous surcharges switched off
  16. Stock size recognition switched off
  17. Sales production cost switched off
  18. Purchase production cost switched off
  19. <internal>
  20. <internal>
  21. PCC calculated
  22. <internal>
  23. <internal>
  24. PCC main discounts
  25. <internal>
  26. <internal>
  27. <internal>
  28. Label control
Tab. 18: BIT 2 item and BOM

  POS_BIT3_STRING and STx_BIT3_STRING:
  Position of the bit in the string, starting from the right! Not used at present!
  POS_PREIS_BIT_STRING and STx_PREIS_STRING:
  1. Minimum quantities calculated
  2. Individual price calculated
  3. Miscellaneous surcharge calculated
  4. Stocksize calculated
Tab. 19: BIT 3 item and BO M

Example: use in connection with report builder
                                                                                                 A+W Software GmbH - Configuration A+W Business - INTERNAL




The expression is TRUE if the sales discount and the item thickness were changed:
StrToNumber ( StrMid ( POS_BIT_STRING, 26, 1 ) ) * StrToNumber ( StrMid ( POS_BIT2_STRING, 31,
1))

           Parameters for bent glass (STx_GEBOGEN)
  Displacement        Length          Description
  0                   10.2            Outside chord size
  10                  10.2            Outside sectional height
  20                  10.2            Outside circumference
  30                  10.2            Outside radius
  40                  10.2            Neutral chord size



                                                                                           142
  50                   10.2      Neutral sectional height
  60                   10.2      Neutral circumference
  70                   10.2      Neutral radius
  80                   10.2      Inside chord size
  90                   10.2      Inside sectional height
  100                  10.2      Inside circumference
  110                  10.2      Inside radius
  120                  10.2      Degrees
  130                  10.2      Outside sectional height of biggest sheet
  140                  10.2      Outside chord size of biggest sheet
  150                  10.2      Shape type (0 = inside, 1 = outside)
Tab. 20: Bent glass parameters




3.3. Print dimensioned sketches on forms
Prerequisite is the installation of Shaping & Nesting. The following amendments must be made in
the initialization file SN.INI, section [Picture]:
FontHeight = -10
Height = 261
Width = 261In section [Screen], parameter ModelFrameCorrection must be set to 0
                                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL




A new bitmap field called MOD_LOGO_VSKZ must be entered in the corresponding form. Also, you
have to create the input variable `VERSK_DRUCK`, type `Number`. Size, position and other
properties of the field can be adopted from a standard form (Speedy
G:\\Report\\German\\Auftrag.Qrp). Field `Print dimensioned sketches` has to be tagged in
management of forms. To enlarge the sketch, you need to amend the bitmap field in the report as
well as the settings for width and height in SN.INI to the new requirements.
IMPORTANT! To guarantee a smooth and correct printout, you should install SN version 3.14-02
from directory Install_Speedy\\Versions\\Setup\\Sn3_ALFAK2.4_2.




                                                                                            143
3.4. Printing of production sketches from version 3.3
A file name for a sketch can be entered (per product) in tab 1 in product master data. Also, you can
define on tab “production” whether the sketch shall be printed on the order forms, or as a
dimensioned sketch (special printout: product sketch). (Code: article sketch – print on forms)
In the order forms, the input variable PROD_BMP is filled as an OBJECT (see AUFTRAG.QRP), in the
sketch printing form MODSKIZZE.QRP, the existing OBJECT variable MOD_LOGO_VSKZ is used since
this is a special printout.
Article info (accessible from product management and item entry) defines the path in which ALFAK
shall search for the product sketch. If no workstation-related path is defined, ALFAK will search for
the sketch in path "...ALFAK2000 3.3\Products" by default.
Furthermore, article info provides information on prices and inventory.
Detailed information:\\Hausi\BUG\A+W_Allgemein\Allgemeine_Entwicklungen\Alfak2000
3.3\Spezifikation Produktskizzen.doc




3.5. Print server installation
From ALFAK2000 version 4.1, printing of forms can be transferred from the clients to the server.
Also, you can define print jobs, for example to print delivery note and invoice with the same job.
ALFAK now also supports the mailing of PDF files via the gotomaxx PDF mailer. The print server will
work only if a user has been registered on the server on which it is being run.
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




         Installation of server and client
For sever installation, please make sure to install SQL Base Engine Version 8.5 or higher. On the
server, the print server (abcdruckserver.exe) has to be started by a link in the autostart directory of
the registered user.

         Configuration of the master data
Printing from the server usually requires the definition of print jobs. The appropriate dialog is found
in master data, menu “Forms - Print jobs”. You can define one or more print batches per print job.
When you switch to the new input mode, first enter the name of the print job, then the document
type. After saving the print job, click on the buttons „Add/Delete“ to define the print batches. If an
existing print job is selected prior to a new entry, the print batches involved will be imported as


                                                                                                   144
well. The sequence of the print batches is decisive as the document status is updated after each
print job, and the lock and minimum statuses are checked before printing.
Please note that when you define the print jobs, the printer names must be available on the server.
It is therefore best to enter the print jobs directly on the server as the combobox „Printer“ only
allows to select the printers installed on that computer.

           Sending emails via PDF mailer
Server printout allows to email PDF files using the program „maxx PDFMAILER Professional“ Version
3.0 by gotomaxx GmbH. Standard, Professional, and Promotion. Promotion and Standard will not
recognise control codes and are therefore not suited to our needs.
The Professional version can be found in
\\Jupiter\ALFAK_Software\Utility Programme\PDFMailer\pdfmailer3prode.exe
and can be used for testing.
After installing PDFMAILER, you only need to set the printer name, and activate checkbox „mail“
when you define the print job. In company master data, tab 4 Documents in mail options, you need
to set Email via PDF file.
Then, only a couple of settings need to be checked/adapted in PDFMAILER. For this purpose, start
the PDFMAILER using the Windows start button and program „gotomaxx“. Via menu „Settings -
Edit“, access the settings dialog.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 64: PDF- Mailer properties - Output

The tab should look as shown above.




                                                                                               145
Fig. 65: PDF- Mailer properties - Mailer

Now set the email system in tabMailer, and disable the checkbox Open email client.




           The PDF mailer form
To transfer the mail address, the reference line, and the name of the PDF file from ALFAK2000 to
the PDFMAILER, you need to enter a couple of control sequence in the form header. The form will
be saved in the customer's form path, and will be set when defining the print job.
An example for such a form for printing order confirmations is installed with ALFAK2000 and is
called „AUFTRAG_PDF.QRP“. Variable „MAILHEADER“ controls whether the control codes will be
printed. A description of the control commands is available in the PDFMAILER documentation; also,
the example form is self-explanatory.
Please make sure that the distance between first control line and top margin is at least 0.8 inches.
If not, the PDFMailer will fail to recognise the control line; email despatch will not work correctly.
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




3.6. Form printing in the DMS system (Saperion)
The forwarding of the printout to a DMS system (e.g. Saperion) is controlled by a print driver and
the batch bat\printdms.bat. This send the print order to the DMS system and to a printer driver for
the physical printer. The 3 transfer parameters to the batch are:
    1. PCL output file with path
    2. Output printer driver is forwarded to the print order
    3. Target path for the DMS program
So that an INI file does not have to be created for each user in order to set up the transfer to the
DMS system (e.g. Saperion), the logic was expanded in the INI file.


                                                                                                  146
Entry in the INI file:
[DMS]
PrintDMS=C:\alfak\bat\printdms.bat    ( the batch file must still be specified)
File=C:\temp (if only a path is entered here, then the file alfak_<Loginname>.pcl is generated
automatically)
The printer entry must be removed, then the printer DMS_<Loginname> is addressed. A writing
back of the values to the INI file is no longer undertaken.
Printer=ALFAKDMS_xx




                                                                                                 A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                           147
3.7. Portuguese certification

           Introduction
As from 01.01.2011, regulations in Portugal demand that commercial software which is used for
printing invoices must be certified by the government before using it. This function has been
integrated in ALFAK and is described on the following pages. The user must run the appropriate
scripts on the corresponding database first (20120116a.sql and 20120116aa.sql; language-based
20120116m.sql and 20120117a.sql).

           Company Master Data
Company master data (Master data > Company > Company data > tab 5.Parameter) now allows to
enable the certification for the Portuguese market. This function is licensed and comes with a new
module.




                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 66: Portug. Certi. Company master data settings

The reason for this is the digital signature on invoices and credit notes. Portuguese certification can
only be enabled by the system administrator. If it is active in the company master data, you can use
the Parameter management button to start a dialog in which various parameters can be
maintained. When you open the dialog for the first time, the private and the public key for the
invoice signature will be created during the saving routine.




                                                                                                   148
Fig. 67: Portug. Certi. - Certification code

These will be saved in the system (temporary Windows directory of the current user) and stored in
the database. The certification code - which is assigned by the Portuguese government - must be
entered in a special field. Once saved, these three parameters cannot be changed.

            Invoice printing
To print invoices for the entered orders, go to dialog Form/label printing (Documents > Order >
Print order). Digital signatures can be created there for printing Invoices (orders) and Credit notes.
This is done in the background of the actual printing process. Prerequisite is the installation of the
Freeware tool OpenSSL-Win32 which is installed on the system together with ALFAK. When you
start the printing of invoices/credit notes, the private key will create a hash code with different
parameters like e.g. the invoice number, invoice date, etc. This hash code is the digital signature for
the current document and will be used as a parameter for creating the hash code of the next
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL



document, referring to the order area. The printout incldues the certification code and four digits
of the hash code (1., 11., 21. and 31. digit, separated by “ – “).




                                                                                                   149
Fig. 68: Portug. Certi. – Invoice printing

The document status changes to „Invoice printed“. This means that invoices must not be changed.
This is achieved by enabling the option Lock documents after printing of invoice in company master
data (Master data > Company > Company data > tab 5.Parameter). There, status point „0103 – Print
invoice“ must be defined for locking the document from this status point on.




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                              150
Fig. 69: Portug. Certi. - Document lock

In management of rights (Master data > Company > User rights), a new restriction must be defined
for users who are not entitled to change documents after the invoice has been printed.




                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 70: Portug. Certi. - User rights- User rights



                                                                                             151
This means for example that the right „0002 – Documents – Order - Order“ must be added and the
sub-right „0017 – Change > Print invoice“ must be defined.

            Cancel invoice
If documents need to be changed, users who are entitled to do this, have to set the switch "Invoice
cancelled" in document management. Please note: If the current document is part of a collective
invoice, all documents of this collective invoice will be updated, i.e. all invoices will be cancelled.




Fig. 71: Portug. Certi. - Cancel invoice


                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                   152
           SAFT-PT export
All invoices and credit notes - referring to a certain period - can be exported to a XML file. This file
can be created in the new dialog SAFT-PT Export (Documents > Order > SAFT-PT-Export). The
business year, the start and end date, and the file path must be defined there. The user can also
export archived documents based on the defined business year. The option „Search archives based
on the defined business year“ must be enabled for this purpose.




Fig. 72: Portug. Certi. - SAFT-PT export




                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                    153
3.8. E-mail sending per document type
To reduce costs and effort in transmitting documents, an extension was implemented in Partner
management (e.g. Master data>Market partner>Customer>Customer) to manage 5 further e-mail
addresses per customer and to be able to assign a corresponding document type, e.g. invoices.
Master Data
In the Partner management (e.g. Master data>Market partner>Customer>Customers) the user has
the opportunity to manage an additional five e-mail addresses for a customer per print mode.
On the left next to the data field for the e-mail address, a new button has been implemented, with
which a dialog for managing the e-mail addresses can be opened. Here you can now set up one
further e-mail address for the fixed print modes quotation, order confirmation, delivery note,
invoice, and credit note.




Documents
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




In the order entry (e.g. Documents>Order>Order) the stored e-mail addresses for the customer in
question are taken from the master data. The dialog for management of the new addresses can
also be called from the order entry (via button). Here the user naturally has the option to override
the master data.




                                                                                                154
In the print program, the e-mail addresses per print mode are evaluated and used for the e-mail
sending. In the screen table, the appropriate e-mail address is also displayed.



3.9. ActiveFax connection

For the third-party software ActiveFax, in the form printing (e.g. Documents>Order>Print Job) there
is a connection via the definition of control characters in the file name. For the generation of a
printout, the following control characters are written to the file name:


Document number + ‘ ‘ + customer name + ‘ @F211‘ + fax number + @


For sending by mail, this works the same way but for the fact that the mail address is written into
the file name instead of the fax number.
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Document number + ‘ ‘ + customer name + ‘ @F211‘ + mail address + @




                                                                                               155
3.10. Print service with Crystal Reports

          Installation and configuration

Warning – Breaking Change for the update of the infrastructure!
Effective immediately, the Reporting Service is no longer a component of the infrastructure services! This
has direct consequences for the update of the infrastructure services. For after an update, the Reporting
Service is no longer installed. In the Setup Launcher, the Reporting Service is available as a separate
installation package and it must be selected there if necessary. So that future AutoUpdate work correctly,
the diskset thus changed should, of course, also be saved.




The positive side effect is that several servers can be installed with the Reporting Service. The configuration
of the Reporting Service is also done in a separate ConfigTool, which was adjusted appropriately for the
                                                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL



configuration on different machines. The multisite configuration must be done separately on each installed
machine with the ConfigTool.


Warning – Breaking Change in section Customizing!
To adapt the existing customizing forms is important when changing to the new function. This applies not
only forms that are printed with Crystal reports, but also existing forms, that are printed with the old Gupta
Report Builder Engine. If existing forms contain customizing formulas and you activate the option "Form
printing via Crystal reports", the customizings have to be adapted! Below, you will find a description of
the adaptations to be made 3.10.6.
Software Installation
The following steps are required for the start-up of the print service with Crystal Reports:


                                                                                                            156
        1.   Installation of the infrastructure services
        2.   Installation of the Reporting Services infrastructure
        3.   Installation of A+W Business basis
        4.   Installation of SAP Crystal Report Runtime Engine
Thus the print service can always only be operated on the computer on which the infrastructure is
also installed.
On the terminals, the installation of the infrastructure middleware is required, which is already pre-
selected during the installation of A+W Business. A license for activation is not necessary, but the
customer must have a company runtime license of SAP Crystal report, this is compulsory to check.
Printer Installation
So that the print service can send its output to a printer, the required printers must be installed for
the user account under which the infrastructure services are running. You can find the user account
by starting the service administration ("services.msc") and searching for the "A+W Infrastructure 6"
service. There, in the "Log On As" column, you can find the user account used. After that, you use
this account to log into the system and install the required printer. However, with the print service,
it is not possible to print to a PDF or with an XPS printer driver. The reason for this is dialogs that
open in the respective driver, which would block the print service. Thus, only printers that physically
exist are available for the output.
A+W Business Activation
Next, in the company master data on the tab "12.Print" the "Form printing via Crystal Reports"
checkbox is enabled. Furthermore, the path for the forms must be reachable for the print service.
Enter it for all Crystal Reports in field Path. The path for the primary search for forms/reports
(Gupta) only serves for printing Gupta forms. Since the report service also supports the sending of
faxes and mails via third-party software, the fax and mail printers can be entered. Mail sending via
third-party software is not preferred, SMTP mail sending is now completely supported and offers
additional features.




                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




All reports are located in A+W Business installation sub-folder …\Reports\Crystal. This also serves
as default, if nothing is specified in the company master data.
Infrastructure Configuration
The configuration of the reporting service is done under A+W Infrastructure 6 Web > Configuration
> Reporting settings.


                                                                                                   157
In the menu element Report settings, the following settings must be made:


Available printer
So that the reporting service is informed on which printer(s) printing is possible, the printers must
be selected here and saved. As soon as a printout should be done in A+W Business, these printers
are suggested as selection possibilities. At least one printer must always be entered here!




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 158
Print Job Retention [in days]
This value determines how long the print orders are retained in the database and the user can view
them or start a repeated printing via PDF view.




Mail server connection
The connection data for the mail sending is set if no third-party software should be used that makes
available a printer driver. See A+W Business activation:




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




Server name
                   Name of the mail server that can be addressed via SMTP.
Port
                   Number of the server port (default is 25).



                                                                                                159
Sender address
                    Mail address of the sender of the mail.
CC
                    The printout is also sent to this mail address.
BCC
                    The printout is also sent to this mail address without the recipient being able to
                    see this.
Use authentication
                    Must be activated if the mail server requires a user log-in
User
                    User name for the log-in
Password
                    Password for the log-in
Use SSL encryption
                    The mail server uses SSL encryption


Form management
A form must now be created in the A+W Business form management. Decisive for the printout on
the print service is always the file extension of the report used. For Crystal Reports, this is *.RPT. As
soon as the form printing uses such a report, the print job is sent to the print service.
In the form management, in addition to the Crystal Report file name, a print service report must be
assigned; it is the link between A+W Business and the print service. The print tables for the print
service are generated with the report and the assigned report group. If, for example, you use the
report "2" with the report group "1", then the tables with the prefix "R0001_..." are generated by
the print service. The Crystal Report must also be created for these tables. If you forget this step or
the report group does not fit the report used, when printing the error message appears that the
database tables for the report could not be found and the print receives an error status.

                                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                     160
The language determines the print tables to be filled by print service.
Table name: R<Report group><Language>_<localized table name>
Example: R0001enUS_OrderHeader
It can be decided for each form whether the outputs of the form are handed over to the iQuote
customer information system and thus the PDF printout is available for the customer. In iQuote,
only the last printout per print identification (OC no., invoice no.) is saved.
The standard Crystal Reports are in the Report\Crystal directory after installation. The report name
is structured as follows. It is recommended that you retain the naming principle so that a grouping
and assignment is achieved.
R<Report group><Language>_<Reportname>.rpt
<Report group>                The report table structure depends on this
<Language>                    Language of the report and the assigned print tables
<Reportname>            Name of the report, can be selected at will, which makes sense
Example: R0001enGB_OrderConfirmation.rpt, R0001deDR_OrderConfirmation.rpt, …




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                161
Mail sending configuration
The default sender address for the SMTP mail sending of documents can be defined in the
infrastructure configuration.




Now, you can enter a different sender per form (order confirmation, purchase order, invoice, ...),
in the form management of A+W Business. Thus it is possible to handle a different responsibility
(department) for certain documents.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




For mail sending, a system text must be entered in the form for the reference and the mail-text
The previous solution via text file is not supported anymore. The texts can be defined in the
system texts.




                                                                                                  162
In the mail reference a text replacement is possible with all fields of the document header table.
Please note, that the language of the form determines the reference table column R0001enUS or
R0001deDE.




The fields to be replaced must be limited in <column name>. This character sequence must not exist
in reference.




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




The language of the system text reflects the customer language in the document or the default
language of the form.
If several orders or invoices exist in one mail, several numbers are written one after another. This
also applies to all other replacement fields.




                                                                                                163
The mail text can be plain text or HTML, thus, a professional mail layout with graphics is possible.
The graphic has to be added as link, since embedded images are not displayed by most mail clients.
The HTML text must start with <html or <doctype.




This text can be defined in customer language, too.
As example you will find in the installation folder + \Reports\Crystal the files
AWBodySample_xx.htm that can be used as template for a mail text.




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                164
165
A+W Software GmbH - Configuration A+W Business - INTERNAL
Print jobs tool window
The following figure shows the detailed flow of the communication between the client (A+W
Business) and the print service. Therefore, close all open windows and select button "Print jobs" via
menu item "View". Now the dialog can be docked on the main window and always opens when
A+W Business starts.




In the tool window, click the right mouse key on a print job to display the selected print job again
or to delete it. All messages of the print service to a print job are displayed, here. The print service
reports informs the user of the current print status here.




The following status values are displayed:
005 – New
             The print order was just generated anew.
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




010 – In queue
             The print order is now in the queue and is checked cyclically. If there is a document
             lock, this is noted in the remark.
020 – Printing
             The print order is currently being processed; it is now being pre-processed, the print
             tables are being filled and then the printing and post-processing begin.
030 – Pre-processing complete
             The documents are locked and invoice numbers are assigned, the collective invoice
             amounts corrected.


                                                                                                    166
040 – Transfer data
             The print tables were filled with the data.
045 – Reprinting
             The printout is repeated without data-changing actions; only the Crystal Report is
             executed again. The result is also saved in.
050 – Printout created
             The printout was created and goes to the print spooler.
060 – Printout successfully done
             The documents were unlocked again and the print job is completed.
070 – Failed to print
             During processing, there was a severe error that caused the caused the cancellation of
             the print job. The reason is specified in the remark. This cannot be a report file that
             does not exist, for example.
Thus all required steps have been performed for the start-up.


Form printing window
In the A+W Business form printing, now you just select the appropriate Crystal Reports print service
and start the printing. The print program now contacts the print service and queries all installed
printers that are displayed on the following selection dialog and can be selected.




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




Only printers that physically exist are available. If a form that is not set in Crystal Reports is
selected, then the printout runs via the existing Gupta print engine. Thus a step-by-step
introduction of the new print engine is possible and all reports do not have to be converted at the
same time.

System text for grille structure
So that the output of the muntin structure can be adjusted to the customer's requirements, a
system text with placeholders for the number of horizontal and vertical muntins as well as the

                                                                                                 167
space between the sheets is present for the installation of the respective grille. The system text
has the number 2100 and the variables %X1 (number of horizontal muntins), %X2 (number of
vertical muntins) and %X3 (number of the space between the sheets) serve as placeholders.
Example for system text 2100: „H: %X1, V: %X2 in AIR %X3“




                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                     168
         Creation of the Crystal Reports

For the creation of the report with Crystal Reports, it is advantageous to use an already-existing
report as template; otherwise, the effort required for creation is much greater. Therefore, the
creation will be described from the point of view of the Crystal Report plug-in for Visual Studio.


Setting the data source location

If an existing report for change is loaded, then first the data source location must be assigned
correctly since otherwise the tables cannot be selected and the preview will not work. A right-click
on the database opens the context menu; "Set data source location" must be selected here




On the following dialog, an existing data source must be selected or a new connection created.
Here, an OLE DB (ADO) source with SQLServer Native Client 11/10 must be selected.
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                169
If now this is confirmed with Next, then finally the current data source and the one to be replaced
must be selected (this must absolutely be selected again) and then confirmed with update.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




The new data source is then displayed as current data source. Now the report can be changed and
the preview selected.


Display Field Explorer

                                                                                               170
Next, the display of the Field Explorer must be activated. To do this, display the Tool window on
the menu "Crystal Reports > Field Explorer."




Report Preview
Prerequisite for the preview view of the report is an existing database connection in which the
assigned tables are present. Print data should be entered in these tables so that the report can
make a data selection. In no case may the "Save data in the report" checkbox be activated. This
preview makes the report adjustment very easy since a check of the results can be made
immediately without print service.




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




Page Settings
In any case, you must pay attention in the "Crystal Report > Design > Page Setup" to remove the
checkmark for the option "No printer (optimize for screen display)." Otherwise, the printer can no
longer be changed by the reporting service. The consequence of this is that the printout gets hung
up and reports can only be sent to the default printer.

                                                                                               171
Assigning and linking database tables

Next, the database tables must be assigned to the report "Crystal Report > Database > Database
Expert." Here, a table for the corresponding report group and language can be assigned to the
report tables. A table alias can be set with F2; this makes the name easier to handle.




The table links are created on the "Links" tab. The data structures of the print tables are
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




structured so that the links are found automatically via the foreign key properties. However, this
only happens as long as the relationship is unambiguous. If, e.g., there are references from the
items and BOMs to the product color, then the product color table must be inserted 2 times,
different aliases assigned, and the linking undertaken by hand.




                                                                                                172
Updating and implementing existing table assignments
In order to determine to which table the access applies. The table must be selected in the Field
Explorer and the "Set Data Source Location" element called up with a right-click. There, under
properties, the origin can be determined.




                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




On the same dialog, the structure can be updated and the table set to a different report group.
This is important if the report should be converted from an order to a quotation, for example, and
thus the report group must be changed.

Inserting report table fields
New report fields are inserted via the Field Explorer > Database fields. All fields are present in
localized form (currently German + English).




                                                                                                     173
Report Parameters
Access to the print data is made via the PrintId parameter; therefore, each report must have this
parameter field.




Caution: for subreports, there are additional requirements here; these will be described in the
Subreports chapter 0.


                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Report section
The individual report sections will be described below and their special features explained.

Section 1 (Report Header)


                                                                                                  174
This is sent only once per print job and thus affects several documents. For us, this area is actually
of no use, so it is therefore empty.

PageHeaderSection 3 (Page Header a)
This is the page header and is used to print the fold mark.




Important here is that this section is put under the page. This is set in the Expert section.




PageHeaderSection 2 (Page Header b)
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




This is the page header and prints the customer logo. This section is output on each page.

PageHeaderSection 2 (Page Header c)
This section is only printed on following pages on which the document header (address) is not
repeated. The section must thus be suppressed on the first page. This is done with a suppression
formula whose result must be TRUE to suppress.




                                                                                                   175
PageNumber = 1 is the suppression condition here; the function WhilePrintingRecords controls
the point in time at which the formula is executed. In this example, only during printing since it is
only then that the page number is known. Additional functions are: BeforeReadingRecords,
WhileReadingRecords.

The function of the page number is connected to the GroupFooter5 (Group Footer 2
Header.OrderId) section, for this is where the page number is reset.

The function @PageOfDocument is a function that outputs the text:
"Page 1 of order 4711 for Glas Müller, Pohlheim." This formula can be edited and adjusted.



                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




GroupHeaderSection1 (GroupHeader 1 Header.SortId)
This section is only needed for the grouping and sorting. It enables the grouping and sorting by
sequence in the number manager, the document number, the item and the BOMs.




                                                                                                   176
This also includes the OrderId and the LineItemNumber, as well as the BillOfMaterialId; together
they define the sorting of all elements.




GroupHeaderSection5 (GroupHeader 2a Header.OrderId)
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL



This section prints the entire document header with address and all header properties such as
document number, delivery date, etc.
It always appears if the underlying group document number changes.




                                                                                                177
GroupHeaderSection6 (GroupHeader 2b Header.OrderId)
This section prints the header texts; it is suppressed if the header texts are empty.




For this, the property must be set in the Expert section.

GroupHeaderSection6 (GroupHeader 2c Header.OrderId)
This section prints the column headers on the first page. The following pages of a document
(since there is no group change to the OrderId) are undertaken with the already-described section
"PageHeaderSection 2 (Page Header c)"; it is suppressed on the first page.

GroupHeaderSection2 (GroupHeader 3 LineItems.LineItemNumber)
Printout of the product description by the @ProductDescription function. This function includes
the logic for suppressing the product designation 2 and 3 if they are empty or print them on a new
line.
The product header repetition in case of structure change is controlled via the suppress function.




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               178
This evaluates the variable LineItems.GroupChange; as long as it is 0, the item header will not be
printed.

Section 3 (Detail a)
The BOM element to be printed is output. The Crystal Reports are structured so that the BOM is
the Detail section; this makes it superfluous to limit the number of BOM elements and the fields
only appear once in the report.

Section 3 (Detail b)
The shape parameters are output here. This section is suppressed if the item in question is not a
shape.




GroupFooterSection2 (Group Footer 3 LineItem.LineItemNumber)
This is the actual item line; the item number, measurement, and item price are output here. It is
not suppressed.

GroupFooterSection5 (Group Footer 2 Header.OrderId)
The output of the total lines is done in this section.
The particularity of this section is that the page number is reset



                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                179
and that this section should be printed at the end of the page.




If this is desired, all subsequent sections must be suppressed if they are empty. This can be done
on the context menu with a click on Suppress (screen shot shows the results)




PageFooterSection 1 (Page Footer)
The output of the page footer is done here. No other options.
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                180
         Creation of Subreports

The subreport technology allows the definition of a master report; it consists of additional
subreports. These may not be nested. The subreports are then executed within the GroupSection
Header.OrderId and allow the output of the document and then the output of all shape and grille
sketches for the document.




Inserting an existing report
An existing report can be imported into this master report.




                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




Here, on the Links tab, the transfer of the selection parameters must be made. These are now the
PrintId and the OrderId since the subreport is printed in the context of the order. Initially,
however, only the PrintId can be linked since the OrderId is only created subsequently as a
parameter.




                                                                                             181
Select the PrintId on the left, move to the right, and now select "?PrintId" as parameter field link.

Now change to the subreport and enter a new parameter field "OrderID"




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL



Now go into the Select Expert Record




and define the new parameter OrderId




                                                                                                   182
Now the parameter for the data record selection must be made known.




In the main report, the 2nd parameter can now be linked.


                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                      183
Thus the subreport is attached to the main report and the parameters PrintId and OrderrId are
transferred.

Conversion of the Subreport
The page header is omitted in the subreport, and page footer, for it comes from the main report.
During the import, Crystal Reports has converted these areas to ReportHeader and ReportFooter.
First these must be deleted




and the section pushed together.




In the ReportFooter, the bitmap must be deleted and the section suppressed, for it is the last one
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




after the GroupFooter Section3!

Since there is no more page header avaialble, we must artificially create a page header section.
For this, first a formula ShowPageHeader is created.




                                                                                                   184
The formula must be inserted into the Group Assistant as group change between OrderId and
LineItemNumber.




If the group is inserted, in the group options, the "Repeat group header on each new page"
checkbox must be set.




                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




Now the item header line can be shifted to the new GroupHeader and the old GroupHeader can
be pushed together.




                                                                                             185
Thus the item header now appears on each page. The subreport is now adjusted.

The subreports for the shapes and grilles can also be inserted this way and then in the section
assistant, the Suppress empty section option must be activated for both sections, for not every
document includes shapes and grilles and we don't want to create any empty areas.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  186
            Special action report fields
With this, we understand all fields that are used in the report, but are not this way in the database.
For them, there must be a code-based reformulation/calculation.

 Special Action English / German                  Description

 Spacer1Thickness / Abstandhalter1Dicke           Thickness of the first spacer (Metric)

 Spacer1ThicknessInch / Abstandhalter1DickeInch   Thickness of the first spacer (Imperial)

 Spacer2Thickness / Abstandhalter2Dicke           Thickness of the second spacer (Metric)

 Spacer2ThicknessInch / Abstandhalter2DickeInch   Thickness of the second spacer (Imperial)

 ShapeParameters / ModellParameter                According to shape parameters (Metric/Imperial)

 WidthInch / BreiteInch                           Width (Imperial)

 WidthMillimeter / BreiteMillimeter               Width (millimeters) on inch database

 HeightInch / HoeheInch                           Height (Imperial)

 HeightMillimeter / HoeheMillimeter               Height (millimeter) on inch database

 ExtendedProductDescription1 /                    Product description 1 (localized/multilingual/description
 ErweiterteProduktbezeichnung1                    replacement)

 ExtendedProductDescription2 /                    Product description 2 (localized/multilingual/description
 ErweiterteProduktbezeichnung2                    replacement)

 ExtendedProductDescription3 /                    Product description 3 (localized/multilingual/description
 ErweiterteProduktbezeichnung3                    replacement)

 DocumentBarcode / Auftragsbarcode                Barcode ( O… )

 ShapeSketch / Modellskizze                       CAD Designer Shapes – sketch according to the form settings

 GrillSketch / Sprossenskizze                     CAD Designer Bars – sketch according to the form settings

 TotalGrossInWords / BruttobetragInWorten         Gross amount in words

 TextBeforeItem / TextVorPosition                 RTF text in front of the item
                                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




 TextBehindItem / TextNachPosition                RTF text after the item

 TextProductRelated / TextProduktbezogen          RTF text product-related

 HeaderTextRtf / KopftextRtf                      RTF text document header-related

 ProductInfo / ProduktInformationen               Product information (localized/multilingual)

 TotalPricePerUnit / PreisProPreiseinheitGesamt   Price per price unit of the entire unit

 TotalPricePerUnitForeignCurrency /               Foreign currency price per price unit of the entire unit
 PreisProPreiseinheitGesamtFremdwährung

 CostPerUnit / KostenProEinheit                   Cost price per price unit of the entire unit



                                                                                                              187
NetPricePerUnit / NettoPreisProEinheit             Net price per price unit of the entire unit

NetPricePerUnitForeignCurrency /                   Net foreign currency price per price unit of the entire unit
NettoPreisProEinheitFremdwährung

AssemblyThicknessInch / DickeInch                  Total thickness of the unit (Imperial)

AssemblyThicknessMillimeter / DickeMillimeter      Total thickness of the unit

GroupChange / Gruppenwechsel                       Group change flag for the product description (header
                                                   repetition)

LabelMode / EtikettenModus                         Label mode (document, item, unit)

Formfeed / Seitenwechsel                           Form feed must be executed

CollectivePrintoutFlag / SammeldruckKennzeichen    Collective printout identifier

CashDiscountDate1..3 / SkontoDatum1..3             Cash discount date 1 to 3

CashDiscountDays1..3 / SkontoTage1..3              Cash discount days 1 to 3

CashDiscountRate1..3 / SkontoSatz1..3              Cash discount rate 1 to 3

DepositGrossItem / AnzahlungBruttoPosition         Gross deposit amount for the item

DepositGrossItemForeign /                          Gross deposit amount for the item in foreign currency
AnzahlungBruttoPositionFW

DepositGrossTotal / AnzahlungBruttoGesamt          Gross deposit amount total

DepositGrossTotalForeign /                         Gross deposit amount total in foreign currency
AnzahlungBruttoGesamtFW

DepositHeader / AnzahlungsKopf                     Identifier for deposit header

DepositItem / AnzahlungsPosition                   Identifier for deposit item

DepositNetItem / AnzahlungNettoPosition            Net deposit for the item

DepositNetItemForeign / AnzahlungNettoPositionFW   Net deposit amount for the item in foreign currency

DepositNetTotal / AnzahlungNettoGesamt             Net deposit amount total
                                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




DepositNetTotalForeign / AnzahlungNettoGesamtFW    Net deposit amount total in foreign currency

DepositVATItem / AnzahlungMwstPosition             VAT amount of the deposit for the item

DepositVATItemForeign / AnzahlungMwstPositionFW    VAT amount for the deposit for the item in foreign currency

DepositVATTotal / AnzahlungMwstGesamt              VAT amount for deposit total

DepositVATTotalFW / AnzahlungMwstGesamtFW          VAT amount for the deposit total in foreign currency

LineItemBarcode / PositionsBarcode                 Barcode of the item ( T2… or D5…. )

ProcessingText / Bearbeitungstext                  The processing text for a processing




                                                                                                              188
ProductionBarcode / ProduktionsBarcode       Production barcode ( C…. )

FormText1..10 / FormularText1..10            Texts 1 to 10 from the form

GlassDescription / Glasbezeichnung           Complete glass description incl. structure and coating

GrillParameters / Sprossenparameter          Grill parameters from system text 2100 (e.g. W: %X1 S: %X2 on
                                             SZR %X3)

                                             %X1 = Number of horizontal grills
                                             %X2 = Number of vertical grills
                                             %X3 = Number of spacers in the grill

GrossDays / BruttoTage                       Gross days

LanguageCode / Sprachkennzeichen             Language code from document or form

ProductVariant / ProduktVariante             Product variant (item and BOM)

PurchaseOrderReference / BestellReferenzen   PO references (XML) example:

                                             <References>
                                              <Reference>
                                               <REF_ID>51696</REF_ID>
                                               <REF_POS>2</REF_POS>
                                               <AB_LIEFERANT />
                                               <AB_DATUM>18.05.1999</AB_DATUM>
                                               <AH_MCODE>DORMA</AH_MCODE>
                                               <OR_TOUR>RHEINLAND-PFALZ</OR_TOUR>
                                               <GEL_MENGE>0</GEL_MENGE>
                                               <AB_LIEFERANT_DAT> - 18.05.1999 /
                                             </AB_LIEFERANT_DAT>
                                              </Reference>
                                             </References>
RackInfo / GestellInfo                       RAck information (XML) example:

                                             <RackInfo>
                                              <Rack>
                                               <NUMBER>99</NUMBER>
                                               <TYPE>Glasbock</TYPE>
                                              </Rack>
                                                                                                             A+W Software GmbH - Configuration A+W Business - INTERNAL




                                             </RackInfo>
ReportParameter / ReportParameter            Print string for DMS archiving

RouteNumber / TourNummer                     Route Number

SteppingParameter / StufenParameter          Stepping parameter derived from system text No. 2Example:
                                             Lite (2) bottom:10 right:20 top:30 left:40 (940 x 960 )




                                                                                                       189
ZuschlagsBit / SurchargeBit   Surcharge bit in string format

                              Position of the bit within the string starting from the right:

                              1. Structure inside
                              2. Edge stripping
                              3. Maximum area
                              4. Maximum aspect ratio
                              5. Edge protection
                              6. free
                              7. free
                              8. Weight rounded
                              9. Transport
                              10. Delivery flat fee
                              11. Rush surcharge
                              12. Recycling
                              13. Special discount 1
                              14. Special discount 2
                              15. Special discount 3
                              16. Special discount 4
                              17. Rack 1
                              18. Monthly invoice
                              19. SZR
                              20. Invoicing
                              21. Deposit
                              22. Special discount 5
                              23. Special discount 6
                              24. Special discount 7
                              25. Special discount 8
                              26. Muntin pads
                              27. Minimum quantities
                              28. Rack 2
                              29. Energy
                                                                                                A+W Software GmbH - Configuration A+W Business - INTERNAL



                              30. Special discount 9
                              31. Special discount 10




                                                                                          190
         Architecture of the Print Service

The following figure shows the detailed flow of the communication between the client (A+W
Business) and the print service. This is always done asynchronously. Thus the client is free for other
tasks immediately after sending the print job and the user can continue with document entry, for
example.




                                            Start of print out                     XML Parameter
       Report Stream
                                                                                   Report ID
                                                                                   Number Manager Name
                                                                                   Document No.
       Status Messages                                                             Printout Type
                                                                                   Printer Name
                                             .Net COM-Proxy


     Client A+W Business




     Print-Service Spooler
     (.Net)

                                               Spooler
                                                (.Net)                                   AWSOA

                                                                                         Core Job




             per Print Job one Engine



     Print-Service Engine
                                                   Pre       Fill up of     Post
     (.Net)
                                                  Run      PrinttTables     Run
                                                                                                                A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                   Gupta COM Object
      Report Stream                                                                               AWB

                                                                                              Report Print
                                                          Crystal Reports                       Tables
                                                                 (.Net)                           Rxxxx




                                                                                                          191
           Adaptations of existing customizing formulas
After activating the option "Form printing via Crystal reports" in the company master data, the
system works with a completely new and reworked dialog for printing of forms. This was necessary
in order to transfer the available printer function (previously commented out in the dialog) into a
functional category. Only in a functional category it is possible to make this function available as
COM object for a SOA service.
This results in re-naming of different variables, usually used in form customizing. Generally, all
variables start with the prefix „m_“. Previously used variables have no or „w_“ prefix, All
customizing forms have to be checked and error messages that occur based on missing variables
have to be corrected with the correct name.


  Previous syntax                                New syntax

  hWndReport                                     m_hWndReport

  w_fktDoc                                       m_fktDoc

  w_nRepPosZaehler                               m_nRepPosZaehler

  w_nRepStklZaehler                              m_nRepStklZaehler



Example:
PREVIOUS:
SalReportSetStringVar(hWndReport, 'UDV_PP_MENGE', 'Amount: ' ||
SalNumberToStrX(w_fktDoc.m_Pos[w_nRepPosZaehler].m_nPP_MENGE, 0));
NEW:
SalReportSetStringVar(m_hWndReport, 'UDV_PP_MENGE', 'Amount: ' ||
SalNumberToStrX(m_fktDoc.m_Pos[m_nRepPosZaehler].m_nPP_MENGE, 0));




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                192
           Customizing in the reporting service with Crystal Reports
Generally, customizing functions that were previously used for a Gupta Report form can no longer
be used in the environment of the new reporting services. These must be created from scratch. This
will be described below using two examples.
The first example describes the manipulation of an existing column of the order header and the
second example shows how you add more (user-defined) data to the order header, fill it with your
own data, and make it available on the form. The files with the formulas used for the following
examples are in the subdirectory ".\Formula\“ of A+W Business after installation. Below this folder,
there is another folder, ".\Formula\ Crystal Reports Formulas\“ that contains the formulas
required for the Crystal Report.


Example 1: manipulation of an existing column in the document header
In this example, the customizing formula "Reporting_ChangeCommission.txt“ is used. First, a new
formula must be created in A+W Business and the content of the file copied into it. In the form
management, on tab 7.Customizing, enter this formula as formula for the detail area. Starting from
that moment, the formula will always be executed as soon as a data record is created for the
reporting.




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




Formula management: creation of the new formula




                                                                                                193
Form management: assignment of the formula to a form

The formula just generated changes the item consignment for particular item numbers. In Crystal
Report, only the consignment must be output in order to be able to see the changes.


Example 2: display of new, user-defined values in Crystal Report
There is frequently a request to output new values that do not exist on the Crystal Reports form. In
this example, these are two values that should be transferred from the company master data to
the order headers. This is the value of the FinAc foreign key (KA_FIRMA.FIBU_KONTO) and the
booking group (KA_FIRMA.BU_KREIS). For this, first the customizing formula from the file
"Reporting_UserDefinedDataXML.txt" is generated and assigned to a form, analogous to the
previous example.
This formula selects the two fields from the company table and inserts them into the VAR_DATA
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL



column of the order header. This column is an XML column and must be assigned the data in the
following format:
<Variables>
 <BU_KREIS>Booking Range</BU_KREIS>
 <FIBU_KONTO>Finac Key</FIBU_KONTO>
</Variables>
The surrounding tag is always called "Variables" and all other tags can be named at will. The values
of the variables are assigned to the day in question, as you can see above. With each form printing,
now the VAR_DATA column for the order header table is filled and transferred to Crystal Reports in
the "R0001enUS_OrderHeader.UserDefinedData" column. From there, the values must be picked
up with form.



                                                                                                194
Since the values are present in a single column as XML, two additional formulas are required in
Crystal Reports in order to be able to output the content in separate fields. Both formulas only
distinguish themselves through the naming of the variables in XML. In the Crystal Reports Designer,
the formulas are created with the content of the files "CR_UserDefinedDataXML_BU_KREIS.txt“
and "CR_UserDefinedDataXML_FIBU_KONTO.txt“. The output of the formulas can then be done
in the desired place on the form. The formulas have an initialization block that can be adjusted very
easily to the individual needs.


Example 3: exclusion of documents not to be printed
If a document should be excluded from printing via customizing, then previously this was done with
the "Load form" formula; the printout ran interactively on the dialog. In principle, this still works by
setting the variable w_bSuppressPrintout = TRUE, but the print job is first dismissed and the status
increase is also done. To do this better, a screen customizing should be incorporated, which sets
the variable w_fktDruck.m_Row[nldx].m_nMode = PM_NOPRINT. Thus, the message comes that
the document will not be printed and the rows are marked.
The following variables are important:
w_fktDruck.m_nID[*]     ! Document number for finding via VisArrayFindNumber ()
w_fktDruck.m_nCountRows ! Number of documents (rows) in the container array


           Form printing via workflow formula
Form printing itself can also be started via a udf function, e.g. from a workflow formula. There is a
separate chapter for this - 10.26_Formulardruck über den Reporting Service.

           Function reference
For the customizing of the Crystal Reports forms, some functions were created in order to simplify
the handling withint the customizing functions and to be able to use them sensibly.


bReturn = udf_GetTable ( sTable )
Provides the name of the table that is currently being accessed.
Parameter:
  sTable                       Receive String: Name of the current table.
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




bReturn = udf_GetValueString ( sColumnName, sValue )
Provides the string value of the named column from the table that is currently being accessed.
Parameter:
  sColumnName                  String: Name of the column for which the value should be determined.
  sValue                       Receive String: The determined value of the column.


bReturn = udf_GetValueNum ( sColumnName, nValue )
Provides the number value of the named column from the table that is currently being accessed.
Parameter:


                                                                                                    195
  sColumnName                  String: Name of the column for which the value should be determined.
  nValue                       Receive Number: The determined value of the column.


bReturn = udf_GetValueDateTime ( sColumnName, dtValue )
Provides the date/time value of the named column from the table that is currently being accessed.
Parameter:
  sColumnName                  String: Name of the column for which the value should be determined.
  dtValue                      Receive Date/Time: The determined value of the column.


bReturn = udf_SetValueString ( sColumnName, sValue )
Sets the string value of the named column from the table that is currently being accessed.
Parameter:
  sColumnName                  String: Name of the column for which the value should be set.
  sValue                       String: The new value that should be set in the column.

                 FAQ

Question:
How to call installed printers per PowerShell on the system?
Answer:
Start the PowerShell and execute the following statement
     Get-WmiObject -Class Win32_Printer | Select-Object -Property Name, DriverName,
      Portname, SystemName, Comment, PrintProcessor, Shared, ShareName


Question:
How can you tell whether the printer is a physical printer or just a virtual printer such as PDFMailer,
XPS printer or eDocPrinter?
Answer:
You use the query above and execute it in the PowerShell. The virtual printers have the value
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL



"winprint" in the property "PrintProcessor."


Question:
No printer is displayed and it is not possible to start printing.
Answer:
There can be several causes for this. Either the infrastructure services are not running or they are
not available. It must be checked whether the services are executed. You can see in the Service
Locator Administrator that is installed in the group A+W/Config Tools. Furthermore, it must be
checked whether the firewall is set correctly. Finally, on the client PC, the address of the computer
on which the services are executed must be checked. The setting is here:


                                                                                                   196
HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Albat+Wirsam\Communication\IceHost




                                                                               A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                         197
Question:
The background color of bitmaps such as the SN sketches are not displayed in a correct white, but
instead, they have a slight gray color. This doesn't look good on the printout, what can I do?
Answer:
A setting in the report is responsible for this. This can be found under "Report > Report Options >
Keep color depth of the original image." If this is switched on, the background is white and no longer
light gray. (see screen shot below)




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  198
Question:
How to get fields in my report, that are included in a new version of the reporting service?
Answer:
First update the data structure in the dynamic print tables. This happens automatically when you
save the respective form in the form management or when you print the respective form once.
Then, the reporting service updates the dynamic print tables (e.g. R0001deDE_Auftragskopf).
Now, update the report so that the new fields are available. Load the report in Crystal report
designer and right-click on "Database Fields". Choose "Set datasource location..." from the popup
menu. In the dialog select in the upper section the table to be updated and in the lower section the
table with the current fields. Click on the button Update and proceed with further updated tables.
After that, close the dialog. The new fields are available below the table and can be placed as usual.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




Question:
In the report with sub-reports, blank pages always appear at the end. How can these be
suppressed?



                                                                                                  199
Answer:
In the reports "R0001enDE_OrderConfirmationShapes.rpt" and
"R0001enUS_OrderConfirmationShapes.rpt" sub reports are used to print the shape and muntin
sketches behind each order. If there are no muntins or shapes in the order, a blank page always
appears at the end of the report.
Therefore, it is necessary to enter a formula in the detail area of the sub-report that displays the
specific position details (here R0001xxXX_OrderConfirmation.rpt) that sets a shared variable as
soon as a shape or a muntin appears. This shared variable is used in the section wizard of the
main report to suppress the respective sub-report for the shapes or the muntins.
In the sub-report R0001xxXX_OrderConfirmation.rpt the formula is "SketchCheck" which sets the
two shared variables "ShowSketch" and "ShowGrills". Then, these are evaluated in the
suppression formula of the"ShapeSketch" and"GrillSketch" sub-reports.
It is also important to completely suppress the unused footer sections in the section wizard in all
reports.

This problem has already been corrected in the current A+W standard reports (case 423102).




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  200
                Known problems and their solutions

Problem:
The dispatch of forms via the Twinfax print driver did not work.
Solution:
It must absolutely be heeded that the line with the control characters is all by itself at the top edge.
The font should be set to "Courier New" with a font size of 12. It must be checked whether this font
is also installed on the PC on which the reporting service is executed. Furthermore, it must be
checked whether the control characters were set correctly in the settings for the printer driver:




If the fax dispatch still does not work, it may be necessary to restart the queue manager:




                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




In addition, all processes with the name "vs_win2app.exe" and "vsfaxdlg.exe" must be ended in
the task manager.




Problem:


                                                                                                    201
The Price/unit net in BOM and item are not correct. The multiplication by the BOM quantity is
missing in the BOM. This creates an incorrect total in the item line. (see case 440489)
Solution:
The affected forms include two incorrect formulas and two incorrect total fields. The A+W
standard reports have already been reworked. However, customer reports must be corrected.
The following formulas must be replaced with the functions below:

BOMNetPricePerUnit:

// Display the BOM item net price per unit (means per one piece of the line item)
// Either in own or foreign currency depending on header setting

WhilePrintingRecords;

if ( {Header.Währung}<> {Company.Eigenwährung}) Then
(
     // Output foreign currency
     //(#440489-AN-18.02.2019)
     {BillOfMaterial.NettoPreisGesamtFremdwährung}
)
else
(
     // Output own currency
     //(#440489-AN-18.02.2019) Multiply by BOM qty.
     {BillOfMaterial.NettoPreisGesamt}
);




LineItemNetPricePerPiece:

// Display the line item net price per unit
// Either in own or foreign currency depending on header setting

local numbervar lineItemNetPricePerPiece=0;

WhilePrintingRecords;


if ( {Header.Währung}<> {Company.Eigenwährung}) Then
(
     // Output foreign currency
     lineItemNetPricePerPiece := {LineItems.NettoPreisStueckFremdwährung};
     if ( NOT IsNull({#SumPieceBOMForeignCurrency}) AND NOT IsNull({BillOfMaterial.Menge}) )
Then lineItemNetPricePerPiece := lineItemNetPricePerPiece + {#SumPieceBOMForeignCurrency};
     lineItemNetPricePerPiece;
)
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL


else
(
     // Output own currency
     lineItemNetPricePerPiece := {LineItems.NettoPreisStueck};
     if ( NOT IsNull({#SumPieceBOM}) AND NOT IsNull({BillOfMaterial.Menge}) ) Then
lineItemNetPricePerPiece := lineItemNetPricePerPiece + {#SumPieceBOM};
     lineItemNetPricePerPiece;
);




Furthermore, the following total fields must be corrected. The fields for the group result must be
changed:

For the field SumPieceBOM, BillOfMaterial.NettoPreisGesamt is entered.



                                                                                                202
For the field SumPieceBOMForeignCurrency, BillOfMaterial.NettoPreisGesamtFremdwährung is
entered.




                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                      203
Problem:
During collective printing of documents, the totals are not correct. The share of the first document
per collective printout is missing. Not affected are the forms for the invoice printing! (see case
442306)
Solution:
The affected forms include an incorrect formula in some of the total functions. Affected are the
following total formulas:
     - CollectiveTotalGross
     - CollectiveTotalVat
     - CollectiveTotalNet
     - CollectiveTotalWeight
     - CollectiveTotalCircumfence
     - CollectiveTotalSqm
     - CollectiveTotalQuantity
     - CollectiveTotalGrossForeignCurrency
     - CollectiveTotalVartForeignCurrency
     - CollectiveTotalNetForeignCurrency




                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




A formula to reset the totals is used in these collective functions. The effect of this is that at the
end of a collective printout, the total is set to 0 and the process begins from the start with the
totaling for the next collective printout. This formula must be replaced completely with this
corrected version:
// Reset totals before start of collective printout or if no collective printout is done

WhilePrintingRecords;

({Header.Sammelausdruckkennzeichen}=2
OR



                                                                                                     204
{Header.Sammelausdruckkennzeichen}=0)
AND
previous({Header.Sammelausdruckkennzeichen}) <> 2;
Problem:
Sometimes, it is necessary to access previous or subsequent BOMs within the detail block. For
example, to output the description of the gas directly next to the description of the spacer.
Solution:
Since all reports of the reporting service are structured so that the BOM elements are output in
the detail area, it is not possible to access the BOM elements directly. In order to receive the
description of the gas when outputting the spacer, you can use the Crystal Reports internal
function "next(x)" to access the data record that follows directly. Because the BOM element of
the gas always follows that of the spacer directly, you can access the desired data this way.
The designation of the BOM is composed in the function "@BOMDescription." Then, with
"next({BillOfMaterial.ErweiterteProduktbezeichnung})" you can access the description of the
next element. So that this only happens when the current focus is on the record for the spacer,
the product type/group of the current element must be queried before this. E.g. „if(
{BillOfMaterial.Produktart} = 60 AND Next({BillOfMaterial.Produktgruppe})=41) Then”.
Now, however, the designation of the gas would be output twice. Once next to the spacer and
once via the normal printout of the BOM. So that the normal printout for the gas is suppressed, a
suppression formula for the detail block is required. This formula must be TRUE in order to
suppress the output. E.g. "( {BillOfMaterial.Produktart}=30 AND
{BillOfMaterial.Produktgruppe}=41 )". This printout is TRUE in the case of a gas and thus its
printout is suppressed.

In order to access the directly preceding data record, the function "previous(x)" exists
analogously.
If it is necessary to access data records that are not directly preceding or directly after the current
data record, this must be done via an array which must be declared as "shared." This array is filled
in a function with the current data records and can then be used in the
function"@BOMDescription," for example. Here it is important to know that Crystal Reports
iterates through the data records in several phases, so it is important when the respective
formula is executed. The formula for filling the data records is executed first with the keyword
"WhileReadingRecords." The formula that outputs the BOM description (@BOMDescription) is
then executed with the help of the keyword "WhilePrintingRecords." Both keywords must always
be at the beginning of a formula in order to specify the time of the execution.

Problem:
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL



In the formula, the "net prices" code from the document header is not considered.
Solution:
In the formula, all fields must be adjusted that contain a discount or a gross price. With a right-
click on the field, you select the "Format object" function from the context menu. On the dialog,
you select the first tab "General" and click on the formula button for the suppression formula.
Here the formula is extended so that the "net price" code from the document header is
considered for the suppression. The field is suppressed with the following statement as soon as
"net prices" is active in the document: {Header.RabattDruck}<>0;
The current formula type R0001deDE_OrderConfirmation.rpt already includes this change.


Problem:

                                                                                                    205
The English forms for the invoice printing do not have the invoice number {Header.InvoiceNumber}
as the main break group, but rather the invoice customer number {Header.InvoiceId} of the
document. Thus, no invoice is generated per invoice number, but rather per invoice customer
number.
Solution:
In the current standard forms that are provided via setup, this error has already been eliminated.
To convert customer forms, take the following steps.

 1.     Start the group assistant




 2. Select the flawed field {Header.InvoiceId} at the top right in the group assistant and click the
    Options button




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  206
 3.      Replace the field there {Header.InvoiceId} with {Header.InvoiceNumber}




 4.      Confirm all dialogs with OK and save the report

After that, the break group has been converted to the correct invoice number.


Problem:
If a document is printed that does not contain any items, no header information is printed. The
printed document is therefore empty and unusable. At least the information of the document
header should be printed.
Solution:
The reason for this problem is the "Inner Join" of the SQL query with which the report retrieves its
data from the database. This "Inner Join" must be changed to a "Right Outer Join" so that
documents without items are also output.
In the current standard forms that are provided via setup, this error has already been eliminated.
To convert customer forms, take the following steps.

      1. Starting the Database Assistant

                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 207
    2. In the Database Assistant, switch to tab 2. "Links"




    3. Selection of the link between header and LineItem
    4. Select the "Link Options" button
    5. Change the link type from "Inner Join" to "Right Outer Join there




    6. Exit all dialogs with OK and save the report. Complete.

Problem:
The product structure is not output although it has changed with regard to the previous item. (see
also case 460661).
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Solution:
The correction can be examined in the standard reports (e.g. R0001
deDE_OrderConfirmation.rpt). There, the formula "SuppressionFormfeed" has to be transferred
into the customer report and placed directly next to the output of the product description. After
that, the field with the formula is suppressed so that it is not printed; it should only fill the
variables.


Problem:
How can I find out which database column belongs to a print table column.



                                                                                                208
Solution:
With this SELECT, you can determine what the referencing column from the DB for your field is.

SELECT B.SourceName AS SourceTableName, A.SourceName AS SourceColName, B.TargetName
AS Report_TableName, A.TargetName AS Report_ColName, A.Description, A.ActionType
from dbo.Core_ReportFields A, dbo.Core_ReportTables B
where A.ReportTableGuid=B.Guid AND A.TargetNamePhrases like '%Auftragsreferenz%';




For English:

SELECT B.SourceName AS SourceTableName, A.SourceName AS SourceColName, B.TargetName
AS Report_TableName, A.TargetName AS Report_ColName, A.Description,
A.ActionType,A.TargetNamePhrases
from dbo.Core_ReportFields A, dbo.Core_ReportTables B
where A.ReportTableGuid=B.Guid AND A.TargetName like 'TotalPricePerUnit';

Problem:
How can I find out which print table column belongs to a database column
Solution:
With this SELECT, you can determine what the referencing column from the DB for your field is

SELECT B.SourceName AS SourceTableName, A.SourceName AS SourceColName, B.TargetName
AS Report_TableName, A.TargetName AS Report_ColName, A.Description
from dbo.Core_ReportFields A, dbo.Core_ReportTables B
where A.ReportTableGuid=B.Guid AND A.SourceName like '%AH_HAUPT_AUFTR%';



                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 209
                PDF file generation for the DMS archiving with Crystal Reports
In the form management, in the future the (template) name of the PDF to be created by the A+W SOA
Reporting Service will be saved.




Of course you can also undertake the definition customer or supplier-specifically for the form in
question. The user should work with appropriate control codes so that the number of the document
to be printed is still in the file name (as with the Gupta Reporting Engine):

<<PDFDIR>100-<<ID>>-DMS BRA-<<DATE>>-<<TIME>>.pdf

The tag <<PDFDIR>> is replaced during the printing with the directory in which the file should be
created and the <<ID>> will be, as already mentioned, be replaced with the document number.
Furthermore, you can set both the current date as well as the time in the file name. An example
might look like this:
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL



\\SERVER01\Mandant0815\100-47110815-DMS BRA-20190625-120000.pdf

The value 100 after the storage directory stands for the document to be printed, here 100 = order
confirmation (print code). During the printing process, the AWSOA Reporting Service reads the
information about the respective document and can then create the PDF file for the DMS archiving
for the Allgeier scanView system in the storage directory. Then the AWSOA Exchange Service
transfers the PDF file created by the Reporting Service to the DMS system and deletes the file from
the storage directory.




                                                                                               210
                User name and print job number in the printer queue

The Reporting Service sends all print jobs with the user name that executes the Reporting Service.
This means that it cannot be distinguished who started the print job in question. For this reason,
the document name of the printer queue is used in order to display the user name and number of
the print job.
Due to a Windows security guideline, however, the document names are only visible for the user
who started the print job; that is, only for the user who executes the Reporting Service. To work
around this, each user who wants to see the document name must have administrator rights on
the print server.




The number of the print job is in the Number column in the A+W Business print job overview. This
way, the print job in question can be started again if necessary if the printer had problems during
printing.




                Employee's sender when sending forms
Normally you use the configuration in the infrastructure or the "Different sender" field in the form
management to control which sender address should be used when sending forms via e-mail.
With a new option in the form management, the sender can now be changed to the employee's e-
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL



mail address if this is entered. When this option is activated, the employee's address always takes
precedence over the other two settings.




                                                                                                211
                Dimension type of muntin drilling points
The dimension type is now available for the output of the muntin drilling points in the Crystal
Reports form. A+W Business internally saves all drilling points as chain dimension. Thus only the
distance of each drilling point to its previous drilling point is available. However, in order for the
printout to be output correctly according to the input, the distances must be added up if the
dimensioning type is set to "to reference point". This is the only way to ensure that the printout
corresponds to the input. The evaluation takes place in a formula within Crystal Reports and can be
found in the standard form for OC printing "R0001deDE_OrderConfirmation.rpt" with the name
"PrintGB".

                Send file attachments via e-mail
If a printout is sent by e-mail, it is now possible to send any file in addition to the PDF file with the
actual printout. These files must be located in the Crystal Report forms folder. This folder is found
in the company master data on tab "12.Print".

                                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                     212
Fig.: Company master data with path to file attachments
The files are stored per form in the form administration. If there is more than one file, the file names
must be separated by a semicolon:




                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig.: one file attachment in the form of the e-mail dispatch


In the print program, the file attachments appear in the table on tab 5.Attachments when the form
is selected. They are always appended by default, but can be deselected if necessary by unchecking
the checkbox in the first column.




                                                                                                    213
Fig.: The print program with a selected file attachment for sending by e-mail




                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                214
                Individual cover letter for mail dispatch
Up to now you could enter a system text for the e-mail cover letter in the form on tab 6.Options 3.
From now on it is also possible to enter placeholders there. These placeholders can be provided by
the print program with any text to get the possibility to design the e-mail individually. To do this,
use the placeholders in the system text in the format <<text1>> , <<text2>> etc. Please note that
each placeholder must be supplied with a text from the print program. Otherwise, an error message
appears when starting the printout.




Fig.: The system text of the cover letter with the placeholder.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig.: The form administration with the assigned system text for the cover letter


As soon as the form for the e-mail dispatch is selected in the printing program, the tab 4.Cover
letter(mail) is activated and the required placeholders must be provided with texts. Predefined text
modules can be created in the text management, which can be selected here and adapted if
necessary.




                                                                                                 215
Fig.: The individual cover letter for the e-mail dispatch
The Reporting Service now uses the system text and replaces the placeholders with the texts
specified in the print program. Internally a converter for RTF to HTML is used. This converter is only
for the conversion of text. Bitmaps or tables used in the texts in the print program cannot be
transferred to the cover letter.

                Output in PDF file
In order to reroute the output of the form printing to a file, it is possible to store a path and file
name in the form management. It is recommended that you use a UNC path for the path, one to
which the reporting service has access. The file name can be provided with placeholders to indicate
the content of the file. The possible placeholders are displayed when clicking on the button in front
of the file name and this way they can also be taken over immediately.



                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  216
If you wish, a user query can be activated with the checkbox below in order to give the user the
opportunity to adjust the file name before saving it.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




So that the output goes to a file, the output in the form printing has to be set to "File" with the
radio button "Output to...".
Essentially all forms previously output can be saved as PDF with a right-click on the print job. Then,
you only have to select the "Save as..." option from the context menu.

                Reprint
With a new functionality for repeated printing of forms, it is now possible, e.g. in case of paper jam
or for troubleshooting, to start an output with the Crystal Report form again. Here, only the already-



                                                                                                  217
existing data at the time of the initial printing is printed out with the form current at the moment.
Thus, for example, you can check the effect of form adjustments to an existing document.
With this type of reprinting, no data in the A+W Business database is used. There is no status check,
no document locking, no stock removal or invoice number generation. Only the output of the
document is stored with the current report in the AWSOA database and output on the original
printer. You must pay attention that the mail sending is done again if the initial printing was also
sent via mail. That's why there is a security query that informs you of this in any case. It's very easy
to reprint a document. Right-click on the desired print job and select the "Reprint" option from the
context menu.




                 Not supported RTF tags
Crystal Reports does not support all RTF tags. For details, use the following link to the SAP
homepage:
https://apps.support.sap.com/sap/support/knowledge/en/1214798

Essentially only texts should be used. Bitmaps and tables that are stored in A+W Business as RTF
text will not be or will only be incompletely printed out. It can even happen that the complete RTF
code is output as plain text.



                 PDF file names in mails
When sending the forms via mail, it is now also possible to store a name for the PDF file. Previously,
the name of the mail subject line was used for the name of the PDF file. If no PDF file name is stored
in the form, the program uses the mail subject line as before.

                 Customizing for mail subject line and PDF file name
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




In the form management, it is now possible to execute customizing functions for the mail subject
line and for the PDF file name. Previously, it was only possible to enter particular placeholders there.
By integrating customizing, it is much more flexible to use. The customizing function is entered with
"<<FX(1234)>>" in the subject line or in the PDF file name. Here, 1234 corresponds to the number
of the formula.
For the customizing here, there are a few specifications that have to be heeded in order to ensure
sensible use. The customizing function is called once for each document that should be printed.
Transfer of data to the customizing formula is done via the following variables:
    •   m_nCurrentRow: The index of the current row in the row array m_Row[]
    •   m_nCountRows: The number of all rows to be printed in the row array m_Row[]



                                                                                                    218
    •   m_Row[*]: The array with all documents to be printed. One document corresponds to one
        element in this array
    •   m_Row[*].m_sPrintId: The Print-ID of the respective row or document. All documents with
        the     same       Print-IT     are    output      in     the   same        PDF    file.
        The Print-ID in the array is always only valid up to the current element in m_Row[].
        Elements that are after the current row have no Print-ID.
    •   m_Row[*].m_nNUMMER: The document number of the element
    •   m_Row[*].m_nSTATUS: The status of the element


An example of such a formula is found on the diskset under the folder "...\Formula\Crystal Reports
Formulas". With the following example, the document numbers of the orders are written to the file
names that land in the PDF file:




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               219
                     Separate PDF files in the mail attachment
In the company master data, there is already a setting with which you can select whether each
document is sent in a mail or whether all documents of a partner are written together in one PDF
file.

 ! ***************************************************************************;
 ! ** Generate the file name for the PDF file that is sent by mail **;
 ! ** Formula needs to be referenced from within the PDF file in the form **;
 ! ** Example: PDF File Name = "OrderConfirmation_<<FX(223)>>.pdf"    **;
 ! **                where 223 is the number of this formula          **;
 ! ***************************************************************************;

 ! Available variables for customizing;
 !         m_sResult           = this needs to be set by that customizing. It is used as the result of the formula and
 will be inserted to the pdf file name;
 !         m_nCurrentRow                 = the row index for m_Row[] of the current row that is processed;
 !         m_nCountRows                  = the number of elements in the array m_Row[];
 !         m_Row[*]            = the array of all rows that should be printed;
 !         m_Row[*].m_sPrintId = the print ID of that row. All rows with the same print Id will be put into the same
 PDF file. The printId is only valid for rows before the current row!!;
 !         m_Row[*].m_nNUMMER = the number of the document;


 ! Used Variables;

 ! g_nUdv[0] = indexer for the rows;

 ! Clear the result first;
 Set m_sResult = '';

 ! Loop over all rows, starting from the current one and go down to the first one that will not be on the same printout;
 Set g_nUdv[0] = m_nCurrentRow;
 While g_nUdv[0] >= 0;
           If m_Row[g_nUdv[0]].m_sPrintId = m_Row[m_nCurrentRow].m_sPrintId;
                     ! Check if the row is having same print Id and will be put onto the same printout;
                     Set m_sResult = m_sResult || SalNumberToStrX ( m_Row[g_nUdv[0]].m_nNUMMER, 0 ) || '_';
           EndIf;

           Set g_nUdv[0] = g_nUdv[0] - 1;
 Wend;

 If m_sResult != '';
           Set m_sResult = SalStrLeftX ( m_sResult, SalStrLength ( m_sResult ) - 1 );
 EndIf;




                                                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                                      220
Now you can also set in the customer master data whether all documents of a customer should be
written to separate PDF files, which are then sent together in a mail. By default, the setting applies
in the company master data. This can also be overwritten per customer.




If the new option is active and if, for example, 3 documents should be sent to a customer, then this
single mail receives three PDF files as attachments.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  221
               Carbon copy function / watermark
In order to activate the carbon copy function, the number of copies has to be entered in the form
management on tab 4. Options 1. This causes the Reporting Service to output as many carbon
copies as specified for each print job.




In order to output a watermark on the copies of the form, the column
{Header}.{Durchschlagsnummber} or {Header}.{CarbonCopyNumber} can be used. The value is 0 for
the original printing or 1 for the first copy, etc.
Since Crystal Reports does not have a function for watermark, a bitmap can be added in the report
in a section of the side header.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




In the section assistant of the side header, the option "Put beneath the following sections" has to
be activated so that the bitmap is displayed under the actual report.


                                                                                               222
Via the object formatter, a suppression formatter is entered so that the bitmap is only displayed
for the carbon copies and not for the original printing.




Content of the suppression formula:
                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




{Header.Durchschlagsnummer}=0;




                                                                                              223
                  Print QR codes
To print QR codes with Crystal reports, the QR code font and DLL from IDAutomation is used. This
can be downloaded as a trial version but is to be licensed to the customer. The A+W IDAutomation
fonts are only one-dimensional barcodes and are not able to print the QR codes .

How to install the QR Code Font and Encoder Package (idautomation.com)




    •    The demo version downloads a ZIP file
    •    Run the file "IDAutomation_QRCodeWindowsFontEncoderDEMO.exe" all necessary data
         will be installed.
    •    In Crystal Reports there are two new entries in Formulas - Functions - Additional functions
         - COM and .NET UFLs (u212com.dll).
          IDAutomationQRCodeEncoderQRSet
          IDAutomationQRCodeEncoderQRGet




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 224
•    Create formula in Crystal Reports. For generating the QR barcode the formula should look
     like:

    stringVar DataToEncode:= ToText({Header.Angebotsnummer});
    stringVar CompleteBarcodeString:="";
    numberVar i:=0;
    numberVar Segments:= IDAutomationQRCodeEncoderQRSet(DataToEncode,0 ,0 ,0 ,0 ,0 ,0);
    For i:=0 to Segments Do
    (
       CompleteBarcodeString := CompleteBarcodeString + IDAutomationQRCodeEncoderQRGet(i);
    );
    CompleteBarcodeString


•    The value to be coded must be adjusted according to the data to be coded
•    The formula field is to be inserted from the Field Explorer and assigned the IDAutomation2D
     font




Now the QR code appears on the form, the word DEMO is always prefixed in the DEMO version
and the QR code is unusable (e.g. DEMO602319) !                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                            225
                Saving the login data in the Crystal Report
The login data are now saved in Crystal Report and always compared to the current login data at
the time of execution. If these are the same, then the report gets no new login data and it can be
executed much faster.
However, this only happens if the SOA database is entered via Windows logon, for security reasons,
Crystal Reports does not allow the storage of a password for a database login in the report. That's
why no more SQLServer should be used.




Each customer report will then have this login data at some time. If, however, we change the report
and thus use the database assistant to bring the local assignment of the database connection into
the report, then this report can no longer run at the customer, for there the service things that the
login data are still correct.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




CAUTION: therefore, always delete the login data in the comments if you make changes to the
report. This prevents problems at the customer's!




                                                                                                 226
227
A+W Software GmbH - Configuration A+W Business - INTERNAL
                HOSTNAMEHOSTNAME


                Timeouts in case of several network adapters
If there are several network adapters on the computers, in order to separate a production
network segment from the commercial network segment, for example, then at the start of A+W
Business or with first printout, there can be downtimes that last up to 30 seconds. This is caused
by the Ice Service Locator, which searches for services in the segment of the adapter that cannot
be reached. To prevent this, a blacklist of IP areas that should not be examined is inserted in the
infrastructure configuration.




However, this alone will not mean that there are no more timeouts.
To stop this completely, the Ice configuration must have fixed IP addresses.
First, the IP of the service locator must be determined; for this, a lookup in the registry and
resolution of a computer name in its IPv4 address.


                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




This is then 194.39.66.73, for example; it is then entered in the Ice configuration under
C:\SANDPIPER1\InfrastructureServiceLocator\config.registry
:



                                                                                                 228
#
# The IceGrid instance name.
#
IceGrid.InstanceName=AWRegistry

#
# IceGrid registry configuration.
#
# add tcp -h <locator ip> for the specific host if you have more than one network adapter
IceGrid.Registry.Client.Endpoints=tcp -h 194.39.66.73 -p 12000 -t 14000:ws -h 194.39.66.73 -p 12003 -t 14000

#IceGrid.Registry.Server.Endpoints=default
# add tcp -h <locator ip> for the specific host if you have more than one network adapter
IceGrid.Registry.Server.Endpoints=tcp -h 194.39.66.73

#IceGrid.Registry.Internal.Endpoints=default
# add tcp -h <locator ip> for the specific host if you have more than one network adapter
IceGrid.Registry.Internal.Endpoints=tcp -h 194.39.66.73

IceGrid.Registry.LMDB.Path=C:/ProgramData/A+W/Sandpiper1/InfrastructureServiceLocator/lmdb
IceGrid.Registry.PermissionsVerifier=AWRegistry/NullPermissionsVerifier
IceGrid.Registry.AdminPermissionsVerifier=AWRegistry/NullPermissionsVerifier
IceGrid.Registry.DefaultTemplates=C:/SANDPIPER1/InfrastructureMiddleware/3.7/config/templates.xml

# Glacier2
#
# IceGrid admin clients must use a secure connection to connect to the
# registry or use Glacier2.
#
#IceGrid.Registry.AdminSessionManager.Endpoints=default -p 12007
# add tcp -h <locator ip> for the specific host if you have more than one network adapter
IceGrid.Registry.AdminSessionManager.Endpoints=tcp -h 194.39.66.73 -p 12007

#IceGrid.Registry.AdminPermissionsVerifier=AWRegistry/NullPermissionsVerifier

#IceGrid.Registry.SessionManager.Endpoints=default -p 12006
# add tcp -h <locator ip> for the specific host if you have more than one network adapter
IceGrid.Registry.SessionManager.Endpoints=tcp -h 194.39.66.73 -p 12006

IceGrid.Registry.SessionTimeout=180
#IceGrid.Registry.SessionManager
#IceGrid.Registry.AdminSessionManager
#IceGrid.Registry.AdminSessionManager.Endpoints=default

#
# IceGrid SQL configuration if using SQL database.
#
#Ice.Plugin.DB=IceGridSqlDB:createSqlDB
#IceGrid.SQL.DatabaseType=QSQLITE
#IceGrid.SQL.DatabaseName=db/registry/Registry.db

Ice.StdErr=C:/ProgramData/A+W/Sandpiper1/InfrastructureServiceLocator/registry_stderr.txt
Ice.StdOut=C:/ProgramData/A+W/Sandpiper1/InfrastructureServiceLocator/registry_stdout.txt

#
                                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL



# Trace properties.
#
#IceGrid.Registry.ReplicaName=Registry
Ice.ProgramName=Master

IceGrid.Registry.Trace.Adapter=1
IceGrid.Registry.Trace.Locator=1
IceGrid.Registry.Trace.Application=1
IceGrid.Registry.Trace.Node=1
IceGrid.Registry.Trace.Replica=1
IceGrid.Registry.Trace.Object=1
IceGrid.Registry.Trace.Server=1




                                                                                                               229
In addition, these must also be updated in the IceGrid for the IceStorm. For this, for the IceStorm,
the definition for editing must be opened.




Now the 2 entries can be provided with the IP of the service locator.




Saving is done with the marked icon and editing is ended via the File -> Close Application menu or
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL



Ctrl+F4.




                                                                                                230
3.11. Management tool Crystal Reports forms

         Preparation and important notes
If you are using the new Crystal Report Management, data in the AWSOA database and in the
reports is changed. That's why the AWSOA database and the Crystal Reports forms must be backed
up beforehand. Only this way can we guarantee that the data can be restored. To prevent the
original Crystal Reports forms from being changed during the optimization or having them become
unusable due to errors during the optimization, you should work on a test directory.




The report groups 1 to 6 are pre-defined and cannot be changed.
If in the end a new report group was created, that is, the report group has a number > 6, then you
can test and continue according to the configuration instructions. This report group generates new
report tables and these tables are not used by the reports and the application.
                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               231
         Introduction
With a large number of documents in a print job, printing Crystal Reports forms can take a long
time under some circumstances. To help here, a management tool was created with which you can
create your own Crystal Reports report groups.
6 report groups are provided by default, to which various reports belong. For example, the Order
report group includes the reports order confirmation, invoice, and delivery note. In any case, you
now have the opportunity based on the existing groups and their reports to create a new report
group, almost as a copy. The goal is to define a reduced set of data for this new group, so that only
the data required for the stored form is determined in A+W Business and must be transferred to
the A+W SOA Infrastructure Reporting Service. The management program can be called both from
the main menu as well as from the form management.

         Creating a report group
In the beginning, you create - based on an existing report group (report type) or the order
confirmation - a new report group (red marking in screenshot: number is set automatically) with
the desired name. Up to now, this is a simply copy of the order confirmation with the identical set
of data that must be procured for printing. You can also delete report groups you have created
again or edit the name of the report and then save it.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 232
Next, you change to the form management and create either a new form with the created report
group or take an existing form and convert it to the report group.




                                                                                               A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                         233
Furthermore, you can define a new Crystal Report for the form; you could, for example, copy the
'old' Crystal Report form and assign the name according to the report group.




          Optimizing a report group

The Crystal Report that is assigned to the form now serves as the basis for the report gtroup and
optimizing the set of data behind it. If you click Optimize, a new dialog opens on which all forms are
displayed that belong to the report group. Of course the function is also available on the
management dialog. If you now start processing with OK, the report group will be optimized using
the fields used in the Crystal Reports forms.


The form is now ready to print. The data that must be procured for the printing now fits exactly in
the fields that are used in the Crystal Report. This way, we reduce the quantity of database queries
executed and gain time when printing.

          Optimizing Crystal Report

If you would like to add a particular field to the Crystal Report or need one for printing, it is possible
to reactivate fields for a report group via the management program. For this, you load the report
group and change to the 2nd tab. In the overview, all tables and the associated fields are displayed.
Useful here can be the filter function if you are looking for a particular field. If you would like to
reactivate some customer data (KU_KUNDEN), you do this via the Active column in the screen table
of the fields. Then you save it and the data structure is updated.


Now you open the Crystal Report form. Now you have to specify the data source path. To do this,
right-click on database fields, and a dialog will open.




                                                                                                             A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                      234
For the example with regard to the customer data, in the beginning, first the order header table
must be updated since it contains references to the customer table. To do this, you mark the table
header and the order header table in the lower display. With a click on Update, the tables are
checked and the missing fields are added in Crystal Reports. Thus, the reference fields for the
customer are now present. Now, you have to bring the customer table itself back into the Crystal
Report. To do this, right-click on database fields and select the Database Assistant menu element.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Here, on the left side you select your database connection and open the view of the database tables
and scroll to the table that you would like to add.




                                                                                               235
The table is added with the ">" button.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Now you assign an appropriate name for the table and click Ok. Thus, the customer data is available
in Crystal Reports once again.




                                                                                               236
3.12. PDF generation in form printing

         Settings
There are different settings that control the program behavior with regard to PDF generation during
CR form printing:
    •   Support of double-sided printing in form management
    •   Document dispatch – mail options in the customer master data
    •   Mail dispatch per document in the company data


 Form Management                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




 Customer master data



                                                                                               237
 Company Master Data




But warning: these settings affect not only whether during mail sending one or more documents
are generated, they also apply for the DMS.
Setting combinations, here the result:
 No.   Customer setting                  Form setting              Result

 1                                                                 Several mails with one
                                                                   document apiece
                                                                   Several PDFs for DMS
                                                                                                A+W Software GmbH - Configuration A+W Business - INTERNAL



 2                                                                 Several mails with one
                                                                   document apiece
                                                                   Several PDFs for DMS

 3                                                                 One mail with a PDF that
                                                                   contains several orders
                                                                   One PDF for DMS that
                                                                   contains several orders
 4                                                                 Several mails with one
                                                                   document apiece
                                                                   Several PDFs for DMS




                                                                                          238
 5                                                                        One mail with several PDF
                                                                          documents
                                                                          Several PDFs for DMS

 6                                                                        Several mails with one
                                                                          document apiece
                                                                          Several PDFs for DMS



With activated option "Transfer in iQuote" in the form management (tab 1. Form), the mail
dispatch option "2 - per customer - document together" is overridden and a PDF per document is
generated. This is necessary since in iQuote, individual PDF files must be created per order.


         Form management change of the date data type in the Reporting
         Service
Starting with version 13.04.7949 of the A+W Infrastructure 6 Reporting Services, the data type of
the date will be taken over from the A+W Business tables into the dynamic print tables. For some
columns, the data type was changed from "Datetime" to "Date" and there is a need to act for
formulas in which the function "ToText(...)" and/or "Date(...)" is used, since the data type of the
parameters has changed.
Crystal Reports doesn't recognize the data type date and interprets this column as a string of
characters. Thus, there may be error messages when executing a print job insofar as the columns
were used in a formula.
The print job may be canceled with the following error message:
"Error in formula <FORMELNAME>: 'WhilePrintingRecords;'A date/time entry is required here."




In this error message, the name of the formula in which the correction must be made is specified.
For the execution of the report in the Crystal Reports Designer, only a slightly helpful error message
is displayed.

                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




A flawed formula might look as follows:
ToText ( {DateField}, “dd.MMM.yyy“ )             -> Error



                                                                                                  239
Depending on the region, the following formula can cause an error.
ToText ( Date({DateField}), “dd.MMM.yyy“ ) -> Error
The correction would look like this, so that only the conversion to CDate is added:
CDate({DateField})                               -> Correct
Thus, it is possible once again to set the desired picture (that is, the date format) for the field via
the properties of the field. Other formulas that can require a date can be supplied with the correct
date value this way.


Here, the complete list with all tables and columns, whose type was changed from datetime to
date:
Table name                Column name
CreditNoteHeader          CreditNoteConfirmationDate
CreditNoteHeader          CreditNoteDate
CreditNoteHeader          DeliveryDate
CreditNoteHeader          DeliveryNoteDate
CreditNoteHeader          InvoiceDate
CreditNoteHeader          PaymentDueDate
CreditNoteHeader          ProductionDate1
CreditNoteHeader          ProductionDate2
CreditNoteHeader          ProductionDate3
CreditNoteHeader          PurchaseOrderDate
CreditNoteHeader          ShipmentDate
Employee                  Birthday
Employee                  Birthday
Employee                  Birthday
Employee                  Birthday
Employee                  Birthday
EnquiryHeader             DeliveryDate
EnquiryHeader             DeliveryNoteDate
EnquiryHeader             EnquiryConfirmationDate
EnquiryHeader             EnquiryDate
EnquiryHeader             InvoiceDate
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




EnquiryHeader             PaymentDueDate
EnquiryHeader             ProductionDate1
EnquiryHeader             ProductionDate2
EnquiryHeader             ProductionDate3
EnquiryHeader             PurchaseOrderDate
EnquiryHeader             ShipmentDate
OrderHeader               DeliveryDate
OrderHeader               DeliveryNoteDate
OrderHeader               InvoiceDate
OrderHeader               OrderConfirmationDate


                                                                                                   240
OrderHeader               OrderDate
OrderHeader               PaymentDueDate
OrderHeader               ProductionDate1
OrderHeader               ProductionDate2
OrderHeader               ProductionDate3
OrderHeader               PurchaseOrderDate
OrderHeader               ShipmentDate
PurchaseOrderHeader       DeliveryDate
PurchaseOrderHeader       DeliveryNoteDate
PurchaseOrderHeader       InvoiceDate
PurchaseOrderHeader       OrderConfirmationDate
PurchaseOrderHeader       OrderDate
PurchaseOrderHeader       PaymentDueDate
PurchaseOrderHeader       ProductionDate1
PurchaseOrderHeader       ProductionDate2
PurchaseOrderHeader       ProductionDate3
PurchaseOrderHeader       PurchaseOrderDate
PurchaseOrderHeader       ShipmentDate
QuotationHeader           DeliveryDate
QuotationHeader           DeliveryNoteDate
QuotationHeader           InvoiceDate
QuotationHeader           PaymentDueDate
QuotationHeader           ProductionDate1
QuotationHeader           ProductionDate2
QuotationHeader           ProductionDate3
QuotationHeader           PurchaseQuotationDate
QuotationHeader           QuotationConfirmationDate
QuotationHeader           QuotationDate
QuotationHeader           ShipmentDate



3.13. Stopping the reporting service
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




The reporting service can also be stopped in the IceGrid (Service Locator) like any other SOA service.
But there are situations where this is not possible. E.g. if there are dependent processes that must
be ended beforehand. This is an alternative to the restart of the entire server. Then proceed as
follows:
    -   End all reporting services with the Service Locator
    -   At least one does not stop, we'll take its process ID
    -   Open Process Manager and go to the process/analyze wait chain




                                                                                                  241
Select the locked spooler (splwow64.exe) and click "End process".




                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                    242
3.14. Crystal Report+Workflow mail with Office365 + OAuth2
From 2020 on, it was no longer possible to create new accounts in Office365 with a user/password
authentication; existing accounts could still be used. Starting in September 2025, Microsoft will
completely switch off this basic authentication (user/password). Thus far, our applications did not
manage the token-based authentication via oAuth2. This has now changed in the Crystal Report
Service of A+W Business; now MailKit can be used as mail client and thus it is possible to choose
between user/password and Office365 authentication. The set-up of the user/password
authentication will not be explained in detail here since it is already known. However, it is different
than the old and works, e.g. also with Hungarian telecom, which has special requirements for the
SSL encryption.
The configuration of the Crystal Report mail dispatch is done in the infrastructure configuration




Here, the MailKit option must be activated and the authentication converted to Office365. Now the
Client ID from the Azure must be inserted, as well as the user from the Azure (domain log-in name).
The data will only be saved here.
Authentication happens in the "Config Tool Reporting Service". This page is only displayed there if
in a client the Office365 authentication is activated.
CAUTION: The authentication of Office365 must be done under the domain that is also running the
ICE node infrastructure. Only then is the mail dispatch authenticated and there is not an exception.
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL



The user must be a domain user!




                                                                                                    243
If the "Authentication and mail dispatch" button is pressed, the Azure authentication dialog opens
and we must enter our password and if necessary the MFA. Only now is the token created for this
user and the test mail goes out. This step must be done on the computer on which the Reporting
Service is running. The token is stored in a user cache. If this file is deleted, then all mail tokens are
gone and the Reporting Service runs into an error when sending.
CAUTION The test mail will be sent to the sender of the mail. If this should differ from your mail
account, you should enter yourself in CC!!

          Saving of the tokens
After the authentication, the tokens are saved in a file. This file is in the %PROGRAMDATA%
folder:

C:\ProgramData\A+W\Clarity\Clarity.Mail.MailKit.O365.MSAL.Storage.bin
                                                                                                             A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                      244
         Configuration OAuth2 in Azure (Office365)

The following steps must be performed by the system administrator in advance: The goal is to
configure an application for the mail dispatch in Azure and to get a Client ID (Tenant ID); these are
then required in the infrastructure configuration
Creating the application

Before you can use OAuth for Outlook.com, you must create an application ID in the Azure
directory.

Go to Azure portal (https://Portal.azure.com) and log in with an administrator account.

Search for "App registrations“ and create a new app:




Go to new registration



                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 245
Click register now. After that, you should see the application (Client) ID and the client (Tenant) ID.
You need these for the configuration of access in the infrastructure




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




Deviating dispatch addresses (e.g. per form) must be entered in the Exchange Admin Center.




                                                                                                  246
         Tracing
The trace of the mail sending from A+W Business Exe is found in the Commercial.ComProxy*.awtrc.
Please search for "SendMailKit". In the trace, you can see precisely with which user the search is
conducted in the token store. Where it is and how many tokens are there. This is very important
for troubleshooting. It also affects the trace from the workflow of the Exchange Service.
A+W Business (incl. workflow) always sends the mails via the Commercial.ComProxy.
The sending in the Reporting Service is done via the Ice Service; the core tracing must be switched
on there.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               247
         Workflow mail in A+W Business
In A+W Business, the configuration is done with the company parameters.




The authentication is done with the button, as is the test mail sending to the specified recipient

Workflow
Mail can be sent with this function.
Boolean = udf_SendMailEx( sFrom, sTo, sCC, sBCC, sSubject, sBody, sHTMLBody, sAttachmentNames,
bAllowInteractive )


Description:
Sends an E-Mail via Mailkit or Standard mail based on the settings of the company data
Returns: TRUE if no error occurs
Parameters:

sFrom          String          Despatcher
sTo            String          Receiver
sCC            String          Copy receiver
sBCC           String          Blind carbon copy receiver
sSubject                String         Subject
sBody                   String         E-Mail content (in text format)
sHTMLBody               String         E-Mail content (in HTML format)
sAttachmentNames        String         E-Mail attachments ...;...;... (only if mailkit)
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL



bAllowInteractive       Boolean        AllowInteractive Authentication

Return Value: Boolean

With it, mails can be sent with Mailkit. Please note that the old udf_sendmail and udf_sendmailSSL
do not support this and have to be exchanged in the customizing.
After the configuration, on first use there must be authentication for each computer and user; this
is different than using the other methods. For the workflow execution it applies that the user who
starts the Exchange service node must perform this authentication on the computer on which the
service is running. This must be done in A+W Business and also with the infrastructure reporting
config tool.



                                                                                                 248
3.15. EI = electronic invoice (XRechnung, ZUGFerd)

          Introduction/requirements/architecture
Introduction
Starting on 1/1/2027, the creation of electronic invoices is prescribed.

Named as the two permissible formats according to the standard in the publication are:
-   CII - Cross Industry Invoice http://www.unece.org/cefact/xml_schemas/index
-   UBL - Universal Business Language http://docs.oasis-open.org/ubl/cs1-UBL-2.1/UBL-2.1.pdf

As a hybrid data format, ZUGFeRD integrates structured invoice data in the XML format

and specifically in the XRechnung CII format into a PDF document (PDF/A-3).
A+W Business supports the current version of these formats.
-   ZUGFeRD 2.3.2 - CII 22B
-   XRechnung UBL 3.0.2
-   XRechnung CII 22B

Free online service https://www.invoice-viewer.de/ for the display of invoices.
Prerequisites
The Reporting Service and B2B Service must be installed. The export format must be defined per
customer. A series of master data must be entered. Only the Crystal Report Service supports the
creation of the e-invoice formats (no Gupta forms)
Architecture
The Reporting Service controls the complete creation and dispatch of the electronic documents. It
uses the B2B Service to generate the documents.




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               249
                                                                                               Customer master data B2B
                                                                                                 data exchange settings



            Form printing dialog                                         AWB




                                                                                                                            Business B2B Service
                                   B2B data exchange settings                  Transfer XML output mode
                                         in parameters

                                                                                                                     CreateB2BDocument

                                                                                                                          Albwir.Edi.Export.Format

             Reporting Service




      Reporting Engine
                                                            CreateXMLDocument (                                      B2B documents +
                                                           Doctyp,XRechnungType,                                         KSeF ID
        BusinessReportingCOM                                     InvoiceNo.)




        Crystal Reports



                                                                   Print Tables




Print PDF
                                                                                                            Mail
                                                                                                          dispatch                     File




                                                                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                                                              250
                                                            Export management




251
A+W Software GmbH - Configuration A+W Business - INTERNAL
          Master data

Company master data

The company master data includes the surrounding data; it is transferred as seller data.




Storage of the VAT ID




Currencies

The ISO currency codes must be assigned in the currencies.
                                                                                                 A+W Software GmbH - Configuration A+W Business - INTERNAL




Country
The ISO country codes must be assigned in the countries.


Employee
In the employee data, the mail address and telephone number must be entered


Customer master



                                                                                           252
In the customer master, the mail address and telephone number must be maintained. For public
clients in Germany, the route ID must be stored; it idenfies the client and invoice recipient.




                                                                                                 A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                           253
4. Production
4.1. Transfer to production

           Types
There are two ways of transferring orders:
Standard
   •     automatic release for production
   •     Scheduling in ALCIM Capacity Planning and reservation of machine capacities
   •     other processes (rough scheduling, detailed scheduling, …) can be executed
   •     Quotes can be optimised because orders and quotes are transferred and reported with
         different codes
Capacity planning
   •     no automatic release for production
   •     Scheduling in ALCIM Capacity Planning and reservation of machine capacities
   •     Additional steps (rough scheduling, etc.) are not performed and cannot be performed
         manually.
   •     Production release by another workflow task (release cannot be performed in A+W
         Production)
   •     After release, rough, detailed scheduling can be performed.
   •     Quotation optimization is possible since orders and quotations with different codes are
         transferred and reported, the old restriction no longer exists today

           Programs
Orders can be transferred by two programs:
Manually
   •     by the user via Production > Production > Production transfer
   •     Currently only standard transfer possible, no capacitative planning
   •     every order in a number manager will be transferred after a status check
Create
   •     By the Commercial Exchange Service via A+W Business workflow task
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL



   •     Transfer type "standard" by workflow task with formula
         "Workflow_AutomaticTransferToProduction.txt"
   •     Transfer type "capacitative planning" by workflow task with formula
         "Workflow_TransferToCapacityPlanning.txt"




                                                                                                   254
       4.1.2.1.          Flow of capacitative planning



         Transfer

                            Order Entry                       BW_LOCK_KAPA.STATUS = 0


                             Workflow                         BW_LOCK_KAPA.STATUS = 1
                    Udf_TransferToCapaci
                       tyPlanning.txt                         BW_AUFTR_KOPF.STATUS = Point 980
                    If error status point 992 if
                    assigned
                                                              BW_AUFTR_KOPF.STATUS = Punkt 992 (error)
                    No prod. relevant item, then
                    status increase                                            OrderXML File
                                                                               Orderingtype=“Reservation“


          Change order                                        BW_LOCK_KAPA.STATUS = 0
        No cancellation in
        production                                            BW_AUFTR_KOPF.STATUS = No change
                                            Production
                                              import

                        ERP Webservice                         BW_AUFTR_KOPF.STATUS = Point 38

                    CompleteScheduling()                       BW_AUFTR_KOPF.STATUS                    =    Point   39
                     SetOrderStatusAll()
                    •     Costs
                    •     Procurement type                              Task for scheduling problems


        Release


                  Production release                               BW_AUFTR_KOPF.STATUS = Point 35



                          Workflow
                                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL



                                                         Select all orders with status from point 35
                Udf_ReleaseForProdu
                     ction.txt


                        PPSWebService                      BW_LOCK_KAPA.STATUS = 12
                OrderChangeStatusEx
                          ()                               BW_AUFTR_KOPF.STATUS = Point 40
                  Release complete

After the release, the same locks, production cancellation take effect in the order entry as in the
standard transfer.


                                                                                                                    255
   4.1.2.2.         Flow of standard transfer



Transfer


             Order Entry                 BW_LOCK_KAPA.STATUS = 0



        Production release               BW_AUFTR_KOPF.STATUS = Point 35



              Workflow                   BW_LOCK_KAPA.STATUS = 12
     Udf_TransferToProdu
                                         BW_AUFTR_KOPF.STATUS = Point 40
            ction.txt

                                                        OrderXML file
                                                        Orderingtype=“Produce“

        Production import




         ERP Webservice
                                         BW_AUFTR_KOPF.STATUS = Point 38
        CompleteScheduling()
         SetOrderStatusAll()
    •      Costs                         BW_AUFTR_KOPF.STATUS            =       Point   39
    •      Procurement type
    •      Production date                      Task for scheduling problems


         Change of order                 BW_AUFTR_KOPF.STATUS = Point 810
                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL



                                         BW_LOCK_KAPA.STATUS = 0

                                                Cancellation PPS Webservice


             Reporting to                BW_AUFTR_KOPF.STATUS =
               production                Point 41, 42, 43, 45, 47, 48, 50, 55, 68,




                                                                                              256
       4.1.2.3.     Flow of production batch solution

    Production batch solution


           Batch resolution in
               production


             Status message          The message "EnteredWithSuccess" comes on initial transfer and with the
             ERPWebservice           batch resolution. Only the minimum and lock status of point 41 decides
                                     what it is. If the order lies in this range, then a batch resolution is made.
         "EnteredWithSuccess"=       Otherwise, it is a successful scheduling with point 38 !!!
                    1




                  Check              It is checked whether the order status
                  order              >= min. status and < lock status of the
                                     status point 41; if this is so, then
                  status             cancellation, otherwise status point 38



                      Yes

             Status change                  BW_LOCK_KAPA.STATUS = no change
             document "Batch
                resolution"                 BW_AUFTR_KOPF.STATUS = Point 41



              Status change                BW_LOCK_KAPA.STATUS = no change
                 document
                "Successfully              BW_AUFTR_KOPF.STATUS = Point 38
                 scheduled"


All existing order locks are retained, for change, press Shift+F12                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                                     257
           Configuration
         4.1.3.1.        Status Points

                                                                        State
   No.     Required for               Designation                       Defaul   Min.       Lock
                                                                        t
   35      Transfer                   Production release                36       x          x
   740     Transfer                   SN file checked                   37       x          x
   980     Capacity transfer          Transfer to Capacity Planning     9        x          x
   40      Standard transfer          Transfer to Production            40       x          x
   810     Order entry                Production transfer cancelled     36       x          x
   38      Capacity report            Capacity planning: scheduled by   43       x          x
                                      time management
   39      Capacity report            Error during automatic            9        x          x
                                      scheduling
   41      ALCIM report               ALCIM: detailed scheduling        51
                                      resolved
   42      ALCIM report               ALCIM: rough scheduling           52
   43      ALCIM report               ALCIM: detailed scheduling        53
   45      ALCIM report               ALCIM: transfer to production     54
   47      ALCIM report               AWPool start of production        55
   50      ALCIM report               AWPool report                     50
   55      ALCIM report               Shipping                          55
   48      ALCIM report               AWBar produced                    48
   68      ALCIM report               AWBar ready for dispatch          68
   78      ALCIM report               Shipping                          78
   88      ALCIM report               AWBar shipped                     88
   860     Transfer                   Cancellation through production   900      Transfer   Detailed
                                      transfer                                              Scheduling
   963     Transfer                   Transfer of non production-       0        40
                                      relevant data
   9 9 Transfer                       Error during transfer to
   2                                  production
Tab. 21: Status points - production
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




         4.1.3.2.        ERP Webservice
Required for
    •    OrderXML production transfer
    •    ALCIM Capacity Planning production report
    •    Data-free production report
    •    AWPort connection
Configuration in Master data > Company > Company data > tab Production > Order settings

         4.1.3.3.        PPS-Webservice
Required for


                                                                                                   258
   •   Production release after capacity transfer
   •   Goods received report to ALCIM
   •   Cancellation
Configuration in Master data > Company > Company data > tab Production > ALCIM connection
   •   URL of PPS-Webservice




                                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                            259
         4.1.3.4.        Switch 'Transfer to production'
Configuration in Master data > Company > Company data > tab Production > Order settings
   Parameters                         Meaning              Addition
   Production interface -             Interface version    Pool.asc 2.1, 2.2, 2.3, OrderXML
   version
   Production     interface-          Path and file name   \\localhost\Trans\Import\Work\ORDERXXXX.XML
   Path/file name
   AWDesign interface -               Interface version    OrderXML
   version
   AWDesign interface –               Path and file name   \\localhost\Trans\Import\Work\ORDERXXXX.XML
   path/file name
   OrderXML version                   OrderXML version    currently only 4.0
   OrderXML URL of ERP-               URL ERP-Webservice  http://localhost/albwir.erp.webservice.20
   Webservice                                             11
   Save OrderXML files via            ERP web service Default: off
   web service                        saves the OrderXML
                                      file in UTF8 format
                                      (instead of ALFAK)
Tab. 22: Switch 'Transfer to production', tab 1



   Parameters                         Meaning                                Addition
   ALCIM                              Transfer for ALCIM                     ALCIM:          on;
                                                                             otherwise off
   Define job number             Transfer of job no. AWPool number area, Pool.asc, OrderXML
                                 otherwise 0
   Item splitting licensed       Transfer of the item quantity split by time Pool.asc 2.3
                                 management, and number
   Automatic transfer upon Goods received reports to production              OrderXML
   receipt of goods
   Transfer leaded designs       Transfer of leaded designs as Georgian bar Pool.asc
                                 record, otherwise as processing
   Edgework per order            no size correction through edgework         Pool.asc
   Transfer article              Article transfer                            Pool.asc, OrderXML
   Transfer (laminated glass) Transfer of film layers (filling/film layers)  Pool.asc 2.2 and
   films                                                                     higher
   Transfer cast resin fillings Transfer of cast resin (filling/cast resin)  Pool.asc 2.2 and
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                             higher
   Transferring         ALCIM- Transfer of special text Transfer of special Pool.asc 2.2 and
   specific text                 text                                        higher
   Transfer route sequence       Transfer of route hierarchy as per Pool.asc 2.3
                                 document, otherwise 0
   Do not transfer direct No transfer of documents with direct Pool.asc, OrderXML
   shipments                     shipment code set
   Supply        type       from If the document procurement type 0 = Pool.asc 2.3,
   Production first              production, procurement type 8 is OrderXML
                                 transferred to production instead of
                                 procurement type 0; this way, this
                                 procurement type overrides the master


                                                                                                     260
                                      data of production. This is necessary for
                                      LAMI that should be produced case by case
                                      or cut.
   Adopt county/state for             The county/state is added to the city, and    Pool.asc 2.3
   address                            transferred in field 15 City of the main
                                      record
   Exchange quantity fields in        Exchange of field 11 Quantity and field 85    Pool.asc 2.3
   the item record                    Item quantity (field 11 now shows the
                                      partial quantity from time management and
                                      field 85 the original quantity)
   Felt pad code in special           Transfer of felt pad code as special text 1   Pool.asc 2.3
   text 1 in item record              (field 133) Item record
   Create order tags                  no function
   Inch values always in              Sizes always in 1/256 inch                    Pool.asc
   1/256 inch
   Connection type as second Connection type of the spacer code is                  Pool.asc
   digit                       transferred as the second digit in field 80
                               Spacer code in the item record
   Customer logo based on no function
   customer
   addressCustomer        logo
   based       on    customer
   address
   Transfer laminated glass Laminated glass steps are transferred as                Pool.asc 2.3
   steps on the BOM level      processing records for stepped glass
   Transfer BOM element Transfer of steps generally as processing                   Pool.asc 2.3
   steps                       record for stepped glass. Shape 0 record will
                               be created for reactangles
   Transfer external packing Transfer of the external packing key in field          Pool.asc 2.3
   code                        36 Preset rack, header
   Mode       for   automatic After minimum and lock status, status point
   transfer                    40 or after entry in capacity lock table
   SN file name transferred Necessary for XOPT to read the cutting                  Pool.asc
   without path and suffix     information in Block.ind. XOPT needs the SN
                               file name in the shape of 000198 instead of
                               201108\000198.SN. Not required for
                               ALCIM!
Tab. 23: Switch 'Transfer to production', tab 2
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




   Parameters                         Meaning                                       Addition
   RONA                               Additional export file for RONA
   LIOPT                              Additional export file for LIOPT
   Backup copies                      Additional backup of the pool.asc file        Pool.asc
Tab. 24: Switch 'Transfer to production', tab 3

         4.1.3.5.        ALCIM language
    •    Required for product names and text in other languages for transfer and master data linking




                                                                                                   261
        4.1.3.6.    ALCIM server
    •   Required for the linking of master data
    •   To be defined in Master data > Company > Company data > tab Production

        4.1.3.7.    Capacity lock status
    •   Production status management in table BW_LOCK_KAPA
    •   Used for formulas (capacity transfer, standard transfer,..) and order entry
    •   Reset to 0 at order entry by
    •   Change of shipping or production date
    •   all structural changes in an item (width or height, supply type,..)
    •   BOM changes (shape, processing steps,…)
    •   No reset because of price changes
(INSERT in BW_LOCK_KAPA is made by order entry only if either AWCapacity is active, or the
licence 61 ZW_Auto (autom. scheduling in capacity planning) exists.

Only then will the order be locked against changes after transfer to production.)




                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                             262
Possible values:
   Valu     Meaning                                                Application
   e
   0        New order entered, or structural changes               Order entry
   1        Planning transfer completed                            Transfer to Capacity Planning
   2        Order imported in ALCIM Capacity Planning              Manual via workflow*
   5        Planning or report error in ALCIM Capacity Planning    Manual via workflow*
   10       Order ready for production release in ALCIM            Manual via workflow*
   11       Production release sent to ALCIM                       Manual via workflow*
   12       Released for production in ALCIM                       Via workflow for Capacity
                                                                   Planning or impl. during
                                                                   standard transfer
Tab. 25: Capacity lock status

*) The function udf_UpdateKapaStatus can be used in a formula for changing the status in table
BW_LOCK_KAPA by hand

          4.1.3.8.       Transfer to production in a different language
    •     Order entry and production in different languages (e.g. order entry in German, production
          Italian)
    •     OrderXML only
    •     Transfer of article names, item text, and processing text in production language
    •     Transfer in standard language if translation is missing
    •     Unchanged transfer of manually amended article names, processing and item text
    •     Master data link: Transfer of article name 1 to 3 of products (translation provided)

          4.1.3.9.       Multilingual article designation
For the creation of the OrderXML, now the texts are also transferred for items and processing in
the customer language if this deviates from the language in which they were entered. Here, only
items and processings are translated that were completely translated into the customer language
(Master data > Products > Items > Items > Languages) and that were not changed manually in the
order entry.
The following boundary conditions apply for the transfer:
    •     The OrderXML version must be at least 5.4 So that the changes are taken over, the
          production system in version 6 must be installed
    •     Main item and BOM elements must be completely translated (designation 1, designation
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL



          2, designation 3)
    •     The designations may not have been edited manually during order entry
    •     To replace the processing text, it must be stored in a foreign language with the
          placeholders


          4.1.3.10.      Reporting of delivery date from production
The calculation of the delivery dates considers the route delivery dates of A+W business only if this
option is set; thus it can no longer report on delivery dates on non-workdays.




                                                                                                   263
Das verknüpfte Bild kann nicht angezeigt werden. Möglicherweise wurde die Datei verschoben, umbenannt oder gelöscht. Stellen Sie sicher, dass die Verknüpfung auf die korrekte Datei und den korrekten Speicherort zeigt.




                                                                                                                                                                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                                                                                                                                            264
           4.1.3.11.              OrderXML description
Order header
ORDER.ORDER_HEADER
            OrderXML                       ALFAK                            ALCIM                          Remark
 ORDER_INFO
     ORDER_DATE                            BW_AUFTR_KOPF.DATUM_BEST         unknown
     ORDER_ID                              BW_AUFTR_KOPF.ID                 POOL_AUFTRAG.AUFTNR
     PARTIAL_SHIPMENT_ALLOWED              BW_AUFTR_KOPF.KO_TEILLIEF        unknown
     DELIVERY_DATE.DELIVERY_START_DATE     BW_AUFTR_KOPF.DATUM_LIEFER_TAT   POOL_AUFTRAG.LIEF_TERM
     DELIVERY_DATE.DELIVERY_END_DATE       BW_AUFTR_KOPF.DATUM_LIEFER_TAT   POOL_AUFTRAG.LIEF_TERM
 CONTROL_INFO.GENERATION_DATE                                                                              act. time stamp


ORDER.ORDER_SUMMARY
            OrderXML                       ALFAK                            ALCIM                          Remark
 TOTAL_AMOUNT                              BW_AUFTR_KOPF.FI_BETR_NETTO      unknown
 TOTAL_ITEM_NUM                                                             POOL_AUFTRAG.MENGE_GESAMT      Total number of glass items


ORDER.USER_DEFINED_EXTENSIONS.headerUSER_DEFINED_EXTENSIONS
             OrderXML                    ALFAK                              ALCIM                          Remark
 SYSTEM                                                                     unknown                        always ALFAK
 VERSION                                 KA_FIRMA.VERSION                   unknown
 UDX.AW
      DEFUNITS defunitLength             KA_FIRMA.DIM_DATABASE              POOL_AUFTRAG.MASS_KZ           if 1, then INH (inch),otherwise
                                                                                                           MMT(mm)
      DEFUNITS defunitThickness          KA_FIRMA.DIM_DATABASE              POOL_AUFTRAG.MASS_DICKE_KZ     if 1, then INH (inch),otherwise
                                                                                                           MMT(mm)
     SHAPE shapeCatalog                  KA_FIRMA.KZ_FORM_KATALOG           POOL_MODELL.MOD_KAT            1=AW,2=LISEC,3=BYSTRONIC,4=BILLCO
 UDX.AW.ORDERINFOS
     OriginalOrderID                     BW_AUFTR_KOPF.ID                   POOL_AUFTRAG.ORG_AUFTNR        for complaints:
                                                                                                           BW_AUFTR_KOPF.AH_HAUPT_AUFTR
 UDX.AW.ORDERINFOS.ERP_INFOS
       DeliverInstruction                BW_AUFTR_KOPF.DATUM_LIEFERWUNSCH   POOL_AUFTRAG.LIEF_TERM_W
       EntryDate                         BW_AUFTR_KOPF.DATUM_ERF            POOL_AUFTRAG.ERFASSUNGSDATUM
       EnteredBy                         BW_AUFTR_KOPF.OR_FACHBERATER       POOL_AUFTRAG.ERFASSER
 UDX.AW.ORDERINFOS.Dispatch
       sequence                          BW_AUFTR_KOPF.TOUREN_RANGFOLGE     unknown
       rackTypeID                        BW_AUFTR_KOPF.OR_VERPACKUNG        unknown                        External key KA_VERPACKUNGEN
 UDX.AW.ORDERINFOS.Ordering
       type                                                                 POOL_AUFTRAG.AUFTKZ            Typ(Production, quote, cancellation)
       category                          BW_AUFTR_KOPF.DOK_TYP              POOL_AUFTRAG.AUFTRAGTYP        Teillieferung, MTS, High Volume...
 UDX.AW.ORDERINFOS.Scheduling
       jobID                             BA_NUMKREISE.LAUF_AWPOOL           POOL_AUFTRAG.PLANLAUF
 UDX.AW.ORDERINFOS.OrderNotes.ADVIC
 E
       number=1                          BW_AUFTR_KOPF.BEST_TEXT1           POOL_AUFTRAG.SONDERTEXT1
       number=2                          BW_AUFTR_KOPF.BEST_TEXT2           POOL_AUFTRAG.SONDERTEXT2
       number=3                          BW_AUFTR_KOPF.OR_LIEFERBED         POOL_AUFTRAG.SONDERTEXT3
 UDX.AW.ORDERINFOS.Delivery
       deliveryDay                       BW_AUFTR_KOPF.DATUM_LIEFER_TAT     POOL_AUFTRAG.LIEF_TERM         nur wenn nicht NULL
       calendarWeek                      BW_AUFTR_KOPF.DATUM_LIEFER_TAT     POOL_AUFTRAG.LIEF_WOCHE        Calendar week Delivery tags
       requestedDeliveryDay              BW_AUFTR_KOPF.DATUM_LIEFER_PLAN    POOL_AUFTRAG.LIEF_TERM_W       nur wenn nicht NULL
       description                       BW_AUFTR_KOPF.OR_TOUR              POOL_AUFTRAG.TOUR_INFO
       Route                             KA_TOUR.TOUR_NR                    POOL_AUFTRAG.TOUR              Auftragstour KA_TOUREN
       enrouteDate                                                          POOL_AUFTRAG.FAHR_TERM         next departure date KA_TOUREN
 Mandator                                KA_FIRMA.FILIALNR                  POOL_AUFTRAG.MANDANT           if not ZERO
 Priority                                BW_AUFTR_KOPF.PRIORITAET           POOL_AUFTRAG.PRIORITAET        only if not 1(STANDARD)
 Attachment.DocumentLink link            BW_AUFTR_ATT_KOPF.FILE_NAME        POOL_DOKUMENTE
                                                                                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                                                            265
Customer
ORDER.ORDER_HEADER.ORDER_INFO.ORDER_PARTIES.BYER_PARTY.PARTY
            OrderXML             ALFAK                           ALCIM                                Remark
 PARTY_ID                        BW_AUFTR_KOPF.AH_IDENT          POOL_AUFTRAG.KUNDE_KUNDE_NR
 ADDRESS
     BOX_NO                      BW_AUFTR_KOPF.AH_POSTFACH       unknown
     NAME                        BW_AUFTR_KOPF.AH_NAME1          POOL_AUFTRAG.KUNDE_NAME1
     NAME2                       BW_AUFTR_KOPF.AH_NAME2          POOL_AUFTRAG.KUNDE_NAME2
     NAME3                       BW_AUFTR_KOPF.AH_NAME3          POOL_AUFTRAG.KUNDE_NAME3
     STREET                      BW_AUFTR_KOPF.AH_STRASSE        POOL_AUFTRAG.KUNDE_STRASSE
     CITY                        BW_AUFTR_KOPF.AH_ORT            POOL_AUFTRAG.KUNDE_ORT
     COUNTRY                     BW_AUFTR_KOPF.AH_LAND           POOL_AUFTRAG.KUNDE_LANDESKENNUNG
     EMAIL                       BW_AUFTR_KOPF.AH_MAIL           unknown
     FAX                         BW_AUFTR_KOPF.AH_FAX            unknown
     PHONE                       BW_AUFTR_KOPF.AH_TELEFON        POOL_AUFTRAG.KUNDE_TELEFON
     STATE                       BW_AUFTR_KOPF.AH_PROVINZ        unknown
     ZIP                         BW_AUFTR_KOPF.AH_PLZ            POOL_AUFTRAG.KUNDE_PLZ_ORT
     ZIPBOX                      BW_AUFTR_KOPF.AH_PLZ_POSTFACH   POOL_AUFTRAG.KUNDE_PLZ_POSTFACH
     VAT_ID                      BW_AUFTR_KOPF.FI_UST_ID         unknown


Shipping address
ORDER.ORDER_HEADER.ORDER_INFO.ORDER_PARTIES.SHIPMENT_PARTIES.DELIVERY_PARTY.P
ARTY
            OrderXML       ALFAK                                 ALCIM                              Remark
 PARTY_ID                  BW_AUFTR_KOPF.AL_IDENT                POOL_AUFTRAG.LIEF_KUNDE_NR
 ADDRESS
     BOX_NO                BW_AUFTR_KOPF.AL_POSTFACH             unknown
     NAME                  BW_AUFTR_KOPF.AL_NAME1                POOL_AUFTRAG.LIEF_NAME1
     NAME2                 BW_AUFTR_KOPF.AL_NAME2                POOL_AUFTRAG.LIEF_NAME2
     NAME3                 BW_AUFTR_KOPF.AL_NAME3                POOL_AUFTRAG.LIEF_NAME3
     STREET                BW_AUFTR_KOPF.AL_STRASSE              POOL_AUFTRAG.LIEF_STRASSE
     CITY                  BW_AUFTR_KOPF.AL_ORT                  POOL_AUFTRAG.LIEF_ORT
     COUNTRY               BW_AUFTR_KOPF.AL_LAND                 POOL_AUFTRAG.LIEF_LANDESKENNUNG
     EMAIL                 BW_AUFTR_KOPF.AL_MAIL                 unknown
     FAX                   BW_AUFTR_KOPF.AL_FAX                  unknown
     PHONE                 BW_AUFTR_KOPF.AL_TELEFON              POOL_AUFTRAG.LIEF_TELEFON
     STATE                 BW_AUFTR_KOPF.AL_PROVINZ              unknown
     ZIP                   BW_AUFTR_KOPF.AL_PLZ                  POOL_AUFTRAG.LIEF_PLZ_ORT
     ZIPBOX                BW_AUFTR_KOPF.AL_PLZ_POSTFACH         POOL_AUFTRAG.LIEF_PLZ_POSTFACH


Items
ORDER.ORDER_ITEM_LIST.ORDER_ITEM
                OrderXML         ALFAK                                     ALCIM                                   Remark
 LINE_ITEM_ID                    BW_AUFTR_POS.POS_NR                       POOL_POS.AE_INTPOS,
                                                                           POOL_POS.AUFTPOS
 QUANTITY                        BW_AUFTR_POS.PP_MENGE                     POOL_POS.MENGE_AUFTRAG
 ORDER_UNIT                                                                unknown                                 always C62(pcs)
 ARTICLE_ID.SUPPLIER_AID         BW_AUFTR_POS.PROD_ID                      unknown


ORDER.ORDER_ITEM_LIST.ORDER_ITEM.USER_DEFINED_EXTENSIONS.itemUSER_DEFINED_EXTE
NSIONS.UDX.AW
 OrderXML                        ALFAK                                     ALCIM                        Remark
                                                                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL


 ManufacturingDate               BW_AUFTR_KOPF.DATUM_PROD1                 POOL_POS.PROD_TERM           nur wenn nicht NULL
 ReferenceID                     BW_AUFTR_POS.POS_NR                       POOL_POS.POS_REFERENZ
 Amount                          BW_AUFTR_POS.PP_MENGE                     POOL_POS.MENGE
 Weight                          BW_AUFTR_POS.PP_MENGE                 *   POOL_POS.GEWICHT_POS
                                 BW_AUFTR_POS.PP_GEWICHT
 MainLineItemID                  BW_AUFTR_POS.POS_GRUPPE                   POOL_POS.H_POS
 CoatingVector                                                             unknown                      see 5.)
 View                                                                      POOL_POS.PROD_ANSICHT        always A (view from the outside)
 CUSTOMER_REFERENCES                                                       POOL_TXT                     Special text se 7.)
 RACK
      highQuantity               BW_AUFTR_POS.KZ_SERIE                     unknown                      2=if set, 0=others. Also set for
                                                                                                        MakeToStock order
      typeID                     BW_AUFTR_POS.FER_GEST_TYP                 unknown
      group                      BW_AUFTR_POS.PMGRP                        unknown
      packingQuantity                                                      unknown                      2=MakeToStock, 0=sonst
      targetQuantity             BW_AUFTR_POS.FER_GEST_ANZ                 unknown
 Label
      code                       BW_AUFTR_POS.ETIK_LAYOUT                  POOL_POS.ETIKETT_KZ
      control                    BW_AUFTR_POS.ETIK_STEUERUNG               POOL_POS.ETIKETT_CTRL
 Attachment.DocumentLink link    BW_AUFTR_ATT_POS.FILE_NAME                POOL_DOKUMENTE
 CommercialQuantities
      requestedQuantity          BW_AUFTR_POS.PP_MENGE                     POOL_POS.MENGE_AUFTRAG       calculated in ALCIM
      shortageQuantity           BW_AUFTR_POS.PP_UNTERMENGE                POOL_POS.MINDERMENGE         calculated in ALCIM



                                                                                                                                      266
    surplusQuantity            BW_AUFTR_POS.PP_UEBERMENGE                       POOL_POS.MINDERMENGE              calculated in ALCIM
 Commission
    ADVICE                     BW_AUFTR_POS.POS_KOMMISSION                      POOL_POS.KOMMISSION1
    CustomerLineItemID         BW_AUFTR_POS.POS_KUNDENPOS                       POOL_POS.KD_POS


Sheets on item
level
ORDER.ORDER_ITEM_LIST.ORDER_ITEM.USER_DEFINED_EXTENSIONS.itemUSER_DEFINED_EXTE
NSIONS.UDX.AW.PRODUCTION.PRODUCT

 OrderXML                                 ALFAK                             ALCIM                            Remark
 TypeID                                   KA_PRODUKTGRP.PRDKTGRP_ALCIM      unknown
 bomID                                                                      POOL_TEILE.AE_REFERENZ           always 0
 PRODUCT_ELEMENTS.GLASS_TYPE                                                                                 only for single annealed, toughened,
                                                                                                             laminated, IG, glass doors
 PRODUCT_ELEMENTS.GLASS_TYPE.ARTICLE
      code                                BW_AUFTR_POS.PROD_ID              POOL_TEILE.ARTNR
      name                                BW_AUFTR_POS.PROD_BEZ1            POOL_TEILE.NAME
      name_customerlanguage                                                                                  Text in customer's language
      name_ex1                            BW_AUFTR_POS.PROD_BEZ2            POOL_TEILE.ARTBEZ2
      Name_ex1_customerlanguage                                                                              Text in customer's language
      name_ex2                            BW_AUFTR_POS.PROD_BEZ3            POOL_TEILE.ARTBEZ3
      procurement                         BW_AUFTR_POS.FER_BESCHAFFARTNR    POOL_TEILE.BESCHAFFUNGSART
      productkey                          BW_AUFTR_POS.PROD_WGR             POOL_TEILE.WARENGRP
      structureCode                                                         unknown                          see 2.)
      matchcode                           BA_PRODUKTE.BA_MCODE              POOL_TEILE.KURZ_BEZ              see 3.)
      matchcode_customerlanguage                                                                             Matchcode in customer's language
      typeID                              KA_PRODUKTGRP.PRDKTGRP_ALCIM      unknown
 PRODUCT_ELEMENTS.GLASS_TYPE.GLASS_DATA
      rotability                          BW_AUFTR_POS.FER_STRUKTURVERL     unknown
      width                               BW_AUFTR_POS.PP_BREITE            POOL_TEILE.BREITE
      height                              BW_AUFTR_POS.PP_HOEHE             POOL_TEILE.HOEHE
      thickness                           BW_AUFTR_POS.PP_DICKE             POOL_TEILE.AUFTRAGSDICKE
      coatingtype                         BW_AUFTR_POS.FER_BESCHICH_SEITE   unknown
      patterntype                         BW_AUFTR_POS.FER_STRUKTURSEITE    unknown
      coatingVector                                                         unknown                          see 5.)
      patternVector                                                         unknown                          see 6.
 SUB_PRODUCT                              BW_AUFTR_STKL.BOM_ID              unknown                          Bom IDs of child elements
 PURCHASE_INFO
      purchaseNumber                      BW_BEST_KOPF.ID                   POOL_BESTELLTEILE.BESTELL_NR
 PURCHASE_INFO.DELIVERY_REFERENCE
      DELIVERY_DATE                       BW_BEST_KOPF.DATUM_LIEFER_TAT     POOL_BESTELLTEILE.LIEF_TERM
      DELIVERY_START_DATE                 BW_BEST_KOPF.DATUM_LIEFER_TAT     POOL_BESTELLTEILE.LIEF_TERM
      DELIVERY_END_DATE                   BW_BEST_KOPF.DATUM_LIEFER_TAT     POOL_BESTELLTEILE.LIEF_TERM


Articles/boxes

              OrderXML                    ALFAK                             ALCIM                Remark
 PRODUCT_ELEMENTS.ADDITION                                                                       only for articles and boxes
    amount                                BW_AUFTR_POS.PP_MENGE             unknown
    reference                                                               unknown              always blank
    ARTICLE                                                                 unknown              see PRODUCT_ELEMENTS.GLASS_TYPE.ARTICLE


Bill of materials (BOM)

Sheets on BOM level
                                                                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




            OrderXML                      ALFAK                             ALCIM                            Remark
 bomID                                    BW_AUFTR_STKL.BOM_ID              POOL_TEILE.AE_REFERENZ
 PRODUCT_ELEMENTS.GLASS_TYPE                                                                                 only for single annealed, toughened,
                                                                                                             laminated, IG
 PRODUCT_ELEMENTS.GLASS_TYPE.ARTICLE
         code                             BW_AUFTR_STKL.BOM_PRODUKT         POOL_TEILE.ARTNR
         name                             BW_AUFTR_STKL.STL_BEZ             POOL_TEILE.NAME
         name_customerlanguage            BW_AUFTR_STKL.STL_BEZ                                              Text in customer's language
         name_ex1                         BA_PRODUKTE.BA_BEZ2               POOL_TEILE.ARTBEZ2
         name_ex1_customerlanguage        BA_PRODUKTE.BA_BEZ2                                                Text in customer's language
         name_ex2                         BA_PRODUKTE.BA_BEZ3               POOL_TEILE.ARTBEZ3
         procurement                      BW_AUFTR_STKL.FER_BESCHAFFARTNR   POOL_TEILE.BESCHAFFUNGSART
         productkey                       BW_AUFTR_STKL.STL_WGR             POOL_TEILE.WARENGRP
         structureCode                                                      unknown                          see 2.)
         matchcode                        BA_PRODUKTE.BA_MCODE              POOL_TEILE.KURZ_BEZ              see 3.)
         matchcode_customerlanguage       BA_PRODUKTE.BA_MCODE                                               Matchcode in customer's language
         typeID                           KA_PRODUKTGRP.PRDKTGRP_ALCIM      unknown
 PRODUCT_ELEMENTS.GLASS_TYPE.GLASS_DATA
         rotability                       BW_AUFTR_STKL.FER_STRUKTURVERL    unknown




                                                                                                                                                267
             width                           BW_AUFTR_STKL.STL_BREITE            POOL_TEILE.BREITE
             height                          BW_AUFTR_STKL.STL_HOEHE             POOL_TEILE.HOEHE
             thickness                       BW_AUFTR_STKL.STL_DICKE             POOL_TEILE.AUFTRAGSDICKE
             coatingtype                     BW_AUFTR_STKL.FER_BESCHICH_SEITE    unknown
             patterntype                     BW_AUFTR_STKL.FER_STRUKTURSEITE     unknown
             coatingVector                                                       unknown                        see 5.)
             patternVector                                                       unknown                        see 6.
 ADVICE
             number                          BA_PRODUKT.FER_OPTIKEY                                             always 1
             typeID                                                                                             always 'UserDefined'
             text                                                                POOL_TEILE.SONDERTEXT1         Digits 1-3 of FER_OPTIKEY
             number                          BA_PRODUKT.FER_OPTIKEY                                             always 2
             typeID                                                                                             always 'UserDefined'
             text                                                                POOL_TEILE.SONDERTEXT2         Digits 4-6 of FER_OPTIKEY
             number                          BA_PRODUKT.FER_OPTIKEY                                             always 3
             typeID                                                                                             always 'UserDefined'
             text                                                                POOL_TEILE.SONDERTEXT3         Digits 7-9 of FER_OPTIKEY
             number                          BA_PRODUKT.FER_OPTIKEY                                             always 4
             typeID                                                                                             always 'UserDefined'
             text                                                                POOL_TEILE.SONDERTEXT4         Digits 10-12 of FER_OPTIKEY
 Ordering
             type                                                                unknown                        Transfer     type    (production,    quote,
                                                                                                                cancellation)
          category                           BW_AUFTR_KOPF.DOK_TYP               unknown                        Teillieferung, MTS, High Volume...
 SUB_PRODUCT                                 BW_AUFTR_STKL.BOM_ID                unknown                        Bom IDs of child elements
 PURCHASE_INFO
          purchaseNumber                     BW_BEST_KOPF.ID                     POOL_BESTELLTEILE.BESTELL_NR
 PURCHASE_INFO.DELIVERY_REFERENCE
          DELIVERY_DATE                      BW_BEST_KOPF.DATUM_LIEFER_TAT       POOL_BESTELLTEILE.LIEF_TERM
          DELIVERY_START_DATE                BW_BEST_KOPF.DATUM_LIEFER_TAT       POOL_BESTELLTEILE.LIEF_TERM
          DELIVERY_END_DATE                  BW_BEST_KOPF.DATUM_LIEFER_TAT       POOL_BESTELLTEILE.LIEF_TERM
 ManufacturingDate                                                               POOL_TEILE.PROD_TERM           see 11.)
 ADVICE
          typeID                                                                                                only for stepped glass and always
                                                                                                                'Production'
             key                                                                 POOL_TXT.TEXT_TYP              only for stepped glass, and always '3800'
             number                                                              POOL_TXT.TXT_NR                only for stepped glass, and always '1'
             text                            BW_AUFTR_STKL.STL_BEZ               POOL_TXT.TEXT                  only for stepped glass
             typeID                                                                                             only for stepped glass and always
                                                                                                                'Production'
             key                                                                 POOL_TXT.TEXT_TYP              only for stepped glass, and always '3801'
             number                                                              POOL_TXT.TXT_NR                only for stepped glass, and always '1'
             text                            BW_AUFTR_STKL.BOM_PRODUKT           POOL_TXT.TEXT                  only for stepped glass


Shapes

            OrderXML                                  ALFAK                                  ALCIM                             Remark
 GEOMETRY typeID                                                                             unknown                           always AREA
 GEOMETRY.AREA
    height                                            BW_AUFTR_STKL.STL_HOEHE                POOL_MODELL.HOEHE                 if item includes a shape:
                                                                                                                               BW_AUFTR_POS.PP_HOEHE
     width                                            BW_AUFTR_STKL.STL_BREITE               POOL_MODELL.BREITE                if item includes a shape:
                                                                                                                               BW_AUFTR_POS.PP_BREITE
 GEOMETRY.AREA.SHAPE
    shapeNumber                                       BW_AUFTR_MODELL.MOD_NUMMER             POOL_MODELL.MOD_NR
    dataCode                                                                                 POOL_MODELL.MODELL_KZ             see 1.)
    shapeFile                                         BW_AUFTR_MODELL.MOD_SN_NAME            POOL_MODELL.FORMDATEI
    shapeReference                                                                           POOL_MODELL.FORMNAME              always blank
    DIM.name                                                                                                                   Additional size number (1-8)
    DIM.value                                                                                POOL_MODELL.MASS1-8               Additional size value


Steps
                                                                                                                                                              A+W Software GmbH - Configuration A+W Business - INTERNAL




             OrderXML                                  ALFAK                                   ALCIM                               Remark
 PRODUCT_ELEMENTS.GLASS_TYPE.STEPPING.STEP
       typeID                                                                                  unknown                             always 'laminated'
       edge                                                                                                                        stepped edge 1-8
       shift                                           BW_AUFTR_MODELL.MOD_STUFE               POOL_MODELL.STUFENEINZUG1-          see 12.)
                                                                                               10


Foils

            OrderXML                          ALFAK                                ALCIM                        Remark
 PRODUCT_ELEMENTS.FOIL                                                                                          only for interlayers
    ARTICLE                                                                                                     see
                                                                                                                PRODUCT_ELEMENTS.GLASS_TYPE.ARTICLE
 PRODUCT_ELEMENTS.FOIL.FOIL_DATA
    height                                    BW_AUFTR_STKL.STL_HOEHE              POOL_TEILE.HOEHE
    width                                     BW_AUFTR_STKL.STL_BREITE             POOL_TEILE.BREITE
    thickness                                 BW_AUFTR_STKL.STL_DICKE              POOL_TEILE.AUFTRAGSDICKE




                                                                                                                                                     268
269
A+W Software GmbH - Configuration A+W Business - INTERNAL
Spacer

             OrderXML           ALFAK                          ALCIM                          Remark
 PRODUCT_ELEMENTS.SPACER                                                                      only for spacers
     ARTICLE                                                                                  see PRODUCT_ELEMENTS.GLASS_TYPE.ARTICLE
     typeID                     BA_PRODUKTE.FER_SZR_KZ         POOL_SZR.RAHMENTYP             third digit of the four-digit FER_SZR_KZ
     typeDescription            BW_AUFTR_STKL.STL_BEZ          POOL_SZR.RAHMENTYP_NAME
     shortTypeDescription       BA_PRODUKTE.BA_KURZ_BEZ        POOL_SZR.RAHMENTYP_NAME_KURZ
     Thickness                  BW_AUFTR_STKL.STL_DICKE        POOL_TEILE.DICKE
     Width                      BA_PRODUKTE.SPR_DICKE          POOL_SZR.RAHMENSTAERKE
     colorCode                  BA_PRODUKTE.FER_SZR_KZ         POOL_SZR.RAHMENFARBE           fourth digit of the four-digit FER_SZR_KZ
     colorDescription           BW_AUFTR_STKL.PROD_FARB_BEZ    POOL_SZR.RAHMENFARBE_NAME      if     blank,        then       KA_FARBE.BEZ    to
                                                                                              BW_AUFTR_STKL.PROD_FARB_ID
 PRODUCT_ELEMENTS.SPACER.CUTB
 ACK
     Edge                                                                                     Cutback per edge
     Value                      BW_AUFTR_MODELL.RUECKSCHNITT   POOL_SZR.VERSIEGELTIEFE        Cutback value
 PRODUCT_ELEMENTS.SPACER.GAS
     Code                       BW_AUFTR_STKL.BOM_PRODUKT      POOL_SZR.GAS_ARTNR             Gas in airspace
     Description                BW_AUFTR_STKL.STL_BEZ          POOL_SZR.GAS_NAME
     shortDescription           BA_PRODUKTE.BA_KURZ_BEZ        POOL_SZR.GAS_NAME_KURZ
 PRODUCT_ELEMENTS.SPACER.TEXT
     idExternal                 BW_AUFTR_POS.FER_RAHMENNR      POOL_SZR.BIEGERTEXTNR
     Text                       BW_AUFTR_POS.FER_RAHMENTEXT    POOL_TXT.TEXT
 PRODUCT_ELEMENTS.SPACER.SEAL
 ANT
     typeID                     BA_PRODUKTE.FER_SZR_KZ         POOL_SZR.VERSIEGELTYP          first digit of the four-digit FER_SZR_KZ
     shortDescription           BA_PRODUKTE.BA_KURZ_BEZ        POOL_SZR.VERSIEGEL_NAME_KURZ   only if there is a BOM element with product group
                                                                                              'edge sealing'
       Description              BW_AUFTR_STKL.STL_BEZ          POOL_SZR.VERSIEGEL_NAME        only if there is a BOM element with product group
                                                                                              'edge sealing'


Bars




                                                                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                                                             270
            OrderXML                                      ALFAK                            ALCIM                          Remark
 PRODUCT_ELEMENTS.BAR_GRID                                                                                                only for Georgian bars
               grillPin                                   KA_SPROSSTYP.MASS_RAND           POOL_SPROSSEN.RAND_PFR
                                                                                           OPF
                   typeID                                 BA_PRODUKTE.BA_SPROSSENNR        POOL_SPROSSEN.TYP
                   measurementNotation                                                     unknown                        always 1 (measured from bottom
                                                                                                                          left)
                   symmetry                               BW_AUFTR_SPROSSEN.SPR_BER_       POOL_SPROSSEN.KZ_ASYM          see 13.)
                                                          KZ
                   file                                   BW_AUFTR_SPROSSEN.AWDESIG        unknown                        BLOB for template bars
                                                          N
 PRODUCT_ELEMENTS.BAR_GRID.ARTICLE                                                                                        see
                                                                                                                          PRODUCT_ELEMENTS.GLASS_TYPE.A
                                                                                                                          RTICLE
 PRODUCT_ELEMENTS.BAR_GRID.CUTBACK
              edge                                                                                                        always 'all'
              value                                       BW_AUFTR_POS.RUECKSCHNITT        POOL_SPROSSEN.RUECK
 PRODUCT_ELEMENTS.BAR_GRID.HORIZONTAL_BARS                                                                                horizontal grid elements
 PRODUCT_ELEMENTS.BAR_GRID.HORIZONTAL_BARS.BAR                                                                            one horizontal bar
              HOLE                                        BW_AUFTR_SPROSSEN.SPR_ABST       POOL_SPROSSEN.BOHRP_W1
                                                          AND                              -12
                   grillPin                               KA_SPROSSTYP.MASS_RAND           POOL_SPROSSEN.RAND_PFR
                                                                                           OPF
 PRODUCT_ELEMENTS.BAR_GRID.HORIZONTAL_BARS.BAR                                                                            one segment of a horizontal bar
 .SECTION
          typeID                                                                           unknown                        always 1
          code                                            BW_AUFTR_STKL.BOM_PRODUK         POOL_SPROSSEN_SEG.ART_N
                                                          T                                R
             colorCode                                    BW_AUFTR_STKL.PROD_FARB_ID       POOL_SPROSSEN_SEG.FARBA
                                                                                           RTNR
             colorDescription                             BW_AUFTR_STKL.PROD_FARB_BE       POOL_SPROSSEN_SEG.FARBE
                                                          Z
             description                                  BW_AUFTR_STKL.STL_BEZ            POOL_SPROSSEN.BEZ
             omit                                         BW_AUFTR_SPROSSEN.SPR_ASY        POOL_SPROSSEN_SEG.WEGF         1=segment is an auxiliary bar
                                                          M                                ALL
             width                                        BW_AUFTR_STKL.STL_DICKE          POOL_SPROSSEN_BREITE
             Milling depth                                KA_SPROSSTYP.FRTIEFE             POOL_SPROSSEN_SEG.FRAES        Milling depth
                                                                                           TIEFE
             thickness                                    BW_AUFTR_SPROSSEN.SPR_DICK       POOL_SPROSSEN_SEG.THICK
                                                          E                                NESS
             procurement                                  BW_AUFTR_STKL.FER_BESCHAFF       POOL_TEILE.BESCHAFFUNGS
                                                          ARTNR                            ART
             Color r                                      KA_FARBE.R                       POOL_SPROSSEN_SEG.FARBE
                                                                                           _R
             Color g                                      KA_FARBE.G                       POOL_SPROSSEN_SEG.FARBE
                                                                                           _G
             Color b                                      KA_FARBE.B                       POOL_SPROSSEN_SEG.FARBE
                                                                                           _B
             Color description.                           KA_FARBE.BEZ                     POOL_SPROSSEN_SEG.FARBE
             Trim v                                       KA_SPROSSTYP.BREITEKREUZ         POOL_SPROSSEN_SEG.TRIM_        see 4.)
                                                                                           WERT



likewise for vertical bars (VERTICAL_BARS)


Processing


                OrderXML                 ALFAK                                  ALCIM                            Remark
  PROCESSING                             BW_AUFTR_STKL.PROD_RELEVANT                                             Export only if PROD_RELEVANT=1
      code                               BW_AUFTR_STKL.BOM_PRODUKT              unknown
      typeID                             BA_PRODUKT.FER_OPTIKEY                 POOL_BEARBEIT.AE_TYP
      processingClass                    KA_FERTSCHLS.BEZ                       POOL_BEARBEIT.AE_KLASSE
      sequence                                                                  POOL_BEARBEIT.AE_BEARB_NR        serial processing number * 100, starting from 100
                                                                                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL



      quantity                                                                  POOL_BEARBEIT.MENGE              see 8.)
      reference                          BW_AUFTR_STKL.BOM_ID                   POOL_BEARBEIT.AE_REFERENZ        always blank
      side                               BW_AUFTR_STKL.FER_BESCHICH_SEITE       POOL_BEARBEIT.SCHICHT_LAGE       0=none,1=level 1,2=level 2
      grouping                                                                  POOL_BEARBEIT.GRUPPIERUNG        always 1
  PROCESSING.PROCESSING.ADVICE
      typeID                                                                    POOL_TXT                         always 'UserDefined'
      number                                                                    POOL_TXT                         always 1
      text                               BW_AUFTR_BEARB.BEA_TEXT                POOL_TXT
      typeID                                                                    POOL_TXT                         always 'UserDefined'
      number                                                                    POOL_TXT                         always 3
      text                               BW_AUFTR_STKL.PROD_FARB_BEZ            POOL_TXT                         only for product group coating, silk screening,
                                                                                                                 frosting
  PROCESSING.PROCESSING_ARTICLE
      code                               BW_AUFTR_STKL.BOM_PRODUKT              POOL_BEARBEIT.AE_ARTNR
      name                               BW_AUFTR_STKL.STL_BEZ                  POOL_BEARBEIT.TEXT1
      Name_customerlanguage              BW_AUFTR_STKL.STL_BEZ                                                   Processing text in customer's language
      procurement                        BW_AUFTR_STKL.FER_BESCHAFFARTNR        POOL_BEARBEIT.BESTELL_KZ         Procurement type P.O. and P.O. (completely) is
                                                                                                                 changed to production




                                                                                                                                                             271
Example: rounded
corner

              OrderXML                                       ALFAK                                            ALCIM                                Remark
 PROCESSING.awProcessing
       quantity                                                                                               unknown                              always 1
       quantityUnit                                                                                           unknown                              always C62(pcs)
       typeID                                                BW_AUFTR_STKL.STL_PRODGRP                        unknown                              RoundedCorner
       id                                                                                                     POOL_BEARBEIT.AW_BEARBTYP            1310
       category                                                                                               unknown                              CornerTreatment
 PROCESSING.awProcessing.RoundedCorner
       radius                                                BW_AUFTR_BEARB.BEA_PARAM11                       POOL_BEARBEIT.MASS2
       CornerWork n                                          BW_AUFTR_BEARB.BEA_PARAM1                   -    POOL_BEARB.ECKENMATRIX               Processed corner(1-8)
                                                             BW_AUFTR_BEARB.BEA_PARAM8
        EdgeQuality                                          BA_PRODUKTE.EDGE_QUALITY                         POOL_BEARB.MASS1                     see 9.)


Lieferant (supplier)

ORDER.ORDER_ITEM_LIST.ORDER_ITEM.USER_DEFINED_EXTENSIONS.itemUSER_DEFINED_EXTE
NSIONS.UDX.AW.PRODUCTION.PRODUCT.PURCHASE_INFO.DELIVERY_PARTY

 OrderXML                                                 ALFAK                                          ALCIM                                           Remark
 PARTY_ID                                                 BW_BEST_KOPF.AH_IDENT                          POOL_BESTELLTEILE.LIEF_KUNDE_NR
 ADDRESS
     BOX_NO                                               BW_BEST_KOPF.AH_POSTFACH                       unknown
     NAME                                                 BW_BEST_KOPF.AH_NAME1                          POOL_BESTELLTEILE.LIEF_NAME1
     NAME2                                                BW_BEST_KOPF.AH_NAME2                          POOL_BESTELLTEILE.LIEF_NAME2
     NAME3                                                BW_BEST_KOPF.AH_NAME3                          POOL_BESTELLTEILE.LIEF_NAME3
     STREET                                               BW_BEST_KOPF.AH_STRASSE                        POOL_BESTELLTEILE.LIEF_STRASSE
     CITY                                                 BW_BEST_KOPF.AH_ORT                            POOL_BESTELLTEILE.LIEF_ORT
     COUNTRY                                              BW_BEST_KOPF.AH_LAND                           POOL_BESTELLTEILE.LIEF_LANDESKENNUNG
     EMAIL                                                BW_BEST_KOPF.AH_MAIL                           unknown
     FAX                                                  BW_BEST_KOPF.AH_FAX                            unknown
     PHONE                                                BW_BEST_KOPF.AH_TELEFON                        POOL_BESTELLTEILE.LIEF_TELEFON
     STATE                                                BW_BEST_KOPF.AH_PROVINZ                        unknown
     ZIP                                                  BW_BEST_KOPF.AH_PLZ                            POOL_BESTELLTEILE.LIEF_PLZ_ORT
     ZIPBOX                                               BW_BEST_KOPF.AH_PLZ_POSTFACH                   POOL_BESTELLTEILE.LIEF_PLZ_POSTFACH


Notes

 1.)      Possible values:             1=shape 99,3=shape 98,2=other shapes
 2.)      Possible values:             10000=TG,2000=Standard LG,3000=LG bullet proof,1000=LG cast resin,1=cast resin filling,2=interlayer
                                       filling
 3.)      Option:        production    IF 'Shortname' is active instead of 'Matchcode', the field will be filled from
          transfer                     BW_AUFTR_POS.PROD_KURZ_BEZ
 4.)      Only for non-continuous      If KA_SPROSSTYP.BREITEKREUZ=0, the trim is half the bar width, otherwise half the BREITEKREUZ value
          bars without milling depth

 5.)      See Def. coating vectors     \jupiter\doku_docuware\ALCIM2000\Import\POOL.ASC_Interface\d-alcim-schnittstelle-23.pdf                 Annex C

 6.)      See Def. of sense of         \jupiter\doku_docuware\ALCIM2000\Import\POOL.ASC_Interface\d-alcim-schnittstelle-23.pdf                 Annex C
          pattern
 7.)      See list of special text     \jupiter\DOKU_DocuWare\ALFAK2000\Interfaces\Production_Shipment\User_Manuals\Sondertexte
                                       der Produktionsübergabe (2.3).xls
 8.)      Possible values:             Always 1, except product group 'Processing, where BW_AUFTR_STKL.STL_MENGE
 9.)      Possible values:             0=undefined,8=arrissing,10=fine grinding,11=polishing,65=mitre,66=bevelling,75=additional grinding
                                                                                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




 10.)     See Standard Processing      \hausi\bug\A+W_Allgemein\Entwicklung\Uebergreifende_Projekte\Normierter_Bearbeitungskatalog\K           Paragraph Data structures
          Catalogue   for   other      ON_051128_Normierter-Bearbeitungskatalog.docx                                                           processing parameters
          processing
 11.)     Abhängig            von      1=BW_AUFTR_KOPF.DATUM_PROD1,2=BW_AUFTR_KOPF.DATUM_PROD2,3=BW_AUFTR_KOPF.DATU
          BW_AUFTR_STKL.BOM_LE         M_PROD3
          VEL
 12.)     Attention                    Steps are defined by positive values for the indention, and are transferred as negative values in the
                                       OrrderXML file
 13.)     Possible values:             Drill   hole    symmetry(Alfak=0,OrderXML=2),Field       symmetry(Alfak=1,OrderXML=1),Drill      hole
                                       asymmetry(Alfak=2,OrderXML=3),Field asymmetry(Alfak=3,OrderXML=3),Drill hole symmetry glass
                                       edge(Alfak=5,OrderXML=4),Field         symmetry          glass       edge(Alfak=6,OrderXML=5)Same
                                       length(Alfak=4,OrderXML=6)




                                                                                                                                                                   272
            Automatic transfer to production
Settings:
The transfer to production settings in Master data > Company > Company data > tab Production
serve to define how automatic transfer shall select orders to be transferred:
- By default, selection considers the minimum and lock status of the status point 40 Transfer to
AWPool
- alternatively, you can select all documents with an entry in the capacity planning pool
Formula:
The formula consists of the call for the function udf_AutoTransferProduction. The formula has two
parameters. The first defines the client and the second, the order area. Both values are necessary
to determine the next job number from the number areas. If an empty order area is transferred,
the formula automatically changes this to <n.e.>.
Examples:
udf_AutoTransferProduction(1, '')
udf_AutoTransferProduction(2, 'ESG')
Start-up:
- Define a formula for automatic transfer to production in Master data > Company > Formulas . An
example can be found in the databases DEMO45 and ALF (formula 9010) or in the formula directory
of the ALFAK installation, formula Workflow_AutomaticTransferToProduction.txt
- Allocate the formulas to a workflow task in Master data > Company > Customizing > tab Workflow
Tasks
- Set the Workflow task in Master data > Company > Customizing > tab Automatic




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                              273
         Item-related transfer to production and barcode registration
Target
The work categories (e.g. arrissing, polishing, CNC, silk screening, etc.) are entered in master data
and are printed as barcode tables. After a check, each order is set to ‘Production release’. Work
orders include production barcodes and can be separated for printing by product category; this way
they are allocated to the production pool in ALFAK. At production scheduling, reading of the item
barcodes and allocation of work process categories are used to fill the transfer to optimsation.
Further processing in connection with cutting optimization are possible any time. When the
optimization result has been confirmed, labels will be printed, showing the process categories as
additional information. At the end of production, the item is reported complete by means of the
work order.
The *.ASC file created at transfer to production is processed further by an interface converter called
‘WriteXOpt‘ and is converted to a production file that can be read by ‘XOpt‘.
This is the barcode-supported, manual ‘production transfer‘ from ‘Alfak‘ to ‘Xopt‘. With this
solution, the work orders created in ALFAK get item barcodes and can be split by product category.
After that, the user can allocate processes to production items (also barcode-controlled). After
successful optimization, these will be printed on the sheet labels. This allows a simple but efficient
production organization without additional scheduling instruments.
Work Processes
A production process includes a group of processes. Dialog
‘Master data\Production\Processes‘ allows the defining of new processes and the editing of
existing ones. The input field in the top right corner of the dialog defines the processing that shall
belong to the corresponding process. The relevant processing steps are ticked. The selection of
processing steps is based on the processing types defined in capacity planning. At present, the
number of processing steps in this input field is restricted to 30 for capacity reasons (there can be
more in capacity planning of course). This number can be extended to 60, 90, etc. via database
script and program amendment if necessary.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  274
Fig. 73: Processes

Print
Menu ‚print’ allows to print the selected process as a barcode to be scanned later.
Job creation and transfer to production
Jobs are created in dialog ‘Production/Production/Transfer barcode Prod.‘ You can create a new
job on tab 1, menu ‘Edit/New‘. The job number is determined from the number area for transfer to
production, considering the defined client and PS area. The current job number always appears on
top when you go to tab 2. Tab 2 allows input/amendments only for this job. You can enter any text
(up to 40 characters) in field ‚comment’.

                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                              275
Fig. 74: Barcode production transfer, tab Overview

Show jobs
The maximum number of jobs to be displayed in this table on tab 1 can be set in menu
‘Functions/No. of jobs‘. This becomes interesting when the number of jobs increases because the
jobs will not be deleted at present (e.g. for archiving by period). If the maximum number is
exceeded when you create a new job, the ‘oldest‘ (i.e. the one with the lowest number) will be
deleted. After the jobs have been selected in the dialog, all as yet untransferred jobs will be created;
the remaining space will be distributed to the already transferred jobs.
State
There are two statuses at present: ‚Compiled’ and ‚transferred’. ‘Compiled’ means that the job has
been created; order items might have been entered, and a process may have been defined.
‘Transferred’ means that the interface file Pool*.ASC including job number has been created. Jobs
with this status cannot be changed.
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




Definition of processes
You can use a barcode reader to register the barcodes created in 2.1.1 on tab 2. The processes will
be updated in the table on tab 1 and displayed on tab 2 in the top right corner. The processing steps
included are shown in the field below for information. They cannot be edited at that point. The
system checks if the defined process exists at all.
Codes
The codes tell the program which information the scanned barcode includes. Codes can be freely
configured. This is done in menu ‘Functions/Codes‘. You can enter a one-digit code for each of the
three possible barcodes. This can be a number or a letter. Input does not have to be continuous
(e.g. 1, 2, 3 is possible as well as 7, 4, 6 or G, 3, Z).


                                                                                                    276
Input of orders and items
A barcode reader is used to scan barcodes from production lists on tab 2. These can be order items
or groups of order items. Information is available from item field FORMGRP. Grouping is made
before the forms are printed, in a separate dialog (the function is enabled in management of forms,
report field is FORMGRUPPE). After procesing, the fields will be deleted; the cursor returns to the
first input field, ready for the next scan.




Fig. 75: Barcode production transfer, tab Details

Checks
An item must not be part of different jobs because the items of a job will always be optimised
together, and are only assigned to one process (which can be a combination of several processes,
as explained above). This is why, after scanning the barcode, the system will always check if the
item in question is included in another job. If this is the case, the corresponding job number will be
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL



reported to the user. The item cannot be added to the present job. The system also checks if the
order item exists in ALFAK. It does not check the status, i.e. if the order item has the minimum
status for transfer to production for example. This is not necessary at the stage of compilation. Only
barcodes with a length of 12 digits will be processed automatically. Longer barcodes are invalid. In
case of shorter barcodes, the program assumes that this is a manual input.
Manual input
You can enter any type of data, anytime. Processes can be defined in the combo box on tab 2 or by
selecting the mode ‚process’ in the top left corner, and entering a process number in the barcode
field at the left.
Enter the order item after selecting the mode ‘Order.no.+Itm.no.‘ and entering the order number
in the left field, and the item number in the field on the right. This is the same with the group


                                                                                                  277
number (the group number is just an item number to which other items belong). The left field has
a total length of 12 digits while the right will hold three digits. In case of manual input, the left input
field should hold no more than 11 digits. Otherwise, the program will interpret the input as a
barcode registration; further processing can cause errors because of the wrong structure.
The input will be processed only if the data exist in ALFAK.
Deletion of entries
You can delete entries either on tab 2, or via button ‘Delete all‘ or individually in menu Edit/Delete.
The menu on tab 1 will delete the whole job. Jobs can be deleted or amended only until they are
transferred.
Transfer to production
Transfer to production can be enabled by the Start button on tab 2. The system creates a Pool*.ASC
file with the corresponding job number. Before that, the system will check whether the user really
wants to transfer jobs to production. Unprocessed orders (e.g. because of the wrong status) are
identified by a symbol in the table on tab 2 (valid until a new job is selected or the program is
terminatied).
Status allocation
After transfer to production, all items of this job get the status ‚transfer to production’ (status 40).
Starting from the first item, the order status is ‚item-related transfer to production’ (status 820).
When all production-relevant glass items have got the status ‚released for production’, the order
gets this status too. Status changes will be recorded in the order history. The job status is set to
‚transferred’ (see above).
Displaying the actual status
Menu ‚Production/report overview’ shows the order items that have already been transferred.
Menu ‚Production/report overview’ shows the order items that have already been transferred.
Registration point
Menu ‚Production/report overview’ shows the order items that have already been transferred.
Menu ‚Production/report overview’ shows the order items that have already been transferred.




                                                                                                              A+W Software GmbH - Configuration A+W Business - INTERNAL




4.2. Production release
    •   Only necessary after transfer to capacity planning
    •   Via workflow task in the Exchange Service
    •   Formula Workflow_ReleaseForProduction.txt
    •   Order gets the status from status point 40 Production transfer


4.3. Cancellation
There are two ways of cancelling an order:


                                                                                                       278
    •   Manual transfer, option 'Cancel' set
        The order gets the 'cancel' code in ALCIM, and in ALFAK the status for status point 860
        „Cancelled by transfer to production“. If there is no status allocation for status point 860,
        status point 810 „Transfer to production cancelled“ will be used

    •   Function 'Change locked items at item entry'
        The order gets the 'cancelled' code in ALCIM and in ALFAK the status of status point 810
        „Transfer to production cancelled“
Cancellation via PPS-Webservice is active by default but can be switched off in company master
data (Master data > Company > Company data > tab Production).


4.4. Optimization of quotations
    •   to check the viability of a quotation
    •   Optimization in ALCIM determines the number of plates required  viability
    •   Manual transfer only
    •   No status check and status allocation
    •   Module „Optimise quotations“ requires that the number areas for QUOTATIONS and
        ORDERS differ from each other to prevent that orders which already exist in ALCIM are
        overridden by identical quotation numbers.


4.5. Production Feedback

         A+W Capacity message after scheduling (CompleteScheduling)
After an order has been transferred to A+W Production, a message is sent to the ERP Webservice
after the order has been scheduled. This only happens if the customer has A+W Capacity active.
In the message, the following tasks are taken care of:
    •   Checking whether all items of the order were reported (can be deactivated)
    •   ·Writing back of procurement type (always) and costs, production date, delivery date (if
        activated)
    •   Date entry in A+W Business in case of shortfall if the stock availability check is activated
    •   Date entry in A+W Business if delivery date could not be adhered to
    •   Status update for status points 38 (scheduled in Capa) and 39 (error during automatic
        scheduling)
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




If in A+W Production the procurement type of a part is changed, then only procurement types and
costs are reported back using the same method.
The settings can be made in the company master data (Master Data > Company > Company Data)
on tab 15.Capa Planning.




                                                                                                  279
           Scheduling and completion reports
Registration Points
Definition of reported registration points in Master data > Production > Production registration
points
Overview
   Registration point = ALCIM status      Meaning
   0                                      unscheduled
   100                                    scheduled in batch
   150                                    Detailed Scheduling
   200                                    Production release
   300                                    Start of production
   350                                    breakage on the shop
                                          floor
   700                                    produced
   800                                    Ready for shipment
   900                                    Delivered
Tab. 26: ALCIM status

Additional registration points to be agreed with ALCIM (free allocation of machinery as STSD
report). Registration point must be over 200 for this.
STSP and AWBar reports have to be configured as type „AWBar, STSP“ while STSL, STSD, STSB, STSG
have to have the type „Other“.
P.O. code
Disabled: for the delivery of purchased goods, no registration point will be defined in ALCIM by
default. This is why purchased items cannot be reported. P.O. items will therefore be ignored when
it comes to raising the order status.
P.O. items will therefore be ignored when it comes to raising the order status. If the P.O. code is
disabled in this case, the order status would be raised even if not all of the P.O. items have been
reported.
Status settings for registration points
   Setting                    Action
   first sheet finished       The first sheet report from a registration point triggers the status
                              update for all items and the header
   first sheet of all items   The first sheet report of an item triggers the status update of the
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




   finished                   reported item. The order status will be updated when all items show
                              this status.
   all sheets finished        The item status will be raised when all sheets of an item have been
                              reported. The order status will be updated when all items show this
                              status.
Tab. 27: Increase of status

Status limit produced
Managed in Master data > Company > Company data > tab Production, button Settings
If AWBar, STSP, STSL, STSD, STSB, STSG are being used, you have to select a registration point here
because the report would cause an error otherwise. If the selected registration point is reported,


                                                                                                280
the job number is adopted for the item (FER_LAUF1) and the production date in the header is
(DATUM_PROD3) updated.
Warning:
STSP  Registration point type „AWBar, STSP“
Other STS report  Registration point type „Other“

           File-based production report
Introduction
The feedback files are used by A+W Production, A+W Business PDC, and the Production Manager.
However, the feedback from A+W Production only works with files that are created and imported
by the AIS into the tables FS_POOL_KOPF/FS_POOL. Both other programs generate entries directly
in these.
The report files mainly supply information on the production progress which is used to update the
order status in ALFAK. Apart from that, production date, batch number and balances are analyzed.
Report files:

        4.5.3.1.     AWBar production report (AWB_STAT)
   File name: AWB_STAT.* (FS_POOL-type 7)
      Field name            Item      Length
      Order                 0         14
      Item/Sub-item         14        5
      Registration point    48        3
      Quantity              51        6
      Day                   57        2
      Month                 59        2
      Year                  61        2
      Hour                  63        2
      Minute                65        2
   Tab. 28: AWBar

Description:
Update of order status and production date.
Reports are made mainly by piece.
Usually, the registration points 600, 700, 800, and 900 will be reported.
                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




        4.5.3.2.     Alcim production report (STSP)
   File name: STSP*.ASC (FS_POOL-type 9)
      Field name                 Item           Length
      Order                      5              10
      Position (Fallback)        15             5
      Item/Sub-item              50             10
      Quantity                   97             6
      Batch                      103            8
      Registration         point 118            3
      (Fallback)
      Registration point         135            6


                                                                                              281
     Year                         121        4
     Month                        125        2
     Day                          127        2
     Hour                         129        2
     Minute                       131        2
     Second                       133        2
   Tab. 29: STSP

Description:
These are messages that have no BOM reference in A+W Business (processing to be generated,
etc.). Thus the status of an order can be mapped still more precisely in the ERP system.
Functionality:
Update of order status, production date, header and item sequence number (also in the archive).
Reports are made mainly by piece.

        4.5.3.3.    Scheduling report (STSL)
   File name: STSL*.ASC (FS_POOL-type 10)
      Field name             Item      Length
      Order                  5         10
      Part number            25        10
      Item/Sub-item          50        10
      Bills of material - ID 60        32
      Production item        92        5
      Quantity               97        6
      Batch                  103       8
      Registration point     111       10
      Year                   121       4
      Month                  125       2
      Day                    127       2
      Hour                   129       2
      Minute                 131       2
      Second                 133       2
      Label number           19 9      20
   Tab. 30: STSL

Description:
Thus the production system reports all actions that affect the flows (batch formation, detailed
scheduling, batch release, batch resolution)
                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




Functionality:
Update order status, production date, header batch number (also in the archive). Warning: no
update of the item status. Production date and batch number are only taken over for the
registration point 200.At registration point 0 the status is reset.
The update is done once per order, that is, the first message for an item immediately increments
the order header status.
Usually, the registration points 0, 100, 150, and 200 will be reported.

        4.5.3.4.    Barcode report (STSD)
   File name: STSD*.ASC (FS_POOL-type 11)
      Field name                 Item        Length


                                                                                             282
     Order                        5          10
     Part number                  25         10
     Item/Sub-item                50         10
     Element reference            60         32
     Production item              92         5
     Quantity                     97         6
     Batch                        103        8
     State                        111        10
     Year                         121        4
     Month                        125        2
     Day                          127        2
     Hour                         129        2
     Minute                       131        2
     Second                       133        2
     Machine/Registration point   135        6
     Work type                    147        20
     Rack number                  239        20
   Tab. 31: STSD

Description:
Update of order status, production date, main and item number (also in archives)
Reports are mainly made per piece, i.e. one report is usually made for every element produced.
The status is mostly 700 or status point 48 – produced
If a registration point has been defined but not status allocation has been made, processing and
status update will be done in connection with time management. Otherwise, „Time management
processes STSD and STSB“ in Master data > Company > Interface service must be ticked so that
processing is made by time management.
To make sure that reports can be properly processed by time management, registration point 700
must be selected in the same dialog as STSD registration point if reports are made by ALCIM.

        4.5.3.5.    Rack allocation report (STSG)
   File name: STSG*.ASC (FS_POOL-type 12)
      Field name         Item      Length
      Order              5         10
      Item               15        5
      Production item    92        5
      Quantity           97        6
      Registration point 111       10
                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




      Year               121       4
      Month              125       2
      Day                127       2
      Hour               129       2
      Minute             131       2
      Second             133       2
      Rack number        239       20
   Tab. 32: STSG

Description:
Booking of order item/rack allocations and the quantity reported in table BA_GESTELLE_AUFTR



                                                                                              283
The production list is updated by the total quantities reported for an order item from
BA_GESTELLE_AUFTR ( if the reported registration point matches the registration point defined in
master data for the STSG report)


        4.5.3.6.     Racks received/shipped (STSK)
   File name: STSK*.ASC (FS_POOL-type 13)
      Field name         Item      Length
      Year               19        4
      Month              23        2
      Day                25        2
      Hour               27        2
      Minute             29        2
      Second             31        2
      Registration point 33        2
      Rack number        43        20
      Rack base type     63        40
      Customer #         103       9
      Order              112       10
   Tab. 33: STSK

Description:
Rack booking based on report status (10=off site - first report, 20=off site - amendment, 40=rack on
site)
Unknown racks will be defined as rack type <n.e.>
Status 10 and 20 Update of output date, status 40 Update of return date
The differing address for the rack is determined by the order that belongs to the off site report (10
or 20). The address is determined in the following way.
Shipping address in the main database
Shipping address in the current archives
Shipping address in the last archives
Customer address in the main database
Customer address in the current archives
Customer address in the last archives
The differing address fields will be deleted in case of an ‘on site’ report (40).

        4.5.3.7.     Rack report (AH_GEST)
File name: AH_GEST.DAT (FS_POOL-type 8)
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Structure Booking type, rack number, shipping date, return date, customer             (separated by
semicolon)

Description: After checking whether the customer and the rack exist, the shipment or the return of
the rack will be booked.

        4.5.3.8.     Breakage report (STSB)
   File name: STSB*.ASC (FS_POOL-type 14)
      Field name         Item      Length
      Order              5         10
      Item               15        5
      Part number        25        10


                                                                                                 284
     Element               60        32
     reference
     Production item       92        5
     Quantity              97        6
     Batch                 103       8
     Registration point    111       10
     Year                  121       4
     Month                 125       2
     Day                   127       2
     Hour                  129       2
     Minute                131       2
     Second                133       2
     Machine               135       6
     Work type             147       20
   Tab. 34: STSB

Description:
Reporting of breakage and complaints
Optional creation of complaint orders

Caution: If ALFAK time management is not being used, breakage reports may reduce the order
status! This is done until the current order status lies between minimum status and lock status of
the status point allocated to the breakage registration point.
Otherwise, „Time management processes STSD and STSB“ in Master data > Company > Interface
service must be ticked so that processing is made by time management.
To make sure that reports can be properly processed by time management, registration point 350
must be selected in the same dialog as STSB registration point.

        4.5.3.9.       AWPool report (POOL.DAT)
   File name: POOL*.DAT (FS_POOL-type 16)
      Field name        Item     Length
      Order             0        10
      Item              10       5
      Production item   15       5
      Pieces            20       15
      Batch             25       40
      AwPool status     29       6
      Year              35       2
                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




      Month             37       2
      Day               39       2
      Hour              41       2
      Minute            43       2
      Second            45       2
   Tab. 35: POOL.DAT

Description:
Update of order status, production date, main and item number (also in archives)
Update of item number as from AwPoolStatus 89
Update of production date as from AwPoolStatus 50 or 89
Update of order information as from status limit 'produced'


                                                                                              285
   Allocation of AwPool status and Alfak status is fixed:
      AWPool status Meaning                           ALFAK status
                                                      point
      40              removed from the job            40
      50              ALFERT transfer header          45
      80              Production started              47
      89              Header report                   50
   Tab. 36: AWPool status

          4.5.3.10.   Receivables report
   File name: can be freely defined in the program.
   Structure: Depends on the chosen financial accounting system.
   Description: Report on customer number and balance, credit limit, receivables, and lock code.

          4.5.3.11.   XOPT report (TAG.ASC)
   File name: TAG.ASC (FS_POOL-type 3)
      Aufbau Field name           Item          Length
      (structu
      re)
                Data type         0             1
                Jobnummer         1             8
                Optikey           9             8
                Jobdes            37            20

     or            Data type         0          1
                   Pattern number    1          6
                   IRun              7          6
                   Width             17         15
                   Height            22         5

     or            Data type         0          1
                   Order number      1          6
                   Item number       7          3
   Tab. 37: XOPT

Description:
There are three types of data (main - H, pattern - P, and tag - L). With regards to the main items,
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




the optimization key is used to check whether a product exists, or whether the production key was
entered.
The pattern records define the size, i.e. stock width and height (fraction for Inch fixed 1/32).
The tag records contain order and item numbers.
All data will be collected, sorted, and booked on stock by withdrawing the stocksizes and returning
the sqm records

          4.5.3.12.   Detailed scheduling report (FEIN.ASC)
   File name: FEIN*.ASC (FS_POOL-type 1)
      Field name          Item     Length
      Version             0        5
      File contents       5        1


                                                                                               286
     File type             6          1
     Order                 77         10
     Item                  17         5
     Sub-item              22         5
     Part number           27         10
     Main order            37         10
     Main item             47         5
     Item reference        52         10
     Element               62         32
     reference
     Production item       94         5
     Jobnummer             99         8
     Lot type              107        8
     Batch no.             115        8
     Rack                  123        8
     Rack type             131        1
     Batch                 132        8
     Sequence lot          140        5
     Stack Number          145        5
     Sequence stack        150        5
     Quantity              155        6
     Surcharge flag        161        1
     Serial flag           162        1
     Quantity flag         163        1
     Filler flag           164        1
     Procurement type      165        3
     From label            168        12
     To label              180        12
     Machine               192        8
     Year                  200        4
     Month                 204        2
     Day                   206        2
     Prod.shift            208        4
   Tab. 38: FEIN.ASC

Description:
Alfak contains a special database table for detailed scheduling reports in which all the above fields
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL



are saved, per order, item and BOM ID.
Selection criteria are processed in Alfak for example in production control/production labels for the
selected batch.
An overivew exists but is currently not integrated (abcBomView.apl and abcPickList.apl). This
applies to the different selection functions (e.g. selection by batch number) as well.

        4.5.3.13.      Rack report (*.PTV)
   File name: *.PTV (FS_POOL-type 2)
      Field name         Item      Length
      Version            40        5
      Order              5         10
      Item               15        5


                                                                                                 287
     Sub-item             20          5
     Part number          25          10
     Item reference       35          10
     Element              45          32
     reference
     Production item      77          5
     Rack                 82          12
     Sub-number           94          5
     Sub-quantity         99          5
     CompleteRack1        104         12
     CompleteRack2        116         12
     CompleteRack3        128         12
     CompleteRack4        140         12
     Machine              152         8
     Type                 161         8
     Year                 168         4
     Month                172         2
     Day                  174         2
     Hour                 176         2
     Minute               178         2
     Second               180         2
   Tab. 39: PTV

Description:
Report on actual quantity, rack number, and production date is saved in table LG_TAG
Entry in serial history (data completed by four complete rack numbers as before)
If the reported quantity matches the quantity for this serial in the warehouse table, the entries in
the warehouse table and in table LG_TAG will be deleted; or otherwise changed.


        4.5.3.14.     Unit report (LAB.ASC)
   File name: LAB*.ASC (FS_POOL-type 15)
      Field name         Item     Length
      Version            0        5
      Order              5        10
      Item               15       5
      Sub-item           20       5
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL



      Part number        25       10
      Main order         35       10
      Main item          45       5
      Item reference     50       10
      Element            60       32
      reference
      Label Number       92       12
      Number of labels 104        5
      Label     number 109        12
      Customer
      Product label      121      12
   Tab. 40: LAB.ASC



                                                                                                288
Description:
Update of table BW_ALCIM_EINHEIT (order, item, label number and label quantity) Analysis as rack
load list only for Cardinal

         4.5.3.15.        AWPoll report (UNIT.DAT)
File name: UNIT.DAT (FS_POOL-type 17)
Structure:       Year; month; day; hour; minute; second; status; label;
                 Machine number; user number, rack number;
                 box number, material number, quantity, load number,
                 ScannerID; cost centre, variant, priority, online,
                 sheet number, processing sequence, selection, order,
        item, itemID, elementID.
                 separated by a blank

Description:
Complete move/transfer/splitting of warehouses
Rack booking including management of racks received/shipped, transfer and definition of sides
Update of table LG_TAG by the reported data and stored order data

         4.5.3.16.        Update of table LG_TAG by the reported data and stored order data
   File name: can be freely defined in the program.
      Field name                  Item           Length
      Record type                 0              1
      Invoice type                1              1
      Customer #                  2              77
      Invoice no.                 9              7
      Order number                16             6
      Order date                  22             8
      Invoice date                30             8
      Item number                 38             3
      Product Code                41             8
      Quantity                    49             11
      Net        amount           60             15
      (sales)
      Net        amount           75             15
      (purchasing)
      Representative              90             3
      code
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




      External VAT code           93             4
      Paym. rel. Ext.             97             2
      code
      Order area - ext.           99             1
      code
   Tab. 41: Enterprise resource planning

Description:
The interface in the COM object (abcprocess) is started via the VBS script wwexport.vbs. Here, you
should check the path/directories in the script in advance and correct these if necessary. You can
define the script as planned Windows task, so that the processing is always done at a fixed point in
time.


                                                                                                289
With the function itself, for each order and credit whose status is smaller than the lock status for
status point 504 – Autom.Archiving, one entry apiece is written to an ASCII file. Then the status
105 – Autom.Archivfreigabe is assigned, insofar as the status was previously between 95 – Invoice
printed and 105 – Autom.Archivfreigabe.




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                290
           File-less report
File-less production progress reports from A+W Production serves to replace the STS reports. The
fileless reporting of production progress from A+W Production serves as replacement for the STS
messages. It can be activated regardless of the set capacity planning. However, it cannot be used
in connection with A+W Business Pro since no ERP Webservice is installed here and the feedback
types processed are set permanently. The feedback from the production manager use the file-
related formats (STSL, STSD, and STSB), however the records are written directly into the table
FS_POOL. No files are created.
File-less report results in ALFAK in:
    •    Status update
    •    Adoption of surplus/shortfalls
    •    Adoption of surplus/shortfalls
In contrast to the file-related messages, these are snapshot messages.
Start-up
By enabling the switch file-less report in company master data (tab 13 Production) production
reports are changed to file-less transfer. In ALCIM, the CommonBase switch Use WebService instead
of STS*.ASC has to be enabled as well.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




    Fig. 76 Activating file-less reports

    Activation will disable the control elements for managing the individual STS files so that they
    are inaccessible to the user; all other report formats like e.g. AWPoll or AWBar remain
    unaffected.




                                                                                               291
          4.5.4.1.     Production report
Processing
If both switches are active, ALCIM asks the ERP Webservice to save the production and rack reports.
AIS then books the saved reports and updates the status where necessary. The ALFAK registration
points have to be configured even with this report. All other registration pionts have to be defined
as type „1 – other“ in registration point master data.
With this feedback type (FS_POOL- type 50) the default status 0 – Batch resolved, 100 - rough
planning, 150 - Detailed planning, 200 - Production release, 300 - Production start, 700 - produced,
800 - ready for dispatch and 900 - dispatched are sent.
    Format
        Field Name                     Item       Length
        Order                          1          20
        Item                           21         20
        Registration point             41         10
        Quantity                       51         10
        Ready indicator                61         10
        Day                            81         2
        Month                          83         2
        Year                           85         4
        Hour                           89         2
        Minute                         91         2
        Second                         93         2
        Rack number                    241        40
        Batch Number                   281        20


Booking
The transferred ALCIM status represents the registration point allocation. If allocation has been
made, item status and order status acc. to the settings made for the registration point
    •     0 = Update of all item statuses when the first sheet is reported
    •     1= Update of item status when the first sheet of the item is reported
    •     2= Update of item status based on reports for all sheets
will be reported and updated.
Commercial surplus/shortfall
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




If production is finished, then the quantity reported is taken over precisely into the order item if
the production system reaches the status 700 - produced is sent with the ready indicator 1 -
minimum quantity or 2 - maximum quantity. After the quantity reported complete has been
imported, item and order will be recalculated and saved.

          4.5.4.2.     Production status report
With this feedback type (FS_POOL type 55), the intermediate stati are sent. Thus it is possible to
map the production progress of orders and items very precisely.
Processing
Since for reasons of compatibility this is a new feedback type, the messages for an order are not
necessarily processed chronologically Under some circumstances this can cause problems if an


                                                                                                292
intermediate status is configured in A+W Production that is sent at the same time as one of the
default stati. Such a configuration must be avoided; these status changes must be mapped
completely using the standard stati.
    Format
        Field Name                     Item        Length
        Order                          1           20
        Item / Sub-item                21          10
        Bom-Id                         31          10
        Registration point / machine   41          10
        Work type                      51          10
        Finished Quantity              61          10
        Reject Quantity                71          10
        Total Quantity                 81          10
        Batch Number                   91          10
        Rack number                    101         20
        Day                            12 1        2
        Month                          12 3        2
        Year                           125         40
        Hour                           129         2
        Minute                         131         2
        Second                         133         2




          4.5.4.3.    Rack reports
The reported production racks are imported into ALFAK in field PROD_GESTELLNR der
Positionstabelle BW_AUFTR_POS. This field was added to the interface as it had not been part of
the former specification while haveing a function assigned in ALFAK.
Rack number check through ERP Webservice
The rack keys are different in ALFAK (number and type) and ALCIM (number). This is why the
following process is applied:
    •     If the reported rack number is not known in ALFAK, a new rack is created with rack type
          <n.e.> and the reported number; the report is imported for booking.
    •     If the rack number is clear, the report will also be imported for booking.
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL



    •     If the rack number is not clear, the report will be imported; an error message appears in
          ALFAK Service Monitor and the report will NOT be processed.
Booking of racks in ALFAK
All bookings can include rack/order allocations.
    •     Status 100-Receipt: Deletes the existing allocation and books the rack received
    •     Status 750-repacked: Deletes the existing allocation and books the reported rack/order
          allocations
    •     Status 800-packed: Deletes the existing allocation and books the reported rack/order
          allocations
    •     Status 900-shipped: Books the rack/order allocations and shipment of rack (if the rack only
          holds orders from one customer)


                                                                                                 293
Format
        Field Name                     Item      Length
        Rack Status                    0         2
        Rack number                    2         20
        Year                           23        4
        Month                          27        2
        Day                            29        2
        Hour                           31        2
        Minute                         33        2
        Second                         35        2
        Order                          37        10
        Item                           47        10
        quantity                       57        68
        Barcode                        63        40
        Machine number                 10 3      10
        Rack Type                      113       40


The transferred rack status provides the mode of the booking:
    •    1 = rack received
    •    2 = packing (not supported)
    •    3 = rack load
    •    4 = rack out
    •    5 = rack rebooking


Online production overview
The order's exact production progress is checked online in ALCIM and displayed in dialog Status
Report List at order entry (menu Production > Production list). The display of the HTML page
returned by the PPS Webservice is managed by ALCIM.


4.6. Production overview
Dialog 'Status report list' in Documents > Order > Order > menu Production The user can display
the production progress of orders here. There are generally two modes in the dialog, which can
swapped between under Options > Production overview
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




           Registration point overview
Data from the booking table PD_AWBAR is displayed here in relation to the set up registration
points. The display always only counts for one order.
If the right has change rights in this dialog, incorrect entries can also be corrected here. The data
can simply be edited in the table. If the user makes an entry, the new status for positions is
automatically calculated and shown in the upper part of the dialog. The user can also make manual
corrections here. The amended data is saved with save. Furthermore, a check is performed on
whether the user has the necessary rights to upgrade/downgrade the status and, if not, the status
changes are not performed, which is then shown in detail to the user.




                                                                                                 294
Fig. 77 Registration point overview

With the script 20170923a.sql, the new status point 993 has been added. If an assignment is
created for this status point, this status point is used for the history entry. In addition, via this status
point, a minimum and lock status can be specified for the changing of the order status.
If the status assignment is not present, the status point of the status to be assigned is used, however
it does not absolutely have to be unambiguous (if two different status points reference the same
status). If no status point is found, the status point 2 is used.

           Online production overview
The online production overview obtains its data directly from the PPS Webservice. The data is taken
from a report, either as an HTML or a PDF.

         4.6.2.1.       HTML overview
                                                                                                               A+W Software GmbH - Configuration A+W Business - INTERNAL




This view is active if only the PPS Webservice address is configured in the company master data.
The display always only counts for one order.




                                                                                                        295
Fig. 78 HTML overview

        4.6.2.2.        Report overview
The new online production overview offers the option of creating a report from the PPS
Webservice. This can even be displayed for several orders at the same time if the production
overview is retrieved from a number manager.
For this, production of the report and any of its parameters must be set on register 13 in the
company master data.
The       entered    text      must     be       in       the     following       form:
Report=//awbawp60/Trans/Reports/BDE/AUW_OrderList_Status.rpt&Unterteile_anzeigen=1&Au
ftrag=[OrderList]
The rpt file to be used is stated under Report and linked to the report parameters with &. The text
[OrderList] is replaced with the corresponding order numbers before transfer to the PPS
Webservice.
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               296
Fig. 79 Report view


4.7. Capacity overview
In the capacity overview, it is possible to view the free and assigned capacities from A+W Capacity
in A+W Business. Here, the user can change among different views. Thus it is possible to display the
capacities by shift or day or for a particular machine or machine group. Furthermore, you can view
the capacities summed up by time, pieces or quantity.
The overview can be opened in the order entry under View > Capacity Overview > Capacity
Overview if the license 150 has been enabled. Furthermore, the A+W SOA services incl. A+W
Corporate Web must be installed and the URL filled for AWSOA services on tab 10.System of the
company data.
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                297
Fig. 80 Capacity overview 1
From this view it is possible with a click on the blue bar to change to a detail view in which the data
is displayed by order or batch.




                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 81 Capacity overview 2


4.8. Production orders

           Installation
To enable this function, the programs abcauftr.exe, abcstamm.exe, abclagwirt.exe and abcfert.exe
need to be updated, and the scripts 20080910a.sql, 20090129a.sql, 20090130a.sql and


                                                                                                   298
20090312m.sql have to be run on the database. Script 20090129a.sql is language-dependent and
has to be installed in the language configured in the database.

           Definition of work orders
Work orders are used to replenish the stock on hand. All articles entered in such an order have the
supply type Production; unlike common orders, they will not be reserved on stock but marked as
‚ordered’.

         4.8.2.1.       Manual input
The only feature of a work order is the document type of the order (see illustration 12). Manual
input of work orders is therefore restricted to selecting the type in the order header.




Fig. 82: Document type of the work orders at order entry

Creation via program „Copy documents“
To create a work order based on a common customer order, the customer order can be used as the
source in program „Copy documents“. Please make sure to select the right document type for the
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL



target document. This has to be set to Work order. To adopt only certain items from the customer
order, you can select them on the second tab as usual. This is also where you can amend the
quantity.




                                                                                               299
Fig. 83: Program „Copy documents“ with the work order as the target document




                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 84: Item selection in the copy program




                                                                               300
          4.8.2.2.        Automatic creation through a shortfall of the stock on hand
Based on the definition of a minimum stock and a standard order quantity for the stock article, the
system can automatically create purchasing suggestions. Dialog Stock P.O. in stock management is
used for this purpose. Usually, this dialog serves to create purchase orders of the type Stock P.O.
By defining suitable references in the supplier file, work orders can be created automatically
however.
On product group or article number level, an internal customer is entered in the supplier file for
whom the work order is created automatically.




Fig. 85: Supplier file for creating internal work orders

The settings for the article number (tab 1) have priority over the settings on product group level
(tab 2).
When the stock P.O. dialog is started, a storing place can be selected first, the stock of which shall
be checked before purchase suggestions are created. Click on the OK button to start the analysis.
The program checks whether the current stock on hand plus the ordered quantities and minus the
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL



existing, reserved quantities will fall below the minimum stock on hand. If this is the case, the
purchasing suggestion will be the multiple of the standard order quantity. The multiplier will be
calculated so that as a result of the P.O. proposal the minimum stock is exceeded. Before the actual
work order is issued, you can select the articles and amend the quantities if necessary. Click once
more on OK to create the work order in the last selected order number manager.




                                                                                                  301
Fig. 86: Automatically created purchasing suggestion for a work order




                                                                              A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                        302
           Completion report for work orders
To add the products for this work order to stock, you do not have to issue an invoice or delivery
note as usual. This is done instead by a status report or by means of the program „production data“.
First, create a registration point. Then allocate to this registration point a status starting from which
the goods are considered ‚produced’.




Fig. 87: Registration point and allocated status

No enter this registration point in company master data, field „Status limit for registration point“.




Fig. 88: Registration point and status limit in company master data

When an item of a work order gets a status report from this registration point, the item will be
added to stock. This status report can be made by hand or automatically via ALFAK Interface Service.
The dialog for manual booking is found in the production program, in menu „Despatch – Status
report“.
                                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                     303
           Completion report for work orders and withdrawal of raw material
Another way of reporting work orders complete is to enter the raw material used and all
production-relevant data for the work order. With the ensuing booking, the raw material is
withdrawn from stock; the corresponding items of the work order are added to stock. Prerequisite
for this is the configuration of the registration point and the status limit (see illustrations 35+36).




Fig. 89: Dialog for entering production data

The production details are entered and booked in the production program, menu „Production-
Production data“.
This is where all data required for production are entered. These are: the production date, the
machine and shift, and the employee in charge. Next, enter the work order and the corresponding
item. The program now automatically displays the data of the finished product. The number of
produced units is defined after that. If the program is to automatically allocate box IDs at booking,
tick the corresponding checkbox. This allows you to enter different contents. If the product is a box
with a complex BOM in which the glass is not the first BOM element, the contents cannot be
changed.
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




In section ‚production details’, enter the production times and the number of employees required
for production. A combo box allows to enter a reason for possible losses. You can choose one of
the predefined reasons.
Lastly, enter the raw material used for production. Lastly, enter the raw material used for
production.
When all data have been entered, booking can be started on tab 3. This tab shows all entries for
the corresponding production date and machine. Double-click on a line or use the button above the
table to select the data to be booked. Click on OK to start the booking.




                                                                                                   304
Fig. 90: Selection of data to be booked

Booking starts with a check of data. After that, the production orders involved will be locked during
booking. Stock articles from the work orders are added; if necessary, new sub-items are created to
be able to handle boxes with unique IDs. The raw material is then withdrawn from stock; if the work
order is complete now, the status is set acc. to the defined settings and an history entry ia made.
The locked documents are released again afterwards.
Once the booked records have been processed successfully, they cannot be selected and edited.
The product structure of the items of the work orders that include at least one booked stock article
cannot be changed any longer.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 305
          Use of BOM elements in a production order
So that BOM elements that are required for the production of the final product can be removed
from stock in production orders, a new switch has been added to the company master data. This
"Consumption of BOM elements for work orders" option is activated in the company master data
on the "7.Stock/PCH/EDI" tab. If this option is activated, a stock-managed BOM element is removed
from stock in production orders and the product of the main item is booked into the stock.




Fig. 91: Company master data "Consumption of BOM elements for work orders" option

A brief example is provided below, which should clarify the use of this functionality.
Application example:
Insulated glass should be recorded in a production order, which contains TG in the BOM. The result
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




after the reporting of the production order should be that the insulated glass is booked to the stock.
Since the TG is used to make the insulated glass, the TG, by contrast, should be removed from the
stock.
Furthermore, a normal customer order should be created for the same insulated glass with TG. In
this order, only the insulated glass should be removed from the stock. The TG is not managed as
stock since it has already been removed from stock by the production order.




Required settings:



                                                                                                  306
    1. In the company data on tab "5.Parameters," the "Activate product ID search" option must
       be switched off.
    2. In the main product, the insulated glass is assigned the procurement type "Removal from
       stock."
    3. In the main product, the TG is assigned the procurement type "Removal from stock."
    4. The TG in the BOM of the insulated glass is assigned the alternative procurement type
       "Production"
Result:
In the production order, the insulated glass is added to the stock and the TG is removed. In the
customer order, only the insulated glass is removed from stock. The TG in the BOM of the insulated
glass is not booked in the stock. If the TG is recorded individually as main product in a customer
order, then the TG is also removed from the stock.




4.9. Linking of master data
    •     Synchronisation of sheets, processing steps, Georgian bars, fillings, articles, spacers, glass
          type groups, glass types, tables, jumbos, and jumbo/table allocations between ALFAK and
          ALCIM
    •     Is enabled by entering the ALCIM server in Master data > Company > Company data > tab
          Production
    •     Setup see internal documentation
          \\jupiter\DOKU_DocuWare\ALCIM2000\Alcim_Alfak\Installation_Configuration\DE-
          Alfak_Alcim_BaseDataSychronisation.pdf (German)
    •     or
    •     \\jupiter\DOKU_DocuWare\ALCIM2000\Alcim_Alfak\Installation_Configuration\ EN-
          Alfak_Alcim_BaseDataSychronisation.pdf (English)
    •     The script \\jupiter\ALFAK_Install\SQL-Skripte\INITALCIMEVOLUTION43.sql can be used for initializing
          the master data link in ALFAK.
    The list of allocations of ALFAK product groups and ALCIM article types.
          ALFAK product group                     ALCIM key                               ALCIM type
           Float glass cut size                   100                                     1
                                                                                                                 A+W Software GmbH - Configuration A+W Business - INTERNAL



            Patterned glass cut sizes             110                                     1
           PVC-U cut sizes                        120                                     1
           Special glass cut sizes                130                                     1
           Cast resin cut sizes                   140                                     9
           Door systems toughened                 149                                     0
           Toughened glass                        150                                     6
          Fire protection glass cut sizes         160                                     8
           Laminated glass articles cut           170                                     8
          sizes
           Decor. glazing                         175                                     0
          Interlayer cut sizes                    176                                     10


                                                                                                          307
Fire protection glass filling         177   10
 Float glass stocksize                180   0
 Patterned glass stocksize            181   0
 Special glass stocksize              182   0
 Laminated       glass     articles   183   0
stocksizes
 Cast resin stocksizes                184   0
  PVC-U stocksizes                    185   0
Interlayer stocksizes                 186   0
Fire protection glass stocksizes      187   0
 IG articles                          200   7
 IG-Spacer                            210   12
 IG spacers, colored                  211   12
 Spacer                               220   12
Grid pattern                          225   13
 Bars                                 230   13
  Grid crosses                        231   0
  Grid edge                           232   0
  glued-on bars                       235   0
  Sealants                            240   0
  Drying agents                       250   0
  Gas                                 260   0
 Edge prot.                           270   0
  Capillary insert                    280   0
 Foils                                300   10
  Color layer                         320   0
  Resin                               340   11
 Boxes                                350   0
  Glass bricks                        370   0
  Multiplex glass                     380   40
  Glass doors                         400   4
  Frosted elements                    401   0
 Glass Cutting                        505   0
                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL



 Qty. stepped IG                      510   0
Multiple steps                        511   0
 Bending                              512   0
 Cambering                            513   0
 Heat Treatment                       515   0
 Heat Strengthening                   516   0
 Laminating                           518   0
Laminated glass production            519   0
 Glazing                              520   0
Fire       protection        glass    521   0
production


                                                 308
 Assembly                    525   4
 IG production               530   0
 Airspace filling            531   0
 Spacer production           532   0
 Georgian bar construction   534   0
 Basic assembly              535   0
 other processing            540   0
 Packing                     545   0
 Grinding                    550   0
 Miters                      551   0
 Fluted bevelling            552   0
 Arrissing                   553   0
 Drilling                    560   0
 Counter-sunk hole           561   0
 Rounded corners             565   0
 Cut-off corners             566   0
 Corner cut-out              570   0
 Edge cut-out                571   0
 Handles                     575   0
 Ticket window               580   0
 Color application           584   0
 Enameling                   585   0
 Etching                     586   0
 Sandblasting                587   0
 Screenprinting              588   0
 Coating                     589   0
 Enamel strip                590   0
 Stamp                       591   0
 Pressure compensation       594   0
  UV protection              595   0
 Inside thread               596   0
 Edging                      597   0
 Moulding                    598   0
                                             A+W Software GmbH - Configuration A+W Business - INTERNAL



  Gluing                     599   0
 Rails                       600   0
 Pipes                       610   0
 Heat soak                   700   0
Wood cut sizes               701   0
Wood stocksizes              702   0
 Wood cutting                703   0
Interlayer cutting           752   0
 Accessories                 800   0
 Sheet metal                 820   0
 Hardware parts              830   0


                                       309
   Locks                                 840               0
   Handles                               850               0
   Alarm transmitters                    870               0
  Deposit invoice                        995               0
  Article text                           996               0
   Item text                             997               0
   Production type text                  998               0
   Other articles                        999               0
   Tab. 42: Allocation of product group and element type

Meaning of column 3 ALCIM element types
  0            Non glass articles
  1            Basic glass
  2            Trade glass
  4            Assembly (articles)
  5            Annealed
  6            Tempered glass
  7            Insulated Glass
  68           LAMI
  9            Cast Resin Unit
  10           LG interlayer
  11           Cast resin
  12           Spacer
  13           Georgian bar
   Tab. 43: ALCIM element types




                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                               310
4.10. Surplus

    •    From version 2011
    •    OrderXML only
    •    Transfer of surplus and shortfalls
    •    Report on the actually produced quantities only file-less
For products and customers for which surplus production shall be possible, percentages for surplus
production have to be defined in the corresponding administration progam Master data > Ppartner
> Customer > Surplus.




Fig. 92: Customer-related surplus

If an order item is entered with a surplus definition for customer and product, the fields
PP_UEBERMENGE and PP_UNTERMENGE will be filled in the order as rounded quantities based on
the PP_MENGE quantity defined and the proportional surplus:
Example: 10% surplus have been defined in master data for customer 1002 and product 550001. If
100 pieces are entered, PP_UEBERMENGE is 10).
                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                              311
Fig. 93: Surplus at item entry

Transfer to production:
Surplus can be handled only by the OrderXML format. Surplus and shortfalls are transferred to
production in separate fields, SURPLUSQUANTITY and SHORTAGEQUANTITY.
Surplus and shortfalls are transferred to production in separate fields, SURPLUSQUANTITY and
SHORTAGEQUANTITY.
Surplus and shortfalls are transferred to production in separate fields, SURPLUSQUANTITY and
SHORTAGEQUANTITY. Surplus and shortfalls are transferred to production in separate fields,
SURPLUSQUANTITY and SHORTAGEQUANTITY.




                                                                                                A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                          312
4.11. Notification of order information and receipt of goods
    •   Enabled in Master data > Company > Company data > tab Production > Goods received
        report > via PPS-Webservice
    •   Direct update in ALCIM via PPS-Webservice or asynchronous transfer
    Transfer can be synchronous or asynchronous In the case of the asynchronous transfer, the
    information is written to the table FS_BESTELLINFOS and can be transferred to the production
    system with the workflow Task Workflow_UpdatePOInProduction. The advantage of
    asynchronous transfer is that the user does not have to wait during the action. On the other
    hand, depending on the time interval this may lead to delays until the purchase order data
    arrives in the production system.
    The information is transferred for the following user actions:
        •   Transfer to purchasing
        •   A purchase order change (order entry or document data)
        •   Cancellation of an order item that has already been transferred to a purchase order
            (leads to the deletion of order information in the production system)
        •   Receipt of goods and OC supplier (notification of delivered quantities)
        •   Creation of a complaint for a purchase order
The purchase order information is only transferred if the order has been transferred to production
(status of the order is larger than the status of the transfer to production or reservation transfer).




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  313
4.12. Miscellaneous
    •    Special text at transfer to production: see internal documentation
         \\jupiter\DOKU_DocuWare\ALFAK2000\Interfaces\Production_Shipment\User_Manuals\ Sondertexte der
         Produktionsübergabe (2.3).xls
    •    Item text will be transferred to production if the text code for production transfer permits
         the transfer (e.g. P). The text type is the external key for the text as defined in text master
         data, in Master data > Text > Text. If no external key has been defined, text type 1 will be
         transferred by default.
    •    Additional processing record Pool.asc: If ALFAK time management is active, an additional
         processing record (record type 6) will be created for every element of the item. Time
         management information like processing sequence, shift, work type, ALCIM number, and
         duration will be transferred to Techsoft.
    •    Automatic SN file creation as from Version 2011: Before the SN files are created, the
         program now analyses the minimum and lock status of status point 740 „SN-file checked“.
         If the current status is not somewhere between minimum and lock status, no SN file will be
         created, and the status will not be raised. If SN file creation causes an error (e.g. drill hole
         without sizes), the user will be informed, and the status will not be raised. By setting the
         minimum production transfer status to the status of SN file creation, you can prevent
         documents with errors during SN file creation from being transferred to production.
Interaction of STSG and partial shipment:
For partial shipments (Documents > Order > NM order > Functions > Partial shipment) the number
of partial shipment items can be determined by the quantity reported packed via STSG.
Enable the option „Partial shipment quantity > Consider rack report for partial shipments“ in the
dialog.




                                                                                                                A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 94: Partial shipment > option Partial shipment quantity




                                                                                                          314
After that, the number of partial shipment items cannot be changed, and is preset by the total
quantity as per STSG reports for the corresponding order item.
Example: the order item contains 100 pcs. of float 4mm; 90 pcs. have been reported packed on
racks via STSG. A partial shipment of 90 pcs. shall be made now. The partial shipment dialog defines
the target quantity as 90 pcs. if the option „Partial shipment quantity > Consider rack report for
partial shipments“ is active; this cannot be changed. There is a partial shipment of 90 pieces now;
the quantity of the original item is corrected to 10.




Fig. 95: Partial shipment > tab Copy by item


4.13. STST archiving
    •    Is enabled in Master data > Company > Company data > tab Archives > Archiving in ALCIM
         by entering the path
    •    STST file starts archiving of orders in ALCIM by reporting the status 1950
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                315
4.14. Transfer to production (OrderXML) and feedback

       General
  •   Transfer to production in OrderXML format requires installation of the ERP web service in
      the version matching the ALFAK version. The URL of the ERP-Webservice is valid for the
      transfer to and reports from production in OrderXML format, and is managed in the settings
      for transfer to production (Master data > Company > Company data > tab Production)
  •   Various functions (cancellation of orders, goods received reports to ALCIM) require
      installation of the TechSoft PPS web service. The URL of the PPS web service can be
      managed in ALFAK in Master data > Company > Company data > tab Production.

       Standard transfer
  •   Orders are transferred to production with the order code; the report is made in the same
      way.
  •   Quotations can be optimized any time.
  •   All documents are separated by document type and are reported acc. to the type
      transferred to production (orders as orders, quotations as quotations).
  •   The standard transfer always includes a release for production with capacity reservation,
      rough and detailed scheduling, etc.




                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                            316
           Illustrated standard transfer process




                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL



Fig. 96: Illustrated standard transfer process




                                                   317
     Status allocation in DEMO44

   Status point                User status               Minimum status            Lock status

   35 - Production release     35 - Production release   0                         35 - Production release
   40 - AW-Pool transfer       40 - AW-Pool transfer     35 - Production release   43 - Scheduled in detail


  Tab. 44: Status allocation in DEMO44
                                                                                                    Manual
transfer to Production
        Manual transfer transfers all orders of the number manager with a status of 35-
        Production release or higher, and below status 43-Scheduled in detail.
Automatic transfer to Production via workflow task
        The transfer via work-flow task and formula 9003 „Work-flow task transfer to
        production“ transfers all orders with a status of 35-Production release and higher, and
        below status 43-Scheduled in detail, and also makes an entry in table BW_LOCK_KAPA
        (field STATUS includes the value 0).

     Cancellation of transfer to production
Items already transferred to production cannot be changed easily at item entry. Should this still
be necessary, a call of the TechSoft PPS web service is available in menu Documents > Order >
Order > tab Item > Functions > change locked item for cancelling the transfer to production.
If status point 810 „AWPool transfer cancelled“ is allocated to a user status, cancellation will
reset the order status to the required user status (status reset!). If status point 810 has not
been allocated, the order maintains its former status.
Cancellation should be possible only up to the transfer to purchasing.
Example DEMO44: an order which has been transferred to production has status 40.
Cancellation will not change the status. After a structural change (quantity, sizes..) the order
shows the value 0 in table BW_LOCK_KAPA and is therefore immediately transferred by
automatic transfer to production by means of the work-flow task „Workflow task transfer to
production“ (because formula 9003 selects all orders with a status of 35 to 42 AND a status
value of 0 in table BW_LOCK_KAPA and transfers them to production).                                             A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                          318
Fig. 97: Cancellation of transfer to production


           Order transfer to capacity planning
    Can only be run as a work-flow task with function udf_TransferToCapacityPlanning in AIS.
    Example formula: Workflow_TransferToCapacityPlanning.txt in formula directory of the ALFAK
    installation.
    Orders will get OrdCd 90 (like quotations) and are only scheduled for capacity reservation
    purposes. After the report from capacity planning, the order must be released for production
    so that it can be produced. Production release is done by calling the PPS-Webservice of
    Techsoft, also by means of a work-flow task (Workflow_ReleaseForProduction.txt).
    Quotations cannot be optimised in this mode because otherwise, orders and quotations would
    be passed on to production with the same code. Since a global flag has to be enabled for
    capacity reservation of orders in Techsoft, reservation would also be made for quotations,
    which is wrong.
                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               319
Fig. 98: Order transfer to capacity planning 1

Reporting of the correct document type has to be enabled by the switch OrderXML transfer type of
orders by setting as order always




                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 99: Order transfer to capacity planning 2




                                                                                             320
           Illustrated process: transfer to capacity planning




                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 100: Illustrated process: transfer to capacity planning




                                                                321
           Automatic transfer to production

Mode 1: Standard, by status point 40 AW-Pool transfer
Mode 2: based on an entry in table BW_LOCK_KAPA (structural changes of an order will enter the
order in this table again so that it can be transferred once more)
Setting in company parameters




Fig. 101: Automatic transfer to production


           Production Feedback

Report from capacity planning acc. to the ERP-Webservice method CompleteScheduling
Reporting of 1. costs, 2. availability on stock, 3. change of supply type, 4. production date update,
5. status update (1st – 4th CommonBase switch on or off)
Configurable in CommonBase management by a switch in Enterprise ERP  Webservice 
AWCapacity
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL



The supply type can be changed in ALCIM (only for laminated galss; change of supply type from
productoin to stock withdrawal and vice versa). Together with the recalculated costs, this change
is reported to ALFAK via ERP-Webservice.

                  Initial status process of an order

Order entry (through the user)
Checking the order for purchased elements (via work-flow task)
Transfer of the order to capacity planning (via work-flow task)
Report from capacity planning (via ERP-Webservice)
Entry for the user to print the order confirmation (via work-flow task)
Printing of order confirmation (by the user)


                                                                                                 322
Automatic release for production two hours after printing of order confirmation (via work-flow
task)

                     Transfer of customer's language via OrderXML
The customer language can now be transferred to A+W Production by OrderXML in the
CustomerLanguage field. For this, it is necessary to initialize the two scripts 20160411a.sql and
20160412a.sql and then allocate the respective country codes in the languages.




Fig. 102 Languages

Then the code is transferred via OrderXML in the set customer language for order entry.




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 103 Customer's language in OrderXML




                                                                                              323
                   Type codes for file annex types
It is now possible to allocate a numerical type code to the file annex types in A+W Business. The
codes can be allocated in the dialog once script 20160523a.sql has been initialized.




Fig. 104 File annex types

These codes are transferred to production with the file annexes by OrderXML and can be used to
only display annexes of a certain type to various production terminals.




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                              324
               Fileless OrderXML transfer

Architecture overview:




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




In order to activate the production transfer by the Commercial Exchange SErvice, the following
scripts must be executed: 20190125a.sql, 20190326a.sql, 20190406a.sql and 20190408a.sql.
Before the fileless OrderXML transfer is activated, it must be checked whether the Planning Import
Service is installed and active. In case of doubt, the Import Service must be installed.




                                                                                              325
If the Planning Import Service is not installed, the OrderXML will not be generated and the Exchange
Service will write an error to the Commercial.ExchangeService trace file.
If the Planning Import Service is used, it should be checked that the Infrastructure Service is
configured correctly in order to work with the A+W Production databases.
Make sure that you have selected the correct AWSOA database in the "Infrastructure Config" tool
(Start menu > Programs > A+W > Config Tools > A+W Infrastructure 6 Config Tool).




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




Make sure in the infrastructure web interface (Start Menu > Programs > A+W > A+W Infrastructure
6 Web) that you have set the correct production database for the client (Configuration menu
element > A+W Production > Database Connection}:




                                                                                                326
After that, please restart the Infrastructure Service.
If all values are configured correctly, the Exchange Service can be started. With the start of the
Exchange Service, the Planning Import Service is also started. The state of the services in the Service
Locator Administration Tool (Start Menu > Programs > A+W > Config Tools > Service Locator
Administration) should be the following:




                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                   327
In order to activate this fileless export option, the option: “Without ERP Webservice” must be
selected. This option can be found under "Settings Orders" and "Settings Quotation" on the Master
Data > Company > Company Data dialog on the 13.Production tab dialog.




After that, the transfer of the files can take place without ERP Webservice and only with the
Exchange Service.
Important: The writing of the files is done starting from that moment by the Exchange Service. The
ERP webservice is no longer involved and for this reason, the options for the ERPWebservice are
deactivated.
In order to activate the fileless export, the option: “Fileless Export” must be selected.




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               328
After the fileless OrderXML transfer has been selected, the fields for the path and the ERP
Webservice URL are no longer needed and are deactivated.
The OrderXML files are now saved in the database in the Order XML table BW_ORDERXML.

The number of storage days of the OrderXML data records can be defined in the company data on
the Master Data > Company > Company Data dialog on the tab 9. Daily Closing:




The default value is 7 days.

The deletion of the OrderXML table will be done with the workflow function
udf_CleanUpOrderXmTable(). With this function, the data records that are older than the storage
days are deleted from the database.

In order to transfer the OrderXML data records filelessly to production, a workflow task must be
created, which uses the function udf_TransferOrderXmlToProduction(...). The description of the
function is in Chapter 10.27_OrderXML-Übergabe über den Import Service and an example of the
workflow in 10.29_Beispiele.

In order to read the OrderXML data records from the database, the following scripts are used:

Select to search the OrderXMLs in the database:
•   The last 10 entries in the OrderXML table
    SELECT TOP (10)
        Convert( xml, XML_TEXT) as Converted_XML,
        ID as Dok_Id ,
        CASE DOK_TYP WHEN 1 THEN 'Quote' WHEN 2 THEN 'Order' ELSE '' END AS Dok_Typ,
        DATUM_SAVED ,
        CASE TRANSFER_STATUS WHEN 0 THEN 'Ready' WHEN 10 THEN 'Success' WHEN 300 THEN 'Error' ELSE
    '' END As Transfer_Status,
        XML_TEXT as Original_XML
    FROM SYSADM.BW_ORDERXML
    ORDER BY DATUM_SAVED DESC;
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




•   The entries in the OrderXML table that were made today are:
    SELECT
        Convert( xml, XML_TEXT) as Converted_XML,
        ID as Dok_Id ,
        CASE DOK_TYP WHEN 1 THEN 'Quote' WHEN 2 THEN 'Order' ELSE '' END AS Dok_Typ,
        DATUM_SAVED ,
        CASE TRANSFER_STATUS WHEN 0 THEN 'Ready' WHEN 10 THEN 'Success' WHEN 300 THEN 'Error' ELSE
    '' END As Transfer_Status,
        XML_TEXT as Original_XML
    FROM SYSADM.BW_ORDERXML WHERE CAST(DATUM_SAVED AS DATE) = CAST(CURRENT_TIMESTAMP AS DATE)
    ORDER BY DATUM_SAVED DESC;




                                                                                                329
•   If the last 10 entries in the OrderXML table must be stored in the Temp directory, you
    should use this script:

    SET ANSI_NULLS ON
    GO
    SET QUOTED_IDENTIFIER ON
    GO
    CREATE PROC [dbo].[save2file]
    AS                                                                                   AS

    declare @ObjectToken INT
    declare @TheContent VARBINARY(MAX)
    declare @Save2File VARCHAR(255)
    declare @id int
    declare @RowNr varchar(255)
    declare @FileNameId varchar(255)
    declare @FileNameDate varchar(255)

    DECLARE TheCursor CURSOR FAST_FORWARD FOR
    SELECT TOP (10) Convert(varchar(255), ID), Convert(varchar(255), DATUM_SAVED, 112),
    Convert(varchar(255), ROW_NUMBER() OVER(ORDER BY DATUM_SAVED ASC)), XML_TEXT FROM
    SYSADM.BW_ORDERXML
    OPEN TheCursor
    FETCH NEXT FROM TheCursor INTO @FileNameId, @FileNameDate, @RowNr, @TheContent

    WHILE @@FETCH_STATUS = 0
            BEGIN
                    SET @Save2File = 'C:\Temp\' + @FileNameId + '_' + @FileNameDate + '_' +
    @RowNr + '.xml'
                    PRINT @Save2File

                    EXEC sp_OACreate 'ADODB.Stream', @ObjectToken OUTPUT
                    EXEC sp_OASetProperty @ObjectToken, 'Type', 1
                    EXEC sp_OAMethod @ObjectToken, 'Open'
                    EXEC sp_OAMethod @ObjectToken, 'Write', NULL, @TheContent
                    EXEC sp_OAMethod @ObjectToken, 'SaveToFile', NULL, @Save2File, 2
                    EXEC sp_OAMethod @ObjectToken, 'Close'
                    EXEC sp_OADestroy @ObjectToken

                    FETCH NEXT FROM TheCursor INTO @FileNameId, @FileNameDate, @RowNr,
    @TheContent
            END

    CLOSE TheCursor
    DEALLOCATE TheCursor
    GO



                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                              330
                Expanded workbench (light)

IG and LAMI can be ordered completely in A+W Business. These items are then transmitted via
purchasing to the supplier; they are regarded as purchased parts (usually only for dispatch) in
production. If, however, an IG is ordered from glass that is cut internally or a LAMI should be
laminated, there was no solution for this Because production had transferred the IG as purchased
part and thus there was no cutting. This required customizing solutions in import. In A+W Business,
the item could be entered as purchased part and the glass as cutting, but this did not happen in
production. If now the Extended workbench (light) option is activated in the company data, the
glass is transferred with procurement type 16- Cut before order and the glass is cut. Only the
assembly or lamination is purchased.
In the solution, it is not considered that the lites have to go to the supplier; this has to be
organized manually internally. That's why there is no complete support of the extended
workbench.




The procurement types in the order entry look like this:




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  331
4.15. Production preview

Section „Production/List of dates/Production preview“ offers a new analysis program with the
following scope:
For every delivery date, the program shows – in a configurable line – the order totals for the product
types IG, single annealed, toughened, and laminated”. All orders of the present delivery date or
later, will be analyzed.
There are 50 columns per delivery date that can be adapted individually. The criteria are a
combination of product type and product group, the result can be shown in units or sqm.
The visible columns can be set for every product type
tab 1 = IG
tab 2 = single annealed
tab 3 = toughened glass
tab 4 = laminated glass
tab 5 = extra allocation
tab 6 = extra allocation

for every terminal. The column width can also be adjusted per work space.
The system administrator defines – company-wide – the contents to be shown in the individual
columns.
The analysis result is saved in a database table so that when the user opens the program, he will
see the last analysis right away. The „Update button“ is used to update the data. The date and time
of the last update are shown on screen.
Examples:




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 105: Production preview 1




                                                                                                  332
    •    Total number of IG sheets in sqm (actual surface)
    •    Total number of IG sheets in units (IG units)
    •    Number of IG units with shapes
    •    Number of IG units with Georgian bars
    •    Number of IG units with UV edge sealing
    •    Number of IG units with toughened sheets in sqm (of IG unit)
    •    Number of IG units with laminated sheets in sqm (of IG unit)
    •    sqm of IG units in size categories 0.5 / to 1.5 / over 1.5




Fig. 106: Production preview 2

This function allows to define the visible columns and their size.
Defining the columns:
The settings apply company-wide and can only be made by the system administrator.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 107: Definition of preview columns

Explanations:
                         Type:           1=product type, 2=product group
                         MP:             Main product.
                         Type 0:         Analysis criterion
No. 0:            Product type or product group, depending on the type
                         Type 1:         1. BOM level.
                         No. 1:          Product type or product group, depending on the type
                         Type 2:         2. BOM level.
                         No. 2           Product type or product group, depending on the type
                         Piece/sqm       1= unit, 2=sqm

                                                                                                333
                        Size category: from (value) to (value)

Generally, the columns in which the product type or product group are entered, will show the
corresponding table when you double-click on it; the input can be adopted from the combo box.



4.16. Transfer of non-production-relevant changes
It is now possible after transferring order data to production to subsequently change non-
production-relevant data in the order and in the items and to update them in the production
system ("late order change").
Non-production-relevant data are:
        •   Delivery date (insofar as it was moved into the future)
        •   Changes to customer address/customer and delivery address
        •   Route
        •   File attachment with identifier for production transfer
        •   Item texts with identifier for production transfer
        •   Consignment
        •   Customer item
The transfer of the data can be done manually with the Production > Production > Production
Transfer dialog (with the mode transfer of non production-relevant data) or with a workflow task,
see "Workflow_TransferChangesToCapacityPlanning.txt."
The UDF function "udf_TransferChangesToProduction" transfers the order to production.
For the transfer, a new status point (963) must be set up. It controls up to which status the
transfer of the data to production is possible.
If the current order status < Minstatus or > Maxstatus, then the CHANGED flag is not set to 1. That
is, the order will not be marked for change transfer. Here, the status of the table BW_LOCK_KAPA
is still decisive. If it is <=10, then the CHANGED flag is also not set. The order was not released for
production.
The transfer must be done with OrderXML Version 5.2 and higher.
For the header and the items, the property "ChangeProduce" in the OrderXML is set.
If the data cannot be taken over into the production system, the recorder has a message entered
in his date list.
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL



This module requires a license.




                                                                                                    334
Flow of the transfer:




Data fields as change markers and triggers for the production transfer
 Field                                  Type        Description
 BW_XXXX_KOPF.CHANGED                   Int         Change of the document header data
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL



                                                    0=none,1=change, 2 =transfer change to
                                                    production
 BW_XXXX_POS_EX.CHANGED                 Int         Change of the item data (per position)
                                                    0=none,1=change, 2=transfer change to
                                                    production
 BW_LOCK_KAPA.CHANGED                   Int         Changes to the document (for faster selection of
                                                    the documents to be transferred)




                                                                                              335
4.17. Location-spanning lite barcodes with goods receipt

If all locations should work with uniform barcodes for purchased products, the barcode must be
passed on to all locations in the supply chain. This means that a TG in a LAMI of an insulating glass
gets the same barcode number in IG, LAMI and TG locations.
Thus the lite is recognized everywhere and there is no need for re-labeling.
To ensure that a uniform barcode can be used for each lite (header part as well as sub-part) in all
companies, the barcodes generated in the first site must be communicated to the supplying sites.
Since the barcode numbers for a lite are always assigned in ascending order, the transmission of
the start barcode number is sufficient.
Process:
Ordering site:
    • AWB: order entry
    • AWB: transfer to AWP
    • AWP: assignment of label numbers
    • AWP: transfer of the starting label number to AWB via ERP WebService Complete
      Scheduling
      (for all header and sub-parts, glass, foils, spacers)
    • AWB: generation of the PO
    • AWB transfer of the order with starting label number
Supplying site:
    • AWB: order will be created (EDI)
    • AWB: transfer to AWP with starting label number
    • AWP: use of the transferred label number                         for     in-house   production
          printing on label
Ordering site:
    • AWP/ProdTV goods receipt: entry of the goods receipt
    • AWP: transfer of the goods receipt to AWB
    • AWB: processing/booking of the goods receipt
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL



The goods receipt is entered in A+W Production via Production Terminal goods receipt and is sent
to the ERP Webservice. The Exchange Services processes the booking via a workflow task.
The following columns were included to receive the barcode start number and the barcode type
(quantities PDC).
BW_AUFTR_POS_EX / BW_AUFTR_STKL

 Field                      Type                Description
 BARCODE_START              NVARCHAR(20)        Production start barcode number
 BARCODE_TYPE               Integer             Barcode type (0=none, 1=high quantity, 9=high
                                                volume)




                                                                                                 336
In the OrderXML transfer, the barcode number and the type are transferred in the attributes labelNumber +
highQuantityID of the tag under UDX.AW/LABEL and UDX.AW/PRODUCT/LABEL.
For a production-relevant change of the product in the order entry, the barcodes for the item are deleted;
the subsequent production transfer re-assigns them for this item.




                  order entry
                                               OrderXML
                  sales order

                                                                       production
                                                                   Import (Capacitive)




                ERPWebService                    Label start
                                                 number                         Goods Receipt
              CompleteScheduling
                                                                              ProductionTerminal

                              Saves the label number



                                                    ERPWebService
                      Order
                                                  Book goods receipt

                                                                Search purchase order by
                                                                label number


            purchase order transfer                                                         EDI
                                                    Purchase Order

                                          Transfers the label
                                          number                           Transfers the
                                                                                                             A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                           label number


                                                     OrderXML with
                        Production Supplier          Default start number
                        Import (Capacitive)                                           Supplier Order



                                                    Multi-level




                                                                                                       337
Configuration of the barcode transfer
The company parameter on the tab "15 - Capacity planning" has to be set, only then is the
barcode transferred and written back to the order in the "Complete Scheduling" report. Caution:
This must be done at both the ordering and the supplying site.




Locking of the order entry against change after the EDI transfer of the PO
A+W Business supports no change transfer to suppliers; therefore, order entry must be locked
against changes if the PO was transferred via EDI. This means that the lock status for repeated PO
transfer of the status point 660 must have the status that the PO gets when it was transferred via
EDI.
Blocking of the EDI transfer in case of order change
If the order is changed and there is a repeated PO transfer, the PO cannot be transferred via EDI
as long as the order was not transferred again to production and the barcode number reported to
the ERP Webservice via Complete Scheduling. This is prevented via the BW_LOCK_KAPA and its
STATUS = 0 or in case of status greater than zero, via the BW_AUFTR_HISTORY. There, for an
order change (status point=2) there must first be a production report (status point=38); only then
may the EDI transfer be executed.
EDI transfer of the PO
So that the barcodes reach the supplier via the EDI interface, the export of the barcodes must be
activated in the supplier's B2B settings. Thus, the complete export of the BOMs for this supplier is
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL



activated automatically. This is absolutely necessary since the barcodes must be exported even
for BOM elements that were not exchanged. For this reason, on the importing other side, the
option of complete import of the BOM from the EDI file must be activated.

The EDI interface version 2.2.034 is absolutely necessary. Only starting with this version are the
barcodes (P3/10, P3/11, S1/32, S1/33) read and written.
Goods receipt reporting from A+W Production Terminal
The Production Terminal transfers the barcodes for booking goods receipts to the
AWCapacityReceiptOfGoods function of the ERP WebService. The barcodes reports are first
saved in the A+W Business database and then have to be processed by the Exchange Service via a
workflow formula. The udf function udf_ProcessReceiptBarcodes exists for this. The following



                                                                                                 338
screenshots show the call of the udf function in a formula and how this formula is entered as
workflow task for the Exchange Service.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




All messages that the booking of the goods receipt generates can be displayed as usual on the
5.Monitor tab. As with the manual booking of the goods receipt, the status of order and PO is set
correspondingly, depending on whether the goods receipt of the respective document is
complete or incomplete.



                                                                                                339
To research which barcodes were saved by the ERP WebService in the database, all data records
with the type 56 can be selected in the tables FS_POOL and FS_POOL_KOPF.




                                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                            340
Configuration in A+W Production:
The reporting in the ERP Webservice must be activated.




The barcode is then scanned in Production Terminal.




                                                               A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                         341
5. Price calculation

5.1. Surcharge type for miscellaneous surcharges on replacement
   sheets
Problem: When a laminated sheet (as part of an IG unit) is replaced, a surcharge of 37 DM/sqm
shall be applied. If the sheet is smaller or equals 0.5 sqm, a graduated minor glass surcharge will be
applied to the replacement surcharge. As the laminated sheet is also coated, a coating surcharge of
35 DM/sqm is applied which - and this is the peculiarity - shall not get the minor glass surcharge.




Fig. 108: Management of other surcharges
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




Solution: Miscellaneous surcharge table with surcharge type “basic price” (non-additive) for the
coating surcharge. This makes sure that the minor glass surcharge will not be applied to the coating
surcharge.




                                                                                                  342
5.2. Automatic transport surcharge on all IG items
Problem: Depending on the customer, a transport surcharge shall be applied to the orders for all
IG units. This surcharge can be applied as net%, gross%, or per sqm.




Fig. 109: Order entry - transport surcharge

Solution: Define a service product and enter it in company parameters. Activate the transport
surcharge in customer base data. When an IG order is entered for this customer, ALFAK will
automatically add item 990. Field Item text 5 offers the basic surcharge value which can be printed
on the form.
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               343
5.3. Change miscellaneous surcharge calculation
Problem: If several proportional surcharges (net % or gross %) shall be applied to a product, you
need to consider how these influence each other.




Fig. 110: Miscellaneous surcharges:

Example:
(The purpose of this surcharge table is to apply a 50% surcharge to certain product groups
                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL



(patterned glass) plus a thickness-based surcharge of 0-150%.)

Calculation example for additive surcharges:
Edgework                               4 lin.m x 6,25          = 25.00
Misc. surcharge Processing index 1     50 % net on 25 = 12.50
Misc. surcharge Thickness up to 9 mm            10 % net on 37.50      = 3.75
Total price of the processing                                          = 41.25

Calculation example for non-additive surcharges:
Edgework                               4 lin.m x 6,25          = 25.00
Misc. surcharge Processing index 1     50 % net on 25 = 12.50
Misc. surcharge Thickness up to 9 mm            10 % net on <25        = 2.50
Total price of the processing                                          = 40,--


                                                                                              344
This calculation difference can be set in miscellaneous surcharges, in connection with the surcharge
type.




5.4. Correction of original sales prices
Problem: The original sales price for order items would sometimes be calculated wrongly and
appears incorrectly in the database. This causes errors in statistics. This problem has been solved
meanwhile; correction is only possible by executing a tool.
In \\jupiter\ALFAK_Develop\Tools liegt die abxrejectcorrect45.exe. The program first corrects the value of all
items with POS_NR >= 900 which are no complaines by changing FI_VK_URSPRUNG using the entry
in FI_POS_GES. This is done for the main database and for all archives defined for correction.
In a second step, all complaint items with POS_NR >= 900 are corrected. The system searches for
the reference order of the complaint and changes the value FI_VK_URSPRUNG of the complaint by
the corresponding value from FI_POS_GES from the order item. The program also searches in
archives for this order. If the order itself is found in archives, the program only searches this archives
and older ones to prevent errors due to changed number ranges.




                                                                                                                 A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 111: Correction of original sales prices




                                                                                                          345
When starting the program, you have to link with the customer's main database. The archives code
will be analyzed automatically. After that, enter the years of the archives to be edited or searched.
Click on the button ‚Correct original sales prices‘ to trigger the correction.
During the correction process, the progress is shown in the dialog; the program issues reports for
the individual items in the table.


5.5. Pricing by formula

          Syntax
Formulas are defined in price management, in addition to the price. The formula is executed in
connection with the order document. All fields of the document header can be accessed directly
(e.g. the customer number m_sAH_IDENT). Database fields must be preceded by ‚m_s’ (for strings)
or ‚m_n’ (numeric fields).
The current item is accessed via
m_Pos[m_nCurItemIdx].<Variable>
( z.B. m_Pos[m_nCurItemIdx].m_nPP_BREITE ).
Use the following term to access the BOM
m_Pos[m_nCurItemIdx].m_PosStukl[m_nCurBOMIdx].<Variable>
(e.g. m_Pos[m_nCurItemIdx].m_PosStukl[m_nCurBOMIdx].m_nSTL_BREITE )
The following variables can be allocated
m_nUdv[*]                 numeric entries
m_sUdv[*]                 string entries
m_sqlUdv[*]        SQL handles

Functions are loaded without ‚Call’.
Syntax:
udf_ExecFormula ( 1 );
Variables are allocated by ‚Set’.
Syntax:
Set m_sUdv[0] = ’Test’;
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




The IF command can be used for restricted program runs; it can be interlocked several times.
Syntax:
 IF <Bedingung>;
                           <Command>;
 IF <Bedingung>;
                                    <Command>;
 ENDIF;
                           <Command>;
 ENDIF;




Every line must be ended by a semicolon, even after IG and ENDIF!


                                                                                                 346
The WHILE command is available for loops, and can be interlocked several times.
Syntax:
 WHILE <Bedingung>;
                               <Command>;
 WHILE <Bedingung>;
                                       <Command>;
                               Wend;
                               <Command>;
                               Wend;



Every line has to end with a semicolon, even after WHILE and WEND!

           Pricing context
Execution of the formula is started several times over; this is done after pricing for the item and the
BOM elements, and after price calculation (calculation of item and BOM price). To handle this by
means of a formula, use the variable m_sFormulaContext. Its content before/after pricing is
‚BEFORE_SELECT_PRICE’, ‚AFTER_SELECT_PRICE’ and before/after price calculation, the value
‚BEFORE_CALC_PRICE’ or ‚AFTER_CALC_PRICE’.
In order to intervene before the price calculation, the context 'AFTER_INIT' serves. It is executed
directly after initializing the price calculation, before the discount search
 IF m_sFormulaContext = 'AFTER_INIT’;
                    <Command>;
                    <Command>;
 ENDIF;

 IF m_sFormulaContext = 'BEFORE_SELECT_PRICE';
                    <Command>;
                    <Command>;
 ENDIF;

 IF m_sFormulaContext = 'AFTER_SELECT_PRICE';
                    <Command>;
                    <Command>;
 ENDIF;

 IF m_sFormulaContext = 'BEFORE_CALC_PRICE';
                    <Command>;
                    <Command>;
 ENDIF;
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL


 IF m_sFormulaContext = 'AFTER_CALC_PRICE';
           <Command>;
           <Command>;
 ENDIF;




           Documentation of functions
All Gupta SQLWindows SAL functions can be used.
SQL commands can be executed only via SqlPrepareAndExecute. SqlImmediate and SqlExists are
not supported. The only valid SQL command is SELECT. The database can be accessed only via
individual, temporary handles.



                                                                                                   347
 IF DbMakeTempConnect( m_sqlUdv[0] );
          SqlPrepareAndExecute( m_sqlUdv[0], '
          SELECT BA_BEZ1 FROM SYSADM.BA_PRODUKTE_BEZ
          WHERE BA_PRODUKT=:m_Pos[m_nCurItemIdx].m_PosStukl[m_nCurBOMIdx].m_nBOM_PRODUKT AND SPRACH_ID =
          0
                 INTO :m_sUdv [0]' );
          SqlFetchNext(m_sqlUdv[0], m_nUdv[0] );
          SqlDisconnect( m_sqlUdv[0] );
 ENDIF;



All created handles must be disconnected again!
The user-defined functions are described in the ALFAK Intranet.

           Customizing quantity limits for pricing
The variables m_nCustomizingIndex1, m_nCustomizingIndex2, m_nCustomizingIndex3 can be
assigned values that can be used for the new limit types "Custom. Index 1-3". This way, the price
search can be influenced by customizing.
 IF m_sFormulaContext = 'BEFORE_SELECT_PRICE';
           SET m_nCustomIndex1 = 999;
           IF ( ProduktartIsGlas( m_Pos[ m_nCurItemIdx].m_nPROD_PRODART ) );
                      IF (m_Pos[ m_nCurItemIdx].m_nPROD_PRODART != PRDART_VSG);
                                  ! Basisglas incl. ESG;
                                  SET m_nCustomIndex1 = 1;
                      ENDIF;
                      IF (m_Pos[ m_nCurItemIdx].m_nPROD_PRODART = PRDART_VSG);
                                  ! VSG;
                                  SET m_nCustomIndex1 = 2;
                                  ! Examine BOM by TG in laminated glass;
                                  SET m_nUdv[0] = 0;
                                  WHILE m_nUdv[0] < m_Pos[m_nCurItemIdx].m_nStuklAnz;
                                              IF ( m_Pos[ m_nCurItemIdx ].m_PosStukl[ m_nUdv[0] ].m_nSTL_PRODART = PRDART_ESG );
                                                         SET m_nCustomIndex1 = 3;
                                              ENDIF;
                                              SET m_nUdv[0] = m_nUdv[0] + 1;
                                  WEND;
                      ENDIF;
           ENDIF;
 ENDIF;




5.6. Calculation of and Search for Average Purchase Costs
                                                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




           Functions up to ALFAK Version 4.1
With only a few exceptions, older versions used to search for an article’s purchase price in the
standard allocation of rates for purchase prices, and apply it to the order. Alternatively, it has been
possible to define a different price key for certain stocksizes and boxes, to be used with priority.
To calculate the average purchase price, it has been necessary to define the article as a stock article,
and enter it in a stock P.O. By booking the receipt of goods, the system used to calculate the new,
average purchase price, saving it as the purchase price in standard allocation of rates. The formula
for calculating the assessed average is:
StockQuantity = actual stock on hand prior to booking the receipt of goods
StockPrice = actual average purchase price acc. to standard allocation of rates
P.O.quantity = quantity added through the receipt of goods


                                                                                                                         348
P.O.price = article price as per stock P.O.
NewPrice = new, average purchase price


                MengeLager * PreisLager + MengeBestellung * PreisBestellung
NeuerPreis =
                                 MengeLager + PreisLager

          Functions up to ALFAK Version 2007
The above method used to cause problems if the P.O. prices had to be corrected after an invoice
check. Additional corrections can be made – without incurring an error – only if the history of goods
received and withdrawn is recorded. This history has been implemented in Version 2007.
If an invoice check results in the amendment of a P.O. for which receipt of goods has been booked
already, the corresponding history record will be changed; the average costs will be recalculated
based on the history.
Because of this change, the calculated, average costs used to be saved with the corresponding stock
article instead of with the purchase price rate. These costs are also separately saved by storing
place, size, and (box) contents.
You can now define a separate, average price per stock article, and calculate it.
If at order entry, an article is entered that is not available on stock as just this variant, pricing will
calculate the assessed average price for all stock articles of the same article number.
Together with this change, the proportional purchase price per stock article will be taken into
account at receipt of goods. When the P.O. is booked, surcharges defined as automatic general
surcharges will be added to the costs of the corresponding item. Therefore, the actual purchase
price of each stock article is the basis for calculating the average costs.

          Functions starting from ALFAK Version 2008
To render this function more flexible and/or to achieve the old function, a new code has been
implemented in both inventory management and product stock sizes. The code in product stock
sizes defines whether or not the average costs of this article are calculated from stock. The stock
management code defines whether or not the corresponding article shall be considered for
calculating the overall average price for all variants of this article.
Pricing first checks the product stock sizes as to whether the article exists in just this variant. If so,
the average price of the stock article is calculated based on this code – or not. If the code is inactive,
the system will search for the price in the standard purchase price rate. If a different purchase price
                                                                                                              A+W Software GmbH - Configuration A+W Business - INTERNAL



code has been entered, this will override the standard rate allocated. If the article cannot be found
in product stock sizes, the system goes on searching for the average price in inventory.
If the average price is calculated based on stock, the exact stock article is defined first. If the article
exists, the defined price will be used. If the article does not exist, the assessed average price for all
products of this article number with an active code will be calculated. If the calculated price is 0,
the system will search for the price in the standard purchase price allocation. If the price code has
been entered manually at order entry, the price is calculated only from the rate allocated to the
selected price key, without searching for an average price.
The codes do not influence the saving of costs for the corresponding stock article.




                                                                                                       349
                                                                 Start der Preissuche




                                                                  Manuelle Vorgabe
                                                                                                  JA
                                                                 des Preis-Schlüssel?
                                                                                                       Suche des EK in der
                                                                                                        Tarifzuordnung des
                                                                                                       vorgegebenen Preis-
                                                                                                             Schlüssels
                                                                         NEIN                              (PR_PREIS)


                                                                                                             ENDE
                                                                          In
                                                                 Produktlagermaßen
                                                                                                       JA
                                                                    (BA_LAGMA)
                                                                     vorhanden?
                                             NEIN



                                                                                                           Suche nach
                                                                    JA                                  Durchschnittspreis
                                                                                                             aktiv?




                                      Produktausprägung
                                    exakt in Lagerverwaltung
              JA
                                      (LG_LAGERORTE)
                                           vorhanden?


     Selektion des
 durchschnittlichen EK                                                                                        NEIN
 aus dem Lagerartikel                        NEIN
  (LG_LAGERORTE)

                                    Bilden des gewichteten
                                   durchschnittlichen Preises
                                   über all die Lagerprodukte,
                                     die das entsprechende
                                      Kennzeichen aktiviert
                                              haben.


                                                                                                         Abweichender
                                                                                                       Preis-Schlüssel für
                                                                                NEIN                     EK hinterlegt?


                   Ist der ermittelte
                                                                 NEIN
                      Preis > 0 ?
                                                                                                               JA



                                                                                                       Suche des EK in der
                                                                         Suche des EK in der
                                                                                                        Tarifzuordnung des
                                                                             Standard-
                                                                                                       vorgegebenen Preis-
                                                                           Tarifzuordnung
                                                                                                             Schlüssels
                                                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL


                                                                            (PR_PREIS)
                          JA                                                                               (PR_PREIS)




                         ENDE                                                                  ENDE



Fig. 112: Average cost calculation process

Below please find some examples for defining an article price which serve to describe the price
searching process acc. to illustration 1.




                                                                                                                             350
    Produkt-Lagermasse ( BA_LAGMA )

    Artikel     Abmessung                  Durchschnittspreis ermitteln          abw. Preis-Schlüssel

    1004        3210 x 6000                JA                                    Lagermaße
    1004        3210 x 3000                NEIN                                  <k.A.>
    1004        3210 x 2000                NEIN                                  Lagermaße




Fig. 113: Product stock dimensions

    Lagerverwaltung ( LG_LAGERORTE )

    Artikel    Abmessung              Bestand     Teilnahme an gesamt              Durchschnitts-Preis
                                                  Durchschnittspreisermittlung

    1004       3210 x 6000            100 Stk     JA                               1,25 EUR/qm
    1004       2000 x 2000            40 Stk      JA                               1,84 EUR/qm
    1004       1500 x 3000            45 Stk      NEIN                             1,99 EUR/qm

    Gew. Durchschnittspreis für Artikel 1004:
    ( 3210*6000*100*1,25 +2000*2000*40*1,84)/(3210*6000*100+2000*2000*40*1,84) = 1,30 EUR/qm


Fig. 114: Inventory management



    Preise laut Tarifzuordnung in Preisverwaltung ( PR_PREIS )

    Preisschlüssel            Preis

    Standard                  1,50 EUR/qm
    Lagermaße                 1,00 EUR/qm




Fig. 115: Price management



Beispiel-Auftrag mit den ermittelten EK’s:

Pos.          Artikel        Abmessung                   Preis-Schlüsselvorgabe                  EK

1             1004           3210 x 6000                 nein                                    1,25 EUR/qm
2             1004           2000 x 2000                 nein                                    1,44 EUR/qm
3             1004           3210 x 3000                 nein                                    1,50 EUR/qm
4             1004           3210 x 2000                 nein                                    1,00 EUR/qm
5             1004           1250 x 1433                 nein                                    1,30 EUR/qm
6             1004           3210 x 6000                 ja ( Lagermaße )                        1,00 EUR/qm
                                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 116: Example order




                                                                                                               351
5.7. Imputed freight costs
The program Imputed Freight Costs offers two functions. These functions serve to determine the
imputed freight costs for orders and print them in the shape of lists, and also split forwarding costs
to orders.
Description of the functions:
1. Calculation and printing of imputed freight costs

The first function serves to determine and print the imputed freight costs for a certain number of
orders. The number of orders is selected by delivery date, customer, and route. Please note that
the imputed freight costs will be revised for every printout.
 The number of orders is selected by delivery date, customer, and route. Please note that the
imputed freight costs will be revised for every printout.
2. Splitting of forwarding costs:

The second function permits to split forwarding costs to a certain number of orders. The number
of orders is selected based on delivery date and route.
Notes:
Enabling the determination of imputed freight costs:
The decision as to whether or not imputed freight costs shall be determined for an order, is based
on the route selected for the order. Decisive is the entry in column €/km in route master data. If
the entry in column €/km is over 0, imputed freight costs will be determined for the order.
Otherwise, there will be no calculation.
Order entry
Imputed freight costs are determined at order entry for the first time. When an order is entered,
the imputed freight costs will be determined for the present order and the associated orders of this
customer for the same delivery date and route. Order entry offers a new menu item, Functions ->
Imputed freight costs. This entry can be used to open a list of imputed freight costs.
Determining the imputed freight costs:
Imputed freight costs are calculated radial. The distance between the site and every single customer
will be taken into account. Example: If the distance from a customer is 50km and a value of € 1.5/km
has been defined for this route in route management, the imputed freight cost for this order would
be € 75. If the customer has placed more than one order for the same delivery date, these € 75
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL



would be split onto the individual orders, based on the glass surface of the orders.
Splitting of forwarding costs:
The forwarding costs will be split onto the individual orders, in relation to the distance to the
customer and the glass surface to be delivered.


5.8. Down payments

          Operation
Deposits are created by means of the module “Copy documents”. A new document is created in
which the items of the original order are listed. The deposit amount is a separate item.


                                                                                                  352
Numbers for deposit invoices are taken from the partial invoice number area.
A new status has to be defined, and allocated to status point 89 The status must lie below the
invoicing status.
The deposit product must be defined as „service“, product group „deposit“. No discount should be
possible.
It has to be entered in product allocation ‚surcharges’ as down payment.
Use system text 50 and 51 to enter invoice data for the item.
50 Invoice <ar> dated <ard> for deposit dated <ad>
51 deposit of for order <aa> of <aad>


<ar> = deposit invoice number
<ard> = deposit invoice date
<ard> = deposit invoice date
<aa> = deposit order number
<aad> = deposit order date


Correct printout requires some changes in the form. Example: Rechn.qrp in the details block.
Essential is the print condition in the old item line.
New variables:
DEPOSIT_HEADER          integer
DEPOSIT_ITEM            integer
ZW_BETR_NETTO                     integer
ZW_BETR_MWST1           integer
ZW_BETR_BRUTTO          integer
DEP_BETR_NETTO          integer
DEP_BETR_MWST1          integer
DEP_BETR_BRUTTO         integer
                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL



These variables are printed on the original invoice, as subtotals of the original items.
On the new deposit invoice, the original items will be printed (controllable via Options in Copy
Documents) and the new deposit item.



5.9. Shape edge surcharges

         Introduction and the problem
Many of our customers have a pricing method for edgework with which the shapes with slanted
and round edges have a different price than those with rectangular or parallel edges. The reason



                                                                                             353
for this is that this edgework has to be performed on special machines, which results in higher costs
(CNC or one-side grinding machine instead of the efficient two-sided grinding machine).
Up to now, this problem has been solved in a manner so that the customer has several edgeworks
(straight shape edge, curved shape edge and rectangular edge). This results in a very complex
process for the customer. The staff that enters data have this under control, but with the Web
Configurator , we are addressing the end customer, who is not aware of this technical issue, which
would inevitably lead to wrong entry with incorrect prices. There is therefore no other way than to
simplify entry, i.e. to return to the essential information of which edges do I want to process how.
The software must do everything else.

           Setting up shape edge price surcharges
The shape segment surcharges are set up in the shape edge surcharges. This is done per shape and
price table and rate




Fig. 117: Shape edge surcharges


                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 354
           Creation of shape edge qualities
During transfer to production, the individual processing has to be split into several processing. Only
this way can the production software determine the different size allowances and machines.




Fig. 118: Shape edge qualities



Only the deviating edge qualities have to be entered in the shape edge qualities. All other edges
can stay set to "<n.e.>" and inherit the quality of the edgework from product management.
If deviating edge qualities are set up for edgework, they will also affect the SNLive sketch and SN
file creation, i.e. the deviating edge qualities are also transferred to the A=W CAD Desginer
(Shapes).


                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  355
           Order entry pricing
Price calculation takes place by determining the single edge length and checking it against the
minimum edge length or the minimum processing length. Please note that if we have a minimum
length, the length of the edges are totaled that have the same surcharge. This is not the case with
the minimum edge length. This is not the case with the minimum edge length.
This is not the case with the minimum edge length.
Exact calculation
Base price 9.20 pro lm, shape edge surcharge edge 3 100% and 30 measurement rounding
Length * Price/lm * same edge surcharge = individual price
1.02+1.02+0.51=2.55 lm * 9.20€ * 1.0(0%)                = 23.46 €/pc.
1.14 lm * 9.20€ * 2.0(100%)                             = 20.976 €/pc
Total                                                   = 44.436 =>44.44 €/pc




Fig. 119: Example of the exact calculation of shape edge surcharges



Non-exact calculation
Base price 9.20 pro lm, shape edge surcharge edge 3 100% and 30 measurement rounding
3 x the length of 1.02 lm is calculated + 1 x 1.02 lm * 2.0(100%)
The user can determine how often the shape edge surcharge is applied to the width and/or height.
The system supports the user to the greatest extent possible of edge 3 is removed, the shape edge
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL



surcharge is also dropped.
Length * Price/lm * same edge surcharge = individual price
1.02+1.02+1.02=3,06 lm * 9.20€ * 1.0(0%)                = 28.152 €/pc
1.02 lm * 9.20€ * 2.0(100%)                             = 18.768 €/pc
Total                                                   = 46.92 =>44.44 €/pc




                                                                                               356
Fig. 120: Example of the non-exact calculation of shape edge surcharges

Calculating minimum lengths
The calculation for the option Calculate minimum length is completed. Each edge is checked for the
minimum length in accordance with the measurement rounding and, if necessary, it is increased
and a surcharge is applied.
When calculating total minimum length however a problem occurs in the case of different shape
edge surcharges. How should the minimum length and the surcharge be calculated, how is it to be
distributed?
Solution: For all identical edge surcharges, the lengths are added and are checked against the
minimum length, which correspons exactly to the prpocess used when single processings are
entered.
Base price 9.20 pro lm, shape edge surcharge edge 3 100% and 30 measurement rounding with
minimum length 1 lm (not per edge!!! )


Length * Price/lm * same edge surcharge = individual price
1.02+1.02+1.02=3,06 lm * 9.20€ * 1.0(0%)                = 28.152 €/pc
1.02 lm * 9.20€ * 2.0(100%)                             = 18.768 €/pc
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL



Total                                                   = 46.92 =>44.44 €/pc

           Effects on production transfer
Shape edge qualities cause the processing records to be split per edge quality in production
transfer. Plus the decoration is now transferred for edgework with the quality OtherEdgeWork.
There are two different cases hereby, depending on whether the A+W capacity planning is active
or not.
    •    Without capacity planning, the processing record is checked for deviating edge qualities. If
         they are available, the processing record is split into various processing records (one per
         edge quality). Then the processing plans are recalculated and the processing texts are
         created, as changes may have resulted from the splitting.


                                                                                                 357
    •    With capacity planning, the processing is split on the basis of the scheduling data. Splitting
         takes place into as many work processes as assigned by capacity planning. Also the new
         edge lengths come from this data. In this case, the processing text is newly created for each
         processing.



Configuration in A+W Production
Up to now, the SN edge quality had always been read from the A+W Production master data of the
processing and checked to see whether this edge quality also exists on the SN drawing. If there are
several edgeworks with the same SN edge quality in the BOM, everything will work if the size
allowance (irrespective of the assigned machine) is the same for every edgework.
Now we have the case that the same processing article has different edge allowances in the SN file
and perhaps differing grinding surcharges are calculated. If such an item is imported, this will stop
at scheduling with an error: "Contradictory grinding allowance for the same edgework in the
drawing". [2507]“
Set the switch [ALCIM_SHAPE / SNUSEORDERDECOFORAWTYPE1090] to prevent this from
happening:
0:      The SN edge quality is read from the article master data (BEARBEIT_EXTRA1).
1:      The SN edge quality is taken from the order, if the field <decoration> is filled in the transfer
file and edge processing has been assigned to the A+W processing type 1090 (other edge
processing).




                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 121: Configuration special edge in A+W Production

Example of an extract from an OrderXML file:




                                                                                                    358
  <awProcessing typeID="Polishing" id="1010" category="Edgework" quantity="10.25" quantityUnit="MTR">
      <Polishing>
          <EdgeWork n="2" />
          <EdgeWork n="4" />
      </Polishing>
  </awProcessing>

  <awProcessing typeID="OtherEdgework" id="1090" category="Edgework" quantity="3.75" quantityUnit="MTR">
      <OtherEdgework decoration="12">
          <EdgeWork n="1" />
      </OtherEdgework>
  </awProcessing>




SN edge quality on laminated glass parts
If edgework is performed on a laminated glass part, a different DECO number is attached to the SN
drawing. This number is the respective number for laminated glass edgework. This happens when
the SN drawing is directly generated by A+W Business or when scheduling in A+W Production.
When determining the grinding surcharges in A+W Production, the surcharges are checks with both
DECOs.
List of SN edge qualities and the implementation on laminated glass parts (Number in A+W Business
and A+W Production always +1):
Special edges 11-16  laminated glass 84-89
Special edges 18-27  laminated glass 90-99
Special edges 100-131  laminated glass 132-163

           Setting up Business Capacity Planning
In the special allocations 2, different work types can be created for a processing and shape for
different shape edges.




                                                                                                              A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 122: Configuration special allocation 2

If A+W Business Time Management is being used, the distribution of the work processes in special
allocation 2 must correspond to the different shape edge qualities. If one of the work processes has
edges with different edge qualities, a message is output during transfer to production and no
OrderXML file is generated.




                                                                                                        359
Fig. 123: Message during transfer to production for faulty special allocation 2




5.10. Wastage rates for price calculation
In A+W Business Pro is it now possible to use the wastage rates detected by the production manager
for the price calculation of quotations and subsequent orders. The scripts 20160509a.sql,
20160510a.sql, 20160511a.sql and 20160508aa.sql must be initialized in order to use the functions.
If a quotation is optimized with the Production Manager, the detected waste rates per glass type
(= product number) in the table are now entered in the table BW_ANGEB_OPTI. The records of the
selected optimization are given the value SELECTED = 1 and are therefore considered by the price
calculation. The values of the other implemented optimizations with SELECTED = 0 are alternatives
that can be used to compare the prices.
The determined rates therefore override the values entered in the product master data. If no
(selected) values are available in the table for the document, the wastage rate from the master data
still applies.

           Management dialog
After the quotation has been optimized by the production manager, the wastage rate to be used
for the price calculation can be subsequently determined in A+W Business. This allows the various
prices to be easily compared and the selected price is directly transferred into the document. The
dialog can opened from the document entry via Functions > Wastage rates.
In the dialog it is also subsequently possible to calculate the costs with a manual wastage value. For
this, the required wastage factor must simply be recorded in the detail table under the entry
"manual entry" and then selected. This can also be done if the quotation has not been optimized
yet. It is also possible to use the value from the master data again by not selecting a record for the
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL



glass type.
The dialog implements a price calculation with each change so that the user does not have to do
anything else than select the required wastage rates per glass type and confirm the dialog with OK.
The purchase prices are also totaled per glass type and shown in the table for a better overview.
This means the difference from the original price can be identified at a glance.




                                                                                                  360
         Document archiving and copying
The determined wastage rates are included in the archive when archiving documents and are also
copied back when copying back from the archive. This ensures that the price is not changed when
copying a document.
Copying a quotation to an order is an exception. Only the selected records are copied for the price
calculation. Subsequent calculation with other previously determined wastage rates is no longer
possible in the order.
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               361
5.11. Energy Surcharge
As from 1st November 2004, glassworks will charge an energy surcharge on glass. This surcharge
will be applied per kilogram. The ALFAK2000 module ‚Energy surcharge` allows to pass this
surcharge on to the customers.
It allows the automatic creation of surcharge item 991. The surcharge can either be applied to glass,
or to the weight of glass items. The surcharge will be calculated at order entry.
Should the amount of the energy surcharge change between input and delivery, the orders have to
be corrected by means of program ‚Recalculate documents'. This program offers a new option for
this purpose, ‚Recalculate special discounts/surcharges`.
The surcharge can be defined for customers and suppliers, and can be enabled or disabled at
document entry and in customer/supplier data.
No other automatic surcharges or discounts will be applied to the energy surcharge.

           Rounding Parameters
As the surcharge is calculated with three digits after the decimal point, the rounding (digits after
decimal point) of the price per price unit needs to be changed. If not already existing, a rounding
rule with three digits after the decimal point has to be defined (illustr. 1) This will be entered in
company roundings for rounding 1 (fig.2).




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 124: Define rounding point




                                                                                                 362
Fig. 125: Rounding allocation


           Defining an Energy Surcharge Article
The energy surcharge article is defined as a service, the quantity unit is ‚pc.'. You have to allocate a
product group that is not ‚000'. Splitting onto glass items in financial accounting/statistics is
impossible.




                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 126: Product management - energy surcharge article


                                                                                                    363
The price has to be entered as price per kilogram.




Fig. 127: Energy surcharge – Price


           Entering the Energy Surcharge Article in Company Parameters
The energy surcharge article must be entered in tab Surcharges in Company Parameters.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 128: Energy surcharge - company data

The surcharge calculation type ‚only on glass weight` or ‚on weight of glass/IG items` is set in tab 4
Documents



                                                                                                  364
                                                            Fig. 129: Energy surcharge - company data 1




365
A+W Software GmbH - Configuration A+W Business - INTERNAL
           Activating the Surcharge in Customer/Supplier Data
The energy surcharge has to be activated for every customer/supplier. This setting will be loaded
at order entry, and can be changed there.




Fig. 130: Enable energy surcharge




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                              366
           Order entry
The surcharge will be calculated and inserted when you leave item entry. To change the price, open
item entry once more and change the price per price unit. The surcharge basis (the weight) is shown
in item text 5, and can be printed after the form has been amended.




Fig. 131: Calculation after item entry




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 132: Surcharge basis




                                                                                               367
           Recalculation after a Change of Price
Orders entered prior to the price change, but have not been shipped so far, have to be transferred
to a number manager. Now start program „Recalculate documents“ with the option ‚Calculate
special discounts/surcharges`. All special discounts will be recalculated, including the energy
surcharge. The item prices will not be changed.




Fig. 133: Recalculation of documents




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                              368
           Changes in Version 4.1
Version 4.1 introduces some changes with regard to the energy surcharge. The surcharge is handled
by the automatic special discount/surcharge logic introduced in 4.1. The advantages are:
    •    Item number specification
    •    The effects of the surcharges on another can be defined
    •    Individual products can be excluded from the surcharge
The conversion of the old surcharge code in the customer master data is done automatically via
update script. The energy surcharge has to be allocated manually, however. The energy surcharge
code is set for the product type (1,2,3,50) for all orders and products. The energy surcharge product
has to be entered in ‚product allocation surcharges‘. Calculation is the same as in the previous
version.




Fig. 134: Product surcharge allocation                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




5.12. Tax calculation by Avalara Tax Service
In the United States, the calculation of the taxes depends on the locations of the seller and
purchaser. It is still decisive in which region, in which country, and in which city the locations are
located.
For this complex task, the activation of the Avalara Tax Service is described in the following. This
service is a for-fee RESTful service from Avalara Inc. A_W Business transfers all relevant information
for the document to this service and receives back the tax rates, tax basis amounts, and the tax
calculated. The basis for the correct tax calculation is the so-called tax codes that must be entered



                                                                                                  369
in A+W Business for each product group. During the transfer, the tax code for each item is
determined using the combi product group of the main product and transferred to Avalara.




Product code management with the tax code for the transport
Since the tax code is a new column, the script 20191029a.sql is absolutely necessary. The call of
the Avalara service is done via a customizing for the tax calculation. For this, a formula in the
customizing management, must be assigned the program point 52-Tax calculation. Starting from
this moment, the tax calculation is no longer handled by A+W Business and must be done
completely in the formula.
An example can be found in the A+W Business formula folder with the name Tax_Avalara.txt.


Set m_nUdv[1] = 1;
! Check if the first m_nKO_STEUERFLAG is enabled. If not, start the regular tax
calculation;
If NOT (m_nKO_STEUERFLAG & 1);
       Set m_nUdv[1] = 0;
EndIf;
                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL



! Check if ShipTo address is inside the US. If not, start the regular tax
calculation;;
If ( m_sAL_LAND != ' ' AND m_sAL_LAND != 'US' );
       Set m_nUdv[1] = 0;
EndIf;
If ( m_sAL_LAND = ' ' AND m_sAH_LAND != 'US' );
       Set m_nUdv[1] = 0;
EndIf;
If m_nUdv[1];
       ! Only for testing, setting sandbox to true;
       Set m_nUdv[0] = TRUE;
       udf_AvalaraTax ( this, '255 S. King Street', 'Seattle', 'WA', 'US',
'98104', m_nUdv[0] );



                                                                                               370
         ! Show errors that might have happened during transfer;
         udf_ShowResults ( MESSAGETYPE_ERROR );
EndIf;
If NOT m_nUdv[1];
       ! Standard tax caluclation instead of Avalara;
       udf_CalcStandardTax ( );
EndIf;



In this example, it is first checked whether the checkbox for the first tax rate in the document is
actvated and whether the goods are sent within the USA. If both are true, the function
udf_AvalaraTax is called. The transfer parameters to the function are the document itself
(this) and the sending address. As last parameter it is specified whether the transfer is done to a
test access of Avalara (true) or to the productive service (false). The function
udf_ShowResults is used to output any possible error messages that occur.
If one of the two criteria (sending within the USA or tax flag active) does not apply, the standard
tax calculation will be performed by A_W Business with the function udf_CalcStandardTax.
The access data for the Avalara Tax Service will be entered in the company master data on tab 2.
Taxes. Here, it is possible to authenticate either via user/password or via account number/license
key.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  371
The tax flag will always be taken over from the customer master data into the order and should
be activated for all customers.
Important is also that the workplace has access to the Internet with the port 80 so that the
Avalara service is accessible.
If everything is set up accordingly, the tax calculation in the order entry is now done via the
Avalara service as soon as the items were recorded. Furthermore, when saving, there is always a
recalculation of the taxes as soon as the customer address or the delivery address changes. As
soon as the invoice printing is done, there is another tax calculation by the Avalara service. This
guarantees that the applicable tax at the time of invoicing is calculated.




Order entry with active tax flag and calculation from the Avalara service                              A+W Software GmbH - Configuration A+W Business - INTERNAL




The functions used:
bRet = udf_AvalaraTax ( fktDoc, sShipFromStreet, sShipFromCity, sShipFromRegion,
sShipFromCountry, sShipFromZip, bSandbox)
Tax calculation by Avalara Tax Service
Parameter:
  fktDoc                  cfktAuf: document for which the tax should be calculated
  sShipFromStreet         String: sender's street
  sShipFromCity           String: sender's city
  sShipFromRegion         String: sender's region


                                                                                                 372
  sShipFromCountry         String: sender's country
  sShipFromZip             String:                sender's                   postal             code

  bSandbox                 Boolean: TRUE = use Avalara text access, FALSE = productive environment
Returns:
TRUE = no error


bRet = udf_ShowResults ( nMessageType )
Output of the messages
Parameter:
  nMessageType             Number: message type that should be displayed. This is a vector that can
                           be connected to the operand (|). (e.g. MESSAGETYPE_ERROR |
                           MESSAGETYPE_INFO)
Returns:
TRUE = no error


bRet = udf_CalcStandardTax ( )
Calculates the taxes according to the normal standard.
Parameter:
None
Returns:
TRUE = no error



5.13. IG construction prices

Over time, ever more IG prices (end product) are negotiated with the end customer. Due to
competition or to gain a market.
Today, the only possibility for managing this in AWB is to create a new IG product and define its
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




final price (primarily as sqm net price)
The number of fixed IG products for price design is growing constantly and thus, the maintenance
effort keeps increasing and the search keeps getting more difficult.
In the order entry, it is becoming more complicated to select the right IG product.
The most difficult point is the EDI import; several existing end customer references could refer to
this new fixed IG composition, and it involves additional effort to correct all of them according to
the new price negotiation.
All of this is simplified greatly with the new IG construction prices feature.
For set-up, the scripts 20210225a.sql, 20210225m.sql, and 20210226a.sql have to be executed.



                                                                                                373
In IG base product, the "IG construction price" check box has to be checked.




In the management program, a price table has to be assigned for each glass construction. This
price table contains the valid price for this construction. Different price codes or individual prices
can also be used. Whether the price is also valid for the mirrored construction is determined by
the "reversible" check box.




                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




Each change of the price assignment is valid immediately in the order entry; this is true even on
different computers.
Search sequence:

The access sequence is defined as follows

1. Fully qualified

This means that all existing components glass, spacer, and gas participate in the search.

2. Without spacer

The spacer with 0=all is found



                                                                                                    374
3. Without gas

The gas with 0=all is found

4. Without spacer and gas

The record with spacer and gas 0=all is found

If no assignment is found after these 4 levels, the default price table from the product data applies.
With triple IG, it is not permissible to assign a spacer or gas 0=all. This is already locked in the
administration program. The storage can only be done for all spacers and/or all gases with 0=all.

The spacer and the gas are no longer price-relevant if the definition for this product was made
explicit in the IG price assignment; for then it is assumed that this price is considered in the price
table. If you are working with 0=all, then the element remains price-relevant and there is a search
for a surcharge!




5.14. Limit quantities for parameterized macros


Parameterized macros are becoming more popular in order to be able to handle complex
processings. These can be applied very flexibly thanks to parameterization. The size can thus be
adjusted to the customer requirement and the number of processing articles kept small. But these
parameters frequently also have effects on the price design; thus, e.g. a small cut-out is cheaper
than a large one, or the parameterized drilling diameter defines the scaling of the price.

For this, the limit types "Macro <x> (dimension)" and "Macro <x> " are used for the 1st to 10th
parameters of the macro. Here, it has to be noted that according to the type of the parameter,
dimension or numeric value (e.g. angle), the appropriate limit quantity has to be selected. For a
dimension parameter, the limit type "Macro <x> (dimension)" has to be used; the <x> is a placeholder
for the parameter number. The prices can be scaled in the price management according to these
new limit quantities.

This is possible for vectors, matrices, and cube prices
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  375
Depending on the macro parameter, the price is drawn from the master data.




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




The limit quantity has to be set depending on the parameter. The limit quantity has to be assigned
using the parameter index (1 - 10).




                                                                                               376
6. Purchase
6.1. Transfer to purchasing

           Executing the P.O. transfer
After acquiring an order, purchase orders can be generated for the included purchase parts. To
ensure that this can be performed, the order must be in the valid status range of the status
allocation 30 "Transfer into the purchase pool".

           Repeated P.O. transfer after item changes
If an item was transferred to one or more purchase orders, then it is blocked for changes in the
item entry of the order. The function "Change blocked item" can be used to make changes
nevertheless. To ensure that this is possible, the purchase order must be in the valid status range
of the status allocation 660 and the order in the valid status range of the status allocation 650. If
one or two of the above is not the case, then the order item cannot be unblocked and edited.
If the item is saved after a change, then the associated purchase order items will be deleted and
the repeated P.O. transfer is triggered when closing the item entry. For this purpose, the purchase
order numbers and the purchase order items will be suggested again for the items that were already
in a purchase order. If the dialog is closed but the P.O. transfer has not been performed, then a new
P.O. transfer must be performed. In this case new purchase orders will be generated.

           Status points overview
  Status         Designation                     Description
  point
  30             Transfer into the purchase This status point is used if orders must be
                 pool                       transferred to purchase orders or the purchase
                                            pool through the menu item P.O. transfer
  650            Order status changed            This status point is used to check whether the
                                                 order is in the valid status range for a repeated
                                                 P.O. transfer
  660            Repeated P.O. transfer          This status point is used to check whether the
                                                 purchase order is in the valid status range for a
                                                 repeated P.O. transfer
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




  670            Purchase order created          Status point order for history entry and status
                                                 change after transfer to a new purchase order
  675            Inquiry generated               Status point order for history input and status
                                                 change after transfer to a new purchase inquiry
  680            Purchase order changed          Status point order for history input and status
                                                 change after transfer to an existing purchase
                                                 order
  685            Inquiry changed                 Status point order for history input and status
                                                 change after transfer to an existing purchase
                                                 order inquiry


                                                                                                 377
The status points 675 and 685 were added using the database script 20160620a.sql. If the script
has not been run, then the status points 670 and 680 are also used for purchase order inquiries.

         Purchase order for Georgian bars
If ordering Georgian bars, then the spacer can either also be ordered or the spacer will be
transferred into the purchase order, but it will be processed there as "do not order". This behavior
can be controlled with the company option "Order spacer together with the Georgian bars".
    •   If the option is set, then the spacer will always be ordered during the P.O. transfer even is
        it is not entered as a purchase order in the parts list of the order.
    •   If the option is not set, then the spacer will be transferred into the purchase order during
        the P.O. transfer, but it will be covered there with the acquisition type "do not order".




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 378
6.2. EDI Interface

          Preparations and settings
Using the EDI interface requires some settings in program “References”. First, we describe the
entries necessary to export purchase orders from A+W Business. This is followed by the settings
that are necessary to import external orders.
During import, interface files are imported in the A+W Standard format (see the separate interface
description) and imported for orders/quotations into A+W Business. For this, the system monitors
the folders that are configured on the dialog for the B2B customer management. If in the interface
file product numbers are used that are not present in the individual system, then mappings must
be created in the article references in order to refer from the external article numbers to your own
article numbers.

          Customers
In the B2B customer management, the customer is configured who sends via EDI interface files. For
this, at least the version of the interface file and the paths for the files must be entered. As soon as
an interface version has been configured for a customer, the import checks whether an appropriate
file is available in the specified source path. The command script is executed during import before
reading in of the interface file and during export, the script is executed after creation of the file.
Furthermore, the sequential number for the export is entered there and a different partner for the
article references if necessary.




                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                    379
In addition, on the "2.Parameter" tab, there are a few important settings with which the behavior
of the import can be controlled.




Here is an overview of the parameters in particular:
 Compulsory referencing      An article reference must be created for all products.
                             First there is a search for reference articles; if no reference is found
                            there, the article number is searched for directly in your own
                            inventory without mapping.
 Locking active              For the duration of the import, a lock file is created that prevents
                            simultaneous processing
                             No lock file is created
 Maximum lock time          Maximum validity duration of the lock file
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




 Definition of the           The document number from the interface file is used
 document number
                             The document number of the number range is used
 permitted
 Take over BOM               The product's BOM is completely composed from the interface
 completely from the        file. Own BOM definitions from the article master data or the article
 interface file             references are thus overridden
                             The BOM is composed from the interface file, the article
                            references, and the article master data. BOMs in the file will be
                            imported as exchanged elements and if necessary, surcharges will
                            be applied.


                                                                                                    380
 Dimension system and       Here, a dimension system deviating from your own settings and the
 dimension precision        dimension precision of the partner are specified. The import converts
                            this to your own dimension system.
 Do not generate             If errors occur during import, the document will not be generated.
 document in case of        The document number used at the time of import is saved and reused
 error                      for the import after error correction
                             The document is generated, any items with errors will not be
                            imported
 Restriction exceeded       
 rejects item               
 Exchange for restriction   
 violation                  
 Allow free complaint       
                            
 Basic product change       
 with 2x exchange           
 Delete inferior edge       
 processing on glass        
 Check processing            Check active (see chapter Bearbeitungsparameterprüfung)
 parameters
                             Check inactive
                            (Mandatory starting with version 2.2.028, checkbox is then inactive)
 Import of market           
 partner-specific texts     
 No shape recognition       
                            
 Expanded DXF import        
                            
                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL



         Selection of external documents
The selection of the individual documents for import is done directly in the table with the normal
Windows standards. That is, via mouse-click and if necessary <Shift> or <Ctrl> and mouse-click.
Furthermore, the three buttons above the table can be used to select all or no documents. The
third button starts a selection dialog on which particular criteria for selection can be entered.




                                                                                               381
         Multi-user operation
As soon as another user has selected a document for import, it is marked in the own view with an
icon and it can no longer be selected. This prevents a document from being imported in several
places and thus duplicated. The name of the employee who is currently editing a document and has
selected it is displayed in the table.




                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                             382
         Checking the reference article
As soon as the user has selected a document for import, the tab "2.Missing references" is activated.
As soon as the user confirms the selection with <Enter> or by clicking the "OK" button or by
selecting the tab directly, you change to the tab. The program checks whether for the selected
documents all articles were created in the B2B article references. If all references are present and
created correctly, the tab "3.Create documents" becomes active automatically. If at least one
reference is missing, this is displayed in the table. With a double-click, the program changes to the
management dialog of the article references, starts its new mode, and pre-populates the known
data fields. The user must add and save the missing data. As soon as the dialog is closed and the
user changes back to the import dialog, there is another check of the references.




         Creating the documents
If all reference articles are present and the user changes to the "3.Documents" tab by clicking "OK"
or pressing <Enter>, a display of the currently selected number manager appears with the
documents it contains. The user can now select the number manager into which the documents
should be imported or generate a new number manager by entering a new name. Furthermore, the
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL



client and the scheduling area are specified. The import is started by clicking "OK" or pressing the
<Enter> key. Insofar as no specification of the document number was defined, the number range
of the specified client and scheduling area is used.
After successful import, the imported documents appear in the overview of the number manager.

         Customizing function for scheduling the files
As already mentioned, the program either schedules the external documents in the buffer tables
on start of the import dialog or when pressing the "Import files" button. This functionality can also
be executed via a workflow with customizing. The customizing function
"udf_EDIImportToDatabase" exists for this. The call in a workflow task causes a search of their
directories for new interface files for all customers with activated EDI import and if necessary these
are transferred to the buffer tables. If in the import dialog the automatic update is switched on, the


                                                                                                  383
documents stored this way appear automatically in the overview directly after successful
scheduling. Error messages can, as for all workflow tasks, be viewed in the Workflow Monitor.
Example:
udf_EDIImportToDatabase ( );
The function has no parameters.

           DXF shape recognition
Prerequisite for using this new function is Shaping&Nesting from Version 2007. The DXF files have
to be entered in the EDI file in field SN Name of the shape record (M1). The DXF files themselves
have to be saved in the same directory as the EDI files. After successful import, the DXF files are
moved to the backup directory. If shape recognition detects a free shape (shape 99) instead of a
standard shape, the system will create a SN file with the converted shape data in the SN path.

           Progress indicator/options
All events that occur are displayed as progress in the lower half of the dialog in a table. Via the
Options menu, the message types (info, warning, and error) of the progress can be selected
individually. Also whether the files can be transferred into the buffer tables on start can be set here.
If this is deactivated, the transfer can be started with the "Import files" button. Via the checkbox
for automatic updating, the table with the documents is updated at the specified second intervals.
The lower limit of the interval for this is 5 seconds.




                                                                                                             A+W Software GmbH - Configuration A+W Business - INTERNAL




With a double-click on a document, a new dialog is displayed on which all data of the selected
document can be edited. With a right-click on a document, a context menu appears via which, in
addition to the display of the document, a lock that may no longer be valid can be lifted. For the
lifting of this lock, a sub-right of the import dialog is required. If no rights are created, any user can
lift the lock.




                                                                                                      384
On the Options menu, you can set whether or not the log is displayed via the import on the dialog.
If the progress is hidden, it is displayed automatically on the start of an action. With the "Hide
progress" button, it can be hidden again.

         Import in background
For the automatic processing of EDI files, it is now possible to create a workflow task for the
Exchange Service. For this a formula is created in the formula management, which calls the function
udf_EDIImport. An example of such a formula, including the sending of the processing status, is
found in the installation folder under the general formulas (Workflow_EDIImport.txt).

         Processing parameter check
For the EDI import (Documents>Order>Import) effective immediately, the processing parameters
in the processing record can be checked. The check can be enabled in the third party interface
management (Master Data>B2B>Customer>Customer>2.Parameters tab>Check processing
parameters) (en). Starting with the interface version Standard Version 2.2.028, the check is enabled
by default and can no longer be switched off. For Edge processings, for example, the number of
marked edges is checked, that is, if there is no shape, logically a maximum of 4 edges can be
processed. If during the check of corner/edge assignments parameters are not set or values are
impermissible, these are corrected automatically. Both this correction as well as errors during the
check are logged on the progress/report window of the EDI import. For Miters, among other things
the angle is checked for a correct value (> 1 and < 89). Insofar as for a Hole drilling a coordinate is
not set, it is pointed out that at least one parameter of the processing <Drillings> was not entered.
The next message shows in detail which parameter is missing or impermissible.

         KLAES – XML / Internorm EDI interface version
The interface types (versions) Klaes and Internorm, which correspond with the EDI interface
version 2.2.025, can now be defined in external interface management. Both cases deal with
editing XML files, but with different structures. For the processing of the files, these must be
copied into the EDI source directory. When starting the EDI import, the XML files are converted
into the A+W EDI format using a filter program. If conversion is successful, the files have been
created in EDI format in the same directory, which can then be automatically read into A+W
Business. If errors have occurred in conversion, these are documented in the protocol file defined
in external interface management. The source file (XML) is then moved into the backup directory.

                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                   385
Furthermore, the B2B customer (see screenshot) and the product references must be defined in
the external interface management.
Klaes example – Product = Contents from junctions in XML structure
a)       Insulating glass (main product) = <glassproduct>
b)       Glasses = <key> or <sys_key> under <pane_structure\pane>
c)       SZRs = <key> or <sys_key> under <pane_structure\szr>
d)       Spacer = <key> or <sys_syskey> under <edge_seal\spacer>
e)       Sash bars = <sprkey> or <XItemId> under <glass_sashbar\sashbardata>




          Internorm interface
                                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL




With the help of this interface, XML files are transformed into the A+W EDI format. During
processing, logging is done in a file. There is writing to the log file in the following cases:

     •   Syntax error in the input parameters
     •   Conversion error (XML is not formatted correctly)
     •   No customer number was written in the XML file
     •   No width or height or quantity or product number
     •   DUMMY - item
     •   DUMMY - Georgian bars

So that everything works correctly, the following adjustments are required:



                                                                                            386
       6.2.13.1.    Adjustment of the VB script Auftraege_Import.vbs
The script serves to read all XML files out of the import directory. As a result, all paths must be
adjusted.

•   Path of the source file ex.: “\\xxx\xxx\Import\“
•   Path of the target file ex.: “\\xxx\xxx\Source\“
•   Path of the log file ex.: “\\xxx\xxx\Prot\import_prot“
•   Path of the exe file ex.: “C:\xxx\Albwir.Edi.Order.Transform.exe“

       6.2.13.2.     New path entries in the partner external interface management

•   Source path ex.: “\\xxx\xxx\Source\“
•   Source file ex.: “*.asc“
•   Log path ex.: “\\xxx\xxx\Prot\“
•   Back-up path ex.: “\\xxx\xxx\Save\“
•   Command script ex.: WSCRIPT.EXE "C:\xxx\Auftraege_Import.VBS"

       6.2.13.3.     Adjustment of the EDI import

•   New screen button for opening the log file with the help of customizing
•   New screen button for deleting the log file with the help of customizing

       6.2.13.4.     Adjustments of the customizing formulas

•   In the formulas, the path of the log file must be adjusted.
•   Formula for opening the log file. It is attached to the first button.
•   Formula for deleting the log file. It is attached to the second button.
•   Expansion of the formula EDI, which is called after the import of an order.
•   Formula for the two buttons.




         EDI import of payments/complaints
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Effective immediately, the EDI import (e.g. Documents>Order>Import) can process the record type
A1 for payments on the header level. The following structure was defined for this:




                                                                                               387
The record type is only imported and is not intended for the export of EDI documents. If you import
an EDI file and such an A1 record is included in the file, then the data is written to the new
intermediate table FS_DOWNPAYMENT. After that, the imported data is evaluated and processed
further if necessary. Now e.g. in case of an order, the payment data record is transferred to the
table BW_AUFTR_ANZAHLUNG. The user then has the opportunity to view the data in the
management program for payments (e.g. Documents>Order>Order>Totals tab>Payment Total
button) and change it.


                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               388
Furthermore, complaints can now be imported via EDI. The document to be imported must be
marked in header record K5 field 9 with Document type as Complaint. Here, the user has the choice
whether "Complaint" is directly in the field or a so-called mapping value for the foreign key
(@REKLA@) or the internal sequential number (#2#) should be used to determine the document
type. The same logic applies for the newly-added fields 18 and 19 in the item record P2, Complaint
reason and –Location.
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Another functionality has been developed for the import of complaints, which checks the fields 2
and 3 of the item record P3 to see whether a reference number (and reference item) is entered
there. If there are several P3 item records with different references to a header record K1, the same
number of complaints must be generated since the restriction in AWB is as follows: you can only
assign one complaint to an original order (assignment of the original via database column
AH_HAUPT_AUFTR in the complaint).


6.3. Export of purchase orders
First of all, enter the customer number you have at your supplier's, on the second tab in field
External number.


                                                                                                 389
Fig. 135: Export of purchase orders

Now, define the export parameters in program „References“. This menu is accessed via the buttons
“Supplier” / “Supplier”.
In field plant number, enter the company number of the target system (supplier). The multi-line
field „Batch file for interface“ allows to enter batch commands to be executed after the export in
order to start an EDI terminal program for instance, or to copy the exported files to another
computer. Set the interface version in combo box „EDI type“. In the patch fields, enter the source
and target path, log path, and backup path for the interface file. Checkbox „Compulsory reference“
will make the export program enter an error message in the log book if there is no reference, and
ignore the item with the non-existent external product. If this field is switched off, the original
product number from product master data will be written in the interface file. This is useful for
instance if the sending and receiving systems are using the same product master data. This is e.g.
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL



useful if the sending and the receiving system use the same product master data. Checkbox
„Locking active“ in connection with the data field „max. lock time“ switches on a mechanism for a
certain time; this shall prevent that two programs can access the same interface file simultaneously.




                                                                                                 390
Fig. 136: External interface - supplier

Now the article references must be created, insofar as the own article numbers from which those
of the supplier differ. Switch to the product reference dialog.
Define a product for the required supplier. Shapes, Georgian bars and processing steps can be
allocated in the same way as you do this at order entry. Also, specify the validity for every product.
This is necessary for example if a supplier plans to change his product data (partially or completely)
at a certain date. These changes can be entered in advance, but will be used for export purposes
only after they become valid. The old product definitions will become invalid.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  391
Fig. 137: Product reference dialog

The start the actual export, switch to the document area, click in the menu on P.O > Export and
start the export program.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 138: Export program

A table appears containing the POs defined for the selected number manager. Click on OK to start
the process. The status of the successfully exported purchase orders will be raised to prevent that



                                                                                               392
a purchase order is exported over and over again. Should there be an error during export, you can
check this in the system log, and print if required.




6.4. PO export via the Dorma Web Service
It is possible to transfer POs for the hardware manufacturer Dorma directly to its Web service. The
configuration required for this will be described below. Essentially, this works so that on the A+W
Business dialog for the EDI export, a table is filled with the Dorma POs. The table is read in at
intervals of 5 minutes by AWSOA Commercial 6 Exchange Service and all POs found there are
transferred to the Dorma Web Service. No workflow is required for this, the export is executed in
the same thread of the openTRANS export. In the company master data, on the tab "10.System",
the check box "Activate Exchange Service for workflows" must be switched on. Directly below it,
the thread is entered in which the openTRANS export and also the Dorma export should be
executed. If there is a zero there, the export is deactivated.




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




Then comes the definition for the access to the Dorma Web service. This is also taken care of in the
company master data on the tab "7.Stock/PU/EDI".




                                                                                                393
Now it must be specified which number the supplier "Dorma" should have in the respective
installation. For this, in the program "Master data > B2B > Supplier > Supplier" the interface type
"Dorma" is assigned for the supplier.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               394
Now it is necessary to create the product references for the Dorma article. This can either be done
manually in the program "Master data > B2B > Supplier > Products" or by import of the Dorma
article (see Chapter 1.8 Article import).




Error messages for the transmission to the Dorma WebService can be viewed on the Customizing
Monitor under the "openTrans" workflow.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               395
6.5. Additional functions

           Copy external products:




Fig. 139: Copy external products

This dialog serves to copy external product definitions from one customer/supplier to another. This
dialog is accessed via the product reference program, entry „Functions/Copy product“.

           Edge reduction for Georgian bars in customer data as from Version
           3.3
So far, the parameter GEORGIAN BAR EDGE REDUCTION was only managed in customer master
data, and did not influence order entry.
From version 3.3, the edge reduction for Georgian bars is analysed in connection with the
calculation of cutbacks, and has priority over a purchase price calculation pattern.
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




When you update to 3.3 please check whether field Georgian bar edge reduction (tab Production)
in customer master data contains information that might cause errors when you calculate the
cutback.




                                                                                               396
6.6. Electronic document exchange

          Order confirmation and invoice
General
As from Version ALFAK2008, order confirmations and invoices can be exported and imported again.
The format used is the document exchange format openTRANS which has been adapted to ALFAK.
It is also possible to import documents without this amendment, i.e. in standard format.

Document export
The export is configured individually for every customer. You can therefore defined whether and
which documents shall be exported for the customer in question. External interface management
offers a new menu for this purpose, Document export. This dialog also serves to define the export
mode. There are two versions at present:
    •   Automatic email dispatch
    •   Saved in a defined directory (on the server)
Prerequisite for using the automatic email dispatch is that an email server is available in the
network. The email address defined in customer master data is used as the standard address for
sending documents to the customer. If an alternative address shall be used, it can be entered in
dialog Document export.
Prerequisite for exporting documents successfully is that up-to-date archives exist and that a
purchase reference has been entered [DokNo u. ItmNo] for the order item, tab „More details" and
the Interface Service has to run with enabled B 2 B handle function!
When order confirmations and invoices are printed, the program will automatically check whether
there are documents for which document export is active. If so, there will be a query as to whether
document export shall be started. If this is confirmed, the corresponding documents will be marked
for export. For every order there is an entry in order history, showing the corresponding status
point (830 for invoice export or 840 for order confirmation export). If these status points have been
allocated, the order will be set to the allocated status. The minimum or lock status is not checked
because export is always directly linked with the print job.
A service is installed on the server (in new versions, AIS) which searches in regular intervals for
documents marked for export. After that, the service runs the actual export automatically in the
background. All exported documents will be saved in archives. To check this, the print program
offers the tab Document export which shows the status of all documents currently marked for the
export.
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Please note: Roto invoice export has been integrated in the new process. Processing will be started
together with the printout, not upon transfer to financial accounting as before.
Export will create special files:
    •   RESPONSExxxx.awotres files are openTRANS-based order confirmations with
        Albat+Wirsam-specific amendments
    •   INVOICExxxx.awotinv - files are openTRANS-based invoices, also with Albat+Wirsam-
        specific amendments

Document import




                                                                                                 397
If a supplier sends in one of the two above-mentioned files, these can be imported by double-
clicking on them. This even works from an email client. The above-mentioned file suffixes were
linked with the program Albat+Wirsam openTRANS ImportTool for this purpose.
 If the files are saved on the hard disk, a generic view of the document is available by means of a
right click and the option View.
The import tool only supports openTRANS files 1.0, Version 2.1 is not supported.
 Apart from the links to the above file suffixes, files with the suffix .xml can be imported as well.
These files cannot be started directly from the email client however. A right click on the file and use
of the options Import as openTRANS document wor Show as openTRANS document will start the
corresponding action.
After the document has been imported successfully, it is available in dialog Electr. price check or
Electr. invoice check which have been added in section Purchasing, Order confirmation and Invoice.
The dialogs are only slightly different, which is why this description applies to both.
Electronical price check and Electronical invoice check

General
The locking behavior in connection with the price and invoice check has been changed by another
patch for ALFAK 2007. When a purchase order is accessed during an invoice check, it will be locked
now. This means that a purchase order cannot be opened for a price or invoice check and P.O. entry
at the same time. The new function 'Open P.O. entry' can be used to amend the P.O. during a price
or invoice check. This function opens a limited P.O. entry, only for the purchase orders which are
currently being checked with regard to prices or invoices.

List of documents and filter settings
When you access the dialog, the document view at the top shows all imported documents of the
type in question. Various filter settings can be made for the view:
The combo box below the table defines whether only open (i.e. still unprocessed) documents, only
rejected documents, or all documents shall be shown.
The button next to it offers additional filter options. These settings will be saved by user. In the top
section you can search for the user who has entered the P.O. that belongs to the document:
All means that there are no restrictions
Only one's own means that only documents entered by the current user will be shown
Defined means that only documents will be displayed the purchase orders for which were entered
by the defined user
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




The items "Only one's own" and "Defined by" can combined. This could be used for holiday
replacements for example when a user will have to handle not only his own documents but also
those entered by his colleague who is on holiday.
In the bottom section you can search for suppliers. The document view shows only documents from
suppliers defined in the filter settings.

P.O. list and document status
When a document is selected from the document list, all related purchase orders will be loaded
and linked with the document. The result of this link is shown in the sections 'P.O. list' and
'Document status'.
The P.O. list shows all related purchase orders. If there is one or more partial shipment(s) for a
purchase order, this/these will be shown in blue letters. An icon in front of each P.O. defines

                                                                                                    398
whether the link between P.O. and document is complete. If this is not the case, column 'Notes' will
tell you why this is so.
The 'Document status' view shows whether the document could be completely linked with all the
related purchase orders. Like the document status, the individual criteria will be shown in color.
The criteria are:
Purchase orders completely referenced
Tells you whether the document refers to all purchase orders. This cannot be the case e.g. if the
present document refers to a partial shipment. If the purchase orders are not fully referenced but
the document is otherwise complete, a partial shipment can be issued automatically (see booking
modes)
Article items missing from purchase orders
Tells ou whether the order confirmation or the invoice shows more items than listed in the P.O.
Overall surcharges/discounts missing from purchase orders
Overall surcharges/discounts will not be ordered as a rule but still appear on the order confirmation
and on the invoice. These items have to exist in the purchase orders in order to run an invoice
check.
Price difference
The purchase orders and the present document show different prices. The fields next to this show
the difference as an amount and as a percentage.
Difference in quantity
The purchase orders and the present document show different quantities.
Document view
This button serves to display the newly imported document in generic form.

Booking modes
The document status tells you which booking modes are valid for the newly imported document. If
the document status is green, the document can be booked. Above the document view, the
program automatically changes the booking mode to 'accept'. The booking modes are:
Reject: The document will be rejected. There will be no price check or invoice check; the document
gets the status 'rejected'. All related purchase orders will be set to the status allocated to status
point 61 (for order confirmations) or status point 64 (for invoices).
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




Accept: The document will be accepted. The prices shown in the document will be applied to the
purchase orders. The order confirmation number of invoices number plus all other document data
will be saved. The status of the purchase orders is also set to 'Order confirmation check' or 'Invoice
check'.
Issue partial shipment: A partial shipment will be issued. The imported document does not include
all items of the related purchase order. Based on the document items, a new partial shipment will
be issued which will be booked as described for 'Accepted'.Baseed on the document items, a new
partial shipment will be issued which will be booked as described for 'Accepted'. The remaining
items are kept in the original purchase order. The status of this P.O. will not be amended.

Item overview



                                                                                                  399
You can switch to the item list to see which items cannot be allocated. This is where all items of this
document are listed. If a purchased item could be found relating to an item of the document, it will
be displayed in the same line.
The P.O. items that could not be allocated to a document so far are shown at the end of the table.
Like in the P.O. list, icons in front of each line mark the status of the individual items.
Overall surcharges/discounts are special. It may happen that the supplier sends just one invoice for
two purchase orders, and that an overall surcharge appears just once in the invoice. Still, the overall
surcharge applies to both purchase orders in this case. To handle this, all related P.O. items will be
shown in the lines in front of the document item. The blue downward arrow shows that these P.O.
items belong to the document item.
A detailed view for all lines of the item list is available at the bottom of the dialog. It shows details
on the document items and on the P.O. items. If a P.O. item has been allocated to a document item,
the details can be directly compared in this area.

openTRANS functions and options
The menu offers a new main item, openTRANS. It includes various functions and options for the
processing of openTRANS documents. Separated by a line, the functions appear in the top section
and the options at the bottom.

The functions are:
Manual allocation of items
If the P.O. references are incorrect or missing from an openTRANS document, the system cannot
automatically link document and P.O. items. Linking can be done by hand in this case.
Selecting this function will open a new dialog consisting of two tables. The table on the left lists all
document items that could not be allocated while the table on the right shows all P.O. items still to
be allocated. Allocation is made by selecting one document item and one P.O. item each, and
pressing OK. The now allocated items will be removed from the corresponding tables.
Special case: overall surcharges/discounts:
As already explained in connection with the item list, it may happen that an overall surcharge shown
in an invoice has to be allocated to several purchase orders. This is done by keeping the CTRL key
pressed while selecting the P.O. items from the table.
Another speciality of the overall surcharges/discounts is the option of using the product number to
define the future, automatic allocation to a certain supplier. The supplier's product number is saved
along with one's own product number for this purpose. The two checkboxes at the bottom of the
                                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL



dialog can be used for this purpose. If both checkboxes are active, the overall surcharges in future
documents from this supplier will be automatically linked with the currently selected product
number.
Another special case: ALFAK - collective invoices:
If collective invoices are issued by ALFAK, the overall surcharges/discounts will be listed as separate
items for every order. Since the direct, manual allocation is not always easy, several document
items can be combined and allocated to the P.O. items in this case. Subsequently, only the collected
document item will be listed in the item overview. This method is always used for the automatic
allocation of overall surcharges/discounts.
Distribute footer surcharges/discounts to P.O.s.



                                                                                                     400
If a document's overall surcharge/discount is distributed to several purchase orders, the
proportional amounts have to be maintained. Based on the surcharge basis, the program tries to
find and offer sensible suggestions. These can be changed any time.
Reverse manual item allocation
This function cancels all manual allocations
Apart from the functions there are two options:

Suppress automatic allocations
 If this option is active, overall surcharges/discounts will not be allocated automatically even if this
would be possible based on the product number. This option can be used if the automatic allocation
is incorrect. When this option has been changed, the document in question has to be imported
again to make sure that the changes become effective.

 Trusting the supplier's product reference numbers
 You can enter a product reference number in the openTRANS document. This means that the
supplier knows one's own product numbers and uses them in documents. Based on this product
reference number, overall surcharges/discounts can be allocated automatically if this option is
active.

          Dispatch notifications
Now it is possible to create dispatch notifications in openTrans format. The file suffix for dispatch
notifications is *.awotdis. Imported dispatch notifications can be used as template for booking in
receipt of goods.


6.7. Export of invoices

          Preparations
First, run all update scripts that have not been run so far. Now enter the status allocations for status
point „830 invoice export“ acc. to the customer’s situation. In customer master data, enter the
external customer number you have got for the recipient of the invoice export (vl)!! Please note
that invoices will be exported right after printing; the minimum and lock status has to take this fact
into account.
Next, set the EDI type to „Standard (openTRANS-based)“ in reference management, „Customer –
invoice export“, and set the directories accordingly. This has to be done for all customers to be
included in the export.
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




Now, only the A+W Business Interface service must be installed and started.
When you print invoices, an export record will be saved in a transfer table which is then processed
by the A+W Business Interface service, and is saved as an XML file in the defined place. From there,
the file has to be transferred to the corresponding customers e.g. by means of VB scripts.


6.8. openTrans 2.1 and credit notes
Starting with version 13.04.112 it is possible to export documents in format openTrans 2.1. In dialog
B2B > Customer > Document Export set the export type to Standard (based on openTrans 2.1).
For one customer only one openTrans version can be used:


                                                                                                    401
In addition, export of credit notes is possible (only openTrans 2.1). To use this function, execute the
following database scripts:
    •   20171127a.sql
    •   20171130a.sql
For the export of openTrans 2.1 documents, the licence 158 must be released.
The A+W Business Interface Service must be up-to-date.
To imitate the export of credit notes, a print of credit notes must be executed. The document is
transferred to the document export pool, that can be seen in the third tab of the print dialog.




                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




The pool display was extended by the openTrans version to get a better overview of the documents
to be exported.



                                                                                                   402
With A+W Production 6.3, now ordered parts that are not usable (breakage, scratches,...) can be
repurchased during production. The unusable sheets are reported by the production system to the
order entry and using a separate dialog, a repurchase, complaint, order credit or reduction of the
order quantities can be made.
The license 154 must be purchased for this module.

           Notification
If there is a break of an ordered part in production, this is reported to A+W Business. In the
employee management, it can be determined per employee that this person receives a message if
a repurchase is required:




Fig. 140: Notification per employee

All employees for whom this message is activated then receive a notification in the scheduling
overview when there is breakage of ordered parts.
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 141: Scheduling overview

With a double-click on the line, the repurchase dialog for this order can be opened directly.
Alternatively, the dialog can also be started from the menu and the appropriate orders selected via
the QBE mode.

           Generation of repurchases
In the Re-purchasing program, the user has the opportunity to repurchase purchased parts of an
order that have been reported broken, to lodge a complaint, to invoice by value or only to reduce
the order quantity.

                                                                                               403
Fig. 142: Repurchasing QBE mode

To get an overview of the orders, you can filter by Order (from-to) and Delivery date (from-to) in
order to limit your selection
In the table, all order-purchase order assignments are displayed for which a re-working is required.
With the Action selection box in the screen table, the user can define whether the broken purchased
part should be repurchased, whether a complaint should be lodged, whether it should be invoiced
by value or the order quantity should be reduced.
Fig. 144: Repurchasing by order

Fig. 143: Repurchasing by delivery date




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                404
If a complaint should be lodged, a reason for the complaint and location must be set or you must
leave the pre-defined values.


Fig. 145: Selection of the action




146Fig. : Action complaint selected


In case of a by value booking, the new order is created with a negative item quantity so that the
booking out from the purchasing statistics can be made correctly. In case of a reduction of the
order quantity, a re-order is excluded and only the original order is corrected by the broken
quantity.




However, before you execute the selected actions, a target number manager should be defined in
which the new documents should be entered.


Fig. 147: Target number manager



After creation, you will be asked whether you would like to print out the new orders. If you say yes,
the print program opens with the defined number manager.



                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 405
Fig. 148: Repurchase generated and print executed




In addition, of course you have the possibility to print out the new documents via
                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




Documents>Purchase order>Print purchase order.
Important: if the notification comes from production that there should be no re-purchase, only the
actions Invoice by value or Reduce order quantity are allowed. In both cases, the quantity is
adjusted in the order in A+W Business. No message to production is sent.

           Message to production
If on the repurchasing dialog the actions Invoice by value or Reduce order quantity are selected
although the production system expects a repurchase, the reduction of the item quantity is
reported to the production system and the quantity reduction is entered as sub-quantity in the
item. The quantity change and transfer of the order are done with the report to production.



                                                                                               406
         Configuration in A+W Production
The message about the breakage of ordered sheets must be enabled in A+W Production with the
[ALCIM_STATE / ERP_BREAKAGE_FEEDBACK] switch. This change takes effect after a restart of the
booking service. The change will be displayed after restarting the booking service.




                                                                                                A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                          407
6.9. Change of the order quantities in case of under or oversupply
   of purchased parts
During goods receipt, the quantities of purchased order items can be changed with an under or
oversupply. For this functionality, the fileless reporting must be enabled and for the order change
after production transfer, the PPS Webservice must also be configured. The functionality must be
activated in the company master data on tab 7.




On goods receipt, two cases must be distinguished:
Order is not yet in production
If the order has not yet been transferred to production, the new quantity is entered in the purchase
order and a corresponding under/excess quantity is stored in the order. The under/excess quantity
is then transferred with the production transfer (OrderXML) to production.
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




Order is already in production
If the order is already in production, first the quantity difference is reported to the production
system and if this was successful, the corresponding difference is entered in the order item as
under/excess quantity. A+W Production 6.3 is required for this message.


In both cases, the actual correction of the order quantity is only made with the production
reporting!
The quantity change in the order item is made immediately.
Only completely-ordered order items can be changed (for ordered BOM elements, there is no
action).

                                                                                                408
         Configuration in A+W Production
With a transfer, in A+W Production a new item with the excess quantity is generated for further
planning. If sheets are broken, a remake item is only created if this excess quantity is underrun.
In case of an undersupply, A+W Production tries to cancel the undersupply. This only succeeds if
not-yet-booked units are available. If not otherwise defined, the first cancellation reason found is
used. If you want to use your own cancellation reason, the corresponding status bar code must be
stored in the switch [ALCIMBOOK / AUTOMATICCANCELSTATUSBC]. This change takes effect after
a restart of the booking service.




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                409
7. Stock
7.1. Configuration examples
Stockkeeping of glass articles in sqm and automatic er und automatische stock orders for
stocksizes
This configuration example explains the settings that are necessary for keeping glass articles with
quantity unit "sqm" on stock and creating a suggestion for a stock order when the stock on hand
falls below the defined minimum. This purchasing suggestion shall consist of a stocksize with fixed
measurements. As a result, you will see the available stock on hand for this glass article as a surface;
there is no need for a production report in order to withdraw the used stocksizes from stock (XTV
report).
This example shows all necessary settings, using the article „1008 – Float 8 mm“ as an example.
First, set the supply type and the stock booking type in product master data. To keep the article on
stock, choose the supply type „stock withdrawal“ and set the stockkeeping type to „1-not size-
related“.




                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 149: Supply type




                                                                                                    410
Next, enter the glass article in inventory management. Enter the record without a size, and the size
to be used for creating the purchasing suggestion. In this example, the record is entered with a size,
i.e. the stocksize, and the measure 3210 x 6000 mm. Please make sure that the main article in both
cases is the stock article of this size. This main article will be used to create the purchasing
suggestion. It is also necessary to compare the minimum stock for the two records. This means that
if the minimum stock of the stocksize is 10 pieces, the minimum stock of the sqm article should be
192.6 sqm. (10 x 3.21 x 6.00 = 192.6 sqm)




Fig. 150: Stockkeeping minimum surface




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  411
Fig. 151: Stockkeeping minimum quantity

These are the necessary settings. To create a purchasing suggestion, start the program "Stock P.O."
in inventory management, and click on [OK] to calculate the purchasing suggestion. Mark the entry
in question and click again on [OK] to create a stock P.O.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 152: Stock P.O.



                                                                                               412
The purchasing suggestion can be displayed at item entry.




Fig. 153: Item entry and purchasing suggestion

When the stock search is started at item entry by [F3] you will see that the quantity for this P.O.
item will not be booked to the stocksize but to the sqm article.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 154: Stock search


                                                                                               413
As a last step, book the receipt of stocksizes upon delivery. This will raise the stock on hand for this
sqm article.




Fig. 155: Receipt of goods


7.2. Availability on stock and replacement time
To get a tangible statement on the stock on hand at a certain date, the expected booking date has
to be defined for all goods to be received and withdrawn in future. When drawing up the list, all
reservations will be deducted from the stock on hand, and all ordered goods will be added. This
shows the expected stock on hand depending on the time.
To exempt certain articles from the stock forecast and availability check, tick in Product master
data, tab 4 Inventory/purchasing the checkbox No availability check. The field „Number of
workdays“ in company master data in group „Stock forecast“ can be used to define the time for the
forecst. When you enter zero, the forecast will be unlimited.
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




The expected booking dates will be fixed as follows at item input. BOM elements and products of
the supply type Stock withdrawal and cutting are entered at the start-of-production date. For all
other stock articles, the shipping date stated in the document will be used as a booking date.
When the order is scheduled in ALCIM Capacity Planning afterwards, the expected dates will be
updated with the calculated, actual ones.




                                                                                                    414
Fig. 156: Overview of the future stock on hand

Stock management now permits to link several stock sizes. This means that the minimum stock has
to be defined only for the main article; the stock on hand will be checked against this. The above
illustration for instance shows the links for article 1004 with a size of 0x0, 3210x4000 and
3210x5000.
A double click on a line in the stock preview produces a dialog listing all documents responsible for
the reservations and purchase orders.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 415
Fig. 157: Defining the main article in stock management


Should the stock on hand fall below the defined minimum at a given date, there are two options.
The first possibility is that there is sufficient replacement time for the article. On the other hand, it
may happen that the replacement time is too short. In the first case, the corresponding lines will
be marked in yellow in the stock forecast. In the second case, the lines appear in red.
To see whether the delivery for a certain order can or cannot be kept, the document header offers
a button next to the shipping date. The replacement time for the entire document will be checked.




                                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                     416
Fig. 158: Document header




                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 159: Checking the replacement time

The articles for which there is not enough replacement time will be listed in a dialog. This dialog
also shows the alternative suppliers defined in the supplier file for the corresponding article. It also
shows every supplier's replacement time and the resulting delivery date. Double-clicking on the
article in the top spreadsheet will open the stock forecast for this article and shows the details.




                                                                                                    417
The replacement time for an article is calculated from the delivery time defined for this article or
its product group in the supplier file, and the route days defined for the supplier in route
management.




Fig. 160: Delivery time shown in the supplier file




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 161: Route management and route days




                                                                                                418
The stock forecast is also accessible from the stock search dialog on tab 2 or from document header
input using the menuFunctions > Stock forecast. If started via stock search, the forecast will be
displayed for just one article; started from the document header input, it shows the forecast for all
stock articles of this document.
Should the ERP web service (ALCIM Capacity Planning) run an availability check and detect a
shortage, an email can be dispatched through a customising formula. For details please refer to
chapter „Customizing - Customizing the availability check for stored goods“.


7.3. Goods received and shipped in boxes
The new receipt of goods dialog is accessible in document management, menu P.O.-Receipt of
goods-Receipt of boxes. This allows to define unique IDs for the boxes. You can also enter different
numbers of sheets for the individual boxes. Prerequisite for this is that the option Use virtual item
numbers is active in company master data. When a stock P.O. that includes boxes is selected, the
tab ‚receipt of boxes’ is enabled.




                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 162: Receipt of boxes

To enter an individual number of sheets as well as an ID for every box, every box of an item is
represented by a new line in the overview. If an item contains five boxes for instance, five lines with
one box each will be shown. After the number of sheets and the ID numbers have been entered,
click on OK to book the receipt of goods. In the P.O., a so-called virtual item number is created for
every box to save the number of sheets and the ID.
Shipping of boxes is handled by means of menu Despatch-Shipping of boxes in the production area.
This dialog works like the receipt of goods dialog, except that you can only select boxes with ID
numbers that are actually available on stock. The number of sheets can be changed if required.
Goods are withdrawn from stock as usual, i.e. when the shipping note or invoice is issued,
depending on the configuration of the status for the withdrawal of goods from stock.

                                                                                                   419
7.4. Combined stock mode and XTV/XOPT report
To activate the combined stockkeeping for certain products, you need to set the stockkeeping mode
to stock products (combined) in the product program, tab 4 (Inventory/Purchasing).
To activate the processing of XTV/XOPT reports, the product numbers entered in XOPT or A+W
Production have to be entered in A+W Business. This is done by means of the key „optimization“ in
the product program, tab 2 (Production). In addition to the combined stock mode, the A+W
Production product number will be entered for every product. After this, you just need to configure
the interface demon (abcbatch.exe). Activate the checkbox „Import of XOPT reports“ in Options-
Extended Settings. The source file and backup path are set in Options-Path settings-XOPT report.
Please make sure to use only UNC paths.
ATTENTION: The XTV/XOPT report file will be created for every optimization. If the optimization is
cancelled, please make sure that the file is not loaded into A+W Business; otherwise, the will be a
wrong withdrawal. Stockplates from manual cutting and breakage have to be reported manually.
When a stockplate is withdrawn by means of an XTV/XOPT report, it will not be withdrawn only
from the default storage place. It is possible via the file extension of the report to use a particular
deviating stock location. This file extension is entered in the stock definition (Master Data > Stock
> Stock Definition) in the designation of the stock location in question. It must be noted that this
file extension must be entered without leading zeroes. If a stock location should be assigned several
file extensions, then all extensions must be separated with a semicolon in the designation of the
stock definition. The file extension is used in A+W Production for the machine number.


7.5. Stock initialization
Initialisation of stock consists of three steps:
    •   Delete stock
    •   Stocktaking
    •   Initialize stock in program „Utilities“
Start by deleting all records from the stock via script. Run the script „LAGER_LOESCHEN.SQL“ in
SQLTalk on the main database for this purpose. The script is found on our server in
„\\\\Speedy\\Install\\SQL-Scripte“.
Now create an inventory list and take the complete stock.
To make sure the old orders and stock orders are correctly initialised, load and execute the
initialisation program in module „Utilities-Lagerinit.“. Depending on the data quantity, this may
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




take some time and should therefore not be done during operation.




                                                                                                   420
7.6. Stockkeeping: Boxes with BOM

           Installation
To enable this function, the programs abcauftr.exe, abcstamm.exe, abclagwirt.exe and abcfert.exe
need to be updated, and the scripts 20080910a.sql, 20090129a.sql, 20090130a.sql and
20090312m.sql have to be run on the database. Script 20090129a.sql is language-dependent and
has to be installed in the language configured in the database.

           Master data definition
Boxes with BOM are articles the structure of which is more complex than the glass boxes known so
far. Picture frame glass can be wrapped in paper for example, and can then be put onto a pallet.
This example article structure will be used to describe the new function.

           Product Master Data




Fig. 163: BOM with a complex box in product master data

Illustration 1 shows the BOM structure for the above example. To make sure that the system will
recognise these products as boxes, the product type has to be set to 200 – box (see illustration 2).




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 164: Product type of the box in product master data.

To make sure that the article can be kept in stock, the supply type must be set to Stock withdrawal,
size-related.




Fig. 165: Supply type


                                                                                                421
To facilitate the input of this product, you can enter a standard width and height for the article
(illustration 4). This way, the matching box article will be automatically selected when the article
number is entered at item input.




Fig. 166: Standard sizes in product master data facilitates the input




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




           Prices
Unlike for the boxes known so far, the price relevance codes will be analysed on main product level
and on BOM level for pricing purposes. So far, the box price used to be calculated and shown only
in the box BOM. The price relevance codes are used to configure this for the new box type. Based
on these codes, the price of the end product is determined by the price of the BOM element, of the
main item, or by both.




                                                                                                422
Price management allows you to enter the box prices as usual. It may be useful to enter them as a
matrix with the limit types Exact width and Exact height. This makes it easy to define e.g. unit price
for different sizes. (see illustration 5)
If you want to determine the price for the pallet (in the example above) only by means of the total
box price (i.e. the BOM), the price relevance code of the main article will be switched off while that
of the first BOM element, i.e. the box, is switched on.




Fig. 167: Box price in price management




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




           Stock sizes
In the stock size management dialog, an entry has to be made for every article in the box; this entry
defines the box contents. In this example, article „Pallet with boxes“ shall consist of 80 boxes each
which again continue 25 sheets each. One needs to make sure that only one entry with clear
contents is made for every article size.




                                                                                                  423
Fig. 168: Pallet of 80 boxes




                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 169: Box of 25 sheets of picture frame glass




                                                    424
A diversion to other price keys can also be made in this dialog. If there shall be no purchase price
search on stock for these articles (average cost), untick the checkbox below the price keys.
To enable stockkeeping for this article, the supply type has to be set to stock withdrawal. When the
article is saved in the dialog, the system will want to know whether it shall also be defined on stock.
If you confirm by OK, the program automatically switches to stock management.

           Stock management
Articles are defined in stock management in the same way as in product stock sizes. The article is
entered with the same sizes and contents. Only the current stock on hand and the storing place
have to be entered. For automatic creation of work orders or stock P.O.s, the fields minimum stock
and standard order quantity have to be entered. For details please see the following chapter, Work
orders.




Fig. 170: Pallet with boxes in stock management
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                   425
Fig. 171: Box in stock management


          Item entry
To enter the example article in an item, just enter the article number. If the standard width and
height have been entered in product master data, the box will be automatically created from
product stock sizes. To enter the article with different sizes or if no standard sizes have been
defined, the required article can be selected via stock search (F3). The article BOM is preset by the
corresponding contents.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 426
Fig. 172: The box in the pallet BOM




                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 173: The picture frame glass in the pallet BOM




                                                      427
7.7. Hegla Warehouse Incorporation
For more information, please refer to \\jupiter\Doku_DocuWare\ALCIB-PMS\LAGER\User_Manuals\DE-CONFIG-
A+W ERP Stock Service.pdf


            Preconditions
In order to be able to use the Hegla warehouse connection for A+W Business 5, it is necessary
that the A+W ERP Stock Service 5 also be installed. This communicates with the Hegla warehouse
and forwards the stock bookings to A+B business by generated sentences in the FS_POOL. These
are then processed by the A+W Business Interface Service
( Formula\ExchangeServiceworkflow_fileless_StockService.txt ).
In addition, a nightly stock reconcilation is performed, whose time can be set in the config tool of
the StockService. Noteworthy is also that an exact stock is only guaranteed if the bookings are
made in the A+W Business stock in timely fashion.

           Configuration
The following steps are required for the configuration of the Hegla warehouse connection for A+W
Business 5:
    •    Creation of a new supplier "Hegla" under Master data > Market partner > Supplier >
         Suppliers
    •    Creation of the external item references for the suppliers created under Master data > B2B
         > Supplier > Products
    •    Setting of the stock type "Hegla" for the warehouse to be synchronized under Master data
         > Stock > Stock definition
    •    Configuration of the A+W Business database in the config tool of the ERP Stock Service
    •    Configuration of the Hegla communication settings in the config tool fo the ERP Stock
         SErvice (here the stock numbers of the Hegla warehouse and the ID of the created Hegla
         suppliers are required)

            Effects
If a warehouse is marked in the warehouse definition as Hegla warehouse, during the delivery note
printing and in case of an XTV report, there is no outgoing booking from the stock since the outgoing
booking was already made via the stock service. In these cases, only the warehouse reservations
for the respective order are triggered.
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  428
         Types of booking
Incoming goods logic
The incoming goods logic behaves differently if a stock location is indicated as production stock and
a separate incoming goods stock was created:




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 429
Cutting message
If a stock plate is cut, the production stock reports this to the ERP Stock Service, which then makes
the removal booking in the ERP stock.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 430
Daily comparison
If the time for the daily comparison is reached, the inventory lists for both stocks are determined
and the differences per stock plate are booked as additional or removal in the ERP stock.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               431
7.8. Stock evaluation according to FIFO/LIFO
With this process it is possible to evaluate the stock items kept in AWB according to the FIFO or
LIFO process. Evaluation is done here according to the periodic process. That is, the stock removals
for the entire period (last stock evaluation up to evaluation point) are totaled up and, depending
on the process, deducted from the goods receipts starting from the beginning or end.
Warning: Stock products with ident numbers cannot be evaluated according to FIFO/LIFO since
these are clearly identifiable! Furthermore, either 1 piece or no piece of this stock product is
present and a removal sequence thus cannot be defined.
Example:

Sample LIFO calculation

 Stock     Article   Date           Value   Quantity      Value
                                    in €    (according to
                                            LIFO)

 1         11 1      1.5.2016       8.50    15 (15)         15*8.50

 1         11 1      4.5.2016       8.70    20 (10)         15*8.50+20*8.70

 1         111       5.5.2016       8.20    10 (0)          15*8.50+20*8.70+10*8.20

Total removals in this period: 20



The LIFO value is (15*8.50+10*8.70) / 25 = 8.58
With LIFO, the last stock receipt is consumed first and the stock value is calculated from the
remaining quantities.



Sample FIFO calculation

 Stock     Article   Date           Value   Quantity      Value
                                    in €    (according to
                                            FIFO)
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL



 1         111       1.5.2016       8.50    15 (0)          15*8.50

 1         111       4.5.2016       8.70    20 (15)         15*8.50+20*8.70

 1         111       5.5.2016       8.20    10 (10)         15*8.50+20*8.70+10*8.20

Total removals in this period: 20



The FIFO value is (15*8.70+10*8.20) / 25 = 8.50

With FIFO, the first stock receipt is consumed first and the stock value is calculated from the
remaining quantities.


                                                                                                432
For both processes, the removal quantities are added up and then deducted beginning with the
first or last receipt. That is, the time of the stock removal is not decisive.

         Set-up
In order to be able to use the calculations, the database must be brought up-to-date. At least the
following scripts must be executed:
    •   20160801a.sql
    •   20160801m.sql
    •   20160802a.sql
    •   20160817a.sql

So that the initial evaluation can be made, the stock inventory may not be negative. The initial
evaluation can only be done by average PCH or manual value. Starting with the time of the initial
evaluation, it is then possible to calculate with the FIFO or LIFO process.

         Initial evaluation
In order to execute a stock evaluation for the first time, you must open the Stock evaluation dialog
in the Materials management module.

        7.8.2.1.    Selection




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




In the area with the red frame around it, you can select the stock products. With the "Not evaluated
since" field, you can determine that only stock products are selected for which the last evaluation
is before this date. This makes sense for a new stock evaluation or if the stock evaluation has only
been performed for parts of the stock.
With the Evaluation setting, the date is specified for which the stock evaluation should be
performed. Thus it is possible to perform a stock evaluation in the past. The stock inventories are
calculated for this date.



                                                                                                433
        7.8.2.2.     Performing the evaluation




If the stock products are selected, these are displayed on the 2nd tab.
The entries can now either be selected in the table (multiple selection possible and makes sense).
All entries can be selected with the red button and all entries can be deselected with the white
button.
After the selection, the FIFO and/or LIFO values can be determined with the 3 Calculate buttons.
For the initial evaluation, the value can only be determined according to average PCH or manually.
For all subsequent evaluations, the value can be determined for the evaluation of the FIFO and LIFO
value.
With the "Change evaluation type" selection box, you can specify the evaluation type for all marked
records. However, the evaluation type can also be set for each individual record.
If the calculation is made, the status for each stock product is displayed in the "Note FIFO/LIFO"
column:
 Ok                                                Evaluation according to FIFO/LIFO was
                                                   performed. For the initial evaluation, this can
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL



                                                   never happen.
 Stock is negative                                 No evaluation can be performed. The stock
                                                   must be at least 0 for an evaluation.
 No initial inventory was found                    There can only be an evaluation according to
                                                   average PCH or manual input. This will happen
                                                   for the initial evaluation for all stock products
                                                   with non-negative inventory
 Quantity must be greater than 0                   An initial evaluation was found, however
                                                   currently the inventory is 0. An evaluation
                                                   according to FIFO/LIFO makes no sense here
                                                   since the stock value is 0 after every procedure.


                                                                                                  434
Evaluations:
 None                                                No stock evaluation is entered
 FIFO                                                The value of the FIFO column is entered as
                                                     stock value
 LIFO                                                The value of the LIFO column is entered as
                                                     stock value
 Through. PU                                         The average PCH is entered as stock value
 Manually                                            The value of the manual input is entered as
                                                     stock value.


To finish, the values must then be saved. Before saving, all set evaluations are checked again for
their consistency. After saving, there is a re-selection of the data.
After saving, there is a re-selection of the data.
The evaluations are displayed in the stock history and stock management.
On the 3rd tab for stock evaluation, you can regard the FIFO/LIFO calculation in detail.

          Evaluation in stock statistics
With the initial evaluation and subsequent stock transactions, the calculation of the FIFO and LIFO
values can then be performed in the stock statistics. For this, before selection of the data, the
option for the FIFO/LIFO values on the menu must be activated.




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




For the selection, then the FIFO/LIFO values are calculated starting from the last evaluation.
The output can either be through a new stock statistics report (without monthly examination) or
through an export of the table in CSV format.


                                                                                                 435
         Re-initialization of the stock evaluation
If the stock inventory should be re-evaluated, the dialog for stock evaluation can be used. Here the
last evaluation is taken as the basis for the re-evaluation. This should be done periodically (e.g.
annually).

         Change to the PCH in the stock management
If after an evaluation the PCH of the stock product is changed in the stock management, the stock
evaluation becomes invalid and it must be performed again. Before saving, there is an indication of
this and the saving can be canceled.

         Change to goods receipt
For the booking of goods receipts, the delivery date entered is used as stock booking date only if
the option "Stock booking date = delivery date" is activated. Thus the stock receipt can be booked
in the past. In addition, the time of the goods receipt can be specified (if there are several goods
receipts on the same day, this is important for the FIFO/LIFO calculation).




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                436
7.9. Customizing the availability for stored goods
The customising program point „60 – Availability check“ allows to execute a user-defined formula
after the availability check. This can be used e.g. to inform the man on stock by email of a
bottleneck. The availability check will be made when the ALCIM Capacity Planning report is sent to
the ERP WebService. and the actual production dates for the corresponding orders are saved.




Fig. 174: Customizing- Management - 60 - Availability check

Program point „60-Availability check“ in customizing management

When you define a formula for this program point please note that the result of the availability
check is transferred to the formula by fixed variables. This way, the formula can define any reaction
to the result. The result is transferred by the variable g_fktFormulaParameter as a product list. This
variable is an array of the data type ‘variant’. The first element includes a list of products the stock
of which does not reach the minimum stock; there is ample replacement time however to order
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




these goods. The second element shows those products the replacement time of which is
insufficient to order the goods on time for shipment or start of production.
The corresponding values are accessed as follows:
Element: g_fktFormulaParameter[0].GetString()
Element: g_fktFormulaParameter[1].GetString()
If an element – i.e. the returned string – is blank, the check did not reveal a shortfall.


The following formula could be used to send an email to the man on stock should the replacement
time be insufficient:


                                                                                                    437
!*******************************************************************************
*******;
!* Send a mail via SMTP as soon as the availability check discovers problems *;
!*******************************************************************************
*******;
!* Used Variables;
! g_sUdv[0] = The text containing products that still can be purchased;
! g_sUdv[1] = The text containing products that cannot be purchased;
!*******************************************************************************
*******;


! The parameters to the            formula    are   stored   in    g_fktFormulaParameter[0]    and
g_fktFormulaParameter[1];


! g_nFormulaParameterCount does contain the quantity of elements in the following parameter
array;
! g_fktFormulaParameter[0] does contain products that can be purchased;
! g_fktFormulaParameter[1] does contain products that can NOT be purchased;


If g_nFormulaParameterCount > 0;


         Set g_sUdv[0] = g_fktFormulaParameter[0].GetString ( );
Set g_sUdv[1] = g_fktFormulaParameter[1].GetString ( );


If g_sUdv[1] != '';
Set g_sUdv[1] = 'For the following products, the replacement period is too short: ' || g_sCRLF ||
g_sCRLF || g_sUdv[1];
udf_SendMail ( '90MX1.kyro.corp', '', '', 'sender@mail.com', 'receiver@mail.com', '', 'Insufficient
stock', g_sUdv[1], '' );
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




EndIf;
         EndIf;


This formula uses the function „udf_SendMail“ which sends an email via SMTP and which is
described in chapter „Global functions“.




                                                                                               438
7.10. Stock transactions


           Transferring stock items with quantity specification

On the Stock Movement dialog (Stock management>Stock movement), the user now has the
opportunity to specify on tab 3.Transfer the quantity of the stock item that should be transferred
to another stock location.
Here a stock removal is booked by the specified quantity of the stock item and a stock addition is
executed accordingly in the new stock location. The user can also still set the booking date as well
as select a comment for the booking.




Fig. 175: Stock movement - Transfer



In the scanner program for the PDC, the functionality was also adjusted as follows. For more, see
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




15.3.4.1

           Range of numbers for stock movements

In order to be able to better trace stock movements in the stock history (Stock
management>Query>Stock history), a transaction ID has been implemented. This ID is a sequential
number that is incremented for any stock movements that are logged in the stock logbook and
entered in the logbook. You can also search for particular transactions in the stock history by
entering a number range in the data fields provided and executing the search.




                                                                                                439
Fig. 176: Stock history



Furthermore, the transaction ID is displayed in the screen table on tab 2.Table.




                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 177: Stock history - Table




                                                                                   440
When printing the stock history, it is also sent to the report.




                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 178: Stock history - Printout




                                                                  441
8. Shipping
8.1. Loading list

Base data settings
Status allocation contains two status points used to create and print loading lists.
    1. Status 78 "Dispatch" to create the loading list
    2. Status 109 "Print loading lists“ for printing of forms
In management of forms, print item 109 "Loading list", or repeated printing (print item 209) have
to be allocated to the corresponding form, "LADELISTE2.QRP".
The module is part of the production control (ABCFERT.EXE), section "Despatch control" and can
only be used if the dongle allows.

         Operation

Compiling orders on a loading list Compiling orders on a loading list
To create a new loading list, use the ALFAK 2000 standard function in menu "Edit – New".
The tab "Collect", P.O. text1 or order number, allows to group the orders for which the loading list
shall be compiled and printed.
When you leave the corresponding data fields (TAB or mouse-click), the selected orders will be
checked regarding status and clarity of invoice and shipping address, then added to the table by
item. The system shows the quantity and the weight of the orders grouped so far, including the
current value.
Orders cannot be added to the loading list repeatedly.
If the user tries to add an order in which the shipping or invoice address differs from documents
grouped so far, the system will remind him of the difference.
The user can still add this order but the loading list will be saved only when shipping and invoice
addresses match in ALL documents.
Shipping information
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




When all necessary documents have been selected, enter details on the loading list on the next tab,
"Shipping info":
DATE    the actual date is preset
QUANTITY        Default is 0
WEIGHT          Default is 0
NOTE Notes on shipping
SHIPPINGTEXT allows to select a text from KA_TEXTE and edit it
SENDER          record from table KU_KUNDEN
RECIPIENT shipping address (must be clear for all documents if the loading list!


                                                                                                442
INV.ADDRESS               Invoicing address (must also be clear!
FORWARDER                 Forwarder (UPS, FEDEX, etc.) as per KA_LKW
The loading list can be saved when all necessary data are complete. The new loading list number
results from the maximum number in table BW_LADELISTE, raised by 1. If there is no loading list in
the system yet, the loading list starts with number 1.
Saving the loading list
Feasibility of data is checked upon saving:
Has a number manager been selected?
Show the fields for quantity and weight entries over 0?
Are shipping and invoicing addresses clear?
The user can override the shipping and invoicing address.
The consequence is that the new entries are saved in all documents of the loading list!
Once issued, the loading list cannot be changed. You can only delete it using the standard deletion
procedure, and reset the loading list entries in the grouped order headers to 0
Print
The menu shows entries for loading list and label printing. When you load this function, the selected
number manager is emptied, filled with the orders of the currently selected loading list, and
transferred to the print program.
To make sure that the loading list is printed correctly, you need to set the collective printing code.
The initial printout should increase the status (setting in status allocation, print code 109); printing
can be repeated if required.
The loading list form is called "LADELISTE2.QRP" and contains the following, additional variables for
the loading list information:
LADELISTE_VERSENDER              STRING                  KU_KUNDEN.NAME1
LADELISTE_BEMERKUNG                       STRING               BW_LADELISTE.BEMERKUNG
LADELISTE_DATUM                           DATETIME             BW_LADELISTE.DATUM
LADELISTE_SPEDITEUR              STRING                  KA_LKW.BEZ
LADELISTE_ANZTEILE                        NUMBER               BW_LADELISTE.ANZTEILE
LADELISTE_GESGEWICHT                      NUMBER               BW_LADELISTE.GESGEWICHT
LADELISTE_LIEFTEXT                        STRING               BW_LADELISTE.LIEFTEXT
LADELISTE                                 NUMBER               BW_LADELISTE.NR
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL



These variables are also sent to the forms in the document view. These have to be added
individually so that the loading list information is displayed.
Moreover, the variable LADELISTE_VERSENDER2 is sent to the VIEW forms. This shows the sender’s
Name 2 as per customer master data.




                                                                                                    443
8.2. Rack management

         Rack load in rack history
WARNING: The database update script 20150331a.sql is required for this functionality. For this it is
necessary that rack occupation is booked before rack exit.
Once the script has been run, the orders on the rack are automatically saved with the corresponding
customer numbers in rack history when the racks are exited. This way, even after the orders have
been archived, it is possible to track the orders that were delivered with this exit. The occupation
can be called by double clicking a rack exit in rack history.




         Sheet shipping rack allocation
WARNING: Observe both dialog variants as to whether a rack can be loaded at all or whether the
sheets that are loaded onto the rack are permitted (max. width, height, total weight). The
maximum values can be set per rack type.
The load can be based on two different types: rack based or order based. We recommend order-
based loading for larger orders. If several small orders are loaded, we recommend the use of rack-
based allocation.
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




It is now possible to enter the assignment of orders to racks in A+W Business. The rack load function
is available for this purpose in rack management in the menu. To select the function choose a rack
that has not yet been shipped. Then the following dialog opens:




                                                                                                 444
In this dialog, order items can be assigned to a rack. If the dialog is opened with a rack number or
is a rack selected by means of a filter (warning: the rack must be on the premises, external racks
cannot be processed), the current assignment is shown. The entire rack load can be deleted with
the button "Empty rack". Order items can now be added to the racks by entering an order and item
number in each new row (a new row is automatically created when leaving the previous row with
the TAB button). In the column "Sheets on rack", the quantity of the item that has not yet been
placed on the rack is shown. Here you can either confirm with the TAB key or change the number
of sheets of this order item by overwriting the quantity on the rack.
The entire new rack load is saved by pressing the Save button (or the return key).
The allocation can also be performed from the order side. For this purpose the menu entry Filter
has to be chosen from the menu and switched to the first tab. Here you can enter an order number
and assign a rack for each order item.
In this dialog too, the allocations for the selected order can be deleted by pressing the button
"Remove allocations". This deletes all allocations of the selected order from rack allocation.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




         Resubmission of racks


                                                                                                   445
Rack management allows defining that a rack shall be resubmitted. At the resubmission date, an
email is sent to the specified user. Resubmission for a rack can be defined either in rack
management, at rack exit, or at the receipt of racks. An email address for the user must be entered
as well; resubmission will not work otherwise.

Using the resubmission function requires the following steps:

    •   Script 20130304a.sql has to be run


    •   Email addresses should be entered for all users


    •   The general email server must be entered in company master data (tab 1)


    •   The formula Workflow_Rack_Reminder.txt must be set up as a work-flow.

    •   The formula may be adapted to the customer's requirements.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               446
8.3. A+W Logistics Optimizer Integration
The A+W Commercial Logistics Service is required to integrate the A+W Logistics Optimizer into
A+W Business. It is responsible for the communication between the two systems. A+W Business
has to be installed on the computer on which the Logistics Service is run as it uses the
BusinessCom.exe. In addition the computer on which the transfer of orders to the Logistics
Optimizer in Business is to be used must also have the Logistics Optimizer installed.




                                                                                                 A+W Software GmbH - Configuration A+W Business - INTERNAL




After successful installation, the transfer can then be started from the number manager in the
display mode Delivery via Functions > Route optimization > Transfer number manager.




                                                                                           447
           Logistics Service Settings
The A+W Commercial Logistic Service requires a connection to the databases of A+W Business and
A+W Logistics Optimizer. They are configured in the A+W Infrastructure Web.




Fig. 179 A+W Business database

Please note that the A+W Logistics Optimizer currently only supports SQL Servers.




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 180 A+W Logistics Optimizer database

Plus the logical user for A+W Business has to be entered here with which the COM objects logs in.




                                                                                              448
Fig. 181 Logical user A+W Business

Plus the backend type also has to be set in A+W Business.




                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 182 Type of system used




                                                            449
          Settings/operation in A+W Business
The A+W Logistics Optimizer must be activated in the company master data to enable the
integration.




Fig. 183: Company management – activate A+W Logistics Optimizer

In A+W Business, the status allocations have to be set up for the status points 870 (transfer route
optimization) and 871 (route optimization to take place). This makes it possible to individually
integrate route optimization into the customer workflow.
In the number manager, the 3 columns of the Logistic Optimizer can be selected; these are the
route of the optimizer, the sequence within the route and the route status. With the Sort button,
a sorting of the number manager according to the optimization result can be done in order to
print the delivery notes in optimization order subsequently, for example. The call of the transfer
and of the optimizer is made via the ribbon bar Functions > Route optimization > Transfer to
number manager.
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                450
Fig. 184 Number manager – new table columns

In addition to the number manager, the route list can be selected and printed after the result. The
optimizer routes are displayed instead of the master data routes.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 185 Route management – optimized routes from A+W Logistics Optimizer




                                                                                                451
In the company master data, it is possible to define which surcharges form the freight revenues
and thus also how the freight revenues arise for the orders that are sent to the A+W Logistics
Optimizer.
As default, no surcharges are activated in the freight revenues table. After definition of the
freight revenues, the company data still has to be saved.




Fig. 186 Company data – definition of surcharges/freight revenues for the A+W Logistics Optimizer


           Start barcode for break scanning
Transfer then from the number manager delivers the start barcode for breakage scanning to the
A+W Logistics Optimizer.
The transfer is affected by the restriction that the A+W Logistics Optimizer transfer takes place after
the Production Capa transfer. However, since this happens directly after order entry, this should
not be a restriction.
Furthermore, with this solution, the OP remake is not used, for here a new barcode number is
generated and it is not known to the A+W Logistics Optimizer.

           Multisite mode
The A+W Logistics Optimizer and the interface have been expanded for work with several sites.
On the configuration dialog of the A+W Logistics Optimizer, there is a new check box that allows
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




switching multisite mode on. After the multisite mode has been switched on, the database is
automatically converted to a common A+W Logistics Optimizer database OTR_COMMON and the
field for the database definition is locked. The databases for the A+W Logistics Optimizer are then
defined in another place.




                                                                                                    452
Fig. 187 Multi-site option in the A+W Logistics Optimizer

There is now a new MultiSite dialog on the Configuration tab. If you go into it, you can now define
an ID (site ID) and a name (site name) for the site in question.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 188 Multi-site configuration in the A+W Logistics Optimizer




                                                                                               453
After the ID and name have been saved (SAVE button), you should set the access data for the A+W
Logistics Optimizer for the respective sites. To do this, select the site and define the computer name
(data source), database (initial catalog), user ID (user ID) and user password.
If the sites are defined, the user can select one of them when starting the A+W Logistics Optimizer.




Fig. 189 Multi-site selection in the A+W Logistics Optimizer

After the A+W Logistics Optimizer has been started, you can see on the status bar with to sites you
are      logged     on      and     to      which      database      you       are     connected.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 190 Multi-site display in the A+W Logistics Optimizer




                                                                                                  454
In order to be able to use the multisite mode as integration between A+W Business and the A+W
Logistics Optimizer, the A+W Commercial Logistic Service must be set so that the required
connection to the databases of A+W Business and A+W Logistics Optimizer are set per site. These
are defined in the A+W Infrastructure Web.




Fig. 191 A+W Logistics Optimizer database for the sites

Important here is that the numbering of the sites and the setting of the databases in the A+W
Infrastructure Web correspond to the settings of the sites from the A+W Logistic Optimizer.
In order to activate the multisite capability of the A+W Logistic Service, you must also switch the
sites active in the A+W Logistic Service Config Tool (shortcut A+W > Config Tools > A+W Commercial
Logistic 6 Config Tool).




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               455
Fig. 192 Multisite configuration in the A+W Logistic Service Config Tool

After the sites have been switched active, the right service is used with the number manager
transfer and the A+W Logistic Optimizer is also started with the right site.


Important: if several A+W Logistics Optimizer databases are used, each of these databases must be
brought up-to-date with the update of the A+W Logistics Optimizer.




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                              456
8.4. A+W Smart Delivery
For the transfer of order documents via the number manager (Documents > Order > NM order >
Functions > Transfer to number manager) to the A+W Logistics Optimizer, the interface was
expanded. Thus effective immediately, in addition to the document data item and rack information
is always transferred to the optimization.




                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 193 Item and rack information in the A+W Logistics Optimizer




                                                                                             457
In order to define order-rack assignment, you must open the dialog in the rack management under
Production > Rack management > Racks > Functions > Rack assignment. Here you define which
order items are stored on which rack. If you have made the assignment, you can transfer the orders
to the A+W Logistics Optimizer. Now the user has access to more detailed information with respect
to his order and the resulting routes for optimization. After the optimization (calculation of travel
distance, departure and arrival times, etc.) and saving (authorization) of the route, the route
information is available in the A+W Smart Delivery app.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 194 A+W Smart Delivery – Login and route overview



                                                                                                 458
Initially the user, that is, the truck driver, must log into A+W Smart Delivery. Then you can see the
routes for which you are authorized. If you click on a route, the overview of the individual
destinations will open. If you select an intermediate destination on the route, the relevant data for
the destination will open. You can get, as in the A+W Logistics Optimizer, information about the
order items and associated rack data. Now click Start on the route overview. Now you have to
work through route by route. The user selects the route with a click and arrives at an overview on
which you have to define the current status of the route; that is, whether or not all order items
have been properly delivered on the respective racks. For example, there is the status Partially
accepted. This can happen if something has broken. Then only a part of the delivery is accepted by
the customer. Another feature is that the truck driver can have the delivery acknowledged in A+W
Smart Delivery. The signature is made on a separate dialog, which opens with a click on the
Company field. Then the data must be saved.




Fig. 195 A+W Smart Delivery – Status change per route destination


                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 196 A+W Smart Delivery – Status changes to A+W Logistics Optimizer
After working through all destinations, the route is completed in A+W Smart Delivery and it is
marked in the optimization system (A+W Logistics Optimizer) as closed - not complete. The route is
no longer available to the user (truck driver) in A+W Smart Delivery if you have set finished – not
complete in the A+W Logistics Optimizer. Always if status changes are made to the route and/or
the destinations, this is reported to A+W Business. If now for a destination the status is set to
accepted in A+W Smart Delivery, this status is sent to A+W Business, and if the corresponding
assignments for the new status point 880 – delivery accepted are defined, the order status is
adjusted. The same applies for the status point 875 – delivery declined; it is the equivalent of the
status declined in A+W Smart Delivery.


                                                                                                 459
           Breakage report
In order to return breakage reports to A+W Business and then create complaint orders, the
following scripts must be executed: 20190910a.sql and 20190918a.sql.
After these scripts have been executed, on the Breakage Reasons dialog, breakage reasons (Master
Data > Production > Breakage reasons) can be defined whether a breakage reason is used for the
coupling of A+W Business and the A+W Logistics Optimizer.




Fig. 197 Breakage source definition on the Breakage Reason dialog

Thus for the coupling to A+W Production and the A+W Logistics Optimizer, the same breakage type
number can be used. Depending on the source, the breakage reports can then be distinguished
according to location, reason, and whether the complaint is free of charge.




The breakage type (status) should also be set in the Logistics Optimizer:




                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                             460
Important: currently, the breakage report has the type/status 10000 in the Logistics Optimizer. For
this reason, in A+W Business, a data record with the type/status 10000 should also be created in
A+W Business.
If with the delivery, a glass is broken, for example, effective immediately you have the opportunity
to specify in the Smart Delivery app how much of the delivery is/was damaged:




This breakage report is then returned to the A+W Logistics Optimizer. If you complete the
tour/route in the A+W Logistics Optimizer, you have to assign the break reported to the appropriate
document. Otherwise no breakage reports can be transferred into A+W Business.
You open the destination in the A+W Logistics Optimizer, change to the Breakages tab, and then
you can edit the break with a right-click on the data record:




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                461
Confirm with OK and with the status report to the ERP system, the breakage report is saved in the
A+W SOA database.
In order to return breakage reports from the A+W Logistics Optimizer and create complaint orders
in A+W Business, a workflow task must be created, which calls the function
udf_RetrieveBreakages. The description of the function is in Chapter 10.28_Bruchübergabe aus
dem Logistic Service and an example of the workflow in 10.29_Beispiele.




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                              462
8.5. A+W Smart Delivery – rack reporting

In the A+W Infrastructure Web there is now a new configuration switch with which the user can
specify whether or not a rack booking is made in A+W Business after reporting from the A+W
Logistic Optimizer (0=no booking, 1=ERP rack system).




Fig. 198 A+W Infrastructure Web – Logistic settings



For the realization of the second phase of A+W Smart Delivery, during which the rack data is
transferred back to the ERP, the routine in the A+W Commercial Logistic Service was expanded for
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL



the reporting to AWB. For this, the structure that is returned to the ERP system (AWB) had to be
reworked. Effective immediately, the rack number, the rack type, the customer (at whom the rack
was), the booking date, the booking type (incoming or outgoing) and a switch whether or not the
rack has been lost will be transferred. Furthermore, the assignment of the rack data to an order
item (incl. quantity) is included in the structure. At the beginning, all the data for the optimization
was also transferred to the A+W Logistic Optimizer.
From now on, the A+W Business COM interface checks whether or not rack data is included. If data
is present, a rack booking is made, either a rack receipt or a removal, which is interpreted using the
data reported back.
If the rack is not created in A+W Business, first an appropriate data record is created and then the
booking is made.
Finally, an entry is made in the appropriate rack history table (BA_GESTELLE_EA).

                                                                                                   463
464
A+W Software GmbH - Configuration A+W Business - INTERNAL
9. Statistics
9.1. Quotation evaluation / Statistics
Enhanced sales support should be enabled in the quotation area. To this end, the success
probability (in %) was also included in the quotation header in order to calculate a preview of the
expected sales on this basis. Quotation statistics was extended so that, besides the quotation value,
the value weighted with success probability is also shown. In the case of alternative quotations, the
alternatives first have a success probability of 0%. The success probability of a quotation and its
alternatives may not exceed 100%. Quotation statistics was extended with further selection criteria
and display fields. This includes the fields Line of business, Customer group, and Region.

         Document recording
In the quotation header (Documents>Quotation>Quotation) a new field Probability of success (in
%) was added. The field is invisible in other documents (order, credit note, order inquiry and
purchase order) and cannot be changed there. The maximum value that can be entered is 100%.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 465
         Quotation statistics
In quotation statistics (Document>Quotation>Quotation statistics), the relative probability of
success and the weighted quotation amount is shown on the screen. The weighted quotation
amount is calculated on the basis of the document total in relation to the relative probability of
success. In addition, the fields Line of business, Customer group, and Region are included in the
quotation statistics, i.e. these fields are shown in the screen table and can be defined as selection
criteria.




         Printing of quotation statistics




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 466
Then the printout of the quotation is reviewed. The general information line of business, customer
group, and region is included in the header area of the printout, whereby the fields Success in %
and Quotation amounts belong weighted in the detail area. The success rate (probability in %) and
the weighted quotation amount are shown per quotation. Furthermore, the average success rate
and the total of the weighted amounts are to be shown per subtotal (customer). The average
success rate is calculated on the basis of the total of the weighted amount.




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                              467
10.Customizing
10.1. Introduction
This documentation describes the settings required in ALFAK to work with Customizing. It also
explains the basics for creating individual formulas for Customizing. It describes the available
functions that can be addressed by the formulas, and their operation. This includes the main
variables available in the formulas as well as the objects ALFAK uses to manage vital data such as
order and item data.
The aim of Customizing is to cope with customers’ individual requirements and wishes. You do no
longer have to amend the source code. Localization of the application is not necessary either. The
customer can use the system sooner, and at lower cost.
The scope of these functions is enormous. You can add new data fields to an item. The user can
manage these in the so-called Customizer. The next step is printing these new fields on forms.
Further application, e.g. individual restriction checks with individual messages. Thanks to the free
access to the ALFAK data, the possibilities are endless.
To make sure the administrator stays in control of the individual functions, formula management
can be configured by the ALFAK system of rights.


Documentation on customizing can be found in the ALFAK installation directory, in sub-directory
Formula: \\Jupiter\ALFAK_Install\Versions\4.5.xxx\Formula\Customizing Documentation.htm




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




10.2. Enable Customising
In Company data, tab 10.System, enable the checkbox Customizing active.




                                                                                                468
Fig. 199: Company data with Customising enabled




                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




10.3. Formula management
Menu Company > Formulas brings you to formula management. This shows a unique number for
every formula, descriptive text and the formula itself.



                                                                                     469
Fig. 200: Formula management


10.4. Formula allocation
There are several options of executing formulas. The time it is executed always depends on an event
in the dialogs. The following paragraphs describe the available events and how to define the proper
formula.


10.5. Control elements
Control elements are data fields, radio buttons, checkboxes, and combo boxes in the dialogs. The
event to which the execution of a formula can be linked is leaving a data field after changing its
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




input. In case of radio buttons, checkboxes, and combo boxes, the status of the event will change.
E.g. by clicking on a checkbox or radio button. The input of combo boxes can be changed via the
keys to trigger the event.
To link a formula to such a control elemeent, click the right mouse key on the corresponding control
element, keeping CTRL + F2 pressed. A context menu appears with the entries Assign formula,
remove formula, and Name of control element. If you select Assign formula, a search dialog appears
from which you can select the required formula. Existing allocations will be preset in the search
dialog. To remove an assigned formula, choose Remove formula.
If a formula needs to access the contents of the control element, you have to know the name of
the control element. This appears when you choose the menu Name of control element.



                                                                                                470
Fig. 201: Formula allocation via search dialog

To get a list of all formulas assigned in a dialog, select menu Customizing from the system menu of
the corresponding dialog. You can display and delete all allocations there.
You can also access this overview via the master data management menu Customizing.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 202: List of allocated formulas in a dialog 1




                                                                                               471
Fig. 203: List of allocated formulas in a dialog 2


10.6. Tables
Formulas for tables are defined via the property menu in the top left corner of the table. From the
context menu, select Customizing – Assign formula to display the formula search dialog. The result
to which the formula is then linked is the click event which will always happen when another line
of the table is selected. It does not matter whether this is done by mouse, keyboard, or navigation
buttons on the toolbar. This way, the formula can react to the change of record, e.g. if the next item
is selected at item entry.


10.7. Window
                                                                                                              A+W Software GmbH - Configuration A+W Business - INTERNAL




The windows and dialogs allow formulas to be linked to different events. The formulas are allocated
in the system menu of the corresponding dialog. The available events are listed in the table below.
   Enter record                          Occurs when you select New from the editing menu of the
                                         window
   Save record                           Occurs after the current record has been saved.
   Change Data Record                    Occurs when the OK button is pressed after changing the
                                         current record. Normally, this will be the case whenever you
                                         press a key in data fields or amend data in radio buttons,
                                         checkboxes, or combo boxes.
   Delete record                         Occurs after a record has been deleted.
   Create window                         Is triggered after a new window or dialog has been created.


                                                                                                        472
  Input check                         Is triggered prior to saving a record. Set the variable
                                      m_bPlausibilityOK to FALSE prevents that the record is saved.
                                      When you open the formula, this variable is always TRUE.
  Show window                         Occurs if a window has been hidden and is now visible again.
  Hide window                         Occurs when a window is hidden.
  Destroy window                      Occurs when a window is closed.
  Create customizing                  Here the formula is set up with the customizing buttons for the
  buttons                             current window (more on this in chapter 7.8 Customizing
                                      Buttons)
Tab. 45: Available events in windows and dialogs.




10.8. Customizing Buttons
In order to start additional functions, it is possible to create user-defined buttons on the start
ribbon. These buttons must be created with special customizing and can then call up any formula
desired. The function for creating such a button is:
udf_CreateButton ( "Name of the button", "Name of the Bitmap", nFormelNummer);
The first parameter is the name of the button as it should be called on the ribbon. The second
parameter is the name of the bitmap that should be displayed on the button. Pay attention that no
path must be specified here, rather only the file name with extension. The bitmap itself must be
stored in the bitmap order of the application. The last parameter is the number of the formula that
should be executed when the button is clicked.
So that the button can be assigned to a window, open the System menu and assign using the menu
element "Create customizing button." After that, the window must be restarted.
                                                                                                              A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                        473
Fig. 204: Menu element for creating user-defined buttons


           Hotkey in dialogs

As of now hotkeys can be defined via customizing:
udf_CreateButtonEx ( nFormelNummer, 1. constant hotkey, 2. constant hotkey );
    -    The first constant describes the button that must be pressed and held:
             o KDS_None, KDS_Shift, KDS_Ctrl, KDS_ShiftCtrl, KDS_Alt, KDS_AltCtrl, KDS_AltShift
                  und KDS_ShiftAltCtrl.
    -    The second constant describes the button that must be pressed actively:
             o VK_0 to VK_9, VK_A to VK_Z and VK_F1 to VK_F12.

A maximum of 5 hot keys per form window / dialog are possible!


10.9. Form printing
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Warning: With the activation of Crystal reports the name of different variables changed. For details,
see chapter 3.10.6
Formulas can be linked to certain events in management of forms. This allows to print variables
calculated at document entry, or to select and print any other data from database. This is done in
formula management, for every single form. Formulas are defined in management of forms, tab 7
– Customizing. You can define a formula for the start and end of a break group and for printing the
detailed record. The user has to decide where on the form this variable shall be printed, and then
link the formula to the matching break group. This will influence the printing performance because
the formula for the detailed section will be executed for every item while the formula for the start
of page is executedonly once per form.


                                                                                                 474
Fig. 205: Customizing in management of forms




10.10.            Program formula allocation
Formulas can be allocated to certain program points. This serves to change the program behavior.
You can basically change the pricing function for example (not based on prices) One example is the
energy surcharge at pricing (see examples). The formulas are always connected with the program
                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL



context. Pricing is subject to the same rules as price formulas. Allocation can be made in Master
data – Company - Customizing.




                                                                                              475
Fig. 206: Program/formula allocation


10.11.             Functions and Variables

Variables
To be able to save data temporarily in forms, there are global variables that can be used at random.
These allow e.g. to transfer data from one formula to another. To have any number of variables
available, the variables are declared as arrays. There is just one array for every data type.
   g_nUdv[*]g_        Numerical data type
   nUdv[*]
   g_sUdv[*]          String data type
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL



   g_lsUdv[*]         Long String data type (>255 digits)
   g_hUdv[*]          Window handle data type
   g_sqlUdv[*]        SQL Handle data type
   g_bUdv[*]          Boolean data type
   g_dUdv[*]          Date data type
   g_saUdv[*]         String Array Datentyp (if an array is required)
   g_naUdv[*]         Numerical array data type (if an array is required)
   g_hfUdv[*]         File handle data type
Tab. 46: Data types of the available, global variables.

If a variable is used, it will remain valid until the entire application is terminated.


                                                                                                476
Functions
There are predefined functions that can be directly addressed from the formulas. A list of these
functions and the corresponding parameters is included in the reference at the end of this
documentation. Loading is done by entering the function name and the parameter list in brackets,
separated by comma. The usual „Call“ before the function is omitted.
The document category
Document categories are used to access the data of an ALFAK document from a formula. The
document category is an object with all data of an ALFAK document including items, bills of
material, processing steps, shapes, and Georgian bars. Header and item entry includes just one
entity of the document category, called w_fktDoc. It gives easy access to the document header for
example. You will get the customer number by means of w_fktDoc.m_nAH_IDENT and the first
customer name via w_fktDoc.m_sAH_NAME1. All database fields of the document can be accessed
this way. The following expression gives access to the items: w_fktDoc.m_Pos[index]. Since the item
index is now known in the category, and may not be consecutively numbered, you have to use an
aid. Assuming that the item number in the item entry table is always correct, you can use a function
of the document category to determine the index by:
w_fktDoc.Search ( g_nUdv[0], frmDocumentItems.tblPos.cnPOS_NR );
After this call, the item index is in the global variable g_nUdv[0]. The second parameter is the
expression required to access the column with the item number in the item entry table. To access
e.g. the item width by means of the index, use:
Set g_nUdv[1] = w_fktDoc.m_Pos[g_nUdv[0]].m_nPP_BREITE;
The width is now included in the global variable g_nUdv[1] and can be used.


10.12.           Syntax
Every formula has to end with a semicolon. This includes notes as well as all other commands
described below. You can use all functions of the Gupta programming environment.
Allocations
Variables are assigned by the set command.
Example:
Set g_sUdv[0] = w_fktDoc.m_sAH_NAME1;
Function calls
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




To load a function via a formula, just enter its name and parameter list in brackets.To load a function
via a formula, just enter its name and parameter list in brackets. You do not have to enter a call
before the name of the function. To use the return value of the function, write the result into a
variable via set command.
Example:
Set g_hUdv[0] = SalCreateWindow ( tblCustomizer, hWndForm);
Grinding
To program a loop in a formula, you can use the header-controlled while loop. This loop always
starts with the command „While <Ausdruck>“ and ends with the command „Wend“. The loop will



                                                                                                   477
be executed as long as the result of the expression is not zero. Execution of the formula is continued
by the command directly after „Wend“ if the expression is FALSE or zero.
Example:
Set g_nUdv[0] = 0;
While ( g_nUdv[0] < 10 );
        …;
                                         Set g_nUdv[0] = g_nUdv[0] + 1;
Wend;




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  478
Conditional execution of commands
To control the execution of formulas under certain conditions, you can use the If command. This
allows to check the results of function calls or run an input check. The formula between command
If <expression> and EndIf is executed if the expression is not zero. No Else case is scheduled.
Example:
If                          g_nUdv[0]                               =                            20;
         SalMessageBox ( … );
         SalMessageBox ( … );
EndIf;
Comments
Comments are expressions starting with an exclamation mark. Please make sure that even
comment lines end with a semicolon.
Example:
! This is a comment. It helps to understand the formula;
User interaction in formulas
There are two methods of allowing user input while a formula is executed which are explained
below. The input dialogs interrupt the execution of the formula and wait for input from the user.
These dialogs are modal. There are input dialogs to check numerical data and strings. These allow
one to four data fields to be checked each so that there are eight different dialogs in total.
A second input option is the so-called Customizer. This is a small table window which can be opened
parallel to the actual window. The table window is not modal; the user can choose the time for
entering data.The table window is not modal; the user can choose the time for entering data.aThe
table window is not modal; the user can choose the time for entering data. The Customizer
remembers its last position and size and will reappear in just that position and size next time it is
started.
Input dialogs
To open an input dialog, first choose a data type and the number of input fields required. To check
two numerical values for example, enter:
udf_InputDlgNumber2 ( hWndForm, 'Überschrift', 'GroupBoxText', 'Name der 1. Variablen',
g_nVar[0], 'Name der 2. Variablen', g_nVar[1] );
This opens the input dialog shown below.
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 207: Entry dialog with two variables of string type




                                                                                                 479
If you confirm the dialog with OK, the return value of the function is TRUE; otherwise, FALSE. The
other seven calls are described in the annex.


10.13.            Customizer
The Customizer consists of a table window with two columns. The first column allows to enter a
name for the variable, program-controlled; the user can edit its value in the second column. This
allows to display and edit any number of values. Unlike the above-described input dialogs, the
Customizer is not modal. This means that the remaining winsows can be used while the Customizer
is displayed. The Customizer always appears in the foreground, in front of the actual owner. If a
value is changed in the Customiser, the owner window reacts; the current record is marked as
‚edited’. This means that the user has to save the current record; changes to the record induced by
the formula will be saved in the database. The Customizer is displayed by:
Set g_hUdv[0] = SalCreateWindow ( tblCustomizer, hWndForm);




Fig. 208: The Customizer at item entry
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




Due to the parameter hWndForm, the owner is always the actual window. The Customizer’s
window handle is allocated to the global variable g_hUdv[0]. It allows to access the Customizer
functions. To get a user-defined variable into the Customizer, you will need:
g_hUdv[0].tblCustomizer.AddValue ( 'depth', '850' );
This enters a line with the variable "depth" and its start value. The following function is used to load
this value from the Customizer:
g_hUdv[0].tblCustomizer.GetValue ( 'depth', g_sUdv[0] );
This sets the variable called "depth" in the globale variable g_sUdv[0]. To redefine the value of a
variable, use the function:
g_hUdv[0].tblCustomizer.SetValue ( 'depth', g_sUdv[0] );


                                                                                                    480
10.14.            Rights
Management of rights allows to prevent that any user can define, edit, or assign formulas. The
rights in formula management are configured by "Master data – Company – Formulas“. The rights
for the formula allocation dialog and all context menus for linking events and formulas is configured
in "Master data – Company – Customizing“.
The rights do not allow to control whether certain formulas shall be executed; it only deals with
management and allocation.


10.15.            Parameter transfer from formula to formula
A global array is used to transfer data from one formula to another.            This array is called
g_fktFormulaParameter, type cfktVar, and includes the following functions:
SetString ( string );
GetString ( );
SetNumber ( number );
GetNumber ( );
SetLongString ( long string );
GetLongString ( );
SetDate ( DateTime );
GetDate ( );
A string and a number data type can be transferred to another formula in the following way:
…
! Put a string into the first item of the array;
g_fktFormulaParameter[0].SetString ( „This is a string“ );
! Put a number into the second item of the array;
g_fktFormulaParameter[1].SetNumber ( 4711 );
! Execute the formula no. 1 ;
udf_ExecuteFormula ( SalContextCurrent ( ), 1):
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




…
To access these parameters in a new formula, you need to do the following:
…
! Get the string out oft he first item;
Set g_sUdv[0] = g_fktFormulaParameter[0].GetString ( );
! Get the number out of the second item;
Set g_nUdv[0] = g_fktFormulaParameter[1].GetNumber ( );
…



                                                                                                 481
10.16.             Variable and function reference
This includes all variables and functions that can be used in the formulas, which are also version-
stable. If you use other functions or variables, there is the risk that formulas can no longer be
executed after a version update.
Global Variables
There is a globally valid array for every possible data type. The contents of these arrays is valid as
long as the corresponding application is run. This way, global variables can be used to exchange
values between formulas. Global variables are available in size formulas, price formulas, and menu
formulas.
  g_nUdv[*]g_nUdv[*]          Array type Number
  g_sUdv[*]                   Array type String
  g_bUdv[*]                   Array type Bool
  g_hUdv[*]                   Array type Window handle
  g_sqlUdv[*]                 Array type SQL handle
  g_dUdv[*]                   Array type Date/Time variable
Tab. 47: Globale Array variables

Global functions
Global functions are accessible everywhere. Like global variables, they can be used in size formulas,
price formulas, and menu formulas.
bReturn = udf_ExecuteFormula ( sContext, nFormula )
Executes the formula defined in nFormula in the defined context.
Parameter:
 sContext                String: Context in which the formula shall be executed. The actual context is
                         defined by SalContextCurrent ( ).
 nFormula                Number: Number of the formula to be executed acc. to formula
                         management.
Example:
The example executes formula number 2 in the current context.
Set g_bUdv[0] = udf_ExecuteFormula ( SalContextCurrent ( ), 2 );                                          A+W Software GmbH - Configuration A+W Business - INTERNAL



bReturn = udf_InputDlgNumber1 ( hWndOwner, sCaption, sGroupBoxText, sLabelText, nValue )
Shows an input dialog with a numerical input field.
Parameter:
  hWndOwner                        Window Handle: Owner of the dialog
  sCaption                         String: Window text of the dialog.
  sGroupBoxText                    String: Text to appear in the group box of the dialog.
  sLabelText                       String: Header text of the input field.
  nValue                           Receive Number: Value entered in the dialog.
Example:
The example shows an input dialog with the title "input", without text in the group box, and with
the header "depth", and saves the entry in the global variable g_nUdv[0].

                                                                                                    482
Set g_bUdv[0] = udf_InputDlgNumber1 ( hWndForm, 'Eingabe', '', 'Tiefe', g_nUdv[0] );


bReturn = udf_InputDlgNumber2 ( hWndOwner, sCaption, sGroupBoxText, sLabelText1, nValue1,
sLabelText2, nValue2 )
Shows an input dialog with two numerical input fields.
Parameter:
  hWndOwner                  Window Handle: Owner of the dialog
  sCaption                   String: Window text of the dialog.
  sGroupBoxText              String: Text in the group box of the dialog.
  sLabelText1                String: Header text of the input field.
  nValue1                    Receive Number: Value of the first input field.
  sLabelText2                String: Header text of the second input field.
  nValue2                    Receive Number: Value of the second input field.


bReturn = udf_InputDlgNumber3 ( hWndOwner, sCaption, sGroupBoxText, sLabelText1, nValue1,
sLabelText2, nValue2, sLabelText3, nValue3 )
Shows an input dialog with three numerical input fields.
Parameter:
  hWndOwner                  Window Handle: Owner of the dialog
  sCaption                   String: Window text of the dialog.
  sGroupBoxText              String: Text in the group box of the dialog.
  sLabelText1                String: Header text of the input field.
  nValue1                    Receive Number: Value of the first input field.
  sLabelText2                String: Header text of the second input field.
  nValue2                    Receive Number: Value of the second input field.
  sLabelText3                String: Header text of the third input field.
  nValue3                    Receive Number: Value of the third input field.




bReturn = udf_InputDlgNumber4 ( hWndOwner, sCaption, sGroupBoxText, sLabelText1, nValue1,
                                                                                             A+W Software GmbH - Configuration A+W Business - INTERNAL




sLabelText2, nValue2, sLabelText3, nValue3, sLabelText4, nValue4 )
Shows an input dialog with four numerical input fields.
Parameter:
  hWndOwner                  Window Handle: Owner of the dialog
  sCaption                   String: Window text of the dialog.
  sGroupBoxText              String: Text in the group box of the dialog.
  sLabelText1                String: Header text of the input field.
  nValue1                    Receive Number: Value of the first input field.



                                                                                       483
  sLabelText2                 String: Header text of the second input field.
  nValue2                     Receive Number: Value of the second input field.
  sLabelText3                 String: Header text of the third input field.
  nValue3                     Receive Number: Value of the third input field.
  sLabelText4                 String: Header text of the fourth input field.
  nValue4                     Receive Number: Value of the first fourth input field.


bReturn = udf_InputDlgString1 ( hWndOwner, sCaption, sGroupBoxText, sLabelText, sValue )
Shows an input dialog with a string input field.
Parameter:
  hWndOwner                   Window Handle: Owner of the dialog
  sCaption                    String: Window text of the dialog.
  sGroupBoxText               String: Text to appear in the group box of the dialog.
  sLabelText                  String: Header text of the input field.
  sValue                      Receive String: Value entered in the dialog.
Example:
The example shows an input dialog with the title "input" without text in the group box, and with
the header "depth", and saves the entry in the global variable g_sUdv[0] ab.
Set g_bUdv[0] = udf_InputDlgString1 ( hWndForm, 'Eingabe', '', 'Tiefe', g_sUdv[0] );


bReturn = udf_InputDlgString2 ( hWndOwner, sCaption, sGroupBoxText, sLabelText1, sValue1,
sLabelText2, sValue2 )
Shows an input dialog with two string input fields.
Parameter:
  hWndOwner                   Window Handle: Owner of the dialog
  sCaption                    String: Window text of the dialog.
  sGroupBoxText               String: Text to appear in the group box of the dialog.
                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




  sLabelText1                 String: Header text of the input field.
  sValue1                     Receive String: Value of the first input field.
  sLabelText2                 String: Header text of the second input field.
  sValue2                     Receive String: Value of the second input field.


bReturn = udf_InputDlgString3 ( hWndOwner, sCaption, sGroupBoxText, sLabelText1, sValue1,
sLabelText2, sValue2, sLabelText3, sValue3 )
Shows an input dialog with three string input fields.
Parameter:

                                                                                             484
  hWndOwner                   Window Handle: Owner of the dialog
  sCaption                    String: Window text of the dialog.
  sGroupBoxText               String: Text to appear in the group box of the dialog.
  sLabelText1                 String: Header text of the input field.
  sValue1                     Receive String: Value of the first input field.
  sLabelText2                 String: Header text of the second input field.
  sValue2                     Receive String: Value of the second input field.
  sLabelText3                 String: Header text of the third input field.
  sValue3                     Receive String:Value of the third input field.


bReturn = udf_InputDlgString4 ( hWndOwner, sCaption, sGroupBoxText, sLabelText1, sValue1,
sLabelText2, sValue2, sLabelText3, sValue3, sLabelText4, sValue4 )
Shows an input dialog with four string input fields.
Parameter:
  hWndOwner                   Window Handle: Owner of the dialog
  sCaption                    String: Window text of the dialog.
  sGroupBoxText               String: Text to appear in the group box of the dialog.
  sLabelText1                 String: Header text of the input field.
  sValue1                     Receive String: Value of the first input field.
  sLabelText2                 String: Header text of the second input field.
  sValue2                     Receive String: Value of the second input field.
  sLabelText3                 String: Header text of the third input field.
  sValue3                     Receive String:Value of the third input field.
  sLabelText4                 String: Header text of the fourth input field.
  sValue4                     Receive String: Value of the first fourth input field.

                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




bReturn = udf_SendMail ( sSMTPServer, sUser, sPasswort, sFrom, sTo, sCC, sSubject, sBody,
sHTMLBody )
Sends an email via SMTP. Caution: the function does not support sending with TLS encryption.
Parameter:
  sSMTPServer                 String: Name or IP address of the SMTP server.
  sUser                       String: User name for registration with the SMTP server.
  sPasswort                   String: Password for registration with the SMTP server.
  sFrom                       String: Sender’s address.
  sTo                         String: Recipient’s address.


                                                                                               485
  sCC                          String: Address of the copy’s recipient.
  sSubject                     String: Email reference.
  sBody                        String: Email text.
  sHTMLBody                    String: Email text in HTML format.


bReturn = udf_FileOpen( hFile, sName, nMode )
Opens or creates a file. In case of an error, a report is issued (program) or an event triggered (COM
object)
Parameter:
  hFile                         File Handle: File reference
  sName                         String: Path and name of the file.
  nMode                         Number: Mode in which the file is opened (OF_Create, OF_Write,
                                OF_Read, OF_Append)
To create or write in a file, enter the mode OF_Create | OF_Write.


bReturn = FileWriteString( hFile, sLine )
Adds a new line to a file. The file must be opened before for writing.
Parameter:
  hFile                        File Handle: File reference (returned by udf_FileOpen)
  sLine                        String: Line to be added to the file.


bReturn = udf_FileClose( hFile )
Close a file.
Parameter:
  hFile                        File Handle: File reference (returned by udf_FileOpen)


bReturn = udf_FileRename( sFileOld, sFileNew )
Renames a file.
Parameter:
  sFileOld                 String: Name of the file to be renamed.
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




  sFileNew                 String: New name of the file to be renamed.
bReturn = udf_FileASCIIToUTF8( sASCIIFile, sUTF8File )
Changes the ASCII file defined in the parameter into an UTF-8 file.
Parameter:
  sASCIIFile                   String: Complete path + file name of the ASCII file.
  sUTF8File                    String: Complete path + file name of the UTF-8 file to be created.


sNewString = udf_StringSubstituteHTMLTags ( sLine )
Replaces all HTML-specific signs like & or < in a string.
Parameter:

                                                                                                    486
    sLine                    String: String in which all HTML-specific signs shall be replaced.
    sFileNew                 String: New name of the file to be renamed.


bReturn = udf_SubExecuteNum ( nFormula, nParam, nParamCount )
Executes the formula defined in nFormula in a local context. This executes the customizing formula
extremely fast. However there is no access option from within the executed formula to the controls
of a window. Required data must therefore be transferred via the dynamic array as parameter and
can be used within the formula.
Parameter:
 nFormula              Number: Number of the formula to be executed acc. to formula
                       management.
 nParam                Number: Dynamic array with number values
 nParamCount           Number: Number of elements in the dynamic array
Example:
The example executes formula number 2 with the two values 123 and 321 as parameters.
Set g_nUdv[0] = 123;
Set g_nUdv[1] = 321;
udf_SubExecuteNum ( 2, g_nUdv, 2 );


Access to both parameters nParam and nParamCount within the formula number 2 from the above
example takes places as follows:
…
Set g_fktDoc.m_nID = nParam[0];
Set g_fktDoc.m_Pos[0].m_nPROD_ID = nParam[1];
…




bReturn = udf_SubExecuteString ( nFormula, sParam, nParamCount )
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL



Executes the formula defined in nFormula in a local context. This executes the customizing formula
extremely fast. However there is no access option from within the executed formula to the controls
of a window. Required data must therefore be transferred via the dynamic array as parameter and
can be used within the formula.
Parameter:
 nFormula              Number: Number of the formula to be executed acc. to formula
                       management.
 sParam                String: Dynamic array with string values
 nParamCount           Number: Number of elements in the dynamic array
Example:




                                                                                                  487
The example executes formula number 5 with the two values 'This is a message box' and 'Heading'
as parameters.
Set g_sUdv[0] = ‘This is a message box’;
Set g_sUdv[1] = ‘Heading’;
udf_SubExecuteString ( 5, g_sUdv, 2 );


Access to both parameters sParam and nParamCount within the formula number 5 from the above
example takes places as follows:
…
SalMessageBox ( sParam[0], sParam[1] );
…


Document category variables
You can access these variables from the menu formulas only by entering a document entity. In
document header and item entry, this entity is called w_fktDoc. The variables and functions are
addressed by this name. You do not need the entity name for price formulas and size formulas as
both are run in connection with the document category.
  m_nUdv[*]                 Array type Number
  m_sUdv[*]                 Array type String
  m_sqlUdv[*]               Array type SQL handle
Example for a menu formula:
Set w_fktDoc.m_nUdv[0] = 1020;
Example for a size formula or price formula:
Set m_nUdv[0] = 1020;


The following variables have special meanings can must not be changed in formulas. They are preset
correctly only for price formulas and size formulas. Using them in menu formulas may result in
errors and breakdowns.
    m_nCurItemIdx            Number: Current item index. Allows to access the current item.
                             (e.g. m_Pos[m_nCurItemIdx].m_nPP_BREITE )
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




    m_nCurBOMIdx             Number: Current BOM index. Allows to access the current BOM. (e.g.
           Number:           m_Pos[m_nCurItemIdx].m_PosStukl[m_nCurBOMIdx].m_nSTL_BREITE
    Current BOM index.       )
    m_sFormulaContext        String: Shows the current execution index of the price formula and is
                             thus valid only for price formulas. Valid input: "AFTER_SELECT_PRICE"
                             (formula was called after searching for prices and prior to summing up)
                             and "BEFORE_CALC_PRICE" / "AFTER_CALC_PRICE" (formula was called
                             after summing up).

Document category functions



                                                                                                  488
Document category functions can be loaded from menu formulas only by the entity name
w_fktDoc. Price formulas and size formulas do not require the entity name
bReturn = udf_AppendProductToBOM ( nItemIdx, nProductNo, nParentNode, nNewBOMIdx,
hSql )
This function is used to add an article to the BOM of an item.
Parameter:
  nItemIdx                    Number: Index of the item to which the BOM element shall be added.
  nProductNo                  Number: Article number of the article to be added.
  nParentNode                 Number: ID of the BOM element to which the new element shall be
                              added. Enter 0 to add it to the main item.
  nNewBOMIdx                  Receive Number: Index of the added BOM element.
  hSql                        SQL handle: SQL handle for the main database.
Example:
In this case, a database connection is established; article 1004 is added to the main article of the
current item. The index of the new BOM element is now available in m_nUdv[0].
DbMakeTempConnect ( m_sqlUdv[0] );
udf_AppendProductToBOM ( m_nCurItemIdx, 1004, 0, m_nUdv[0], m_sqlUdv[0] );
SqlDisconnect( m_sqlUdv[0] );


bReturn = udf_DeleteBOMItem ( nItemIdx, nDeleteIdx )
This function is used to delete a BOM from an item.
Parameter:
  nItemIdx                    Number: Index of the item from which the BOM element shall be
                              deleted.
  nDeleteIdx                  Number: Index of the BOM element to be deleted.
Example:
Deletes the BOM element the index of which is in g_nUdv[0] in the current item.
udf_DeleteBOMItem ( m_nCurItemIdx, g_nUdv[0] );
bReturn = udf_ExecFormula ( nFormulaNo )
This function executes a formula in connection with the price formula or size formula.
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




Parameter:
  nFormulaNo                       Number: Number of the formula to be executed.
Example:
Loads and executes formula number 1.
udf_ExecFormula ( 1 );


bReturn = udf_GetPrice ( nType, nObject, nCustomer, sCustomerGroup, nListID, nKeyID,
nTableID, nBorder1, nBorder2, nBorder3, nPrice, nPriceType )




                                                                                                489
Determines the price for a certain article based on the price tables. Border 1-3 shows the quantity
limit that has been found. This has to be checked against the exact quantity limits.
Parameter:
  nType                           Number: Controls the search in price tables. 0 = PR_PRICE, 1 =
                                  PR_CU_PRCIE, 2 = PR_CG_PRICE, 3 = PR_SU_PRICE, 4 =
                                  PR_SG_PRICE
  nObject                         Number: Customer or supplier project.
  nCustomer                       Number: Customer number.
  sCustomerGroup                  String: Customer group.
  nListID                         Number: Price list number.
  nKeyID                          Number: Price code number.
  nTableID                        Number: Price table number.
  nBorder1                        Receive Number:Quantity limit 1.
  nBorder2                        Receive Number:Quantity limit 2.
  nBorder3                        Receive Number:Quantity limit 3.
  nPrice                          Receive Number: Resulting price.
  nPriceType                      Receive Number: Price type.


bReturn = udf_GetVariable ( sVarName, sVarValue )
Returns the contents of a user-defined variable. This variable used to be filled by loading
udf_SetVariable. User-defined variables in a document are automatically saved in the database for
further use. This allows any new property for a document that has been entered before via input
dialog or Customizer to be saved.
Parameter:
  sVarName                        String: Name of the variable to be accessed.
  sVarValue                       Receive String: Contents of the variable.


bReturn = udf_SetVariable ( sVarName, sVarValue )
Defines the value of a user-defined variable.
Parameter:
  sVarName                        String: Variable name.
  sVarValue                       String: New value of the variable.
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




bReturn = udf_SearchBOMItemByProductTyp ( nStartIndex, nProductTyp, nStuklIndex )
Searches the current item (m_nCurItemIdx) for a BOM element based on the ALFAK product type.
This function is only to be used for size and price formulas as it internally uses the variable
m_nCurItemIdx.
Parameter:
  nStartIndex                      Number: Zero-based start index for the search.
  nProductTyp                      Number: ALFAK product type.
  nStuklIndex                      Receive Number: BOM index of the element found.Receive
                                   Number: BOM index of the element found.




                                                                                               490
bReturn = udf_SearchBOMItemByProductTypEx ( nStartIndex, nItemIndex, nProductTyp,
nStuklIndex )
Searches the current item (m_nCurItemIdx) for a BOM element based on the ALFAK product type.
Unlike function udf_SearchBOMItemByProductTyp () it can be used also outside size and price
formulas.
Parameter:
  nStartIndex                    Number: Zero-based start index for the search.
  nItemIndex                     Number: Item index
  nProductTyp                    Number: ALFAK product type.
  nStuklIndex                    Receive Number: BOM index of the element found.Receive
                                 Number: BOM index of the element found.


nReturn = udf_AdjustValueOnItemPricePerUnit ( nValue, fktItem )
Searches the current item (m_nCurItemIdx) for a BOM element based on the ALFAK product type.
Unlike function udf_SearchBOMItemByProductTyp () it can be used also outside size and price
formulas.
Parameter:
  nValue                         Number: Price per piece to be adapted to the price per price unit
  fktItem                        cfktPos: Item object
  nReturn                        Number: Surcharge on the price per price unit




Item category functions
The described functions are part of the item category. They have to be addressed by the entity
                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL



name and the index of the item in question.
bReturn = udf_GetIdxByOccurrence ( nProdukt, nOccurence, nStlIdx )
Determines the BOM index based on its article number and frequency of occurrence.
Parameter:
  nProdukt                 Number: Article number of the required BOM element..
  nOccurence               Number: Occurrence of the required BOM element. If you search
                           for the third time this BOM element appears, enter 3.
  nStlIdx Receive  Number: Receive Number: BOM index of the element wanted. If this is not
  BOM index of the element found, -1 will be returned.
  wanted.
Example:

                                                                                             491
In this case, we are searching for the second article with number 1004. The BOM index is saved in
variable m_nUdv[0].
m_Pos[m_nCurItemIdx].udf_GetIdxByOccurence ( 1004, 2, m_nUdv[0] );


bReturn = udf_GetVariable ( sVarName, sVarValue )
Returns the contents of a user-defined variable. This variable used to be filled by loading
udf_SetVariable. User-defined variables in an item are automatically saved in the database for
further use. This allows any new property for an item that has been entered before via input dialog
or Customizer to be saved.
Parameter:
  sVarName                        String: Name of the variable to be accessed.
  sVarValue                       Receive String: Contents of the variable.


bReturn = udf_SetVariable ( sVarName, sVarValue )
Defines the value of a user-defined variable.
Parameter:
  sVarName                        String: Variable name.
  sVarValue                       String: New value of the variable.


bReturn = udf_SetProcessingRemark ( nCurBOMIdx, sProccessingText )
Puts the defined text into the processing text "BEA_TEXT" of the BOM element.
Parameter:
  nCurBOMIdx                       Number: Current BOM index.
  sProcessingText                  String: Processing text.



bReturn = udf_DeleteTextNo ( nTextNumber)
Deletes the transferred text number from the item text.
Parameter:
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL



  nTextNumber                     Number:Text number
Returns:
TRUE =Text has been deleted.


bReturn = udf_AddTextNo ( nTextNumber, nTextLocation, hSql)
Deletes the transferred text number from the item text.
Parameter:
  nTextNumber                     Number:Text number
  nTextLocation                   nTextLocation Number: 0=before item 1=after item
  hSql                            SqlHandle: Temporary database handle


                                                                                               492
Returns:
TRUE = Text has been inserted


bReturn = udf_SearchBOMbyID ( nBomID, nBomIdx )
Search         BOM        index      based       on       the       BOM         ID       (BOM_ID)

Parameter:
   nBomID                         Number: BOM ID number
   nBOMIdx                        Receive Number: BOM index number
(-1 if not existing)
Returns:
TRUE = BOM has been found
Form printing variables
To send variables to the formula report, you have to have access to the window handle of the report
generator. The index of the current item is required as well. There are spezial variables for the
formulas to be allocated to the printing of forms.
  hWndReport                      Window-Handle: Window handle of the report generator.
  w_nRepPosZaehler                Number: Index of the item being printed.
Extended BOM printing
If a new value shall be printed for the STx variables of the BOM, the corresponding BOM element
can be accessed by means of the variable
  w_nRepBOM_ID[*]                (BOM ID at BOM printing)
ALCIM no. is required as well. The element w_nRepBOM_ID[0] corresponds with the element’s
BOM ID for ST0_BEZ. Access to the BOM index is given from BOM_ID via function
udf_SearchBOMbyID
Variables in displayed reports
The following variables can be used in displayed reports for the document types (quotation, order,
credit note, enquiry, P.O.):
  hWndReport                      Window-Handle: Window handle of the report generator.
  w_nRepPosZaehler                Number: Current index on the item list
  w_nRepStklZaehler               Number: Current index on current item’s BOM.
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Variables in shape sketches
You can use the following values for the customizing of shape sketches:
  hWndReport                      Window-Handle: Window handle of the report generator.
  w_nRepPosZaehler                Number: Current index on the item list
Input check variables
To define sensible variables for input checks, you may have to prevent saving. There is a variable
that must only be used in formulas executed in connection with the event „input check“. The
variable is called m_bPlausibilityOK and has to be set to FALSE to prevent saving.




                                                                                               493
10.17.          Size formulae
Defining a formula
Formulas are defined master data, Products-Size formulas by the programmer or an experienced
project manager. The program will interpret the formula in connection with the order object. The
term m_Pos[m_nCurrentPosIdx] serves to access the current item; the variables from the item
table have to be added, separated by a dot. The resulting Gupta SQLWindows program code to
access the item width is:
Set nResult = m_Pos[m_nCurItemIdx].m_nPP_BREITE;
Every formula has to end with a semicolon. Only single lines are valid.
Defining a product
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




The formulae can be used in all size fields in product management and its sub-dialogs (shapes,
Georgian bars, processing). Press Ctrl+F2 in the corresponding field. This opens a dialog with a
selection of formulae. If the formula is allocated to the data field, the display shows e.g. F (5) for
formula number 5:




                                                                                                  494
Fig. 209: Open formula dialog in product management

At order entry, the formulae will be recalculated whenever a product is amended; the sizes always
represent the actual status. If the cursor is set on a size field at product entry, a tool tip appears,
showing the defined formula so that you can check this quite easily.
Size formula variables
Size formulas are always allocated to the size fields in article master data. These formulas are called
at size transfer and shall return the corresponding size. This works only if every size formula returns
its result via the variable "nResult".
  nResult                             Number: Is used in size formulas to define the size.
Example:
In this case, the width of the current item is returned.
Set nResult = m_Pos[m_nCurItemIdx].m_nPP_BREITE;
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




10.18.           Text Customizing

Completing spacer/processing text by formulas
The tag <@formulanumber@> can be used to complete a spacer/processing text by a formula.
Formula number shows the corresponding formula. The formula is executed in connection with the
order document. The rules are the same as for price formulas. The result of text replacement has
to be defined in variable sResult. Examples: see annex.




                                                                                                   495
10.19.         EDI Customizing
The functions of EDI Import and EDI Export can be completed by allocating a formula to the
corresponding program item. The formula will be executed at the start and at the end of the
import/export of each document. Since only one formula can be allocated per export/import, you
have to define the execution time – similar to price formulas – in the formula context (variable
m_sFormulaContext). The variable m_sFormulaContext has the following values, depending on the
context:
Start                    of                      import:                       "BEFORE_IMPORT"
End                     of                        import:                       "AFTER_IMPORT"
Start                    of                       export:                      "BEFORE_EXPORT"
End of export: "AFTER_EXPORT"
Start                    of                      import:                       "BEFORE_IMPORT"
End                     of                        import:                       "AFTER_IMPORT"
Start                    of                       export:                      "BEFORE_EXPORT"
End of export: "AFTER_EXPORT"
After document entry: “AFTER_SAVE“
Start                    of                      import:                       "BEFORE_IMPORT"
End                     of                        import:                       "AFTER_IMPORT"
Start                    of                       export:                      "BEFORE_EXPORT"
End of export: "AFTER_EXPORT"
Start                    of                      import:                       "BEFORE_IMPORT"
End                     of                        import:                       "AFTER_IMPORT"
Start                    of                       export:                      "BEFORE_EXPORT"
End of export: "AFTER_EXPORT"
The variable by which the current document can be accessed is called fktDoc.
Execution using the "AFTER_SAVE" context is performed after saving the document and creating
the history entry, but before the duplicate and credit limit check.
Since export and import have been implemented as COM objects, it is essential not to open
message boxes or other dialogs (e.g. user input) within the formulas.Since export and import have
been implemented as COM objects, it is essential not to open message boxes or other dialogs (e.g.
user input) within the formulas. This would cause the program to abort with a runtime error. You
should use the function TRACE as a debugging support.
bReturn = TRACE ( sTraceMessage, nTraceLevel, nTraceCategory )
                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




Creates a trace message.
Parameter:
  sTraceMessage String:           String: Contents of the message
  Contents of the message
  nTraceLevel                     Number:Level of the trace message ( EVENT_ERROR,
                                  EVENT_INFORMATION or EVENT_WARNING )
  nTraceCategory                  Number: Category of the trace messsage ( TRACE_COMMON,
                                  TRACE_PRICECALC,      TRACE_DIALOG,      TRACE_DATABASE,
                                  TRACE_CUSTOMIZING )




                                                                                              496
10.20.             P.O. Transfer
The P.O. header and items can be adapted by using formulas. In the customizing dialog, you can
enter a formula for the items 200-Transfer to purchasing(header) and 201-Transfer to
purchasing(item).




Fig. 210: Customizing P.O. transfer

200 – Transfer to purchasing (header)
The variable by which the current document can be accessed.
fktBest:           Current P.O.
fktAuftr:          Current order
Example see example 8
                                                                                                 A+W Software GmbH - Configuration A+W Business - INTERNAL




201 – Transfer to purchasing (item)
The variable by which the current document can be accessed.
p_fktEKDoc.m_Pos[nBEST_POS_Idx]:              Current P.O. item
p_fktBestArray[nArrayIdx]:                   Current P.O pool entry
p_fktDoc.m_Pos[nPosIdx]:                      Current order item
The query nMode = PO_MODE_INTERNAL determines if you are currently at internal transfer to
purchasing.




                                                                                           497
Status allocation of P.O. status
Settings in connection with repeated transfer to purchasing
 Status point                                  Allocate status
 650 - order status changed                    Yes
 660 - repeated transfer                    to Yes
 purchasing
 670 - P.O. created                            No
 680 - P.O.                                    No
Tab. 48: Status allocation of P.O. status




10.21.             Filling the purchase pool via workflow formula

A new udf function (udf_TransferToPoPool) has been developed to automatically transfer orders
to the order pool. Orders are ONLY placed in the pool. Then, the user should assign the supplier
and can create the PO (Documents > Order > PO Transfer).


The following formula Workflow_TransferToPoPool.txt is delivered with the setup:
! ******************************************************************;
! ** Transfer all orders to PO pool                              *******;
! ******************************************************************;
!;
! Used Variables;
! g_sqlUdv[0] = Main database handle;
! g_nUdv[0] = FETCH result;
! g_nUdv[1] = User status;
! g_nUdv[2] = Min status;
! g_nUdv[3] = Lock status;
! g_nUdv[4] = Sales order number;
                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




!;
! *****************************************************;
! Start of the transfer process;
! *****************************************************;
!;
IF udf_ReadStatusPoint( 30, g_nUdv[1], g_nUdv[2], g_nUdv[3] );
         ! Connect to main database;
                   If DbMakeTempConnect ( g_sqlUdv[0] );


                                                                                             498
                  TRACE ( 'Start formula "Transfer to PO pool"', EVENT_INFORMATION ,
                  TRACE_CUSTOMIZING);
                  !;
                  IF   SqlPrepareAndExecute(      g_sqlUdv[0], DbParse('SELECT ID FROM
                  SYSADM.BW_AUFTR_KOPF WHERE STATUS >= :g_nUdv[2] AND STATUS <
                  :g_nUdv[3] INTO :g_nUdv[4]') );
                           WHILE SqlFetchNext( g_sqlUdv[0], g_nUdv[0] );
                                  !;
                                  ! Transfer orders to PO pool;
                                  !;
                                  TRACE ( 'Order to transfer: ' || SalNumberToStrX(g_nUdv[4],0),
                                  EVENT_INFORMATION , TRACE_COMMON );
                                  !;
                                  udf_TransferToPoPool(0, nMODE_AUFTRAG, g_nUdv[4]);
                                                  Wend;
                  ENDIF;
                  DbDisconnect( g_sqlUdv[0] );
         ENDIF;
ENDIF;




                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                             499
10.22.             Tax calculation
Customizing has been extended to be able to handle the different tax calculation methods. This
allows to implement a special, country-related tax calculation.
Formula-based tax calculation requires customizing in several places.
The customizing dialog Master data/company/customizing, tab Programs, serves to define the
formulas for tax calculation.
50 - tax rate search and calculation in the item
51 - tax rate search in the header (customer is added)
52 - tax calculation and addition




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 211: Customizing tax calculation

If these formulas have been added, standard calculation is completely switched off; all taxes have
to be calculated via customizing. Tax calculation on item level is ineffective.


                                                                                              500
 At document entry, tax calculation has to be triggered when fields are changed. This requires menu
customizing. Save the field contents in the order structure and open tax calculation and display of
fields.




Fig. 212: Search formula in document entry

Tax rates can be entered in program Master data/Finances/Tax matrix. Input limits have to be filled
via menu customizing.
Customer master data now offers the checkboxes Tax code for the individual taxes. These can be
used for control purposes in the tax formulas. By default, they have no function. The code 'end user'
has been adopted from customer master data and can be changed as required in the document.
Taxes can be named by means of the system text modules 151-155
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Tax calculation formulas for Brazil
Tax     calculation     formulas    are    assigned    using    Brazilian    tax    for    example.
Brazilian tax calculation knows five taxes
ICMS - Depending on the shipping area (route), the tax is calculated by means of a code ‚ICMS
contribute’.
Customers with this flag are distinguished by end customers and resellers.
The definition is made in program Tax matrix
This table shows the tax rates and dependences:




                                                                                                 501
                                 For companies which contribute For     companies
                                 with ICMS taxes                which DOES NOT
                                                                contribute   with
                                                                ICMS taxes
 Regions                         If destined to End Customers
                                 subsequent
                                 commercialization
                                 or
                                 industrialization
 SP                              18%               18%
 Zona Franca/Manaus              0%                0%           0%
 Southeast & South               12%               12%          18%
 Northeast,                      7%                7%           18%
 North,Center-West &
 Espirito Santo State
Tab. 49: Brasil. Tax rates and dependences:

PIS - The tax is 1.65% and is added to the ICMS tax.
CONFIX - The tax is 7.60% and is added to the ICMS tax.
IPI - The tax depends on the product and is calculated by item. It is added to all former taxes.
Exception: the customer is an end customer and subject to ICMS tax in which case, the IPI tax is
calculation basis for ICMS tax, and is calculated first.
ISS - Service tax depending on the customer's area


Setting up formula calculation for Brazil
The customizing dialog Master data/company/customizing, tab Programs, serves to define the
formulas for tax calculation.
Formula allocation point:
    •    50 - Allocate formula 350
    •    51 - Allocate formula 351
    •    52 - Allocate formula 352
The following formulas have to be allocated for menu customizing:
    •    Formula 353 - Document header - Click Event - combo box Route and Add button, and
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL



         delete the shipping address
    •    Formula 354 - Document header - Click Event - combo box State
    •    Formula 355 - Document header - Click Event - end customer
    •    Formula 360 - Tax matrix - create window
The demo database includes all formulas
Form printing
For printing of forms, the same tax variables are available for tax 3-5 and for tax 1-2.
To fulfil (for Brazilian tax calculation) the requirement that the tax must be included in the price per
price unit, the tax amount for the item (for tax 1-5) can be loaded from the item variable
(POS_ITEM_MWST1-5). The form has to be customized to get the value of price/price unit. The total



                                                                                                    502
item tax has to be adapted to the item’s price unit using the function float
udf_AdjustValueOnItemPricePerUnit(Value, item object).
Import and Export of Payment Information
In Brazil, the payment traffic is normaly handled via the banks. The customizing formulas are used
in order to transfer payments to the banks and also read in the report about payments made. These
formulas must be adjusted individually for each bank for their file format. After that, the formulas
for the import and export of the bank in question are assigned in the bank administration.
Das verknüpfte Bild kann nicht angezeigt werden. Möglicherweise wurde die Datei verschoben, umbenannt oder gelöscht. Stellen Sie sicher, dass die Verknüpfung auf die korrekte Datei und den korrekten Speicherort zeigt.




Fig. 213: Import and export of payment information

Furthermore, it is necessary to set the external keys of the currency identifiers to the international
currency identifiers.

                                                                                                                                                                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                                                                                                                                            503
Das verknüpfte Bild kann nicht angezeigt werden. Möglicherweise wurde die Datei verschoben, umbenannt oder gelöscht. Stellen Sie sicher, dass die Verknüpfung auf die korrekte Datei und den korrekten Speicherort zeigt.




Fig. 214: Adjusting currency identifiers

The tax number must be entered in the company master data.




                                                                                                                                                                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 215: Tax number in the company master data

Examples for custommizing are located in the installation path of the formulas (normally
C:\Program        Files\A+W\ALFAK         2011\Formula\)        with       the     name
brasiliantax_paymentbankexportXXX.txt or brasiliantax_paymentbankimportXXX.txt.

                                                                                                                                                                                                                            504
For the actual import or export of the payment, you access the import/export of payments via
Documents > Order.
There, the payments to be exported are selected, the appropriate bank is selected, the file name
specified and the export started with a click on OK. During the import, the bank and the file name
must also be specified and the import is started with a click on OK.




Fig. 216:Import/export of payments




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               505
10.23.          Cash discount date calculation
Calculation of the cash discount date requires flexibility on the application’s part. This is because
the conditions are subject to negotiation. It is therefore possible to implement this via customizing.
Standard calculation will still be run, i.e. even partial aspects can be changed. Customising runs in
the context of the document category.
In the customizing dialog, the formula for item 40-cash discount date has to be entered. The
following variables can be set via customizing:
m_nCashDiscountRate1…3                   ->      Cash discount1-3
m_nCashDiscountDays1…3                   ->      Cash discount days 1-3
m_dCashDiscountDate1…3                   ->      Cash discount date 1-3
Standard implementation uses the function ABC_ValutaDate to calculate the cash discount date.
Set m_dCashDiscountDate1 = ABC_ValutaDate(
m_dDATUM_RECHNUNG, m_dDATUM_RECHNUNG, 0, 1, m_nCashDiscountDays1, 0, 0, 0 )


dDate = ABC_ValutaDate ( dInputDate, dDeliveryDate, nInvoiceDay, nFlag, nCashDays,
nCashDay1, nCashDay2, nCashDay3)
Cash discount date calculation
Parameter:
  dInputDate               Date/Time: Starting date (invoice date)
  dDeliveryDate            Date/Time: Shipping date (if nFlag=11)
  nInvoiceDay              Number: Invoicing date (Standard 0)
  nFlag                    Number: Cash discount calculation type (Standard 1)
  nCashDays                Number: Number of cash discount days
  nCashDay1…3              Number: Payment date 1 to 3 (Standard 0)
Returns:
New cash discount date


                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  506
10.24.             Data container for customizing data
The data container for customizing data can be used to manage data required for customizing,
flexibly by means of the database. The names of the tabs and tables on screen can be defined by
the project manager by means of formulas.




Fig. 217: Formula dialog – Data container - creating formulas

So that the administrator maintains control over the individual functionalities, the management of
the dialog can be configured via the ALFAK rights system.
These scripts must be executed. - 20081006a.sql/20081007a.sql/20081007m.sql
Customizing data recording
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




A dialog has been created with the help of which new or changed customizing data can be saved in
an appropriate database. You call the dialog from the master data\company\data container. It has
five tabs. Each tab represents another aspect of customizing. On each tab, there is a screen
tablewhere the storing of the data takes place. On Insert, all columns can be edited. The user has
the possibility to make new entries with the help of the Control element combo box.

The names of the tabs can be specified by the planner (see below: 8.23.2.2). If something is already
set up, it can be found under Screen customizing on the Customizing dialog.


Adjusting the data container dialog with formulas
Sample formulas

                                                                                                507
Example 1:
Formula data container for customizing data:



Tab descriptions
!***************************************************************************;
!** Set labels for all tabs                         **;
!***************************************************************************;
picTabs.SetLabel(0, 'Erlöskontenermitlung', FALSE);
picTabs.SetLabel(1, 'Wetter', FALSE);
picTabs.SetLabel(2, 'Land', FALSE);
picTabs.SetLabel(3, 'Kunden', FALSE);
picTabs.SetLabel(4, 'MyTest', FALSE);


Table headers
The table headers can be defined in the same formula.
! ***************************************************************************;
! ** Set row header for all tables                     **;
! ***************************************************************************;

SalTblSetColumnTitle(tblCustomizingData1.cbBorder1, 'Produkt');
SalTblSetColumnTitle(tblCustomizingData1.cbBorder2, 'Doktyp');
SalTblSetColumnTitle(tblCustomizingData1.cbBorder3, 'AV-Bereich');
SalTblSetColumnTitle(tblCustomizingData1.cbWert, 'Erlöskonten');

SalTblSetColumnTitle(tblCustomizingData2.cbBorder1, 'Vormittag');
SalTblSetColumnTitle(tblCustomizingData2.cbBorder2, 'Tag');
SalTblSetColumnTitle(tblCustomizingData2.cbBorder3, 'Nacht');
SalTblSetColumnTitle(tblCustomizingData2.cbWert, 'Datum/Temperatur');

SalTblSetColumnTitle(tblCustomizingData3.cbBorder1, 'Rusland');
SalTblSetColumnTitle(tblCustomizingData3.cbBorder2, 'USA');
SalTblSetColumnTitle(tblCustomizingData3.cbBorder3, 'Östereich');
SalTblSetColumnTitle(tblCustomizingData3.cbWert, 'Wert');
                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




Table fields
The table fields (monitor) shall be edited.

Additionally, you can enter fix values from combo boxes, that have been defined with the help of
the formula.

!***************************************************************************;
!** Set value for columns Table 1                          **;
!***************************************************************************;
tblCustomizingData1.cbBorder1.AddValueString('1004-Float 4 mm', '1004');
tblCustomizingData1.cbBorder1.AddValueString('1006-Float 6 mm', '1006');



                                                                                              508
tblCustomizingData1.cbBorder1.AddValueString('1008-Float 8 mm', '1008');
tblCustomizingData1.cbBorder1.AddValueString('ESG Klar 4 mm', '4004');
tblCustomizingData1.cbBorder2.AddValueString('Auftrag', '2');
tblCustomizingData1.cbBorder2.AddValueString('Gutschrift', '1');
tblCustomizingData1.cbBorder3.AddValueString('ESG-Fertigung', 'ESG-Fertigung');
tblCustomizingData1.cbBorder3.AddValueString('<k.A.>', '<k.A.>');
tblCustomizingData1.cbBorder3.AddValueString('Isolierglasfertigung', 'Isolierglasfertigung');
tblCustomizingData1.cbBorder3.AddValueString('Vitropur', 'Vitropur');


Customizing access to the data container
The function determines a value with particular limits, which was saved to the database by the
Data container dialog. So that a query to the database can be performed without problems, the
following parameters should be entered when the function is called.

udf_ReadData(nMode, nTyp, sBorder1, sBorder2, sBorder3, sValue)


Parameter:
nMode           Number: Predefeined mode
                1 – In the query, the limits in the WHERE clause are established with "=". A
                particular value is searched for.
                0 – For the mode, the limits in the WHERE clause are established with ">=". That
                is, if no data record with the specified limits is found, the next such one is
                determined for which the limits are larger. For examples, see below.
nTyp            Number: Tab on the Data container dialog
sBorder1        String: Limit 1
sBorder2        String: Limit 2
sBorder3        String: Limit 3
sValue          Receive String: The value that is determined.



Returns: TRUE = no error


Example 2:
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Formula - call of the function udf_ReadData(…)
In the example, a formula is defined in customizing that calls the function udf_ReadData(...)
mentioned above. The result is then available in the variable m_sWdv[0] and is communicated to
the user in the form of a MessageBox. The formula is executed from the price formulas in the
context of the document class through the call of the function udf_ExecFormula(999).


! ***************************************************************************;
! **          Use Function udf_ReadData for data container customizing
data                     **;
! ***************************************************************************;
!** Used Variables                                                **;

                                                                                                509
! m_nUdv[1] -> Product number                                           ;
! m_nUdv[2] -> Document type                                            ;
! m_sUdv[0] -> The value of the read data                               ;
! m_sUdv[1] -> number area                                             ;
!****************************************************************************;
Set m_nUdv[1] = m_Pos[m_nCurItemIdx].m_nPROD_ID;
Set m_nUdv[2] = m_nDocType;
Set m_sUdv[1] = m_sOR_AVBEREICH;
! ** The function udf_ReadData delivers one certain value from table KA_CUSTOMIZINGDATA by
insert **;
! ** mode,type and 3 borders                                            **;
! ** Parameters:                                                  **;
! **       Number: nMode              The mode for the query. These are two values permit: **;
! **                      1 - determines the value with exactly eingegebeneb borders **;
! **                      0 - If it exists no value with the given borders, it is used in **;
! **                      WHERE Klaus instead of BORDER1= :sBORDER1, BORDER1 >=
:sBORDER1 **;
! **       Number: nTyp            Tab number in dialog Datencontainer **;
! **       String: sBorder1        border 1
! **       String: sBorder2        border 2 **;
! **       String: sBorder3        border 3 **;
! **       Receive String: sWert     The value of the entered data. If it was found no record the
string delivers **;


udf_ReadData(0,1, SalNumberToStrX( m_nUdv[1] , 0), SalNumberToStrX( m_nUdv[2] ,
0), m_sUdv[1] ,m_sUdv[0]);



SalMessageBox ( m_sUdv[0], 'WERT', MB_Ok );
Apply formulas
Using the Selection menu, the formulas are assigned to the dialog. The Selection menu can be called
up with a right-click on the window header.
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                510
Fig. 218: Data container selection menu

You can also reach the Customizing dialog using the Selection menu.




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




In order to incorporate the tabs and table header formula, select the menu element: Event handling
"Create window" and search for the created formula that adjusts the tab and the table header.




                                                                                               511
Fig. 219: Data container – creating a window

For the sake of simplicity, insert the formulas from the examples above into a complete one. And
implement this as described.
So that the effect is visible, you must restart the dialog.
If after the fact you would like to fill the table columns, use the "Create new data record" menu
element and search for the formula that should be incorporated.
In order to examine all formulas set up for the dialog, use the "Customizing" menu element on the
Customizing dialog. The first tab "Screens" displays the formulas set up.
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




10.25.            Sending the declaration of performance
In order to make the sending of the declaration of performance more flexible, a customizing
element has been introduced. In the customizing management (Master data > Company >
Customizing), the element 500 - Sending of declarations of performance is used for this. The
formula is called up before sending each declaration of performance once. In the formula that is
assigned to this element, you have access to the complete e-mail and the associated customer
number. The following variables are available:
  nCustomerID                                  Number: Number of the customer
  fktMail.m_sSMTPServer                        String: Address of the SMTP server
  fktMail.m_sSMTPUser                          String: User for the log in to the SMTP server


                                                                                                512
  fktMail.m_sSMTPPassword            String: Password for the log in to the SMTP server
  fktMail.m_sFrom                    String: Address of the sender
  fktMail.m_sTo                      String: Address of the recipient
  fktMail.m_sCC                      String: Address of the copy recipient
  fktMail.m_sBCC                     String: Address of the bcc recipient
  fktMail.m_sSubject                 String: Re
  fktMail.m_sData                    String: Content of the mail in text format
  fktMail.m_sDataHtml                String: Content of the mail in HTML format
  fktMail.m_saAttachment[*]          String Array: Array with the attachments of the mail. Contains
                                     the declarations of performance.
  fktMail.m_nAttachementCount        Number: Number of entries contained in the array of the
                                     attachments.


The customer number in the variable cCustomerID should not be changed. If necessary, it serves
only to communicate additional information about the customer within customizing via SQL query.
In the following example, the content of the classifier "LE receiver" is read out of the customer's
classifier via SQL query and used as alternate mail address for sending the declaration of
performance.
! Open the database connection;If DbMakeTempConnect ( g_sqlUdv[0] );             ! Read ID of the
classifier (LE-Receiver);      If SqlPrepareAndExecute ( g_sqlUdv[0], 'SELECT ID FROM
SYSADM.KA_KLASSI_DEF WHERE K_BEZ = \'LE-Receiver\' INTO :g_nUdv[0]' );                          If
SqlFetchNext ( g_sqlUdv[0], g_nUdv[1] );                          ! Read content of the
classifier;                         If SqlPrepareAndExecute ( g_sqlUdv[0], 'SELECT K_WERT
FROM SYSADM.KU_KLASSI_WERTE WHERE ID = :nCustomerID AND K_ID = :g_nUdv[0] INTO
:g_sUdv[0]' );                                                            If SqlFetchNext (
g_sqlUdv[0], g_nUdv[1] );                                            Set fktMail.m_sTo =
g_sUdv[0];                                     EndIf;                          EndIf;
   EndIf;          EndIf;       ! Close database connection;          DbDisconnect ( g_sqlUdv[0]
);EndIf;


10.26.          Form printing via the reporting service
Two functions can be used to transfer documents to the reporting service. The function
"udf_PrintDocument(…)" transfers the individual documents and the function
"udf_PrintNumberManager(…)" transfers a complete number manager to the reporting service.
Therefore, it is possible, e.g. to send order confirmations via mail automatically using a workflow
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL



task. The documents can be selected depending on their status, for example, and added to a
number manager. In chapter 10.29_Beispiele such a formula is presented as workflow formula for
the exchange service.
bReturn = udf_PrintDocument ( nID, nDocType, nForm, nOutputType, sOutputDevice,
sArchiveYear, nNumberRangeMode,        nClientID, sOrderArea, dDate, nLabelMode,
nNumberOfCopies, bCollectivePrintout )
Prints out the specified document with the help of the reporting service.
Parameter:
 nID                     Number: the number of the document




                                                                                               513
nDocType         Number: the type of the document (nMODE_AUFTRAG,
                 nMODE_BESTELLUNG, nMODE_ANGEBOT, nMODE_GUTSCHRIFT,
                 nMODE_BESTELLANFRAGE)
nForm            Number: the number of the form with which printing should be done
                 can be seen from the table in the form management
nOutputType      Number: 0=output on printer (sOutputDevice), 1=output via mail,
                 2=output to file (file name and path must be specified in the form)
sOutputDevice    String: exact name of the printer on which output should occur. For
                 possible names, see the reporting services from the infrastructure
                 services.
sArchiveYear     String: the year of the archive or empty for main database
nNumberRangeMode Number: mode for access to the number ranges for invoice and
                 delivery note number (0=uses the values from nClientID for site and
                 sOrderArea for AV-area,1=site and AV area from document;sOrderArea
                 and nClientID are empty,2=client from document and AV area from
                 sOrderArea;nClientID remains empty)
nClientID        Number: the specified site number for the number ranges. Only
                 important if nNumberRangeMode = 0.
sOrderArea       String: the specified AV area for the number ranges. Only important if
                 nNumberRangeMode = 0 or 2
dDate            Date/time: print date for invoice date. If empty, the current date is
                 used.
nLabelMode       Number: mode for the label printing (0=per unit, 1=per item, 2=setting
                 from document)
nNumberOfCopies  Number: number of copies at least 1

bCollectivePrintout   Boolean: TRUE = collective print, FALSE = no collective print




                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                      514
bReturn = udf_PrintNumberManager ( sNumberManager, sUser, nDocType, nForm,
nOutputType, sOutputDevice, sArchiveYear, nNumberRangeMode, nClientID, sOrderArea,
dDate, nLabelMode, nNumberOfCopies, bCollectivePrintout )
Prints out the specified number manager with the help of the reporting service.
Parameter:
 sNumberManager   String: the number manager to be printed
 sUser            String: user of the number manager
 nDocType         Number: the type of the document (nMODE_AUFTRAG,
                  nMODE_BESTELLUNG, nMODE_ANGEBOT, nMODE_GUTSCHRIFT,
                  nMODE_BESTELLANFRAGE)
 nForm            Number: the number of the form with which printing should be done
                  can be seen from the table in the form management
 nOutputType      Number: 0=output on printer (sOutputDevice), 1=output via mail,
                  2=output to file (file name and path must be specified in the form)
 sOutputDevice    String: exact name of the printer on which output should occur. For
                  possible names, see the reporting services from the infrastructure
                  services.
 sArchiveYear     String: the year of the archive or empty for main database
 nNumberRangeMode Number: mode for access to the number ranges for invoice and
                  delivery note number (0=uses the values from nClientID for site and
                  sOrderArea for AV-area,1=site and AV area from document;sOrderArea
                  and nClientID are empty,2=client from document and AV area from
                  sOrderArea;nClientID remains empty)
 nClientID        Number: the specified site number for the number ranges. Only
                  important if nNumberRangeMode = 0.
 sOrderArea       String: the specified AV area for the number ranges. Only important if
                  nNumberRangeMode = 0 or 2
 dDate            Date/time: print date for invoice date. If empty, the current date is
                  used.
 nLabelMode       Number: mode for the label printing (0=per unit, 1=per item, 2=setting
                  from document)
 nNumberOfCopies  Number: number of copies at least 1

 bCollectivePrintout     Boolean: TRUE = collective print, FALSE = no collective print            A+W Software GmbH - Configuration A+W Business - INTERNAL




10.27.         OrderXML transfer via the import service
Two functions can be used to transfer documents to the import service and/or delete them. The
function "udf_ CleanUpOrderXmlTable(…)" deletes all old OrderXMLs and the function
"udf_TransferOrderXmlToProduction(…)" transfers all OrderXMLs that are finished to the import
service through the exchange service. In chapter 10.29_Beispiele such a formula is presented as
workflow formula.
bReturn = udf_TransferOrderXmlToProduction ( bResetErrors, sMessages )
Prints out the specified document with the help of the exchange service.
Parameter:



                                                                                            515
 bResetErrors        Boolean: TRUE = flawed OrderXMLs should be transferred again, FALSE =
                     flawed OrderXML will not be transferred again
 sMessages           Receive string: info or error messages as character string that can be traced
                     or sent via e-mail



bReturn = udf_CleanUpOrderXmlTable ()
Removes all OrderXMLs from the BW_ORDERXML table that are older than the number of storage
days (default value = 7 days).



10.28.          Breakage transfer from the Logistic Service
The function "udf_RetreiveBreakages(…)" transfers all breaks that were not yet transferred from
the Logistic Service. In chapter 10.29_Beispiele such a formula is presented as workflow formula.
bReturn = udf_ RetreiveBreakages ( sMessages )
Generates the complaints for breakages from the Logistic Service.
Parameter:
 sMessages           Receive string: info or error messages as character string that can be traced
                     or sent via e-mail



10.29.          Examples

User-defined variables and the Customizer
In this example, the user-defined variable "depth" – previously added to the Customizer – is
analysed and saved in the item. When the item is saved in the database at item entry, the system
also saves the user-defined variables in the database. This is a menu formula which can linked with
the event "change record" at item entry for instance.
! Determine the actual item index;
w_fktDoc.Search ( g_nUdv[0], frmDocumentItems.tblPos.cnPOS_NR );
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




! Load the depth from Customizer;
g_hUdv[0].tblCustomizer.GetValue ( 'Tiefe', g_sUdv[0] );
! Save the depth in the item structure;
w_fktDoc.m_Pos[g_nUdv[0]].udf_SetVariable ( 'Tiefe', g_sUdv[0] );
! Write the depth in the BOM;
w_fktDoc.m_Pos[g_nUdv[0]].udf_GetIdxByOccurrence ( 40002, 1, g_nUdv[1] );
If g_nUdv[1] != -1;
        Set w_fktDoc.m_Pos[g_nUdv[0]].m_PosStukl[g_nUdv[1]].m_nSTL_BREITE =
        SalStrToNumber ( g_sUdv[0] );
EndIf;



                                                                                                516
! Delete row flags from Customizer;
SalTblSetFlagsAnyRows ( g_hUdv[0], ROW_Edited, FALSE, 0, 0 );
New formula variable
In this example, the user-defined variable "depth" is sent to printing of forms.
w_fktDoc.m_Pos[w_nRepPosZaehler].udf_GetVariable              (      'Tiefe',      g_sUdv[0]    );
SalReportSetStringVar ( hWndReport, 'TIEFE', g_sUdv[0]);
Spacer Text
The formula tag is replaced by the IG structure and spacer color.
!*******************************************************************************
*;
!** Get the DGU Structure to the Variable sResult for bendertexts **;
!*******************************************************************************
*;
!** Used Variables ;
!** m_nUdv[0] => Sorting index;
!** m_nUdv[1] => B.O.M. index for access;
!** m_sUdv[0] => Buffer string;
!*******************************************************************************
*;
! Sorting B.O.M by BOM_ID;
m_Pos[m_nCurItemIdx].CreateSort ( );
! Index for B.O.M.;
Set m_nUdv[0] = 1;
! Loop on all B.O.M items;
WHILE m_Pos[m_nCurItemIdx].GetSort(m_nUdv[0], m_nUdv[1]);
 ! Init buffer;
  SET m_sUdv[0] = '';
 ! Is parent of main item;
                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




  IF m_Pos[m_nCurItemIdx].m_PosStukl[m_nUdv[1]].m_nBOM_NODE = 0;
  ! For glass only the short description;
    IF ProduktartIsGlas( m_Pos[m_nCurItemIdx].m_PosStukl[m_nUdv[1]].m_nSTL_PRODART );
       Set m_sUdv[0] = m_Pos[m_nCurItemIdx].m_PosStukl[m_nUdv[1]].m_sSTL_KURZ_BEZ;
  ENDIF;
  ! For gas only the short description;
    IF m_Pos[m_nCurItemIdx].m_PosStukl[m_nUdv[1]].m_nSTL_PRODART = PRDART_FUELL;
       Set m_sUdv[0] = m_Pos[m_nCurItemIdx].m_PosStukl[m_nUdv[1]].m_sSTL_KURZ_BEZ;
  ENDIF;

                                                                                               517
  ! For Spacer add the color;
    IF m_Pos[m_nCurItemIdx].m_PosStukl[m_nUdv[1]].m_nSTL_PRODART = PRDART_ABST;
      Set m_sUdv[0] = m_Pos[m_nCurItemIdx].m_PosStukl[m_nUdv[1]].m_sSTL_KURZ_BEZ;
      IF m_Pos[m_nCurItemIdx].m_PosStukl[m_nUdv[1]].GetFarbBez( ) != ' ';
       Set        m_sUdv[0]        =          m_sUdv[0]                ||          '-'        ||
m_Pos[m_nCurItemIdx].m_PosStukl[m_nUdv[1]].GetFarbBez( );
   ENDIF;
  ENDIF;
 ENDIF;
 ! Add the text to the result variable;
  IF SalStrLength( m_sUdv[0] );
  ! Add slash if has length;
    IF SalStrLength( sResult);
      SET sResult = sResult || '/';
  ENDIF;
    SET sResult = sResult || m_sUdv[0];
 ENDIF;
  Set m_nUdv[0] = m_nUdv[0] + 1;
WEND;




Processing text
The formula tag is replaced by the item size.
!*******************************************************************************
**;
!** Sets the item width and height in the processing text   **;
                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




!*******************************************************************************
**;
Set sResult = SalNumberToStrX( m_Pos[m_nCurItemIdx].m_nPP_BREITE, 0 ) || 'x' ||
SalNumberToStrX( m_Pos[m_nCurItemIdx].m_nPP_HOEHE, 0 );
Load program via buttons
Every dialog has two buttons (pbTB_DUMMY1 and pbTB_DUMMY2) in its toolbar. These have to
be visualized in the event „show dialog“ by means of a formula. After that, you can add a formula
to the button at the Cklick event. This allows to load an external program for example.
Show window
! ************************************************************************;


                                                                                              518
! ** Change location, visibility and Text of the dummy button **;
! ************************************************************************;
SalSetWindowLoc ( pbTB_DUMMY1, 5, 0.1 );
SalSetWindowText ( pbTB_DUMMY1, 'Test' );
SalShowWindow ( pbTB_DUMMY1 );


Click on the button:
! **************************;
! ** Call the Notepad **;
! **************************;
! SalLoadApp ( 'Notepad.exe', '' );
! SalLoadAppAndWait ( 'Notepad.exe', Window_Normal, g_nUdv[0] );
SalLoadAppAndProcessMsgs( 'Notepad.exe', Window_Normal, g_nUdv[0] );
Energy surcharge by fixed size, stocksize, and box
The energy surcharge shall be graduated. Special discounts 4+5 are used for the energy surcharge
on stocksizes and boxes . Glass products can only be assigned the common energy surcharge.
Allocation is done at pricing. The formula has to be allocated via general program formula allocation
(see 3.5).
!
********************************************************************************
;
! ** Using auto. Discount for Stock sizes an boxes (Discount 4+5) **;
!
********************************************************************************
;
!** Used Variables ;
! ** m_nUdv[0] = Discount surcharge flags of product ZUSCHLAG_xxx;
! ** m_nUdv[1] = Fetch variable;
! ** m_sqlUdv[0] = Handle to main database;
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




IF m_sFormulaContext = 'AFTER_SELECT_PRICE';
! Connect to main database;
IF DbMakeTempConnect( g_sqlUdv[0] );
 ! Search main product in basic data and get the surcharge flag;
  IF    SqlPrepareAndExecute(         g_sqlUdv[0], 'SELECT   PRZ_ZUSCHLAG_BIT     FROM
SYSADM.BA_PRODUKTE WHERE              BA_PRODUKT=:m_Pos[m_nCurItemIdx].m_nPROD_ID INTO
:g_nUdv[0]' );
   IF SqlFetchNext( g_sqlUdv[0], g_nUdv[1] );


                                                                                                 519
  ! Main product has energy surcharge;
    IF g_nUdv[0] & ZUSCHLAG_ENERGIE;
    TRACE ( 'Price formula (310):      Basic             data   product       has   energy   surcharge',
EVENT_INFORMATION , TRACE_PRICECALC );
   ! Item is not a stock size and not a box, so change to surcharge ZUSCHLAG_ENERGIE, disable the
others;
    IF            NOT           m_Pos[m_nCurItemIdx].m_bLagermass                                  AND
m_Pos[m_nCurItemIdx].m_nPROD_PRODART != PRDART_KISTE;;
     TRACE ( 'Price formula (310):         Item has energy surcharge', EVENT_INFORMATION ,
TRACE_PRICECALC );
     SET               m_Pos[m_nCurItemIdx].m_nPROD_ZUSCHLAG_BIT                                      =
m_Pos[m_nCurItemIdx].m_nPROD_ZUSCHLAG_BIT | ZUSCHLAG_ENERGIE;
      SET              m_Pos[m_nCurItemIdx].m_nPROD_ZUSCHLAG_BIT                =
m_Pos[m_nCurItemIdx].m_nPROD_ZUSCHLAG_BIT & ( 0xFFFFFFFF - ZUSCHLAG_SONDERRABATT4
- ZUSCHLAG_SONDERRABATT5 ) ;
  ENDIF;
  ! Item is a stock size, so change to surcharge ZUSCHLAG_SONDERRABATT4, disable the others;
     IF m_Pos[m_nCurItemIdx].m_bLagermass AND m_Pos[m_nCurItemIdx].m_nPROD_PRODART
!= PRDART_KISTE;
     TRACE ( 'Price formula (310):     Item has energy surcharge for stock sizes',
EVENT_INFORMATION , TRACE_PRICECALC );
     SET               m_Pos[m_nCurItemIdx].m_nPROD_ZUSCHLAG_BIT                                      =
m_Pos[m_nCurItemIdx].m_nPROD_ZUSCHLAG_BIT | ZUSCHLAG_SONDERRABATT4;
     SET               m_Pos[m_nCurItemIdx].m_nPROD_ZUSCHLAG_BIT            =
m_Pos[m_nCurItemIdx].m_nPROD_ZUSCHLAG_BIT & ( 0xFFFFFFFF - ZUSCHLAG_ENERGIE -
ZUSCHLAG_SONDERRABATT5 ) ;
  ENDIF;
  ! Item is a box, so change to surcharge ZUSCHLAG_SONDERRABATT5, disable the others;
  ! Attention: Box is a stocksize as well, so it must be the last question;
     IF m_Pos[m_nCurItemIdx].m_nPROD_PRODART = PRDART_KISTE;
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL



     TRACE ( 'Price formula (310): Item has energy surcharge for boxes', EVENT_INFORMATION ,
TRACE_PRICECALC );
     SET               m_Pos[m_nCurItemIdx].m_nPROD_ZUSCHLAG_BIT                                      =
m_Pos[m_nCurItemIdx].m_nPROD_ZUSCHLAG_BIT | ZUSCHLAG_SONDERRABATT5;
     SET               m_Pos[m_nCurItemIdx].m_nPROD_ZUSCHLAG_BIT            =
m_Pos[m_nCurItemIdx].m_nPROD_ZUSCHLAG_BIT & ( 0xFFFFFFFF - ZUSCHLAG_ENERGIE -
ZUSCHLAG_SONDERRABATT4 ) ;
  ENDIF;
  ENDIF;
 ENDIF;


                                                                                                     520
 ENDIF;
  SqlDisconnect( g_sqlUdv[0] );
 ENDIF;
ENDIF;
Direct shipment of P.O. to a certain supplier
POs are always transferred to suppliers as drop shipments. You do not have to set the code Direct
shipment in the order.
!*******************************************************************************
*******;
!** Direct delivery for DORMA                                     **;
!*******************************************************************************
*******;
!** Used Variables ;
! fktAuftr = Order document;
! fktBest = P.O. document;
!*******************************************************************************
*******;
! CAUTION: Please change the Supplier no to your value for Dorma         **;
!*******************************************************************************
*******;
! Supplier no for Dorma;
IF fktBest.m_nAH_IDENT = 7003;
          ! Set flag for direct delivery in P.O.;
                  Set fktBest.m_nAH_LIEFER_KZ = 1;
                  ! transfer main adress from order to purchase order;
                  Set fktBest.m_sAL_KOPF = fktAuftr.m_sAH_KOPF;
                  Set fktBest.m_sAL_NAME1 = fktAuftr.m_sAH_NAME1;
                  Set fktBest.m_sAL_NAME2 = fktAuftr.m_sAH_NAME2;
                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




                  Set fktBest.m_sAL_NAME3 = fktAuftr.m_sAH_NAME3;
                  Set fktBest.m_sAL_STRASSE = fktAuftr.m_sAH_STRASSE;
                  Set fktBest.m_sAL_PLZ = fktAuftr.m_sAH_PLZ;
                  Set fktBest.m_sAL_ORT = fktAuftr.m_sAH_ORT;
                  Set fktBest.m_sAL_LAND = fktAuftr.m_sAH_LAND;
                  Set fktBest.m_sAL_PROVINZ = fktAuftr.m_sAH_PROVINZ;
                  Set fktBest.m_sAL_TELEFON = fktAuftr.m_sAH_TELEFON;
                  Set fktBest.m_sAL_FAX = fktAuftr.m_sAH_FAX;
                  Set fktBest.m_sAL_ANREDE = fktAuftr.m_sAH_ANREDE;

                                                                                              521
                  Set fktBest.m_sAL_PARTNER = fktAuftr.m_sAH_PARTNER;
         !;
         ! Order delivery adress has priority;
               IF SalStrLength( fktAuftr.m_sAL_NAME1 || fktAuftr.m_sAL_NAME2               ||
fktAuftr.m_sAL_NAME3 || fktAuftr.m_sAL_STRASSE || fktAuftr.m_sAL_ORT );
                  ! Lieferanschrift uebernehmen;
                                 Set fktBest.m_nAL_IDENT = fktBest.m_nAH_IDENT;
                                 Set fktBest.m_sAL_KOPF = fktAuftr.m_sAL_KOPF;
                                 Set fktBest.m_sAL_NAME1 = fktAuftr.m_sAL_NAME1;
                                 Set fktBest.m_sAL_NAME2 = fktAuftr.m_sAL_NAME2;
                                 Set fktBest.m_sAL_NAME3 = fktAuftr.m_sAL_NAME3;
                                 Set fktBest.m_sAL_STRASSE = fktAuftr.m_sAL_STRASSE;
                                 Set fktBest.m_sAL_PLZ = fktAuftr.m_sAL_PLZ;
                                 Set fktBest.m_sAL_ORT = fktAuftr.m_sAL_ORT;
                                 Set fktBest.m_sAL_LAND = fktAuftr.m_sAL_LAND;
                                 Set fktBest.m_sAL_PROVINZ = fktAuftr.m_sAL_PROVINZ;
                                 Set fktBest.m_sAL_TELEFON = fktAuftr.m_sAL_TELEFON;
                                 Set fktBest.m_sAL_FAX = fktAuftr.m_sAL_FAX;
                                 Set fktBest.m_sAL_ANREDE = fktAuftr.m_sAL_ANREDE;
                                 Set fktBest.m_sAL_PARTNER = fktAuftr.m_sAL_PARTNER;
         ENDIF;
ENDIF;
BOM printing
BOM printing is controlled by the array w_nRepBOM_ID[*]. It includes the BOM IDs which are
printed in the corresponding position. The BOM ID allows to access the BOM element using the
function udf_SearchBOMbyID().
!*******************************************************************************
***********;
                                                                                                 A+W Software GmbH - Configuration A+W Business - INTERNAL




!** Adding the cost price/PU on BOM items to the form printing                       **;
!** Create new variables UDV_BOM_COST_PUxx (xx = 0 to maxBOM items)            **;
!** Assign this formula to the detail event of the form                        **;
!*******************************************************************************
***********;
!** Used Variables ;
!** g_nUdv[0] => Fetch variable;
!** g_nUdv[1] => Index of BOM item;



                                                                                           522
!*******************************************************************************
***********;


! Loop for maximum of 20 printed BOM items;
Set g_nUdv[0] = 0;
WHILE g_nUdv[0] < 20;
                  ! by default BOM isn't printed;
           SalReportSetNumberVar                      (                                 hWndReport,
'UDV_BOM_COST_PU'||SalNumberToStrX( g_nUdv[0], 0 ), NUMBER_Null );
         ! BOM is printed;
                  IF w_nRepBOM_ID[g_nUdv[0]] != NUMBER_Null;
                           IF w_fktDoc.m_Pos[w_nRepPosZaehler].udf_SearchBOMbyID                         (
w_nRepBOM_ID[g_nUdv[0]], g_nUdv[1] );
                           ! Adding cost price per price unit to the form;
                                         SalReportSetNumberVar     (     hWndReport,
'UDV_BOM_COST_PU'||SalNumberToStrX(               g_nUdv[0],           0          ),
w_fktDoc.m_Pos[w_nRepPosZaehler].m_PosStukl[g_nUdv[1]].m_nEK_PREIS_ME );
                  ENDIF;
         ENDIF;
         SET g_nUdv[0] = g_nUdv[0] + 1;
Amending the proceeds account record for transfer to financial accounting
A customer requires a different format for the proceeds account record. The standard is five-digit
customer numbers while the customer uses eight-digit numbers.
One needs to enter a formula describing the proceeds account record in the new format; this
formula has to be allocated to item 302 – FinAcc transfer (proceeds account record) in Customising.
!
********************************************************************************
******************;
! **     Interface desciption for the sales account record of the standard DATEV interface **;
                                                                                                             A+W Software GmbH - Configuration A+W Business - INTERNAL



! **     with increased field lengths for invoice number and customer account                **;
!
********************************************************************************
******************;


!                 Field    Start   Length           Description;
!                 1        01      1                Leading "-" if orders are exported, otherwise the
record
                                                                                  starts with field 2;
!                 2        02      10               Gross amount;


                                                                                                   523
!                   3      12     7                Sales account;
!                   4      19     7                Invoice number;
!                   5      26     6                not needed;
!                   6      32     2                Day of the invoice date;
!                   7      34     2                Month of the invoice date;
!                   8      36     8                Customer account;


! Used functions;


! Adjust_NrToStr (value, fieldLength, digits);
! Converts the number in value into a string with the desired number of digits.;
! The string is filled with leading Zeros until the desired field length is reached;


! Adjust_NrToStrB (value, fieldLength, digits);
! Converts the number in value into a string with the desired number of digits.;
! The string is filled with leading blanks until the desired field length is reached;


! Adjust_String (value, fieldLength);Adjust_String (value, fieldLength);
! Adds trailing blanks until the string in value gets the desired field length;


!
********************************************************************************
******************;


! Initialize the result value;
SET sResult = '';
! If orders are exported the record requires a leading '-';
                                                                                              A+W Software GmbH - Configuration A+W Business - INTERNAL




If w_nDocType = nMODE_AUFTRAG;
      SET sResult = '-';
EndIf;


! Adding gross amount to the record;
SET sResult = sResult || Adjust_NrToStr( w_nGrossAmount * 100 , 10, 0 );
! Adding the sales account to the record;
SET sResult = sResult || Adjust_NrToStrB( SalStrToNumber( w_sSalesAccount), 7, 0 );
! Adding the invoice number to the record;

                                                                                        524
SET sResult = sResult || Adjust_NrToStrB( w_nInvoiceNo, 7, 0 );
! Adding an field with 000000 to the record;
SET sResult = sResult || Adjust_String( '000000', 6 );
! Adding day of the invoice date to the record;
SET sResult = sResult || Adjust_NrToStr( SalDateDay ( w_dInvoiceDate), 2, 0 );
! Adding month of the invoice date to the record;
SET sResult = sResult || Adjust_NrToStr( SalDateMonth ( w_dInvoiceDate), 2, 0 );
! Adding the customer account number to the record;
SET sResult = sResult || Adjust_NrToStr( w_nCustomerAccount, 8, 0 );


The formula creates text consisting of the required fields in the desired format, and allocates it to
the variable sResult.
sResult is analysed by transfer to financial accounting, and is then transferred to the financial
accounting file.
Transfer to financial accounting – transfer of customer master data
This formula creates a record from the necessary fields of customer master data (customer number,
street, post code, name, … ). The fields of this record have no fixed length and are separated by
semicolons.
Formula – see
\\jupiter\ALFAK_Install\Versions\4.4.xxx\Formula\ Financ_DATEV_CustomerExport.txt

Or in the local ALFAK installation directory ‘formula’.
Workflow – print job after scheduling in Capacity Planning
This formula selects all orders of status 38 (schedule in time management) and adds in the user’s
calendar a task for printing, faxing, and emailing.
The orders are moved to a number manager, and the date list is updated.
Formula – see
\\jupiter\ALFAK_Install\Versions\4.4.xxx\Formula\Workflow_AddPrintTask.txt

Or in the local ALFAK installation directory ‘formula’.
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL



Workflow – check orders for purchased elements
This formula checks all orders of a certain status for purchased elements.
If purchased elements are involved, the order will get a certain status; if there are no purchased
elements, the order will get a different status.
Formula – see
\\jupiter\ALFAK_Install\Versions\4.4.xxx\Formula\ Workflow_CheckForPurchaseParts.txt

Or in the local ALFAK installation directory ‘formula’.
Workflow – Release for production
This formula selects all order of the same status with an order confirmation print date of over two
hours, and raises the status to ‘release for production’.

                                                                                                 525
Formula – see
\\jupiter\ALFAK_Install\Versions\4.4.xxx\Formula\ Workflow_StatusUpdateToReleaseForProduction.txt

Or in the local ALFAK installation directory ‘formula’.
Workflow – Production release in ALCIM
This formula selects all orders of the status ‚release for production’, raises the status to ‚transfer to
AWPool’ and releases the orders for production by calling the PPS Webservice. The production
status in BW_LOCK_KAPA is raised to ‘release for production'.
Formula – see
\\jupiter\ALFAK_Install\Versions\4.4.xxx\Formula\ Workflow_ReleaseForProduction.txt

Or in the local ALFAK installation directory ‘formula’.
Workflow – Production transfer to Capacity Planning
This formula selects all orders within a status area and transfers them as an OrderXML document
to ALCIM Capacity Planning. The type of the OrderXML documents is ‚planning’. Explicit release for
production must be made separately. The production status in BW_LOCK_KAPA is raised to
‘transfer’.
Formula – see
\\jupiter\ALFAK_Install\Versions\4.4.xxx\Formula\ Workflow_TransferToCapacityPlanning.txt

Or in the local ALFAK installation directory ‘formula’.
Workflow – Production transfer and release for production
This formula selects all orders within a status area and transfers them as an OrderXML document
to ALCIM. The type of the OrderXML documents is ‚order’ so that the order is released for
production at once. The production status in BW_LOCK_KAPA is raised to ‘release for production'.
Formula – see
\\jupiter\ALFAK_Install\Versions\4.4.xxx\Formula\ Workflow_TransferToProduction.txt

Or in the local ALFAK installation directory ‘formula’.
Workflow – updating the BW_LOCK_KAPA status for an order
This formula sets the order status in table BW_LOCK_KAPA. This status reflects the order’s current
state in ALCIM.
Valid entries are:
                                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL



 Nummer         Constant                              Description
 (number)
 0              KAPA_NEW_ENTRY                        New document or amended document
 1              KAPA_TRANSFERRED                      Transfer to ALCIM complete
 2              KAPA_IMPORTED                         Document imported into ALCIM without error
 5              KAPA_IMPORT_ERROR                     Document imported into ALCIM with error
 10             KAPA_READY_FOR_RELEASE                Document can be released for production
 11             KAPA_RELEASE_SEND                     Release to ALCIM complete
 12             KAPA_RELEASE_FOR_PRODUCTION           Document has been released for production
Formula – see
\\jupiter\ALFAK_Install\Versions\4.4.xxx\Formula\ Workflow_UpdateKapaLock.txt

Or in the local ALFAK installation directory ‘formula’.
Workflow – reducing the order status after a scheduling error in ALCIM Capacity Planning


                                                                                                     526
This formula reduces the order status if an error has occurred during scheduling in ALCIM Capcity
Planning so that the order status was reduced to the user status of status point 39 „Scheduling
error“.
Formula – see
\\jupiter\ALFAK_Install\Versions\4.4.xxx\Formula\ Workflow_StatusUpdateAfterPlanningError.txt

Or in the local ALFAK installation directory ‘formula’.
Interfaces – goFX – transfer of order data of EDI documents to XML file
This formula exports all entries in table FS_TRANSFER as an XML file to the goFX interface of glas
online.
The entries in FS_TRANSFER are made by triggers monitoring the status and delivery date changes,
and the deletion of EDI orders.
Formula – see
\\jupiter\ALFAK_Install\Versions\4.4.xxx\Formula\ Interface_goFX_FileOutput.txt

Trigger – see
\\jupiter\ALFAK_Install\Versions\4.4.xxx\Formula\ Interface_goFX_Trigger_SqlBase.sql

Or in the local ALFAK installation directory ‘formula’.


To use this function, install the triggers and enter the formula as a work-flow task in the AIS, then
adapt the status mapping of the ALFAK status to the goFX status – customised – in formula
Interface_goFX_FileOutput.txt.


Example for status mapping:


                                              ! Set the status of the order in the output file;



                                                                           IF g_nUdv[2] < 400;
                                                                                            Set g_sUdv[6] =
'imported';
                                     ENDIF;
                                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




                                     IF g_nUdv[2] >= 400 AND g_nUdv[2] < 540;
                                               Set g_sUdv[6] = 'processing';
                                     ENDIF;
                                     IF g_nUdv[2] >= 540 AND g_nUdv[2] < 590;
                                                                                            Set g_sUdv[6] =
'packed';
                                     ENDIF;
                                                                           IF g_nUdv[2] >= 590;



                                                                                                              527
                                                                                    Set g_sUdv[6] =
'delivered';
                                 ENDIF;
                                                                   IF g_nUdv[2] = 852;
                                                                                    Set g_sUdv[6] =
'revoked';
                                 ENDIF;


In this example, all EDI orders with a status below 400 will be set to goFX status ‚imported‘, all EDI
orders of status 400 to 539 to ‚processing‘, all EDI orders of status 540 to 589 to ‚packed‘, and all
EDI orders of status 590 and above to ‚delivered‘. ALFAK status 852 is mapped to goFx status
‚revoked‘.
Credit limit snapshots
The credit limit snapshot allows to analyse the development of certain financial data for a customer
within a defined period.
The system will analyze the credit limit 1, credit limit 2, receivables, liability, balance 1, balance 2,
and the 4 orders on hand.
The orders on hand are
1. Undelivered orders
2. Orders shipped but not yet invoiced
3. invoiced orders which have not been transferred to financial accounting
4. Totals of 1-3
Credit limit snapshots can be viewed and printed in dialog Master data - Customer – Credit limit
analysis and directly at customer management, tab Balance.
Snapshots are created by a daily workflow task run by the ALFAK Interface Service, which analyses
the financial data.
For details on workflow tasks in AIS, see chapter Workflow in this document.
Installation:
First, define a formula in formula management for creating the financial snapshots (Master data >
Company > Formulas). An example formula can be found in the formula directory of the ALFAK
                                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL




installation „Workflow_TransferCreditLimit.txt“.




                                                                                                      528
Fig. 220: Finance snapshot formula

This formula is allocated to a workflow task in customizing management (Master data > Company
> Customizing > tab Workflow Tasks)




                                                                                                A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 221: Finance snapshot Workflow

on tab Automatic process execution, data for the ALFAK Interface Service are added.




                                                                                          529
Fig. 222: Finance snapshot activation

If the VB script is loaded several times a day, the snapshots of the corresponding day will be deleted
before a new one is created.




Printout of documents via the reporting service via workflow task
The following example selects all documents of the main database whose status is in a specified
range and inserts them into a new number manager. This number manager is then transferred to
the reporting service with the function udf_PrintNumberManager() and sent there via mail.
The example is also found in the file workflow_print_documents.txt in the folder of the
ExchangeService formulas (e.g. C:\Program Files (x86)\A+W\Business 6\Formula\ExchangeService).
The formula contains a section for assigning the variables that must be adjusted depending on
application case. In the end, the formula is attached and activated as workflow formula.
! This formula is selecting all orders that are in between the defined stauts, put them into
a new number manager and send that number manager to the reporting service for print an order
confirmation;

! Used variables;
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL


! g_nUdv[0] : Fetch result;
! g_nUdv[1] : Document no.;
! g_nUdv[2] : Number of documents to be printed;
! g_nUdv[3] : Document type (nMODE_AUFTRAG, nMODE_BESTELLUNG, nMODE_GUTSCHRIFT,..);
! g_nUdv[4] : Form ID (see form management in basic data);
! g_nUdv[5] : Lower bound of the status for selectiong the documents;
! g_nUdv[6] : Upper bound of the status for selectiong the documents;
! g_bUdv[0] : Boolean for result of every function call;
! g_sqlUdv[0] : Sql Handle to the main database;
! g_sUdv[0] : Name of the number manager;
! g_sUdv[1] : Name of the user for the number manager;

! ===============================================================================;
! Initialization section. Variables can be changed;
! ===============================================================================;

! Name of the number manager;
Set g_sUdv[0] = 'Rep_' || SalFmtFormatDateTime ( SalDateCurrent ( ), 'yyyyMMddhhhhmmss' );




                                                                                                  530
! Username used for number manager and printing;
Set g_sUdv[1] = 'Administrator';

! Document type of the documents;
Set g_nUdv[3] = nMODE_AUFTRAG;

! Form ID, see form management to find the proper value. This has to be changed for every
database;
Set g_nUdv[4] = 10049;

! Select documents with a status between the both following values g_nUdv[5] and g_nUdv[6];
Set g_nUdv[5] = 8;
Set g_nUdv[6] = 8;

! ===============================================================================;
! End of Initialization section;
! ===============================================================================;

! Database connection;
Set g_bUdv[0] = DbMakeTempConnect ( g_sqlUdv[0] );

! Selection of orders that should be printed by status ordered by entry date;
If g_bUdv[0];
       Set g_bUdv[0] = SqlPrepareAndExecute ( g_sqlUdv[0], DbParse ( 'SELECT ID FROM
SYSADM.BW_AUFTR_KOPF WHERE STATUS BETWEEN :g_nUdv[5] AND :g_nUdv[6] INTO :g_nUdv[1] ORDER BY
DATUM_ERF' ) );
EndIf;

! And put them into a new number manager;
Set g_nUdv[2] = 0;
If g_bUdv[0];
       While g_bUdv[0] AND SqlFetchNext ( g_sqlUdv[0], g_nUdv[0] );
               Set g_bUdv[0] = udf_AddDocumentToNumberManager (             g_sUdv[0],   g_sUdv[1],
g_nUdv[1], nMODE_AUFTRAG );
               Set g_nUdv[2] = g_nUdv[2] + 1;
       Wend;
EndIf;

! Now send the numbermanager to the reporting service for printout the order confirmation;
! Parameters are:;
! -    name of number manager;
! -    name of user for that number manager;
! -    document type;
! -    ID of the form that should be used (see form management dialog);
! -    output type (0=printer,1=mail);
! -    output device (name of printer or empty if using mail);
! -    archive year (empty if main DB);
! -    number range mode (0=preset of client and order area,1=order area and client from
document,2=client from document and preset of order area);
! -    client ID;
! -    order area;
! -    date (if empty, current date is used);
! -    label mode (0=per unit, 1=per line item, 2=per order, 3=use setting from document);
! -    number of copies;
! -    collective printout flag (TRUE=yes, FALSE=no);
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL


If g_bUdv[0] AND g_nUdv[2] > 0;
       Set g_bUdv[0] = udf_PrintNumberManager ( g_sUdv[0], g_sUdv[1], g_nUdv[3], g_nUdv[4],
1, '', '', 1, 1, '', DATETIME_Null, 0, 1, FALSE );
EndIf;
! Send a short message to the workflow monitor;
If g_bUdv[0] AND g_nUdv[2] > 0;
       COMMessageBox ( 0, 'Numbermanager ' || g_sUdv[0] || ' successfully transferred for
printout.', 'Exchange service', MB_Ok | MB_IconInformation, IDOK );
EndIf;
If g_bUdv[0] = FALSE;
       COMMessageBoxError ( 0, 'Error transferring numbermanager ' || g_sUdv[0] || ' for
printout. See trace for more info.', MB_Ok, IDOK );
EndIf;
! Disconnect database handle;
If g_sqlUdv[0];
                      DbDisconnect( g_sqlUdv[0] );
EndIf;

Transfer of OrderXMLs via the import service via workflow task (fileless)

                                                                                                531
The following example deletes all OrderXMLs that are older than the number of storage days. After
that, all OrderXMLs that were not flawed were sent to production by the import service. The
function udf_TransferOrderXmlToProduction() specifies with the g_sUdv[0] parameter a string with
information messages that are then traced. The string can also be sent to an e-mail sending udf
function.
The example is also found in the file workflow_transferorderxmltoproduction.txt in the folder of
the formulas (e.g. C:\Program Files (x86)\A+W\Business 6\Formula\).
For start-up, the formula must be attached as workflow formula and activated.


!
******************************************************************************************;
! ** Transfer all ready OrderXMLs to production.                          **;
! ** Delete the OrderXMLs that are older than the retention time beforehand.     **;
!
******************************************************************************************;

! Used Variables;

! g_sUdv[0] = Transfer messages;

! Used functions;

! udf_CleanUpOrderXmlTable( );
! Cleans up the BW_ORDERXML Table by removing OrderXMLs that are older than the retention
time;

! udf_TransferOrderXmlToProduction( Boolean, Receive String );
! Transfers all Ready OrderXMLs to Production;
! Parameters: udf_TransferOrderXmlToProduction( Retry failed OrderXMLs, Transfer messages
);
! Example: udf_TransferOrderXmlToProduction( FALSE, g_sUdv[0]);
! If the tranfer to production ( without retrying failed OrderXMLs ) was successful variable
g_sUdv[0] holds the Info messages, otherwhise variable g_sUdv[0] holds the Error messages;

!
*******************************************************************************************
******;

! Clean up OrderXMLs;
udf_CleanUpOrderXmlTable();

! Transfer OrderXMLs to Production (AWP);
IF udf_TransferOrderXmlToProduction( FALSE, g_sUdv[0] );
       TRACE ( 'Tranfer to Production Informations: ' || g_sUdv[0] , EVENT_INFORMATION ,
TRACE_CUSTOMIZING);
ENDIF;


Transfer of the breaks from the Logistic Service via workflow task
                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




The following example collects all breakage reports from the Commercial Logistic Service that have
not yet been sent to A+W Business 6. After that, all breakage reports that were not incorrect are
created as complaints. The function udf_RetreiveBreakages() specifies with the g_lsUdv[0]
parameter a string with information messages that are then traced. The string can also be sent to
an e-mail sending udf function.

The example is also found in the file workflow_check_logistics_breakages.txt in the folder of the
formulas (e.g. C:\Program Files (x86)\A+W\Business 6\Formula\).
For start-up, the formula must be attached as workflow formula and activated.
! *****************************************************************;
! ** Retrieve all breakages from Logistic Service ********;
! *****************************************************************;



                                                                                              532
! Used Variables;
! g_bUdv[0] = Return value from udf_RetreiveBreakages;
! g_sUdv[3] = Message for result mail;
! g_lsUdv[0] = Receive parameter for all messages that the export creates;

! *****************************************************;
! Start of the transfer process;
! *****************************************************;

Set g_lsUdv[0] = '';
Set g_bUdv[0] = udf_RetreiveBreakages( g_lsUdv[0] );

If g_bUdv[0];
       Set g_sUdv[3] = 'Retrieved all breakages from Logistic Service';
       EndIf;
If NOT g_bUdv[0];
       Set g_sUdv[3] = 'Breakage retrieve from Logistic Service failed';
       EndIf;

! Put the result into a TRACE file if configured.;
TRACE ( g_sUdv[3], EVENT_INFORMATION, TRACE_CUSTOMIZING );
TRACE ( g_lsUdv[0], EVENT_INFORMATION, TRACE_CUSTOMIZING );

! Send the result of the transfer process via mail;
! udf_SendMail ( '<MAILSERVER>', '<AUTH_USER>', '<AUTH_PASS>','<FROM>', '<TO>', '<CC>',
g_sUdv[3], g_lsUdv[0], '' );




                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                    533
10.30.         User-defined column in number manager

Simple allocation
In the screen table of the number manager, there is a column "csCustomeText" in which you can
fill any data via customizing. It is a column of the type "string" and behaves accordingly for the
sorting with a double-click on the column header. To assign this column to data, it is necessary to
create a customizing formula with an appropriate assignment and to assign this formula to the
"Load data record" element via the context menu of the table.




Set g_sUdv[0] = 'Hello world';
Set tbl_NV.csCustomText = g_sUdv[0];


Thus, the text "Hello world" appears in the "csCustomText" column of the number manager.
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Assignment of data from database
If, however, the desired data has to be procured via SQL statement from the database, this method
alone does not perform well enough. It is possible to extend the actual statement that uses the
number manager for filling with individual columns. Thus it is not necessary with each loading of a
data record to make a connection to the database. There are two string variables for this:
"tbl_NV.w_sSubSelect" and "tbl_NV.w_sSubInto." These should be populated via customizing
formula when generating the number manager with the SELECT columns and the Into variables.
The number manager uses these columns to select as soon as they are filled. It must be noted that
the columns used, insofar as they come from the document header, should be named with the alias
"B."


                                                                                               534
Here is an example for the reading of the net amount:


Set tbl_NV.w_sSubSelect = ', B.FI_BETR_NETTO';
Set tbl_NV.w_sSubInto = ', :g_sUdv[0]';
SalTblSetColumnTitle ( tbl_NV.csCustomText, 'Netto Betrag' );


This formula has to be assigned to the Customizing - Event "Set window" of the number manager:




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




After that, only the formula from 10.30.1 has to be assigned the table even "data record loaded."
And as even, you thus have the net amount of the order in the "csCustomText" column of the
number manager.

Assignment of data from database with Sub-SELECT
Another possibility is to select data from another table and link it to the data from the current
document. Thus, for example, it is possible to select data that is not included in the document from
the customer master data after the fact.
In the following two formulas, the credit limit is selected from the customer master data after the
fact with 2 places after the decimal point:



                                                                                                535
Set tbl_NV.w_sSubSelect = ', cast ((SELECT KREDIT_LIMIT1 FROM
SYSADM.KU_KUNDEN WHERE ID = B.AH_IDENT) as decimal (30,2))';

Set tbl_NV.w_sSubInto = ', :g_sUdv[0]';

SalTblSetColumnTitle ( tbl_NV.csCustomText, 'Kreditlimit' );


The formula for the table event "data record loaded" can thus remain unchanged:


Set tbl_NV.csCustomText = g_sUdv[0];




                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                  536
10.31.          Creating a product description from BOM
With the customizing expansion point 30, it is possible to attach a formula that creates the product
designation according to your own rules.




Here, the function udf_ProdDescByBOMNode( nBOM_ID, sDelimiter, bShortDescription) creates
the product description from the BOM; it can be determined whether the description should be
taken from the short descriptions and how the separator should be set.
The formula "..\Formula\description_IG+LamiDesc2byShortDescription.txt“ creates a sample
implementation; here the BOM is composed in the product description 2 and the separator is a "/".
The short description is used and not the BOM description. The formula runs in the context of the
item class; access to the header structures is not possible.




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                537
10.32.               iTOE rules
The iTOE rule editor allows you to store a formula as condition. The condition is TRUE if this formula
sets the variable bReturn = TRUE.
Access to the order is gained via fktDoc, so the customer number can be queried via
fktDoc.m_nAH_IDENT.
The current item can be accessed via fktPos.
The processings are not yet created; that's why no access to them is possible.
In order to access the processing found from iTOE/DXF, the object fktSNBearb must be used that
belongs to the class cfktSNProcessing.


  cfktSNProcessing

  Description: Class with all properties of a processing from SN
  Instance Variables
             Number: m_nAWID                                       ! The AW-ID of the processing
             Number: m_nSN_BEA_PARAM[30]                           ! The SN processing parameters
             String: m_sCornerVector                               ! The corner vector
             String: m_sEdgeVector                                 ! The edge vector
             String: m_sLayerNumber                                ! The layer
             Number: m_nLevel                                      ! The level
             Number: m_nMeasureType                                ! The measurement type
             Number: m_nInnerReferenceCorner                       ! The reference corner for interior cut-outs
             Number: m_nRotationReferenceEdge                       ! The angle of rotation
             Number: m_nEdgeQuality                                ! Edge quality from AWB !!!
             String: m_sMacroName                                  ! Macro name
             Number: m_nProcessingMode                             !

             Function: udf_GetParamText
             Description: Get all parameter from CAD.
                                    Returns: Parameter String
             Returns String:



The A+W processing type dialog defines the AWID and which parameters are transferred. These are
in the array m_nSN_BEA_PARAM.
To output the parameters during the formula development, you can use the function:
fktSNBearb.udf_GetParamText()
. It returns all parameter values as string.
                                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Sample formulas are found in Formula/iTOE




                                                                                                                  538
539
A+W Software GmbH - Configuration A+W Business - INTERNAL
11.Workflow
11.1. Introduction
The workflow is used for the mainly automatic processing of orders, from input up to production
release in ALCIM. All following steps (receipt of goods, printing of shipping notes, transfer to
financial accounting, …) will still be performed by hand, by the user.
The work-flow application tool is the ALFAK Interface Service (AIS) which can run the individual
tasks either periodically (e.g. production transfer) or at a fixed time (e.g. transfer to statistics).
You have to assign to the tasks the property cyclic or fixed time in Customizing management, tab
Automatic process execution. Process execution with the property cyclic or fixed time.
    •   In customzing management, periodical work-flow tasks (e.g. report tasks) are now entered
        and displayed acc. to the 00:00 pattern, but with execution type "00-cyclic".
    •   Example: the cyclic execution time of 00:30 defines that the work-flow task is run every 30
        minutes
    •   Example: the cyclic execution time of 02:00 defines that the work-flow task is run every 2
        hours
The tasks to be performed by AIS can be defined individually in the workflow management of ALFAK
Customizing, depending on the company’s processes.
After all, every workflow task consists of several customizing formulas which gives the engineer a
maximum of freedom when defining the workflows.
The following examples refer to the initial installation at SOTRAVER, France.
The following graphs shall illustrate the order processing procedure.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  540
                                                            11.2. Schematic display




541
A+W Software GmbH - Configuration A+W Business - INTERNAL
Fig. 223: Workflow - Procedure up to the release of production




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 224: Workflow – Procedure after release for production

First you need to analyse which tasks can be automatically performed via workflow. For every task,
a workflow task has to be defined which again is based on a customising formula. The customizing
reference in this document describes how formulas should be defined and programmed.



                                                                                              542
11.3. Transfer to ALCIM Capacity Planning
Newly entered orders are transferred by means of the first task Workflow Task Transfer To Capacity
Planning to ALCIM Capacity Planning. These orders are planned, but not scheduled as jobs; no rough
or detailed planning is made. After transfer, orders will get the user status of status point 980
Transfer to Capacity Planning.


11.4. Report status from ALCIM Capacity Planning
As a planning result, ALCIM Capacity Planning sets the status of the planned orders to the user
status of status point 38 Scheduled in TM or, in case of an error, to 39 Error during automatic
scheduling.


11.5. Printout after ALCIM Capacity Planning
After successful scheduling in ALCIM Capacity Planning, order can be printed, emailed, and/or
faxed. The task Workflow Task After Scheduling adds a print job to the user’s diary. Additionally,
the order can be assigned to a certain number manager.
If the user double-clicks on a printjob while in module Documents, the print module will be directly
started on the number manager defined in the formula.


11.6. Status reduction due to an error in ALCIM Capacity Planning
Scheduling errors may necessitate a reduction of the order status so that the following processes
can be performed without manual status changes (e.g. order is set to status 39 after a scheduling
error while the lock status for order confirmation printing is 21).
The task Workflow Task Update Status After Planning Error resets the status of the orders where a
scheduling error occurred to the status required by the user.
 Orders will get the user status of the required status point


11.7. Check for ordered elements
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




When the order confirmation has been printed, the Task Workflow Task Transfer To Capacity
Planning checks all orders with status Print OC for ordered elements and assigns a new status.
The new status can be configured freely.
 Orders with ordered elements e.g. get the user status of status point 1029 Order includes
ordered elements.
 Orders without ordered elements e.g. get the user status of status point 35 Release for
production.




                                                                                                543
11.8. Release for production in ALFAK
So far, orders have been scheduled but not released for production yet. If the customer does raise
an objection within two hours after printing the order confirmation, it can be assumed that
production can be started. The condition for this release is not fixed but can be amended by means
of the formula on which the task is based.
The task Workflow Task Update Status to Release for Production sets the status of the orders of
status Print OC which have been printed more than two hours ago, to the user status of status point
35 Release for production.
 Orders will get the user status of status point 35


11.9. Release for production in ALCIM
When the order has got the status 'Released for production', it can be released for production in
ALCIM. The task Workflow Task Release for Production in ALCIM sets the status of the orders of
status Release for production to the user status of status point 40 Transfer to AWPool. The reason
is that a standard release for production contains an implicit release for production, and the order
meets this status after the usual transfer. Moreover, the PPS web service is contacted; ALCIM is
informed that the order can be produced.
 Orders will get the user status of status point 40


11.10.            Management
Formulas
All necessary formulas (9000–9006) are managed by module Formulas in ALFAK master data.




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 225: Administration - Formula example

All formulas and settings for the workflow are saved in the databases DEMO44 and ALF on the
database server SPEEDY.


                                                                                                544
Additionally, all formulaas are part of an ALFAK installation (as text files) in sub-directory Formula
or are available in Additionally, all formulaas are part of an ALFAK installation (as text files) in sub-
directory Formula or are available in
\\Jupiter\ALFAK_Install\Versions\4.4.xxx\Formula einsehbar.




11.11.             Workflow Tasks
Formulas are allocated to tasks. A task is a process step that can be periodically run by AIS.




Fig. 226: Workflow tasks - Example

Automatic setting of tasks
All tasks get settings regarding their sequence and cycle time. The sequence defines the sequence
in which AIS performs these tasks. The cycle time defines the interval – in minutes – in which the
task will be performed.
                                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                     545
Fig. 227: Workflow Tasks – Automatic setting




11.12.            Report from ALCIM Capacity Planning
ALCIM Capacity Planning returns the following information to ALFAK:
   1. Time costs
   2. Production date on item and BOM level
Based on the production date, ALFAK checks if all stock articles required for this order are available
and, if not, whether they can be ordered and delivered on time.
A shortage on stock results in a task for the user ( postponement of shipping date).
The production dates determined by ALCIM Capacity Planning are adopted in the order for items
and BOM.
The actions to be performed during the ALCIM Capacity Planning report can be individually defined
in CommonBase.
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  546
Fig. 228: User-defined CommonBase settings


11.13.           Change of order after release for production
An order can be changed even after it has been released for production, by means of menu
„Functions  Change locked item“. If in order entry the delivery data is moved to the past, the
system attempts to cancel it in the production system.
The PPS web service is contacted; the system tries to cancel the order to be produced (orders can
be cancelled in ALCIM until the job has been created).
If cancellation has been successful, the order can be changed.
If the order could not be cancelled, the user will be asked whether he still wants to change the
order.
Changing the locked item will set the order status to the user status of status point 810 Transfer to
AWPool cancelled.
The changed order now goes through the cycle again, starting from the transfer to ALCIM Capacity
Planning.



                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 547
                                                            Fig. 229: Change the blocked position




548
A+W Software GmbH - Configuration A+W Business - INTERNAL
Thee following chart clarifies the order status during production transfer and cancellation:


                                              Order can be change (newly entered
                                                     or already cancelled)



                                                       Transfer to production


                                                           Order locked



                                                 •       Change locked item

                                                 •       Enter new item

                                                 •       Delivery date in the past



                                                         Request whether
                                                       cancellation should be        User selects cancel, order
                User selects no, order is            performed (for a locked         will not be saved.
                saved                                item change always yes)




                                                        User selects yes


                                                                                           Status is not in the
                                                      Check status point 810
                                                                                           valid range


                                                       Status is in the valid
                                                       range




                                                     Call cancellation in PPS               Cancellation successful.
                                                                                            Set status point 810




                                                     Cancellation not possible                                               A+W Software GmbH - Configuration A+W Business - INTERNAL




               No,         changes                        Save anyway?
               rejected




            Yes, leads to inconsistent data




                                                                                                                       549
11.14.             Automatic transfer to production
In connection with the workflow, automatic transfer to production via AIS is unnecessary because
this is done by a workflow task.


11.15.             Notifying the Service Monitor
With every formula – these are the core of every Workflow task – a notification can be sent to the
Service Monitor to visualise to the user the actions of the workflow and possibly occurring errors.
The function udf_EventToServiceMonitor can be used for this in the formulas.


11.16.             EDI orders
For EDI orders, order confirmations do not have to be printed. This is why EDI orders can be
exempted from selection for the print job.


11.17.             Notification at order entry
As soon as new tasks – created by a report from ALCIM Capacity Planning – are added to the user’s
task list, the message 'You have got new messages' will appear in the status bar at order entry/print
program.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 230: Order entry, tab Totals




                                                                                                 550
 11.18.  Managing the production status in table
    BW_LOCK_KAPA
 The table BW_LOCK_KAPA contains the field STATUS. It depicts the order status with regard to
 production. The field can show the following entries:

  Value        Meaning
  0            New order entered, or structural changes         Order entry
  1            Transfer      to      production/planning        Transfer to ALCIM/ALCIM Capacity
               completed                                        Planning
  2            Order imported in ALCIM Capacity                 Manual via workflow*
               Planning
  5            Planning or report error in ALCIM Capacity       Manual via workflow*
               Planning
  10           Order ready for production release in            Manual via workflow*
               ALCIM
  11           Production release sent to ALCIM                 Manual via workflow*
  12           Released for production in ALCIM                 Workflow Release for Production
                                                                in ALCIM
 *)
Tab. 50: Managing the production status in table BW_LOCK_KAPA
                                                                                      *) To
 change the status manually in table BW_LOCK_KAPA, the function udf_UpdateKapaStatus can be
 used in a formula.


 11.19.           Structural order changes
 Changes of the shipping or production date, all structural changes of an item (e.g. width or height,
 supply type,..), and all changes of the BOM (shape, processing steps, …) result in the setting of the
 order status in the corresponding BW_LOCK_KAPA record to 0 so that it can be transferred again
 to ALCIM Capacity Planning.
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




 Price changes do not result in an update of the production state in BW_LOCK_KAPA.


 11.20.           Availability on stock
 Together with the report from ALCIM Capacity Planning, availability of the articles on stock will be
 checked.
 In case of a shortage of stock, a task will be entered for the user.




                                                                                                   551
Fig. 231: Stock availability

The user can double-click on the task to go directly to the order and check the stock availability.


11.21.    Automatic transfer to statistics, archives, or document
   deletion
Automatic transfer (to statistics, archives, document deletion) and the archiving of the system log
book via VisualBasic script/batch file (auto_eoday.vbs, auto_eoday.bat) are no longer supported;
this has been replaced by two work-flow tasks in ALFAK Interface Service (AIS).
Start-up of the work-flow tasks:
     •    Update ALFAK Interface Service 2009
     •    Update the COM objects abcreceive44.exe and abcprocess44.exe
     •    Update abcstamm.exe
     •    Update the message file germes.txt (or the appropriate message file)


All of the above elements have to date from 27.11.2009 or later.
Automatic transfer to statistics and archives:
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Define a formula for autoamtic transfer in formula management
     •    Example formula: Database DEMO44 or ALF (formula number 9008)
     •    Example formula: local ALFAK installation in sub-directory Formula (file
          Workflow_AutomaticTransfer_EndOfDay.txt).
     •    The example formula will perform the transfer for all document types. By deleting the
          corresponding lines, the formula can be restricted to certain document types (e.g. only
          quotations).
     •    Define the work-flow task by allocating the new formula in Customizing management, tab
          3 Work-flow Tasks




                                                                                                  552
Fig. 232: Workflow allocate task to the new formulas


    •    Define the AIS settings in Customizing management, tab 4 Automatic process execution.
         Enter a fixed time (e.g. 20:00 for 20:00 h) as an interval/time, and set the execution to "1-
         fixed time". With these settings, AIS will execute this task daily at 20:00 h.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                   553
Fig. 233: Interval for workflow task

    •    Restart AIS
    •    Reports from the transfer are no longer recorded in text files but are shown on the service
         monitor
    •    For a further client (in the same or a different database) add a second section to the AIS
         configuration. For a second client in the same database, please make sure to limit the ALFAK
         user to the second client.

                 Increase the setting „BatchUsers“ to „2“:
                       <add key="BatchUsers" value="2" />
                 Insert and configure the block „Setting2“ for second client analogous to „Setting1“:
                       <add key="Setting2/DatabaseName" value="demo44" />
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                       <add key="Setting2/DatabaseType" value="2" />
                       <add key="Setting2/DatabaseServer" value="" />
                       <add key="Setting2/ALFAKUser" value="sysadm2" />
                       <add key="Setting2/ALFAKPassword" value="c3lzYWRt" />
                       <add key="Setting2/InstanceName" value="sysadm2" />
                       <add key="Setting2/IniFile" value="C:\ProgramData\A+W\ALFAK
                          2009\abcstart.ini" />




                                                                                                   554
Archiving and deletion of the system logbook:

for customers who do not do automatic transfers but still want to archive and delete the system
logbook
    •   Example formula: Database DEMO44 or ALF (formula number 9009)
    •   Example formula: local ALFAK installation in sub-directory                  Formula     (file
        Workflow_ArchiveSystemLogbook.txt).
    •   Set up like the automatic transfer described above


Separate deletion of statistics, order info, commission statistics, stock logbook, time management,
rack history, EDI back-up files, credit limit snapshots, and history orders:
The deletion of the above-mentioned data is done after the storage days specified in the company
mastesr data during the automatic statistic and archive transfer. However, the functionality is also
available separately and can be started in an individual workflow task with the function
"udf_ClearStatistics." An example is available in the formula "Workflow_ClearStatistics.txt."


11.22.          Constants and functions used

                Constants
1. Task/date types
TASK_ Standard          Standard date
TASK_OrderEntry         Date for calling the order entry
TASK_AWCapacity                 Date as per capacity planning
TASK_DokumentsToPrint           Task type printout
TASK_DokumentsToFax             Task type fax
TASK_DokumentsToMail            Task type email


2. Document types
nMODE_ANGEBOT                   Quotation
nMODE_AUFTRAG                   Order
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL



nMODE_GUTSCHRIFT                Credit note
nMODE_BESTELLUNG                Purchase orders
nMODE_BESTELLANFRAGE            Enquiry


3. Report types to ALFAK service monitor
EV_ERROR                        Error report
EV_HINT                                   Note
EV_WARNING                      Warning
EV_RESULT                       Result


                                                                                                 555
4. Production status (saved in BW_LOCK_KAPA)
KAPA_NEW_ENTRY                   Document entered/changed
KAPA_TRANSFERRED                 Document transferred to ALCIM
KAPA_IMPORTED                    Document imported in to ALCIM
KAPA_IMPORT_ERROR Document import caused an error
KAPA_READY_FOR_RELEASE Document ready for production release
KAPA_RELEASE_SEND                Production release dispatched
KAPA_RELEASE_FOR_PRODUCTION Document released for production

                Functions
1. Adding a task/date
udf_addTaskForUser(Task text, Task type, Document Number, Document Type, Employee, Number
              manager name, Task time)
The function enters a date/task in the transferred ALFAK user’s task list.
Return:
TRUE if the date could be entered or did already exist; otherwise FALSE
Important: the task/date will be created only if there had been no task/date existing for the
transferred combination of user, task type, and reference.
If DATETIME_Null is transferred as expiry time in parameter "Task time", the expiry time will be set
to the present date + 1 day.
Reference of the task/date (parameter „Reference“) may be the name of a number manager for
example. If the parameter „Reference“ is left blank, the document number will be entered in the
reference field of the task/date.


Order entry only:
If the task type is TASK_DocumentToPrint, TASK_DocumentToFax or TASK_DocumentToMail and a
number manager has been transferred as a reference, a double-click on the date/task will call the
print program and the number manager
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL



If the task tye is TASK_AWCapacity and a document has been transferred as a reference or
document number, double-clicking on the date/task will open order entry on this document and
the transferred document type.
Examples for task times:
two hours ahead: SalDateCurrent() + (1/24)*2 (1/24 is 1 hour)
one day ahead: SalDateCurrent() + 1


The user’s task list only shows tasks/dates that do not lie in the past.


Parameter:

                                                                                                556
Task text                     Text of the task/date for the user
Task type                     Task/date type (see constants TASK_XXX)
Document number               Number of a document
Document type           Document type (see constants nMODE_XXX)
Employee                      Name of an ALFAK user
Reference                     Reference info (e.g. name of the number manager)
Task time                     Expiry of the date/task




Example:
The user Administrator is allocated a task/date informing him that there are orders to be printed.
The date expires in two hours’ time. A double-click on the date opens the print program and the
number manager ‚Print‘.
udf_addTaskForUser(‘Orders to be printed, TASK_DokumentsToPrint, 0, nMODE_AUFTRAG,
‘Administrator‘, ‘Print‘, SalDateCurrent() + (1/24)*2)
The user Administrator receives a task/date informing him that he should check the delivery date
of order 1000. The date expires in a day’s time. A double-click on the date opens the order entry on
order 1000.
udf_addTaskForUser(‘Please check delivery date’, TASK_AWCapacity, 1000, nMODE_AUFTRAG,
‘Administrator‘, ‘‘, SalDateCurrent() + 1)

2. Event to ALFAK service monitor
udf_EventToServiceMonitor(Event type, Event message)
This function sends a message to the service monitor which appears on the service monitor’s
message list.


Parameter:
Event type                      Event type (see constants)
Event message           Event text

Example:
udf_EventToServiceMonitor(EV_HINT, ‘Document 1000 ready for OC‘)                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




3. Adding a document to a number manager
udf_AddDocumentToNumberManager(Number manager name, Employee, Document number,
Document type)
 The document will not be transferred to a number manager. The number manager will be created
if it does not exist already for the transferred user.


Parameter:
Number manager name             Number manager name
Employee                        Name of an ALFAK user
Document number                 Number of a document


                                                                                                557
Document type           Document type (see constants)

Example:
udf_AddDocumentToNumberManager(‘PRINT’, ‘Administrator’, 1000, nMODE_AUFTRAG)

4. Updating the task list in a program
udf_UpdateTasks(Program name)
This function updates the list of dates in a program.


Parameter:
Program name            Name eines Programms

Example:
udf_UpdateTasks(‘abcauftr.exe’)



5. Check for purchased elements
udf_CheckForPurchaseParts(Document status, Status point purchase parts, Status point no
purchase parts)
This function checks all orders of the transferred status for purchase elements and changes the
status to ‘purchase elements included’ or ‘no purchase elements’. The new status is defined by the
transferred status points.


Parameter:
Document status                 Status of the orders to be checked
Status point purchase parts     Status point for included purchase elements. The order will get the
                                allocated status if it contains purchase elements.
Status point no purch. parts    Status point for ‘no purchase elements’. The order will get the
                                allocated status if it does NOT contain purchase elements.

Example:
udf_CheckForPurchaseParts(21, 1029, 35)
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




6. Status increase
udf_StatusUpdate(Document number, Status point new)
This function raises the order status to the status of the transferred status point. The status will
NOT be lowered.


Parameter:
Document number                 Order number
Status point new                Status point for status increase



                                                                                                558
Example:
udf_StatusUpdate(1000, 35)
7. ALCIM transfer to production
udf_TransferToProduction(Document number, Document type)
This functions executes a production transfer to ALCIM for the transferred document.


Parameter:
Document number               Order number
Document type           Document type (see constants)

Example:
udf_TransferToProduction(1000, nMODE_AUFTRAG)
8. Production transfer to ALCIM Capacity Planning
udf_TransferToCapacityPlanning(Document number, Document type)
This functions executes a production transfer to ALCIM Capacity Planning for the transferred
document.


Parameter:
Document number               Order number
Document type           Document type (see constants)

Example:
udf_TransferToProduction(1000, nMODE_AUFTRAG)


9. Production release
udf_ReleaseForProduction(Document number, Status point new)
This function performs for the transferred document a production release in ALCIM via PPS
webservice and raises the status in ALFAK to the status of the transferred status point.          A+W Software GmbH - Configuration A+W Business - INTERNAL




Parameter:
Document number                Order number
Status point new               Status point for status increase

Example:
udf_ReleaseForProduction(1000, 40)

10. Update of production status in BW_LOCK_KAPA
udf_UpdateKapaStatus(Document number, Document type, Kapa status)
This function sets the status (production status in BW_LOCK_KAPA) for the transferred document.


                                                                                            559
Parameter:
Document number               Document number
Document type           Document type (see constants)
Kapa status                   Production status (see constants)

Example:
udf_UpdateKapaStatus(1000, nMODE_AUFTRAG, KAPA_NEW_ENTRY )

11. Reducing the order status after scheduling error in ALCIM Capacity Planning
udf_StatusUpdateAfterPlanningError (Document number, Status point new)
This function reduces the status of the transferred order to the user status of the transferred status
point if the current order status is lower/equals status 39 „Scheduling error“. This function should
be used to select all orders of status 39 then reduce their status.
Parameter:
Document number                 Document number
Status point new                Status point the user status of which this order shall get

Example:
udf_StatusUpdateAfterPlanningError (1000, 2 )

12. Checking and reading the status allocation
udf_ReadStatusPoint     (nStatusPoint,   Receive    nStatus,   Receive      nMindeststatus,   Receive
nSperrstatus)
Reads the status allocation for the status point.
If the status allocation can be read, the receive parameters
nStatus, nMinStatus and nSperrStatus will get the values allocated to this status point.

Parameter:
nStatusPoint            Status point to be read
nStatus                 Allocated status
nMindestStatus          Minimum status of the status allocation
nSperrStatus            Lock status of status allocation

Returns:
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




TRUE if the status allocation can be read and FALSE if it cannot be read.

Example:
udf_ReadStatzsPoint ( 35, nStatus, nMinStatus, nSperrStatus )




                                                                                                  560
12.Interfaces to Financial Accounting
12.1. Brilliant
General:
Transfer to BRILLIANT financial accounting system has been solved by customizing. The
documentation on the customizing of the transfer to financial accounting is found in this document,
in section Customizing (see 0).
Interface description
\\jupiter\DOKU_DocuWare\ALFAK2000\Interfaces\FINAC\User_Manuals\Brilliant

Settings:
      •   In accordance with financial accounting, external keys for
               o Tax
               o Payment Terms
      •   must be defined.
      •   In transfer to financial accounting, set the option "Customer account instead of customer
          number”.
      •   Four formulas have to be defined and allocated to program items:
  No.            Formula                                       Program item
  1              Financ_Brilliant_Start.txt                    300 – FinAcc transfer (start record)
  2              Financ_Brilliant_Head.txt                     301 – FinAcc transfer (invoice header
                                                               record)
  3              Financ_Brilliant_SalesAccount.txt             300 – FinAcc transfer (proceeds account
                                                               record)
  4              Financ_Brilliant_TaxAccount.txt               300 – FinAcc transfer (tax record)
The formulas number 1-4 are part of every ALFAK installation and are found in the Formula
directory.


12.2. Datev
General:
Export of customer master data to Datev can be customised to match the requirements of the
                                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL




corresponding financial accounting program. The documentation on the customizing of the transfer
to financial accounting is found in this document, in section Customizing (see 0).
Interface description
\\jupiter\DOKU_DocuWare\ALFAK2000\Interfaces\FINAC\User_Manuals\Datev

Settings:
      •   A formula has to be defined and allocated to a program item:
  No.            Formula                                       Program item
  1              Financ_DATEV_CustomerExport.txt               307 – FinAcc transfer (customer export:
                                                               customer record)



                                                                                                      561
The formula used, Financ_DATEV_CustomerExport.txt , is part of every ALFAK installation, to be
found in directory Formula.


12.3. Varial
General:
Transfer to financial accounting writes three files for transferring invoices, credit notes, and costs,
and another four files for account and address file for customers, and account and address file for
suppliers.
The target directories for the output files should be temporary directories. After transfer to financial
accounting, the batch defined in master data will be executed, copying the output files to the target-
and backup directory.
Interface description
\\jupiter\DOKU_DocuWare\ALFAK2000\Interfaces\FINAC\User_Manuals\Varial (Semco)

Settings:
    a) Company master data – tab FinAcc
          a. Export/Import: VARIAL 2.5
          b. Client: maximally three-digit company number of the customer in VARIAL financial
             accounting
          c. Document export: three path/file names, separated by semicolon
                 Example: C:\Temp\XXSEQINP;C:\FiBu\XXSEQINP;C:\Temp\XXSEK000
                 Path/file 1 for invoices
                 Path/file 2 for purchase orders
                 Path/file 3 for cost file
             d. Partner export: four paths, files names separated by semicolons:
                 Example: C:\Temp\XXSEQIPK;C:\Temp\XXSEQIKO
                 Path/file 1 for debtor account file
                 Path/file 2 for debtor address file
                 Path/file 3 for creditor account file
                 Path/file 4 for creditor address file
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL



             e. Batch file: Create batch file for copying the output files to the target directory
                backup directory (optional)
             f. Options ‚cost accounting active’ on
             g. Apart from the proceeds accounts, the cost centres of the proceeds accounts have
                to be maintained.
             h. Receivables report import: path and file name
                     i. Example:
                        The file includes four fields, Customer/Receivables amount/credit limit,
                        and insured credit limit, separated by semicolons
                        Example: (1000;14738;20000;25000)

    b) Settings: FinAcc transfer option s
           a. Override output file "off"

                                                                                                    562
            b. Customer transfer disabled "off"
            c. Customer account instead of customer number as required
            d. Transfer to cost accounting „on"




    c) The following external keys have to be maintained in ALFAK master data (to be agreed with
       financial accounting
           a. Payment terms (external key max. three-digit)
           b. Currencies (external key max. three-digit)
           c. Tax (external key max. three-digit)
           d. Field service (name max. 15)
           e. Titles (name max. four-digit)
           f. Counties/provinces (name max. three-digit)
           g. Languages (external key max. two-digit)
           h. Countries (name max. three-digit)
           i. Debtor/credit account for tax
Special features:
    •   for invoices for miscellaneous customers, master data transfer is always made based on the
        order data
    •   Invoice numbers of purchase orders are entered at invoice check as: invoice no. supplier #
        internal batch no. (e.g.: 123456#000001).
    •   Cost accounting records are issued only for invoices (positive amount) and credit notes,
        document type <n.e.> (negative amount). The cost unit is created from the profit account's
        cost centre in the following way:
        Cost centre = 4100102  Cost unit = 200410010
        The cost unit always has nine digits. The first digit is always the last digit of the profit
        account, followed by the rest of the profit account (filled up to eight digits to the left using
        zeros).
        2 + 00 + 410010
    •   Profit accounts are transferred without the last digit
    •   Record number + text of external record
            Invoice             Credit note       P.O. with invoice             P.O. w/o invoice no.
                                                  no.
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




Field17     Invoice no.       Invoice no.         Invoice no.                   Internal batch no.
Field49     RE“ + Invoice no. RE“ + Invoice no. + Invoice no. Invoice           Internal    batch  no.
            +    „/AU“      + „/AU“ + Document no.       +    „/“   +           Invoice no. + „/“ +
            Document no.      no.                 Matchcode supplier            Matchcode supplier

    •   Settlement document
            Invoice              Credit note         Purchase Order
 Field80    empty                Invoice         no. Invoice no. Lieferant (supplier)
                                 reference order
    •   Cost unit in profit account record



                                                                                                    563
             Invoice             Credit note      P.O. profit account          P.O.    other     profit
                                                  starts with 5                accounts
 Field55     2              2                     empty                        1
 Field56     Cost centre of Cost centre of profit empty                        Cost centre of profit
             profit account account w/o last                                   account w/o last digit
             w/o last digit digit



12.4. eGecko
General:
Transfer to financial accounting creates one file (or two files if invoices received have to be written
as well) for transferring invoices, credit notes, or costs, and another file for customer master data.
The target directories for the output files should be temporary directories.
Interface description
\\jupiter\DOKU_DocuWare\ALFAK2000\Interfaces\FINAC\User_Manuals\eGecko

Settings:
    a) Company master data – tab FinAcc
          a. Export/Import: CSS eGecko (GER)
          b. Client: max. four-digit company number of customer in Gecko financial accounting
          c. Booking area: Two booking codes must be entered, for orders and credit notes.
             These are read by the program, and saved in the appropriate places in the FinAcc
             transfer file.
          d. Document export: path and file name or, if required, another file name for invoices
             received, separated by semicolon (P.O.)
                 Example:
                        1) c:\temp\Fan\%d%M%y*buch-dat.xml
                           Or
                        2) c:\SNH\%d%M%y*AUS-dat.xml;c:\SNH\%d%M%y*EIN-dat.xml

            e. Partner export: path and file name
                 Example: c:\temp\Fan\adress*.xml
            f.   Receivables report import: path and file name
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




                 Example: c:\temp\Fan\salden.dat


    b) Settings: FinAcc transfer option s
           a. OEM conversion active
           b. Automatic sorting active (customer/invoice/order)

    c) The following external keys have to be maintained in ALFAK master data (to be agreed with
       financial accounting)
           a. Payment terms (external key max. three-digit)
           b. Languages (external key max. two-digit)
           c. Countries (name max. three-digit)


                                                                                                   564
              d. Titles (name max. four-digit)
Special features:
    •   Phone and fax number are included in the export of customer data. This is done
        automatically in connection with transfer to financial accounting based on a change of
        customer master data. In customer master data, the phone and fax number (area code and
        phone number) have to be entered separately. The separator is a minus sign but /, \ or a
        blank can be used as well.
    •   Booking area


  eGecko                  ALFAK
  buchungsschluessel      Booking area acc. to company master data
  210                     For orders/invoices (customer account)
  150                     For orders/invoices (profit account)
  250                     For credit notes (customer account)
  110                     For credit notes (profit account)

    •   Document no.


  eGecko                 ALFAK
  referenznr             Record number (invoice number) from the document header


    •   Booking text


  eGecko                 ALFAK
  buchungstext           Name of customer shown on the invoice


    •   Customer account


  eGecko                 ALFAK
  Acct. No.              Customer #

                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                             565
12.5. Customizing of the Transfer to Financial Accounting

Every record type written during transfer to financial accounting can be overridden by a formula,
i.e. the record structure and the contents of the record are defined by the formula (formula items
300 to 308). It is also possible to add information to an existing record, i.e. an existing format will
still be used, completed by a new field (formula items 309 to 316).
The formula transfers this record to the transfer to financial accounting which again transfers it to
the financial accounting file.
The customizing management offers on tab Programs 16 new customizing items.

            Customising items
Each of these items corresponds to the transfer of a record type, each item can be allocated a
separate formula:
 Point                                         Record type     Meaning
 300 – FinAcc transfer (start record)          Start record    This record is written once, when transfer is
                                                               started
 301 – FinAcc transfer (invoice header         Invoice header This record is written once per invoice in the
 record)
                                               record          number manager
 302 – FinAcc transfer (proceeds account       Proceeds        This record is written for every proceeds
 record)
                                               account record account of an invoice
 303 – FinAcc transfer (tax record)            Tax rate        This record is written once per invoice (VAT)
 304 – FinAcc transfer (end record)            End record      This record is written once, to complete the
                                                               transfer
 305 – FinAcc transfer (receivables report)    Report       on This formula is executed once for every
                                               receivables     imported receivables record
 306 - FinAcc transfer (customer export)       Start record    This record is written once, when transfer is
 start record)
                                                               started
 307 - FinAcc transfer (customer export)       Customer        This record is written for every customer
 customer record)
                                               record          exported
 308 - FinAcc transfer (customer export)       End record      This record is written once, to complete the
 End record)
                                                               transfer
 309 – FinAcc transfer (add to start record)   Start record    The return value of this formula is added to the
                                                               start record, or the record is directly changed
                                                               via UDF function
                                                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL



 310 – FinAcc transfer (add to invoice         Invoice header The return value of this formula is added to the
 header record)
                                               record          start record, or the record is directly changed
                                                               via UDF function
 311 – FinAcc transfer (add to proceeds        Proceeds        The return value of this formula is added to the
 account record)
                                               account record start record, or the record is directly changed
                                                               via UDF function
 312 – FinAcc transfer (add to proceeds        Tax rate        The return value of this formula is added to the
 account record)
                                                               start record, or the record is directly changed
                                                               via UDF function
 313 – FinAcc transfer (add to start record)   End record      The return value of this formula is added to the
                                                               start record, or the record is directly changed
                                                               via UDF function


                                                                                                          566
 314 - FinAcc transfer (customer export)   Start record   The return value of this formula is added to the
 add to start record)
                                                          start record, or the record is directly changed
                                                          via UDF function
 315 - FinAcc transfer (customer export)   Customer       The return value of this formula is added to the
 add to customer record)
                                           record         start record, or the record is directly changed
                                                          via UDF function
 315 - FinAcc transfer (customer export)   End record     The return value of this formula is added to the
 add to start record)
                                                          start record, or the record is directly changed
                                                          via UDF function
Tab. 51: Customizing- Points




                                                                                                             A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                     567
           Variables and functions used
 Invoice header
 w_nGrossAmount                          Gross invoice amount
 w_nGrossAmountFW                        Gross invoice amount in foreign currency
 w_nInvoiceNo                            Invoice number
 w_sInvoiceNo                            Alpha-numerical invoice number / column NR_RECHNUNG (tables
                                         BW_BEST_MAN / BW_BEST_AUFTR)
 w_dInvoiceDate                          Invoice date
 w_dDueDate                              Due date
 w_nCustomerAccount                      Customer #
 w_fktDoc                                Order category
 w_fktDKP                                Customer category
Tab. 52: Invoice header - Variables

 Proceeds account
 w_sSalesAccount                        Proceeds account
 w_nSalesAccountAmount                  Net amount of proceeds account
 w_sSalesAccountCostCenter              Cost centre of proceeds account
 w_bSplit                               TRUE = invoice has more than one profit account, FALSE otherwise
 w_bSplitERLKOMitBetrag                 TRUE = invoice has more than one profit account with an amount,
                                        FALSE otherwise
Tab. 53: Proceeds account- variables

 Tax
 w_nTax1Percentage                       Percentage of tax 1
 w_nTax2Percentage                       Percentage of tax 2
 w_nTaxAmount1                           Amount of tax 1
 w_nTaxAmount2                           Amount of tax 2
 w_nTax1AmountFC                         Amount of tax 1 in foreign currency
 w_nTax2AmountFC                         Amount of tax 2 in foreign currency
 w_nTax1BaseAmount                       Basic amount of tax 1
 w_nTax2BaseAmount                       Basic amount of tax 2
 w_nTax1BaseAmountFC                     Basic amount of tax 1 in foreign currency
 w_nTax2BaseAmountFC                     Basic amount of tax 2 in foreign currency
Tab. 54: Tax - Variables

 Cash d.
 w_nDiscountAmount                       Cash discount
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




 w_nDiscountAmountFC                     Cash discount in foreign currency
 Foreign key for various
 master data
 w_sTax1ExternalKey                      External key for tax 1
 w_sTax2ExternalKey                      External key for tax 2
 w_sPaymentTermsFKey                     External key for payment condition ‘invoice’
 w_sCurrencyExternalKey1                 External key 1 for the invoiced currency
 w_sCurrencyExternalKey2                 External key 2 for the invoiced currency
Tab. 55: Discount and external key - Variables




                                                                                                   568
           Customer category w_fktDKP
To export customer master data, the object w_fktDKP can be used to access the data of the
customer to be exported.
The name of the customer is determined by w_fktDKP.m_sNAME1 for example, and the street by
w_fktDKP.m_sSTRASSE. All database fields of the document can be accessed this way.
More examples
 w_fktDKP.m_sPLZ                       ZIP code
 w_fktDKP.m_sTLF1                      Telephone 1
 w_fktDKP.m_sUST_ID                    VAT ID
 w_fktDKP.m_nKREDIT_LIMIT              ALFAK credit limit


BRILLIANT: Example of a completely customized transfer to financial accounting
The BRILLIANT transfer consists of a start record which is written once per transfer, an invoice
header for every invoice in the number manager, the variable number of proceeds account records
per invoice, and a tax record per invoice. Customer master data transfer is handled by customizing
too.
First, set the financial accounting interface (Master data > Company > Company data > tab FinAcc)
to „Customizing“ in company parameters, and fill in the required parameters (e.g. output file).




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 234: FinAc dialog - Master data

Define the necessary formulas in formula management (Master data > Company > Formulas). The
example formulas for the BRILLIANT transfer are found in the formula directory of every ALFAK
installation (Financ_Brilliant..)
Important: in all formulas of transfer to financial accounting, the text allocated to variable sResult
is written in a line of the financial accounting output file.



                                                                                                  569
Fig. 235: FinAc– Formula Management

The formulas have to be allocated to the corresponding program items in Customizing
management.




                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 236: FinAc - Customizing




                                                                                570
          Format functions
Adjust_NrToStr(value, fieldLength, digits)
This function converts a numeric entry value into a string. The number digits defines the number of
decimals of the value to be adopted. The number fieldLength defines the length of the string. If the
number is shorter than fieldLength, the entry will be headed by zeros.
Examples:
Adjust_NrToStr(4.25, 8, 2)                     return „00004.25“
Adjust_NrToStr(8500, 4, 0)                     return „8500“


Adjust_NrToStrB(value, fieldLength, digits)
The function converts like Adjust_NrToStr but fills up with BLANKS
Examples:
Adjust_NrToStrB(4.25, 8, 2)                    return „ 4.25“
Adjust_NrToStrB(8500, 4, 0)                    return „8500“


Adjust_String(value, fieldLength)
Brings a value string to the necessary field length by adding BLANKS if necessary
Examples:
Adjust_String(„Dieter Endres“, 20)             return „Dieter Endres      “
Adjust_String(„Dieter Endres“, 4)              return „Diet“
SalNumberToStrX ( Number, DecimalPlaces)
Converts a number with the defined number of decimals into a string
Examples:
SalNumberToStrX( 4711, 0)                               return „4711“
SalNumberToStrX( 4711.452, 2)                           return „4711.45“


SalStrLeftX ( String, Number )
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




Returns the defined number of characters from a string
Examples:
SalStrLeftX( “Dieter”, 10)                              return „Dieter“
SalStrLeftX( “Dieter”, 3)                               return „Die“


SalStrLength ( String )
Returns the number of characters of a string
Examples:
SalStrLength( “Dieter”)                                 return: 6

                                                                                                571
Adjust_Date_YYYYMMDD ( Date )
Formats the transferred date in the format yyyyMMdd (yyyy=year,MM=month,dd=day) and returns
it as a string
Examples:
Adjust_Date_YYYYMMDD( 28.9.2009)                  return: „20090928“


Adjust_Date_DDxMMxYYYY ( Date, Separator)
Formats the transferred date in the format ddxMMxYYYY (yyyy=year,MM=month,dd=day) - x being
the separator sign – and returns it as a string
Examples:
Adjust_Date_DDxMMxYYYY ( 28.9.2009, „/“)          return: „28/09/2009“




                                                                                              A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                        572
           UDF functions for manipulating/adding fields
IMPORTANT: The mentioned udf functions can be used to change or add an existing record and will
always affect the record defined by the formula allocation.
If for instance the udf function is used in the formula allocation 315 – FinAcc transfer (customer
export: add to/insert in customer record), the udf function will affect the customer record at master
data export!


udf_XMLAddNode ( NodeName, NodeText, ParentNode)
For XML interfaces: adds a new junction to the parent junction and sets the value of the new
junction.
Example:
Udf_XMLAddNode ( ‚mahnbar‘, ‚j‘, ‚PersonenKonto‘ )
Adds the new junction ‚remindable‘ with the value ‚j‘ as a sub-junction of ‚Personal account‘.
<PersonalAccount>
                <Nummer>1000</Nummer>
                <Name>Müller</Name>
                <mahnbar>j</mahnbar>
</PersonalAccount>


udf_XMLSetText ( NodeName, NodeText)
For XML interfaces: sets the text for an existing junction.
Example:
Udf_XMLSetText ( ‚mahnbar‘, ‚n‘ )
Sets the text for the junction ‚remindable‘ to ‚n‘.
<PersonalAccount>
                <Nummer>1000</Nummer>
                <Name>Müller</Name>
                <mahnbar>n</mahnbar>
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




</PersonalAccount>


udf_SeparatedFieldAddField ( FieldSeparator, FieldText)
For interfaces with field separator: adds a field separator and a new field at the end of the interface.
Example:
udf_SeparatedFieldAddField ( ‚;‘; ‚no reminder‘ )


udf_SeparatedFieldSetText ( FieldNumber, FieldSeparator, FieldText)



                                                                                                    573
For interfaces with field separator: changes the contents of the field with the transferred field
number to the new value.
Example:
udf_SeparatedFieldSetText ( 2, ‚;‘, ‚no reminder‘ )
Sets the contents of the second field to ‚no reminder‘


udf_FixedFieldAddField ( FieldLength, FieldText)
For interfaces of fixed field length: adds a new field at the end of the interface.
Example:
udf_FixedFieldAddField ( 13, ‚no reminder‘ )


udf_FixedFieldSetText ( FieldOffset, FieldLength, FieldText)
For interfaces with field separator: changes the contents of the field in the transferred place to the
new value. Attention: Offset is zero-based.
Example:
udf_FixedFieldSetText ( 0, 13, ‚no reminder‘ )
Sets the contents of the first field to ‚no reminder‘




12.6. Export debtors and creditors in the workflow

           With file
The export of the debtors and creditors can now be done via workflow formula. However, this
depends on the financial accounting interface; it has to be set in the company parameters. The
export only works if the interface also supports the export of this data.
The    task   can    be    set   up      with           the   sample    formula       ExchangeService\
workflow_finacdebitorcreditorexport.txt.
The udf function "udf_FinacDebitorCreditorExport( Client, Type, Filename )" is documented in the
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




customizing function reference "Formula\customizing documentation.htm".
Which data records are transferred is determined by the database column KZ_STATUS>0 of the
KU_KUNDEN/LI_LIEFERANTEN table.
The export generates messages in the Exchange Service Monitor.

           With Webservice (eGecko)
The export of the debtors and creditors can now also be done via Webservice for the eGecko
FinAc.
The FinAc must be configured for eGecko as if it would be done via file. The export file must also
be set, for first a file is generated and this is then transferred to the eGecko Webservice.



                                                                                                   574
The     task      can      be      set       up     with         the   sample     formula
ExchangeService\workflow_finacdebitorcreditorexportWS.txt.
The udf function "udf_FinacDebitorCreditorEGeckoWSExport( Client, Type, serviceUrl, User,
Password )" is documented in the customizing function reference "Formula\customizing
documentation.htm."
Which data records are transferred is determined by the database column KZ_STATUS>0 of the
KU_KUNDEN/LI_LIEFERANTEN table.
No user/password is required in order to address the Webservice. With the call <Url
Webservice>?WSDL it is possible to check whether it can be reached.
The export generates messages in the Exchange Service Monitor.




                                                                                             A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                       575
12.7. CAM credit management interface


CAM is a system for risk management http://prof-schumann.com . For this, in addition to data from
the FinAc (open items), it also uses insured credit limits and data from various information services.
Within this system, decisions about the creditworthiness and the limit assignment to individual sites
are made. Even urgent inquiries, for example for limit increase or redistribution, are processed here
in timely fashion.

The overall process is organized in 3 partial areas:

1) Application for increase of the credit limit.
    If for the entry of an order, the credit limit approved for the customer is exceeded, a dialog can
    be called up with which the person entering the order can apply for an increase of the credit
    limit automatically and electronically. The application should be logged.




2) Transfers of current data from CAM to A+W Business
    The changes in the CAM system (new limits, creditworthiness indicators or changed open
    items) should be transmitted without delay to the ERP systems and become effective there.

3) Automatic release of locked orders
    Today's manual process for releasing locked orders should be automated.
    After new limits, open items, etc. have been transmitted, there is a check whether locked
    orders can be released automatically. The release is then done automatically by A+W
    Business.
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL



Due to the compatibility with old customer numbers, an expansion has been undertaken. If a
creditor account has been stored in the customer master data, then the transfer to CAM is done
and the processing of the credit limit increase via this account number; it includes the customer's
old account number.




                                                                                                    576
           AWB                                                Exchange                         CAM
                                 KU_LIMITR
                                                               Service
          Entry                   EQUEST                                                  Web Service
                                                              Workflow

                   Saves       limit        Reads the limit              Transfer of the data to
                   increase                 increase                     WebService




        CAM                              ERP                                               Exchange
     Management                        WebService                FS_POOL                    Service
                                                                  Typ60                    Workflow
                    Transfer of the              Saving of the
                    changed credit               data
                    limit data

                                                                                           Customers
                                                                                            + Orders


Credit limit changes from CAM
The WebService receives the dat from CAM and saves it as data records with the type 60 in the tables
FS_POOL and FS_POOLKOPF. Processing is not done in the WebService.
                                                                                                              A+W Software GmbH - Configuration A+W Business - INTERNAL




The WebService has a new interface 'ErpCredit'; it includes the new method

public bool StoreCreditData(ErpSettings erpSettings, Credit credit, out string result)

For the call of the web service, the database connection and the logical A+W Business user must be
transferred. The database connection is made via integrated security, to have access to the database with


                                                                                                        577
the pool user application. The logical A+W Business user must be created and its password must also be
transmitted.

The parameters in detail are:

  ErpSettings

  Server                   Name of the SQLServers incl. instance

  Database                 Database name (catalog) of the A+W Business

  USER                     Logical A+W Business user for login to the database

  PASSWORD                 Password for login to the database

  ClientType               Always 2= A+W Business

  DatabaseType             Always 3 = SQLServer

  ConfigurationFile        Always empty



  Credit

  CreditDetails<CreditDetail>           Collection of all changed credit data of the client



  CreditDetail                                                      AWBusiness

  CustomerNo             Customer number                            KU_KUNDEN.ID

  Rating                 Credit standing (CAM)                      KU_KLASSI_WERTE.ID=6

  Limit 1                Credit limit                               KU_KUNDEN.KREDIT_LIMIT

  Limit 2                Delivery limit                             KU_KUNDEN.KREDIT_LIMIT1

  Limit 3                Insurance limit (CCI)                      KU_KLASSI_WERTE.ID=8

  Ranking                Ranking (CAM)                              KU_KLASSI_WERTE.ID=7

  Lock                   Lock ID (0=not locked, 1=locked)           KU_KUNDEN.KZ_GESPERRT
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




  OpenItems              Receivables                                KU_KUNDEN.SALDO_J




                                                                                                  578
The record structure in the FS_POOL type 60 looks like this:

  Field                                Position   Length   Description

  Customer #                           0          15       Customer number for the credit data

  Limit 1                              15         15       Credit limit 1 (credit limit)

  Limit 2                              30         15       Credit limit 2 (delivery limit)

  Limit 3                              45         15       Credit limit 3 (insurance limit, classifier = 8 )

  Lock                                 60         2        Lock ID (0=not locked, 1=locked)

  Ranking                              62         10       Creditworthiness ranking, e.g. "AAA" (classifier = 6)

  Rating                               72         10       Creditworthiness, e.g. 0-100 (classifier = 7)

  Receivables                          82         15       Customer open items



For the processing, a workflow must be created, which calls the function udf_ProcessCreditLimit().

Example in ..\Formula\workflow_creditlimitCAM_import.txt.

The data is updated in the customer master data and the processing is logged in the workflow management.

If the reporting produces a positive balance for the customer, then after the entry sequence, the orders are
released with credit limit lock until the balance is 0 once again. For the credit limit lock, the status point 700
is used; for the release, the status point 701 is used. Caution: The status of the order is reset. The status points
must be assigned.


Application for credit limit increase

The credit limit increase application dialog displays all applications existing in the table. The status (0=created,
2=processed, 9=error) indicates what the status of the application is.

If several applications are made at the same time, then only the last one is transferred; the others are set to
processed. In the Result table column, a corresponding error message from CAM is displayed. There can only
ever be one application unprocessed in CAM; the 2nd application will be declined with error message.
                                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                                   579
The table updates itself automatically, however the user does not have to wait for the transfer; this
is done in the background by the Exchange Service. There is no feedback.
The dialog contains a credit limit and delivery limit; the application can be time-limited and limits
can be defined according to the time limit.
The entry of the records is done in the table KU_LIMITREQUEST. A workflow must be created that
transfers the data to CAM. Example: ..\Formula\workflow_creditlimitCAM_export.txt.
The transfer is done by the function udf_RequestCreditlimitCAMWSExport ( URL, User, Password).
If there are errors during transmission, then the record is set to the error status; there is no new
transfer. The application must be made again.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 580
12.8. Fibu-WebService via customizing (Beta not released)

           Overview
The possibility has been created to approve web queries via the customizing. Here, both the header
and body data can be released; XML and JSON are supported for the data transfer. It must be noted
that for the JSON transfer to a Web service, an XML input is required; the XML data is converted
within the ResRequest functionality. During the transfer of an XML data structure to a Web service,
XML can be created directly by the customizing; the XML data is not processed further.

           Functions
This functionality makes it possible to send Web queries via POST and GET to any end point and to
receive the corresponding answer.
The following UDF functions have been added in the course of the development:

 Function:          udf_GenericWebService_RestRequest
 Parameter:
                o   - string xmlConfiguration
                o   - string xmlPayload
 Return:            string Return (as XML construct)
 Description:       The query is sent to the desired Webservice with the appropriate configuration
                    in the xmlConfiguration-XML-String. The configured parameters and body are
                    used from the xmlPayload parameter. All required parameters must be filled
                    out. To make parameter input easier, there are help functions provided (see
                    below).




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 581
Function:          udf_GenericWebService_Payload_Body_Create
Parameter:
               o   - string sValue (example: 1234,56)
                   This parameter includes the value that should be created in this body
                   parameter.
             o     - string sName (example: Parameter1)
                   This parameter includes the name of the value that should be created in this
                   body parameter.
             o     - Number nType (example: 1)
                   This parameter includes the type that should be used for the specified sValue.
                   Several types are possible:
                   0 = sValue is a string
                   1 = sValue is a float/double (has places after the decimal point)
                   2 = sValue is an integer (has no places after the decimal point)
Return:            string xmlBody (as XML construct)
Description:       This function creates the sBody that is used in the call of the function
                   'udf_GenericWebService_BuildPayload'. To join several body parameters, the
                   return value of this function can be attached to a previous return value of this
                   function. It is important that with this function the right nType is used for the
                   respective sValue.



Function:          udf_GenericWebService_Payload_Header_Create
Parameter:
               o   - string sValue (example: 1234,56)
                   This parameter includes the value that should be created in this header
                   parameter.
             o     - string sName (example: Parameter1)
                   This parameter includes the name of the value that should be created in this
                   header parameter.
             o     - Number nType (example: 1)
                   This parameter includes the type that determines how this header is
                   transferred in the query. Several types are possible:
                   0 = unprocessed header (no changes)
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                   1 = Query Parameter
                   2 = Automatic (WebClient decides per query type where the header will be
                   written)
Return:            string xmlBody (as XML construct)
Description:       This function creates the sBody that is used in the call of the function
                   'udf_GenericWebService_BuildPayload'. To join several body parameters, the
                   return value of this function can be attached to a previous return value of this
                   function. It is important that with this function the right nType is used for the
                   respective sValue.




                                                                                                   582
 Function:         udf_GenericWebService_BuildPayload
 Parameter:

 Boolean          - (optional) string sBody
                o Success
 Integer          This parameter determines which data should be transferred in the query; this
                  HttpStatusCode
 String           parameter
                  ResultContent        is         generated        via        the       function
 Boolean          'udf_GenericWebService_Payload_Body_Create'. The use of the function
                  HasException
 String           'udf_GenericWebService_Payload_Body_Create' is only mandatory if the query
                  ExceptionMessage
                  is a JSON query. For an XML query, this body can also be created manually since
                  it is not type-specific. This parameter can be empty.
                o - (optional) string sHeaders
                  This parameter determines which other headers should be transferred in the
                  query;       this    parameter       is   generated     via     the   function
                  'udf_GenericWebService_Payload_Header_Create'. This parameter can be
                  empty.
 Return:           string xmlPayload (consists of finished XML payload that is used by the main
                   function 'udf_GenericWebService_RestRequest‘.)
 Description:      This function builds the XML payload using both parameters. The call of this
                   function is mandatory, even if both parameters are empty.




'GenericWebServiceResponseDto'   structure      that     is    returned     by     the    function
'udf_GenericWebService_RestRequest'. This is always a string that contains this structure as XML.


Example of an XML return:

 <?xml version="1.0" encoding="utf-16"?>
 < GenericWebServiceResponseDto xmlns:xsi="http://www.w3.org/2001/XMLSchema-
 instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Success>true</Success>
  <HttpStatusCode>200</HttpStatusCode>
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL



  <ResultContent>{
  "data": "example return data",
  "value": "{\"someNumberValue\":\"1234\",\"moreNumberValues\":164384.4}"
 }</ResultContent>
  <HasException>false</HasException>
  <ExceptionMessage />
 </Return>




                                                                                                583
Example: use of the generic Web service using the customized Web service FinAc implementation
for C.Bergmann can be found here: "Financ\Customized Web-Service-FIBU\C.Bergmann \WF-Fibu-
302-Erlöskontensatz.txt". In the example, with the help of the new UDF functions that were made
available for this development, an XML document is built and sent to an endpoint provided by the
customer.



         Trace notes
For the execution of the function "udf_GenericWebService_RestRequest" the traces are written
under the category "CommercialExchange". The parameters of the query for use of the "Debug"
trace level and the result are written too. For execution without "Debug" trace level, the
parameters are only repeated if an exception occurs. Trace entries are written under the name
"GenericWebServiceSendRequest".




                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                             584
12.9. FinAc - workflow functionality

         Overview

With the introduction of this new option, it is now possible to execute the FinAc completely in a
workflow in the background. This option must be activated explicitly. The new option is in
"Company Data" > "FinAc" > "Financial Accounting" > "Enable Workflow". With the activation of
this class, currently the entire FinAc class is replaced with the new implementation; the
consequence of this is that all functions that are not directly dialog-related are no longer
represented in the frmFIBU class. A new functional class has been added for this, which now
includes these functions (cfktFibu). Upon activation, this new class is used in the interactive FinAc
execution and in the workflow. However, this option is only available for FinAcs that use the
standard abcfibu.exe; this excludes all numeric FinAcs and some country-specific FinAcs. The
"Enable workflow" option is deactivated automatically insofar as the workflow execution is not
available.




         Workflow execution

To start the FinAc workflow, the following UDF function is used:
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




udf_FIBU_Workflow(nNV_FaktTyp, nMandant, sNVName)
The UDF function returns a Boolean that is TRUE with successful execution and FALSE in case of an
error. Traces are written depending on which error occurred. Traces are written under the function
name.
For the execution in the workflow, it is assumed that all formulas that are executed in the
customizing of the FinAc have already been adjusted to the new naming of the variables! If no
formulas are used, then no changes must be made.




                                                                                                 585
         Functioning and special functions

With activation of the workflow functionality of the FinAc, a new class is used that can be execute
the entire implementation of the FinAc apart from a dialog.
It must be noted that for workflow execution, no dialogs can be displayed. This means that all errors
and any messages are displayed in the workflow log.
If there is no revenue account, the error message is displayed in the log. There is no interactive
query of the revenue account. If a revenue account is not found at the beginning of workflow
execution, the entire execution is interrupted and noted with an error. The revenue accounts must
be created correctly so that an execution of the workflow is possible.
For the workflow, the original variable names are taken over nearly identically; however, each
variable has a "m_" placed in front of it. That is, if a variable was previously called "w_sInvoiceNo",
it will be called "m_sInvoiceNo" in the workflow environment. This applies for all variables except
for global variables; these can be reached normally. It must be noted that all local function variables
have still received the original naming; all Instance/ex. window variables are affected by the
renaming.
For the implementation, only the AW standard FinAcs have been tested in connection with the
workflow implementation; all other FinAcs must be checked before first use. Insofar as customizing
is used, it must be adjusted. It is recommended that you create a copy of each FinAc customizing
formula used in order to ensure data back-up of the original formula; this way, if an error occurs,
the original formula will still be present. The variables must be adapted according to the new
naming in the copy of the formula.




                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                   586
        Sample implementation

An example of a complete implementation of a customized Web service FinAc can be found under
this path: "Financ\Customized Web-Service-FIBU\C.Bergmann".




                                                                                               A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                         587
13.Databases
13.1. Replication
Replication serves to transfer data from a company's headquarters to its subsidiaries/sites. This
requires the creation of data structures in the databases in which the amended or new data
headquarters data will be saved. By means of replication, the data will be distributed from
headquarters to all sites, to be added or updated. So-called Triggers have to be installed to be able
to collect the newly created of changed data at headquarters. Triggers are database processes that
can respond to events such as Insert or an update.Triggers are database processes that can respond
to events such as Insert or an update. These triggers make it easy to log data changes without major
program amendments.
At the individual sites, it must be possible to disable certain data fields in the management
programs for products, customers, and suppliers so that these fields can only be changed by
headquarters, via replication. Other data such as the route in customer data, have to be processed
by the individual sites. It is therefore necessary to select all records created or changed via
replication to be able to process the local data, and correct them if necessary. The local data are
defined by means of the replication management program.
The program Basic number areas has been added in master data, General (see Abb. 232); it is used
to manage the number areas for most of the catalogue tables. This is essential as the primary keys
of these catalogue tables are the names themselves while ALFAK uses the background number for
identification. The number areas allow to define special, non-clashing number areas for every site.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 237: Basic number areas




                                                                                                 588
           Activating replication
Please find below a description of how to prepare ALFAK for replication.
Database update
To guarantee that replication works properly, it is essential that the data structure of all databases
involved has the same release. This is why all update scripts should be run via script management
on the database first.
Setting the company parameters
To make sure that the master data management programs behave correctly, you need to enable
the code for active replication in company parameters (Abb. 233).To make sure that the master
data management programs behave correctly, you need to enable the code for active replication
in company parameters (). As a result, all non-local data fields will be locked in the management
programs for partners and products; these can be changed only by headquarters, via replication.




Fig. 238: Replication settings in company master data

When replication is active, the administration dialogs for products, customers, and company
parameters will find out which fields contain local data, and which do not. Non-local fields cannot
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




be processed by the user. The local data are defined in the replication administration program. If
field Route 1, Route 2 and the Delivery terms are defined as local fields in replication management,
Abb. 234 shows the reaction of customer management. This setting has to be made for the
subsidiaries only.




                                                                                                  589
Fig. 239: Local fields in customer management

The lock code in product and partner management was extended to allow the receiving site to
select and process the records easily. Abb. 235 shows that the replicated records can be easily
selected in QBE mode. The tagged data are available in the system only after the user has gone
through the data, edited them, and set the lock code to not locked.




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 240: Selecting replicated customers in customer management

To allow the replication core to tag the replicated data in the target system, use the replication
management program to define a default receipt value for the lock code. This value is the same for

                                                                                               590
product and partner management. First, activate the indicator for a default value, then enter the
default itself. The following list shows the value and its meaning; Abb. 236 shows replication
management and the default values for the customers.




Fig. 241: Reception default for customers

0 = not locked
1 = locked
2 = replicated




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                              591
Defining rights for catalogue tables
It is essential that the receiving sites cannot change the existing catalogue data as this might corrupt
the replication. To ensure this, the rights for all users have to be defined accordingly. Rights should
be allocated in such a way that new data can be created, but existing data cannot be changed. Abb.
237 shows the management of rights with the appropriate settings.




Fig. 242: Management of rights

Defining the sites in the head office’s database
In the database of head office, you need to define all sites to which data shall be replicated. This is
done in the replication management program as shown in Abb. 238. Please make sure to enter the
subsidiaries' data correctly Abb. 238 as the database login in the target system will be using this
information. You have to use different paths for the individual subsidiaries to save the export files
and import the receipts for the subsidiaries (see Abb. 239).


                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                    592
Fig. 243: Entering subsidiaries (master)




                                                 A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 244: Entering subsidiaries (slave)




                                           593
Defining the jobs
The replication creates the data based on so-called Jobs. These jobs define the tables to be included
in the replication of headquarters. To replicate customer data for example, enter a job for the
Customer table in the management program (see Abb. 240). All tables customer master data refer
to, will be replicated this way.




Fig. 245: Jobs for replication

Exclusion of tables
Tab 3 can be used in the Master to exclude tables from replication. This is set by means of „Disabled
(manually)“ in the table view. When a table is disabled, the system checks whether table RR_TODO
includes data for the replication of this table. If records are found for this table, the program will
want to know whether existing records shall be removed. If this is affirmed by „Yes“, all data still to
be replicated will be removed from table RR_TODO.
Manually disabled tables will never be transferred by replication:
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                   594
Fig. 246: Replication – Exclusion of tables

For tables which are explicitly excluded from replication, a sending default must be set for the
reference tables to avoid a „Foreign Key“ error at the import. When a table is disabled, the program
will check now whether a sending default shall be set for the reference tables. An entry can be
made or selected from the following dialog; this will be used as the sending default for all reference
tables.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 247: Replication - Defaults

Transfer of replication data
To copy the data to the subsidiaries , an automatic task for the ALFAK Interface Service will be
entered at headquarters. Add the formula from the file Workflow_ReplicationExport.txt to this task.
The function loaded by this formula will export the replication data for every headquarters and for
every job. The data will be saved in the directory defined for the subsidiary in replication
management. Before the export, the receipts from the subsidiaries' directory will be processed.
Every subsidiary must define an automatic task for the ALFAK Interface Service to which the formula
from file Workflow_ReplicationImport.txt will be added. This formula imports all import files for this


                                                                                                  595
subsidiary from the directory defined in replication management, and creates a receipt for every
file.
This completes the replication cycle. The result must be emailed and also appears on the ALFAK
Service Monitor.




Fig. 248: Display of the finished replication on the ALFAK Service Monitor

Installation and update of replication management
The replication is automatically updated when the ALFAK installation is updated by means of the
SetupLauncher. The components for the replication core are installed and updated by the ALFAK
Interface Service; the Udf functions can be found in the ALFAK Com object abcreceiveXX.exe which
is installed and updated by the ALFAK basic setup.


Disabling the old replication call
When the new replication is installed by AIS, the old replication needs to be disabled by means of
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




the VB scripts. Possibly existing tasks have to be disabled in the operating system or in the backup.




                                                                                                 596
Fig. 249: Disabling the old replication call


            Defaults
Replication uses three types of defaults.
Dispatch default – will always be saved in the transfer file instead of the original value when the
data are transferred to the subsidiary
Receipt default – after receipt of the data, this wil be saved in the database instead of the transfer
data, distinguishing:
     •    conditional default (only for newly created records)
     •    unconditional default (will always be set)
Default filler – if a field (column) is missing from the transfer file, this value will be entered in the
column in the target database.

            Known Problems
                                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL



Replication will not work if umlauts are used in connection with the Unify SQL Base 11.5 PTF3.
This can be corrected by Unify's EMP5258EDP and replacing SQLBaseODBC.dll. This hotfix is not
included in the standard installation and has to be installed if required.
Procedure:
After installing PTF3 of SQLBase, the files of the archives EMP5258EDP.zip have to be copied onto
the installation. Now replace SQLBaseODBC.dll. This is not necessary for PTF4 because it includes
the error correction. The necessary files are part of the diskset of the installation directory of Unify
SQLBase 11.5.
During installation, you can check whether the necessary version have been installed on the
computer. The files of EMP5258EDP have file version 11.5.3.7145 and the new SQLBaseODBC.dll



                                                                                                     597
 has the file version 11.5.3.7362. The files of PTF4 have file version 11.5.4.7773. The following list
 can be used to check the installatoin of SQLBase:

  File                              PTF3 + EMP + ODBC Hotfix         PTF4
  CSFCNV32.dll                      6.0.0.4                          6.0.0.4
  Csfedt32.dll                      11.5.3.7145                      11.5.4.7773
  Daemon32.exe                      11.5.3.7145                      11.5.4.7773
  EFDAEMON.exe                      11.5.3.7145                      11.5.4.7773
  efhost.exe                        11.5.3.7145                      11.5.4.7773
  Pswdhlpr.dll
  Sqlbapw.dll                       11.5.3.7145                      11.5.4.7773
  SQLBaseODB.dll                    11.5.3.7362                      11.5.4.7773
  SQLBaseODBCSetup.dll              11.5.3.7145                      11.5.4.7773
  SQLBaseOLEDB.dll                  11.5.3.7145                      11.5.4.7773
  SQLBaseUtil.dll                   11.5.3.7145                      11.5.4.7773
  Sqlcrt32.dll
  SQLNTTLK.exe                      11.5.3.7145                      11.5.4.7773
  Sqltalk.exe                       11.5.3.7145                      11.5.4.7773
  Sqltne.dll                        11.5.3.7145                      11.5.4.7773
  Tlkc32.dll                        11.5.3.7145                      11.5.4.7773
  Tlkc32sp.dll                      11.5.3.7145                      11.5.4.7773
  Unify.SQLBase.Data.dll
Tab. 56: List to check SQLBase      11.5.3.7145                      11.5.4.7773

 The files must exist in the export and import systems.


 13.2. SQL Server Migration
 The migration tool generally permits database porting from SQL Base to SQL Server. As from ALFAK
 Version 2012, migration is possible between the database systems. This is done with the Unicode
 option switched on (automatically). Since ALFAK 2012 can handle Unicode, database conversion to
 Unicode, even from SQL Base to SQL Base and SQL Server to SQL Server, is compulsory. After that,
 the database can be used only with ALFAK 2012 and later with a 2012 version.
 IMPORTANT: the archive databases that are in use must also be migrated with the migration tool
 before you start up ALFAK 2012.

            Database Connection
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL



 Originally, a SQL Base source and a SQL Server target for database migration could be entered. In
 view of ALFAK Version 2012, the database migration tool has been extended. The first new feature
 is the database login of the dialog: The connection for source and target database can now be set.
 Valid options are:
     •    SQL Base Native
     •    SQL Server OLEDB
             o You also need to enter the server on which SQLServer has been installed.
             o For SQLServer Express, you have to enter SQLEXPRESS apart from the
                 server name: <ServerName>\SQLEXPRESS
 The database, the user, and the password have to be entered as usual. The SQL Server database is
 accessed by an integrated security in the Windows login. For details please refer to the SQL Server
 setup.


                                                                                                  598
Fig. 250: DBMigrationstool – Login


           Limitations
User authentication only in connection with the integrated Windows security.User authentication
only in connection with the integrated Windows security. From ALFAK Version 2012, the Application
Role will be created for SQL Server
The replication of A+W has not been changed to SQLServer. This is scheduled for ALFAK Version
2012
No master data history available
Competing master data access will not be blocked; the last one wins. For SQL Base, the first one
wins

           SQL Server setup
SQLServer must be installed with combined user authentication. The passwords for the SA user
have to be noted and kept in a safe place. Login authorization and database user have to be defined
in Management Studio. A login for the user group has to be defined (database
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




server/security/registrations). This gives the users access to the database server. The server should
be set to Public which suffices for ALFAK users.

The user group has to be given access to all necessary databases including archives (database
server/databases/<database>/security/user). The database role should be set to DB_Owner.
DB_Datareader+DB_Datawriter is also sufficient. In this case, database updates have to be made
by a user with DB_Owner. This is possible after the databases have been created (see 0).

Activate the TCP/IP log in the SQLServer configuration manager (Start->Programs->Microsoft
SQLServer 2008->Configuration tool) and start the SQLServer Browser service. This is necessary for
the clients to address the SQLServer.


                                                                                                 599
To test the database connection you can create a file with suffix UDL. Double-clicking on this file
will open the database connection dialog. Here, select Microsoft OLEDB Provider for SQLServer as
a provider. Now choose the database server. Select Windows authentication. The connection can
be tested when the databases are visible.
Client setup
Client PCs may require the installation of MDAC 2.8 (Microsoft Data Access Components). This
depends on the other programs installed (ALFAK setup does not handle this at present).

          Migrating an existing database
The source database has to have the status of ALFAK 2008 prior to migration. For migration with
Unicode option, the database must be updated to the latest version of ALFAK 2011 at least. This
is the only way to make sure that the data types and definitions permit
the migration without errors. Prior to migration, there has to be a registration that permits access
to the database. The database must be accessible. See items 13.2.3 and0.
Migration tool settings
Migration is done in five steps 0 - 0. First configure the migration tool. Enter the source database
connection in Source. This is done by means of the server, database, user, and password (for
migration with Unicode option, choose the source's codepage). User and password have to be a
real user (SYSADM).
Target configures all details referring to the target database, i.e. definition of server, database, user,
and password. The possible source and target database combinations (with or without Unicode
option) are enabled automatically (according to the ALFAK Version).
Important: The database names have to be different. The migration tool does not execute an
„InPlace-Migration“.
Checkbox SQLExpress no longer exists. This extension must be entered by hand for the SQL Server
name. If SQL Server is chosen as the target database, a button after the database name is enabled
in order to define the starting size of the SQL Server database. This prevents defragmentation due
to too many enlargements during migration. The tables are allocated to individual file groups. These
can be split to different disks in case of performance problems. This allows parallel access.
Furthermore, a pattern name must be defined for SQL Server (SYSADM). The following file paths
define the files for the scripts as per 0 and 0. They should not be changed. The migration tool has
been configured now, and data migration can begin. Settings are stored. Migration of archives
databases works in the same way; you only have to set the checkbox Archives as well.
                                                                                                             A+W Software GmbH - Configuration A+W Business - INTERNAL



Creating the database and pattern
First, use the button Get Binary to load the database, the binary data or long strings (‚Long String‘)
into the table. The table serves for overview and the records can not be edited.
The database migration tool has been completed by a conversion function.
Microsoft SQL Server offers the data type date from Version 2008 R2 upwards. As from now, the
SQL Base date data type can be converted to a SQL Server date data type. Based on the text file
DBMigration_DateColumns.txt            which          must          be         saved         in
the <Alfak installation directory>\Cmd\, one can find out - in SQL Server migrations where the
databases could not be converted by means of this function so far - one can find out which
column used to have the data type date . You can also create the text file
DBMigration_DateColumns.txt yourself by means of migrating a SQL Base database to SQL Server.


                                                                                                      600
This
option can be enabled by ticking the checkbox Convert Date, and will be executed when the
database pattern is created. Data type date is important for ALFAK capacity planning, no matter
whether ALFAK Version 2011 or 2012 is used.
After that, the actual migration steps can be started.
First, select migration step Create Pattern and press OK. A script is created in the source database
which is used to define the pattern on SQLServer. The database name is fixed in the script. For SQL
Server, open the script in Management Studio (file/open/file). Use the Execute button to run the
script. When the database has been created, the migration user has to be given access to the
database (registration and database account), see 13.2.3. Important: For an SQL Base target
database, the script already includes the creation of indices when this migration step has been
executed. Load the script in SQL Talk and run it.




Fig. 251: Database Migration Tool
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




Data migration
Choose migration step Data Migration and press OK. The table data will be transferred. Errors
during data migration can be viewed in the log file afterwards (Migration.log). It is structured in
such a way that the inserts can be done later. (troubleshooting provided).




                                                                                                601
Fig. 252: Data migration – SQL Base  SQL Server with Unicode option

Enter foreign keys and indices
Choose migration step Create Foreign Keys (and Indices) and press OK. For an SQL Server target
database, two scripts will be created which have to be loaded and run in Management Studio
(file/open/file). The database requires no settings; this is part of the script. For a SQL Base target
database, just one script will be generated for Foreign Key creation. This is loaded and run in SQL
Talk. Unless data migration is running flawlessly, the foreign keys should not be added to the
database. The script (for SQL Server target database) will delete all existing foreign keys before
restoring them. This means that this process can be run as often as necessary. This also applies to
the script with the indices.
Defining or updating the ALFAK user
Porting SQL Base to SQL Server database generally requires no user migration. The following applies
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




to database migration of ALFAK Version 2012 and higher: There is no real user migration for porting
a SQL Server system to SQL Server. The migration tool defines the application role (Migration
Step 4. Application Role) for the created database. A further script (SQLAuthorization.sql) is
created in the A+W sub-directory of the Windows user [ Application data for all users e.G.
C:\Documents and Settings\All Users\Application Data\A+W\<ALFAK_PRODUCTNAME>], to be
executed in SQL Server Management studio.
If the target database is a SQL Base system, it will be first equipped with the standard ALFAK user.
All others will be migrated thereafter.
Select migration step 4. User migration and press OK: the tool will trigger the commands.
Loading SQL Base compatibility functions



                                                                                                  602
To make sure that SQL Server can handle the special functions of SQL Base Datenbank (@
functions), run the script <Alfak Installationsverzeichnis>\Cmd\MS SQLSERVER.SQL with the
Management Console on the database. ATTENTION: You have to select the database; it is not fixed
in the script. The database is now ready for use!

         Time required
For the migration, all data records in the source database must be read in and stored in the target
database. This is done using normal SQL commands. The porting of a 815 MG database on a virtual
PC with 2.4 GHz requires approximately 15 minutes. A data migration with switched-on Unicode
option on the same system requires approximately 20 minutes. From this, a factor of approximately
25% arises with respect to a non-Unicode to Unicode porting.

         Tips and tricks
Until ALFAK2011, all text fields (long varchar) are saved as binary columns. These cannot be printed
in                                          Crystal                                         Reports.
To print these text fields in the reports, you have to implement a function in Crystal Reports
in SQL Expression Fields:
{fn CONVERT (“BW_AUFTR_TXT”.”BEZ”,SQL_VARCHAR) }
The error during the creation of indices (migration of a SQL Base database to SQL Server without
Unicode conversion) is corrected with a repeated migration. The migration tool used to create
indices which included the same columns as the primary key. One last essential aspect is that from
ALFAK Version 2012 on, the Unicode option must be switched on for database migrations. The
database will be automatically updated to Version 2012.




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                603
           Note with activated change monitoring

If the change monitoring is active in the target database, due to the Unicode conversion, this must
absolutely be reinitialized. Furthermore, the triggers for the change monitoring must be
recreated. The previous database triggers still work with the ASCII data types. If one of the
triggers is violated with an update of a data record, there will be a database error. This is
prevented with this!




Fig. 253: Change monitoring initialization after migration




13.3. SQLBase Settings
 Performance Settings for Version 8.5
 Cache             24000        (min. recommended value for SQLBase 8.5 and 256 MB RAM)
 Sortcache         64000        (min. recommended value for SQLBase 8.5 and 256 MB RAM)
                                                                                                              A+W Software GmbH - Configuration A+W Business - INTERNAL




 Readonly                 0

 Oracleouterjoin          0

 Logfileprealloc          1              (1= Login files are immediately created with a size of X MB)

 Partitions               0
 Optimizerlevel           2              (2= current optimization technique, 1= old optimization
                                         technique)
 Locktimeout              275
 secureapi                0



                                                                                                        604
 sortlevel              0               (0 = activating the sort cache. For ALCIM, this parameter will
                                        cause the server to crash if the command Distinct is used in a
                                        query - it is therefore best completely deleted from SQL.ini)
 threadmode             1               (1 = for NT/Win200/Win2003, 2 = for Win9x,ME)
 workalloc              5000            (abhänig von der größe des Ram-Speichers des Servers
                                        Standard=1000)
Tab. 57: SQLBase Performance Settings




                                                                                                               A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                         605
14.Capacity planning
14.1. Description
A+W Business Capacity Planning offers the opportunity to calculate production date and costs for
orders and items. The most important individual parts are described below.


14.2. Master data
So that the capacity planning can work correctly, a series of master data is required. This is
described below.

          Work types
An activity is designated a work type, which is performed on a glass item during the value creation
chain. Each production step calculated by the capacity planning is assigned a work type.
On the dialog, all settings can be changed that have a direct effect on the work types. These are,
e.g. the sequence, which defines the sequence during the production process and whether the
processing is only done on the main product (e.g. dispatch)




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 254 Work types




                                                                                               606
         Allocations:
Allocations serve to assign the BOMs from the orders or quotations the required work types. Thus
the capacity planning knows which work types must be performed for an item. The production
sequence arises from the composition of the BOM and the sequence of the work type.
There are various types of allocations. These are evaluated in the following sequence for each BOM
element. As soon as an allocation provides a match, the search is canceled and the work types in
the allocation found are used.
Via the factor on some dialogs, the estimated time and costs of the work type can be adjusted again
separately.

        14.2.2.1.    Special allocation 4
Here you can set that for a particular processing on a particular shape another work type (or several)
than normal should apply if there is a particular follow-processing after the processing. Here you
can specify on which edges which work type should be performed and calculated.

        14.2.2.2.    Special allocation 2
Here allocations can be created for edge processings on a shaped sheet. Various work types can be
performed on different edges. In addition, different behavior can be set for different quantities.

        14.2.2.3.    Special allocation 3
With this allocation, you can define different work types for edge processings if they should only be
done on particular edges.

        14.2.2.4.    Special allocation 1
Here you can define different work types for processings if a particular follow-up processing will be
done.

        14.2.2.5.    Combined product class
On this dialog, you can allocate work types if a particular product is included in a product with a
defined product class.

        14.2.2.6.    Combined product type
See combi product class, only with product type.

        14.2.2.7.    Product
Allocations of work types per product.
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




        14.2.2.8.    Product group
Allocations of work types per product.

        14.2.2.9.    Good group / top group / main group
Allocations of work types per goods group.

        14.2.2.10. Product type
Allocations of work types per product type.




                                                                                                  607
         Machine types
The type of a machine. This controls which restrictions are active for a machine and permit an entry.
For A+W Business Pro, there is an additional field in which the type of machine driver is set.
Depending on the type, additional fields are then available on the machine dialog.

         Machines
Machines are the stations on which the required work types are performed. They are allocated
restrictions, machine drivers, and costs. Here, the machine type and production area are also
allocated.

         Default times
A default time is the allocation between a machine and a work type. Thus it is possible to store
times for various combinations that determine how long performance of the work type takes on a
machine. Here the time can be entered in hours per time unit as individual price, vector, matrix or
cube.
Via the priority, you can control which machine is preferred by the scheduling for use of a work
type. All other machines that were allocated the work type through a default time are entered as
deviating machines, insofar as they are not declined due to restriction violation.

         Product areas
Here it is possible to group machines in order to allocate a common calendar, for example. This
dialog can also be used to set which status is assigned if an item or an order has run through this
production area completely.

         Transition time/matrix
Here times can be set for the transition between work types and production areas.
In the transition matrix, the duration is set in days, which must exist with a jump from a work type
to the follow-up processing if here there is a change between particular production areas. Shifts
can be set with specification of decimal numbers between 0 and 1.
In the transition times, the duration in shifts is specified, which must exist for the change between
two work types.
On both cards, 0 can be used as wildcard in order to determine a transition from one or all
production areas or work types.
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




         Calendar
The duration of the shifts is determined on the calendar. A calendar day can be assigned up to six
different shift durations.
Calendars can be created for the combinations production area and site or work type and machine,
whereby here 0 can also be used as wildcard. If a date is sought by scheduling for a work type on a
machine, then the next day is sought on the appropriate calendar on which shifts are entered; there
is then a check whether capacities are present.




                                                                                                 608
14.3. Scheduling
In the scheduling, costs and time for documents are determined. Here, initially for the complete
BOM of a document, the work types are sought via the allocations that are required for the
production. For this work types, the possible machines are determined on which production is
possible. Here, the times and costs are also calculated.
Then the production date is determined for each work type. Here, calculation is always backwards
from the delivery date. The production date is thus always as close as possible to the delivery date;
forward scheduling is not possible here.

           Programs
Orders can be scheduled by two programs:
Manually
      •   Single order by the user: Production > Capacity planning > Scheduling > Schedule order
      •   Complete number manager by the user: Production > Capacity planning > Scheduling >
          Schedule NM
Create
      •   through the ALFAK Interface Service (AIS)
      •   Standard         transfer           via      workflow               task,         formula
          Workflow_TransferToALFAKCapacityPlanning.txt
Configuration
Status allocation always refers to the production transfer. In the following example, the minimum
status for production transfer is status 37 which is allocated at automatic or manual scheduling as
the scheduling result. Successfully scheduled orders can therefore be directly transferred -
automatically or manually - to production.
Status Points
                                                                   State
 No.       Required for             Designation                    Default   Min.       Lock
 37        Scheduling               KAPA: scheduled (backgr)       37        x          x
 38        Scheduling               Capacity planning: scheduled   37        x          x
                                    by time management
 39        Scheduling               Error    during    automatic   9         X          X
                                    scheduling
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




 44        Scheduling               No entry in TM                 37
Tab. 58: Status points - Capacity planning

ERP Webservice
Required for
      •   OrderXML production transfer using capacity planning data
Configuration in Master data > Company > Company data > tab Production > Order settings




                                                                                                 609
Capacity status
    •    The scheduling status is shown in table BW_LOCK_KAPA, Feld KAPA_STATUS
    •    Used for formulas (scheduling) and order entry
    •    Reset to 0 at order entry by
             o Change of shipping or production date
             o all structural changes in an item (width or height, supply type,..)
             o BOM changes (shape, processing steps,…)
             o No reset because of price changes
Possible values:
 Value       Meaning                                                Application
 0           New order entered, or structural changes               Order entry
 1           Scheduled                                              Scheduling
Tab. 59: Capacity status


14.4. Updating the old capacity planning to Patch July 2011
    •    Differences from the old capacity planning:
             o Scheduling, completion report, and control unit in program Production
             o Master data, allocations, and locks in program Capacity Planning
             o Automatic scheduling and transfer of residue by workflow tasks in AIS
             o Sql Server support
    •    Procedure
             o Unload tables KA_MENU and KA_FAVORITEN
             o Saving old programs
                      abcstamm.exe
                      abcfert.exe
                      abcstart.exe
                      abczeitw.exe
                      abcauftr.exe
                      abczwbatch.exe
                                                                                             A+W Software GmbH - Configuration A+W Business - INTERNAL



                      abczwrestev.exe
                      abcreceive45.exe
             o Save capacity planning reports
                      bamasszu.qrp
                      zw_avb_st.qrp
                      zw_mar_st.qrp
                      zw_stati.qrp
                      zwaggtypen.qrp
                      zwauslastung_08.qrp
                      zwauslastung_12.qrp
                      zwbeatyp.qrp
                      zwprober.qrp)


                                                                                       610
       o   Stop and delete planned tasks from the old, automatic scheduling
           (abczwbatch.exe) and residue transfer (abczwrestev.exe)
       o   Delete the programs abczwbatch.exe and abczwrestev.exe
       o   Database update (updating the menu, new database columns, creation of columns
           which were previously created by the program abczeitw.exe)
                20110328m.sql
                20110329a.sql
                20110330a.sql
                20110331m.sql
                20110401m.sql
                20110405a.sql
                20110429a.sql
                20110808a.sql
       o   Update ALFAK installation
       o   Execute the ALFAK config tool to define the new TRACE switch Capacity Planning
       o   Automatic              scheduling:           Add            the            formula
           Workflow_TransferToALFAKCapacityPlanning.txt as a task in AIS With this formula,
           from Version 10.8.2011, it is no longer necessary to schedule orders by hand which
           were entered BEFORE the change. This version of the formula also selects orders in
           the status area of automatic scheduling the entry BW_LOCK_KAPA.KAPA-STATUS
           of which shows NULL instead of 0. With older versions of the formula, orders have
           to be scheduled by hand,With older versions of the formula, orders have to be
           scheduled by hand,
       o   Automatic residue transfer: Add the formula Workflow_RestManagement.txt as a
           task in AIS
       o   Check the customizing formulas for scheduling of machine restrictions, dwell days,
           and priorities. The scheduling variables used in the formulas have to be converted
           to the new spelling (e.g. nAuftrag to m_nAuftrag). See section Customizing of
           scheduling
       o   OrderXML production transfer with capacity planning data
                Update the ERP Webservice to at least issue July 2011
                Enable the switch Production transfer (OrderXML) with scheduling data in
                    capacity planning settings
       o   Setup on an existing SqlServer system
                Migration of the existing SqlServer database (source/target SqlServer)
                    using the migration tool and enabled option „Convert Date“ to convert the
                    existing data columns.
                                                                                                A+W Software GmbH - Configuration A+W Business - INTERNAL




•   Tool for checking the new capacity planning
       o \\jupiter\ALFAK_Develop\Tools includes the tool abczwcompare45.exe which can be
            used to compare the results of the old and new scheduling.
       o This tool will work only if executed on a computer on which ALFAK 2011, issue
            patchday July 2011 has been installed.
       o We strongly recommend to execute the tool only on a test database and to delete
            the scheduling data from the database table ZW_AUFTR_ZEIT before loading the
            tool!
       o Procedure - comparison
            Press the button Start old capacity planning.




                                                                                         611
Fig. 255: Capa- Tool 1

The old scheduling is loaded as a dialog; start it by pressing OK. The selected number manager is
scheduled and scheduling is finished after that.




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 256: Capa – Start old values from ALFAK 1

Press the button Read old records. The tool will read the scheduling results.




                                                                                              612
Fig. 257: Capa- Tool 2

Press the button Start new capacity planning. The new scheduling is loaded from the production
program (abcfert.exe) of the ALFAK version installed; press OK to start it. The selected number
manager will be scheduled. Production must be closed completely after scheduling is finished.




                                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 258: Capa- Start old values from ALFAK 1



Press the button Read new records. The tool will read the new scheduling results.



                                                                                            613
Fig. 259: Capa- Tool 3

Press the button Compare. The tool will analyse the old and the new scheduling results.
If no differences are found, the message reads No difference between old and new capacity
planning.




260Fig. : Capa- Tool 4
                                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL



If differences are detected, the different records in table ZW_AUFTR_ZEIT will be listed on the
spread sheet including order, item, BOM, work type, machine, time and costs. The programmer in
charge will have to look into this matter.




                                                                                            614
Fig. 261: Capa- Tool 5


14.5. Configuring ALCIM with ALFAK capacity planning and
   OrderXML
ALFAK capacity planning with OrderXML transfer of scheduling data is possible with ALFAK 2009,
patchday August 2011 and ALFAK 2011, patchday July 2011.
The correct allocation of the defining processing (e.g. cutting of a float sheet) of an element requires
ALCIM version 2011, patch August!
ALCIM must be run in Professional mode without ALCIM Capacity Planning because the Compact
mode includes other special features which are not taken into account by external time
management!
Procedure for new systems:
Start with the ALCIM standard database and ALCIM in COMPACT mode. Machine allocation master
data for the sections cutting, line, and spacer production have already been defined but only work
via processes, not via external machine IDs.
Now enable the ALCIM Professional mode and disable ALCIM Capacity Planning. Delete the existing
machine allocation master data via script and reinstall machine allocation. The result is the "old"
machine allocation editor.
                                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL



The script \\jupiter\TECHSOFT_Glasbaum\ALCIM\Projektierung\SQL\BereinigungMZOfuerALCIM_Professional.sql w
can be used to delete the machine allocation.
Procedure for existing systems:
In case of an update of a POOLASC system, you only need to set the element tree mode to 1 because
machine allocation master data in this system are not based on ALCIM Compact structures. The
above script must not be run.
To set/check the element tree mode, go to the following point in ALCIM master data:




                                                                                                     615
Fig. 262: Setting for existing system in ALCIM master dataFig. : Setting for existing system in ALCIM master data

Basic settings for existing and new systems
As ALFAK knows no defining processing, the processed article must be marked by a defining
processing in ALCIM (COMPACT and Professional) with the code internal processing.
Example: processing article 49000 cutting




                                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 263: ALCIM - Processing article


                                                                                                                    616
To make sure that machine allocation during order import into ALCIM is successful, the machine
numbers in ALFAK and ALCIM must be the same, or have to be allocated by means of a machine
condition in ALCIM.
Machine allocation Professional - example: „Hegla cutting“




Fig. 264: Machinery allocation ALCIM- ALFAK 1



Select the corresponding production section (here: HEGLA cutting) and load the context menu
„Modify condition“ for the condition for this production section.




                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 265: Machinery allocation ALCIM- ALFAK 2

Set the formula CUBLES-106-Zuschnitt Hegla ISO as a condition in dialog „Select condition“



                                                                                             617
Fig. 266: Machinery allocation ALCIM- ALFAK 3

New conditions can be defined by means of the graphics editor or the text editor by „New
condition“. Use „Edit“ to change existing conditions. Example: Condition for allocating the ALFAK
machine ID 106.




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 267: Machinery allocation ALCIM- ALFAK 4


14.6. Customizing variables for machines, dwell days, priorities to
   be used for scheduling
 Meaning                           Alt.          New                    Example

                                                                                              618
Order number                 nAuftrag       m_nAuftrag
Item number                  nPos           m_nPos
Element number (BOMID)       nBomid         m_nBomid
Date of entry                nErfdatum      m_dtErfdatum
Deliv. date                  nLieferdatum   m_dtLieferdatum
Scheduled delivery date      dtLT_Plan      m_dtLT_Plan
Route                        sATOUR         m_sATOUR
Customer number              nKDNR          m_nKDNR
Customer Name                sKunde         m_sKunde
Priority                     sRaster        m_sRaster
Lock code                    sSperrkz       sSperrkz
Document type                sDokTyp        m_sDokTyp
Production preparation                      m_sAvBereich
Product type                 nProduktart    m_nProduktart
Product group                nProduktgrp    m_nProduktgrp
 Quantity                    nMenge         m_nMenge
Width                        nBreite        m_nBreite
Height                       nHoehe         m_nHoehe
Area                         nQM            m_nQM
Linear meters                nLFM           m_nLFM
Thickness                    nDicke         m_nDicke
Weight                       nGewicht       m_nGewicht
Item includes gas            nMitGas        m_nMitGas
Item includes shape          nIstModell     m_nIstModell
Item includes Georgian       nMitSprossen   m_nMitSprossen
bars
Element product number       nProdukt       m_nProdukt
Element product group        strWGR         m_sWGR
Element super product        strWOG         m_sWOG
group
Default time - notes         sBemerkung     m_sBemerkung
Processed edges              sKanten        m_sKanten         01000000 = Edge 2
                                                              processed
Element supply type          nBeschArt      m_nBeschArt
Element color number         nFarbID        m_nFarbID
Stepped item                 bStufe         m_bStufe
Max. glass thickness in      nESmax         m_nESmax
                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




item
Min. glass thickness in      nESmin         m_nESmin
item
Total Width                  nGesDicke      m_nGesDicke
Max. spacer thickness in     nmaxSZR        m_nMaxSZR
item
Min. spacer thickness in     nminSZR        m_nMinSZR
item
No. of film layers in item   nFolienzahl    m_nFolienzahl
The number of grid fields    nSPRFelder     m_nSPRFelder
in item



                                                                                  619
 No.     of    grid  edge         nSPR_RAP          m_nSPR_RandAnschl
 connections in item                                ussPunkte
 Machine                          nAgg              m_nAggregat
 Work type                        nArbNr            m_nArbNr
 Hierarchy code                   nRFOZ             m_nRFOZ
 Persons at machine               nPersonen         m_nPersonen
 Machine runtime in hours         nStunden          m_nStunden
 No. of shifts                    nSchichten        m_nSchichten
 Work type sequence               nFolge            m_nFolge
 Machine type                     nAggtyp           m_nAggtyp
 Machine production area          nProber           m_nProduktBereich
 Minimum time                     nMinzeit          m_nMinZeit
Tab. 60: Customizing- Variables


14.7. Calculation of time costs for quotes
To improve the profitability checks for quotes, you can now calculate the time costs
by means of a workflow task in the ALFAK Interface Service (as from patchday September 2011).
Automatic calculation will determine the material and time costs for a quotation, and purchase and
sales prices can be compared.

The time costs of all quotes in the range of status point 990 „Capacity planning: Cost calculation“
will be calculated automatically, and adopted for the quote. Successful calculation will raise the
status of the quote to the user status of status point 990 „Capacity planning: Cost calculation“ while
an error (e.g. machine allocation missing) will reset the status of the quote to the user status of
status point 991 „Capacity planning: Cost calculation error“.


Cost calculation only calculates the machine costs; unlike capacity planning, it does not reserve
machine capacities.

To implement this function, run the database scripts 20110811a.sql and 20110812a.sql and allocate
the new status points 990 „Capacity planning: Cost calculation“ and 991 „Capacity planning: Cost
calculation error“ to the corresponding user status in status allocation. Now enter the formula
„Workflow_CostCalculationOffers.txt“ as a workflow task in the ALFK Interface Service. The COM
object abcreceive44.exe /abcreceive45.exe on the AIS computer must at least have version
'Patchday September 2011'.
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




14.8. Capacity information by customer
First, enter in master data the maximum production capacity in sqm, per weekday and product
type. The data are entered in master data, in „Company – Company data“ on tab „13. Production“
in table „Total capacities“. If no entries are made, there will be no validity check at the end of order
entry.




                                                                                                    620
                                                            Fig. 268: Total capacity




621
A+W Software GmbH - Configuration A+W Business - INTERNAL
For all customers to be analysed separately (normally, the top customers or key customers), a
reserved production capacity (in sqm) is entered in customer management, per product type and
weekday. The corresponding table is found in customer management, tab „9. Production“.




Fig. 269: Reserved production capacity

At the end of item entry, the capacities of the top customers are checked against the actual order
data. If violations are detected for key customers or NON-key customers, the system issues a
message and comes up with the overview. The fields that can cause production bottlenecks, are
marked red.
To get an idea of the use of production capacity, open the menu „Functions – Capacity info by
customer“ in the order header.
Only articles with supply types cutting, production, and stock withdrawal with cutting will be
checked. The system only checks the main items, not the bills of material!
                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                              622
15.Production data collection (barcoding)
15.1. Introduction
Online shop floor data collection via barcode scanner is done by a Windows-CE based scanner
supplied by Datalogic (Scorpio). The actual program runs on a terminal server which connects with
the scanner via remote desktop. The scanner sends all registered data to the currently active data
field as keyboard entries.
To make sure that the barcoding program starts automatically when the scanner is registered at
the terminal server, you need to copy a link to the barcoding program for the user to an autostart
group. The program to be linked is called abcscanner.exe and is found in the Alfak program directory
(e.g. C:\Program Files\A+W\ALFAK 2011\Program\German). Before starting the program, the Alfak
start program must be run once on the computer, and the correct database connection must be
entered in the login dialog. From that point on, the program will always connect to the database
using the actual information.
The automatic start up of the program can be set by means of a configuration program (A+W
Business 5 Scanner AutoStart Config) in the start menu ConfigTools from A+W Business 5.5 update
3 in the start menu Config Tools. In this program the scanner program (language dependent) can
be selected for the currently registered user so that the program is started whenever the user logs
in.




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                623
15.2. Settings

           Scanner
The scanner can be configured on any terminal. First, install the configuration software that comes
with the scanner on a PC, then connect the scanner via USB. Now start the configuration software
(Datalogic Configuration Utility). In the program, first set Postamble im Menü Hw Configuration >
Laser > Parameters > Reader Parameters > Text Formatting. Just enter a tabulator. There are two
ways of entering the tabulator. You can either enter a tabulator in an editor (e.g. Notepad or Word)
and copy it to the data field by copy and paste. Alternatively, press the ALT key, and keep pressing
it while entering on the number block the digits 0 0 9 before releasing the ALT key.
At the end of every scan, a [TAB] will be sent to the barcoding program to signalise that this barcode
has been registered.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 270: Completeness of barcode reading




                                                                                                  624
The second and last setting is CheckEvaluation in menu Hw Configuration > Laser > Parameters >
Reader Parameters > Code39 > Standard. This must be set to Enabled so that the check digits of the
Code39 barcodes will be checked instead of being sent to the program as valid data.




Fig. 271: Code39 settings

When all settings have been made, they can be transferred to the scanner. Select menu item
Configuration > Send to Device to transfer all settings.
Alternatively, you can load the configuration file installed by the Setup/Auto-Update using the
configuration program, and transfer it to the scanner. This configuration file (Datalogic Skorpio
Configuration ALFAK BDE.cfg) includes all necessary settings and is found in the Config directory of
the Alfak installation (e.g. C:\Program Files\A+W\Alfak 2011\Config\Datalogic Scanner
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Configuration).




           Master Data
The corresponding registration point type has to be entered in master data, in Production > Shop
floor registration points in column 'barcode type'. This is required for the receipt of goods and for
completion reports.


                                                                                                 625
Fig. 272: Enter registration point

If the registration point has been clearly allocated to the barcode type (in the above illustration e.g.
for receipt of goods), the user does not have to register the registration point at the scanner if the
corresponding program point is selected.




                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




In user management, you need to enter the personnel numbers of the users who are going to
register with the scanner by means of their personnel barcode.




                                                                                                    626
Fig. 273: User management – User settings - Barcode for scanner


           Interface Service
To book completion reports via scanner, the registered completion reports are buffered in the
database before being processed by AIS. To make sure that AIS can assign these bookings, it is
necessary to define the entity name of AIS as „sysadm“. This is default after installation. This setting
must be checked if more than one entity of AIS is installed.




                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




           Capacity planning
If completion reports are to be booked in Alfak capacity planning, a unique registration point must
be entered for the machine in question. This is done in machine management, in Capacity planning



                                                                                                    627
> Master data > Organization > Machines. The work type to be used is always registered via
barcode.




Fig. 274: Machine allocation for registration point




                                                                                             A+W Software GmbH - Configuration A+W Business - INTERNAL




15.3. Functions
The individual barcoding dialogs and their function are listed below.


                                                                                       628
           Login
Scans can be made only after the user has scanned his personnel barcode.




Fig. 275: Barcoding – Registration via employee barcode

After the user has registered successfully, the program proceeds to the main menu. From there you
can go to the corresponding dialogs to enter receipt of goods, inventory bookings, rack load, or
completion reports.




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 276: Barcoding - Main menu


           Receipt of goods
Scan the barcodes of the purchased items for which goods have been received.



                                                                                              629
Fig. 277: Barcoding - Receipt of goods

When the purchased item's barcode has been scanned, enter the quantity received (via keyboard).
The program shows the full quantity for the purchased item by default; this has to be changed only
if the quantity received is different. If no change is necessary, scan the barcode of the next
purchased item. The program will collect these scans without actually booking them. This is only
done if you press the ENTER key on the scanner or scan the barcode of another P.O. If you press
the BACK key or the ESC key while there are purchased items in the memory which have not been
booked so far, the program wil want to know whether these shall be booked now.
If the just scanned P.O. item is a box, you can scan a box ID barcode right afterwards and change
the contents of the box if necessary. The program automatically enters a quantity of 1 piece which
cannot be changed. For boxes with an ID you can enter different contents.
After a purchased item has been scanned, the bottom quantity field shows the number of articles
ordered, and the number of articles received.


                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




           Completion and breakage report
The production reports are found in the production report sub-menu, which replaces the previous
completion report in the scanner main menu.




                                                                                              630
Fig. 278 Production report menu



The completion report dialog can be used to change the status of an order item. All scans which are
made here are first saved in the database then processed by AIS as STSD reports. Status changes of
orders will be made afterwards. For details on configuring the AIS for STSD reports please refer to
chapter 3.5 Produktionsrückmeldung.




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 279: Barcoding - Completion report

When an order item has been scanned, enter the quantity to be reported complete. The program
will always preset the full item quantity. Press ENTER to save the completion report. The record is
then processed by AIS, and the order status is amended if necessary. If only one piece is to be
processed per scan, you can select the option "Quantity=1". If this option is enabled, when scanning



                                                                                                631
a barcode 1 piece is immediately booked as complete. No additional quantity has to be entered nor
the enter button pressed.


The breakage report dialog can be used to change the status of orders, but only negatively, in
contrast to the completion report.




Fig. 280 BDE breakage report

Operating and booking work in the same way as the completion report, but it is possible to include
the breakage reason and creator. These can be selected either by pressing the button on the
scanner or by using the barcode. The barcodes can be printed out in the programs complaint reason
and creator using the labels form.
After booking a record, the information on the last booking is shown as a summary on the scanner.

          Stock booking
Before starting an inventory booking, please define whether goods shall be added or withdrawn. In
addition, the menu for boxes is accessible from here.                                                A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                              632
Fig. 281: PDC – Stock movement




                                       A+W Software GmbH - Configuration A+W Business - INTERNAL



Fig. 282: PDC- Incoming stock




                                 633
Fig. 283: PDC - Outgoing stock

The next dialog works the same way for incoming and outgoing stock. After the stock location
barcode has been read, the stock article bar code can be read and the respective quantity entered
for the incoming or outgoing booking. By pressing the ENTER key, the booking is made directly.

         15.3.4.1.       Transfer
Under the stock movement menu element, there is now also the function transfer. If you select it,
you must first scan a stock location bar code.




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 284: PDC - Select stock location




                                                                                              634
After that, you land on the dialog for transferring stock items. Here the user must scan a stock item,
that is, the stockID of a stock item, whereupon the current inventory is displayed. Now you should
first define the quantity that should be transferred.




Fig. 285: PDC - Transferring stock item



Here the user can specify a new stock location and make the booking.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 286: PDC - Successful transfer




                                                                                                  635
       15.3.4.2.    Boxes




Starting with version 12.5, there is also a Boxes submenu available. With this menu, you can call
the following five functions:
   1. Remove sheets
      Use this function to reduce the sheet count in a box. For this, first a box bar code is
      scanned, and after that, the quantity displayed is set to the new value. By pressing the




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




       ENTER key, the booking is made.


   2. Decomposing boxes
      With this function you can decompose a box (that is, the box is deleted and the remaining
      sheets are booked to stock). For this, first a box is scanned and after that, its content can
      be edited. By pressing the ENTER key, the booking is made.




                                                                                                 636
3. Change stock location of boxes
   You can use this function to change the stock location of a box. For this, first a box is
   scanned and after that, the bar code of the new storage location is entered. The booking




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




    is then triggered immediately.


4. Put box on inventory list
   Use this function to place a box on the current inventory list. After the box has been
   scanned, the new storage location can be scanned. After both scans have been
   completed, the current quantity of the sheets in the box can still be edited. By pressing




                                                                                               637
    the ENTER key, the booking is made.




5. Outgoing Goods Box
   With this function, boxes with ident number can be assigned to an order item. Initially, an
   order item barcode must be scanned. After that, the number of lites in the box is
   determined by scanning the box barcode. It can be edited accordingly. By pressing the
   ENTER key, the booking is made.


                                                                                                 A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                           638
         Racks
In order for racks to be able to be processed, the following conditions have to be checked
beforehand:
   1. Rack numbers have to be unique. You can therefore not create a rack with the same
      number but a different rack type. If the same number is used, a letter should precede the
      rack number (for the rack type).
   2. When booking racks, the width and the height of the rack is checked and the loading
      weight is checked. These values can be adjusted per rack type.
   3. Rack booking was developed for shipping, i.e. only main items can be added to a rack.
   4. The only racks that can be loaded are those which are not booked for off site, have not
      been reported lost and are not locked.
   5. Point 5 ensures that the allocation of the rack is fully backed at rack exit.




Starting with version 6 there is also a rack submenu available. With this menu, you can call the
following three functions:


   1. Loading
                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                             639
For leading racks, the rack to be loaded first has to be selected. When scanning the rack
barcode, you can add the order item to the rack in the next dialog:




                                                                                              A+W Software GmbH - Configuration A+W Business - INTERNAL




After the successful selection of a rack, you can add the order item to the rack. Two
different modes are supported hereby, those with the buttons "Quantity = 1" and "Input
quantity". The currently set mode is highlighted in green.

The T2 bar code must be used to add order items.



In the mode "Input quantity" after the item barcode has been scanned, the quantity that
has not yet ben loaded onto the racks is shown. This can then be edited if a smaller
number is to be loaded. Pressing the enter button on the scanner confirms the booking.



                                                                                        640
   In the mode "Quantity = 1", the booking is executed directly after scanning the order item
   barcode. Only 1 piece is booked hereby.



   The result of the last booking is always shown in the window "Last booking".



   To exchange the racks, press the Back button and then select a different rack.

2. Emptying




   With this dialog, a rack can be reported empty. In this process, all allocations of the order
   items placed on the rack before are deleted. WARNING: There is no security query!!!

3. Display
                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                             641
         With this dialog, the current allocation of order items on a rack can be displayed. If a rack
         barcode is scanned, the order items with the respective loaded quantity are shown in the
         allocation window. In addition, the customer number is also output. The list contains six
         entries. You can browse with the forward and backward button.

           Miscellaneous
The menu Miscellaneous includes the dialogs for order item information, registration information,
and change of user. When an item barcode has been scanned, order item information will show the
item name, item size, quantity, quantity delivered, price per price unit, and the delivery date.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 287: Barcoding - Order item information




                                                                                                  642
The 'change user' dialog is explained in chapter 13.3.1 Anmelden. After scanning a valid user code,
the present user will be signed out, and the new user registered.
The registration information dialog shows the currently registered user, the database, the database
system (Microsoft SQL Server or Unify SQL Base), the registration point, the machine, and the work
type.




Fig. 288: Barcoding- Login information


15.4. Barcodes
The individual dialogs and functions require certain barcodes. These are Code39 barcodes with
check digit, with an asterisk at the start and at the end.
Personnel barcode
Prefix: PE
User data: The personnel number as per user management
Example: *PE000000199F*
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Registration point barcode without work type for goods received
Prefix: RP
User data: Registration point ID
Example: *ES00000000166*
Registration point barcode and work type for completion report
Prefix: EA
User data: Registration point ID and work type ID separated by a hyphen
Example: *EA0000000015-101P


                                                                                               643
Order bar code for reporting finished and sheet-rack assignment
Prefix: T2
User data: Order number + item number (3-digit) + element number (3-digit)
Example: *T200000243001001%*
Order barcode for order information
Prefix: D2 or Präfix: T2
User data: Order number + item number (3-digit) + element number (3-digit) (only T2)
Example: *D200000243002Q* or *T200000243002001Q*


P.O. barcode for receipt of goods
Prefix: D5
User data: P.O. number + item number (3-digit)
Example: *D50000070650001.*
Box barcode for stock additions and withdrawals
Prefix: BO
User data: Box ID. Attention: ID must not start by zero!
Example: *BOBC00002H*


Warehouse barcode for inventory booking
Prefix: LA
User data: Warehouse ID
Example: *LA0000000001W* or *L0000000001W*


Stock article barcode for inventory booking
Prefix: LP
                                                                                             A+W Software GmbH - Configuration A+W Business - INTERNAL



User data: Stock article ID
Example: *LP0000000164E*


Rack number
Prefix: GE
User data: Rack number
Example: *GE9099E*


Reason for complaint


                                                                                       644
Prefix: BR
User data: Number of reason of complaint
Example: *BR1$*


Cause of complaint
Prefix: BC
User data: Number of cause of complaint
Example: *BC2P*




                                                 A+W Software GmbH - Configuration A+W Business - INTERNAL




                                           645
          Printing barcodes

In the following programs in A+W Business, a barcode printing functionality was implemented for
the online plant data recording (via barcode scanner):In the following programs in A+W Business, a
barcode printing functionality was implemented for the online plant data recording (via barcode
scanner):
    1. Employee management (Master data>Company>Employees)
    2. Registration point in production (e.g. Master data>Production>Other>Registration points
       production)
    3. Default time (Capacity planning>Master data>Default times>Default times)
    4. Print program (e.g. Documents>Order>Print order)
    5. Stock definition (Master data>Stock>Stock definition)
    6. Stock management (Stock management>Inventory management)
    7. Racks (Production > Rack management > Racks)
    8. Reason of complaint (Master Data > Products > General > Complaint Reason)
    9. Cause of complaint (Master Data > Products > General > Complaint Cause)
If the useful data does not exceed the possible data length, the barcodes are filled up with zeros (0)
(except rack barcodes). Furthermore, all barcodes received a final test digit. A general print
functionality was also installed in the employee management (1). The barcodes contain the
personnel number (here 199) of the employee (example: PE000000199F). The registration point
barcode (2) is formed from the ID of the registration point (example: ES00000000166). In the
default times program (3), the user now has the opportunity to print a registration point barcode
with work type for the completion report in the online PDC. This is composed of the ID of the
registration point and the ID of the work type separated by a hyphen (example: EA0000000015-
101P). The print program for the form printing (4) can print an order barcode (order info in online
PDC) or a purchase order barcode (incoming goods in online PDC), effective immediately. This
barcode includes the document number, the 3-digit item number, and a 3-digit part number (always
000 since only main items are output here) (example order T200000243002000Q – example
purchase order: D50000070650001.). For the stock booking in the PDC, the stock location must be
scanned accordingly. For this, on the one hand the barcode printing on the stock definition dialog
(5) was reworked and on the other hand, the online PDC was expanded. Effective immediately, the
online PDC can process such storage location barcodes with an L-prefix. The barcode includes the
ID of the storage location (example: *L0000000001W*). Then, barcodes of the stock items (5) are
necessary for the stock booking. In the stock management, the appropriate barcodes, which include
the ID of the stock item, can now be printed (example: LP0000000164E). For racks, a list of racks
can be selected in rack management (7) and then printed for this barcode (Functions > Print Rack
Barcode). As the racks are alphanumeric, they are not filled with leading zeros.
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




Note: All bar codes are written to the report variable F_IDENT_C39 of the respective form/report.


15.5. Booking history
It is now possible to protocol the implemented completion and breakage reports. The switch "fill
history table for completion reports" must be activated in the company master data on register 15.
Capacity planning to activate the function.
If the switch has been activated, the edited reports are recorded in the table FS_BOOK_HISTORY. If
the booking is active in the A+W Business capacity planning, the reports will also be recorded when
booked in the same way. This also applies for reports performed via the dialog in A+W Business.
Otherwise the bookings are recorded in PD_AWBAR.

                                                                                                  646
The following data is hereby saved
    •    Order number
    •    Item number
    •    BOM element
    •    Time of scanning
    •    Mitarbeiter
    •    Registration point
    •    Work type (only for booking in capacity planning, otherwise 0)
    •    Breakage reason (only for breakage reports)
    •    Cause of breakage (only for breakage reports)
    •    Booked quantity
    •    Origin (BDE, manual, implicit)


Furthermore, there is an dialog on analysis of the booking history (Statistics > Booking history). Now
the records to be displayed can be filtered via the QBE mode so that precise statistics, e.g. per
employee, can be created.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 289 Booking history

By pressing, the displayed records can also be grouped according to two dynamic criteria, which
can also be set in the dialog.




                                                                                                  647
16.A+W CAD Designer (Shapes)
16.1. Print dimensioned sketches
Settings for the sketch size, fonts, etc. can be made in forms management of ALFAK Release 3.3.




Fig. 290: Formula management - sketches

The settings can be made for print item 544 - Shape sketches on a separate DIN-A4 sheet, and for
sketches in the form (print items 100-499).
Attention: In Releases 3.1 and 3.2, the ALFAK2000 setup program used to copy an SN.INI file
automatically. This INI file contained settings to optimize the printout of sketches. However, these
settings prevent those in Release 3.3 (see above) from becoming effective.
As from 27.1.03, this INI file is no longer distributed by the setup; for all 3.3 installations before that
date, the INI file must be corrected on the workstation as follows:
DRAWINGEDGEZvmStyle = "TName = "Arial"; TScaleType = 1; TSize = 0.03; TColor = RGB(0,0,255);
                                                                                                              A+W Software GmbH - Configuration A+W Business - INTERNAL



TBkColor = RGB(255,255,255); TULine = 0; TBold = 0; TItalic = 0; TCharSet = 0; TPFamily = 0;
TWorldText = 1; LType = 0; LWidth = 1; LColor = RGB(0,0,255);"
Should the setup directory on the ALFAK server still contain an SNI.INI, this has to be deleted.


16.2. Copy SN files
With release 3.3, ALFAK2000 order entry allows to create SN files automatically.
We need to distinguish:




                                                                                                       648
           Rectangles and standard shapes:




Fig. 291: Create SN file name


Press button        to automatically create a serial number with suffix *.SN. The numbers are
managed in number areas, per production area. The file will be saved in the directory defined for
SN catalogue tables. The file will be updated whenever an item is saved.
Files created by Shaping & Nesting cannot be allocated (alpha-numerical file name).




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                              649
            Shape 99 (free shape, Shaping Nesting file):




Fig. 292: Assign available SN file




Fig. 293: SN file directory                                                                               A+W Software GmbH - Configuration A+W Business - INTERNAL



Button         allows t o select a file created by Shaping & Nesting, to be allocated to an order item.
This file will not be changed by ALFAK.
ALFAK can print true-to-scale sketches for these files.




                                                                                                   650
           Shape 98 (shape based on template):




Fig. 294: SN - Shape 98

Enter a block name if required.
ALFAK cannot print a sketch of course.


16.3. Edge processing via SN4
The edgework quality could not defined up to version 3.3.144 (28.01.2003). This means that all
edgework (arrissing, grinding, polishing) is shown as „edge polishing“, and saved as such in the SN
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL



files. This means that all edgework (arrissing, grinding, polishing) is shown as „edge polishing“, and
saved as such in the SN files. This would entail a database change which cannot be done in 3.3.
Therefore, an INI file was created in which the edge quality can be entered. For an example file, see
program directory \\Program\\German\\edge.ini
[EdgeClass]
9100=8
9300=10
9400=11
The structure of the entries is =
Edge quality: 8=arrissing, 10=bevelling, 11=polishing


                                                                                                  651
This file should therefore contain all edgework matching to these qualities. This guarantees the
correct interaction of ALFAK and SN4.
If this file has not been created, or if a processing is missing, the sketch reads “polishing”. When
you create an SN file and the edge quality is missing, creation of this file is stopped.
From version 3.4, the edge quality will be part of product master data.
Sketch view now checks whether an edge includes more than one type of edgework, in which case
no sketch/file will be created. This check is made only if the edge quality is known.


16.4. Bug Fixes
Degenerated shapes (segments are missing) are now shown correctly.
Edge and corner cut-outs are now shown as separate contours, and do no longer cause cutting
errors.
These functions require SN version 4.04 which is part of the ALFAK setup since 18th December 2002.


16.5. Handling of notches and cut-outs in SN4
Until version 3.3.171 (06.03.2003), the edgework quality for the above processings could not be
defined. The quality for a product can now be entered in Edge.ini. Default, if no entry is made, is
“arrissing”
<ALFAK2000 3.3>\Program\German\edge.ini
[EdgeClass]
9100=8
9300=10
9400=11
The structure of the entries is =
Edge quality: 8=arrissing, 10=bevelling, 11=polishing
This file should therefore contain all edgework matching to these qualities. This guarantees the
correct interaction of ALFAK and SN4.
If this file has not been created, or if a processing is missing, the sketch reads “polishing”. When
you create an SN file and the edge quality is missing, creation of this file is stopped.
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




SN 4.04.01 must be installed to use this function.
ATTENTION: The function (introduced in SN 4.04) to create the above processings as individual con-
tours, can only be guaranteed in SN 4.04.01.




                                                                                                652
16.6. Template input

           Prerequisite
In SN4, you need to create a file that contains additional sizes and other parameters. Please make
sure that the names of the normal additional sizes are kept. Width should remain ‚W' and height,
‚H'. This is necessary to ensure that shape input can transfer the parameters from ALFAK to SN4
and back.
The template file name must start with a ‚T_'. Parameter that shall not be shown in ALFAK, must
start with _ . These are internal variables.

           Procedure
Defining the SN file in product master data.




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 295: SN file in product master data




                                                                                               653
Fig. 296: Change Template file name

You need to use the shape view for order entry; this changes the template file name (serial number
+ ‚_T.SN').
The parameters from the SN file cannot be read at present.




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 297: Shape sketch




                                                                                               654
16.7. Automatic Variables for Template Input
Template input now offers a new feature, Automatic Variables. These variables have to be created
in the SN file, and have to start with a double underscore. Follows the product number of the
processing that serves as the source for the values. Separated by underscore, enter the n-th variant
of this product. Last, enter the parameter number of the value.
Example:
__9610_03_02
  |   | |
                  |     | +--- Parameter index, starting with 0
                  |     +--- n-th variant of the processing below the glass to be processed
  +--- Product number of processing step




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 298: Edit SN variables




                                                                                                655
Use of parameters, per processing type:

         Drilled hole
Parameter 00 - X value 1. hole
Parameter 01 - Y value 1. hole
Parameter 02 - D value 1. hole
Parameter 03 - X value 2. hole
Parameter 04 - Y value 2. hole
Parameter 05 - D value 2nd hole
Parameter 06 - X value 3rd hole
Parameter 07 - Y value 3rd hole
Parameter 08 - D value 3rd hole
Parameter 09 - X value 4th hole
Parameter 10 - Y value 4th hole
Parameter 11 - D value 4th hole

         Edge cut-out
Parameter 00-07- Edge number
Parameter 08 - Width of notch
Parameter 09 - Height of notch
Parameter 18 - Distance of notch
If, except for the additional shape sizes, the template contains only automatic variables, you can
save it without opening the sketch view. If there are other variables, these have to be entered in
the sketch view.
Variable names are suppressed in the SN sketch by means of SN.INI
SuppressExpressionsInDrawingViews = 1 in section [View]                                              A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                              656
16.8. Other essential SN.INI settings
StandardShapeResolution = 1/64 or 0.1 in case of rounding problems


16.9. Settings in EDGE.INI
Edge.INI allows to control the color depth of Shaping+Nesting.
[Shapes]
SNView=DRAWINGTARGETPRODUCT
Colorbits=4
SNView: DRAWINGTARGETPRODUCT or DRAWINGEDGE
Colorbits: 1, 2, 4 depending on the color depth, 1 meaning black&white


16.10.         24 Bit color depth and RDP 6.1
To display the sketches on a white background, the terminal server must be set to a color depth of
24 Bit. The clients have to be able to handle RDP 6.1 and ask for a color depth of 24 Bit.


16.11.         Configuration of the page view
Which SN.INI is active can be determined with the Config Tool for the CAD Designer (Shapes) Config.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               657
The depiction of the side view is activated via SN.ini, section PICTURE.
General
ShowProfile = 1
ProfileFontSize = 12
ProfileFontType = ARIAL
ProfileWidthInPercent = 20
ProfileHeightInPercent = 20
Foils
ShowProfileFoil = 1
Coating/Pattern
The display of coating/structure for single glass (glass for which the side view is not generated
automatically) must be activated via the SN.ini, PICTURE section:
ShowProfileCoating = 1
ShowProfileStructure = 1


The side view is only generated if
1) The steps are available or
2) Drilled holes are in place and the SN.INI key [Picture] ShowProfileDrilling is 1 or
3) Countersunk holes are in place and the SN.INI key [Picture] ShowProfileCounterSinking is 1 or
4) Certain surface processings are there and one of the following keys is enabled:
    [Picture] ShowProfileSurface is set to 1 or
    [Picture] ShowProfileCoating is set to 1 (appears to come from CoatingVector) or
    [Picture] ShowProfileStructure is set to 1 (appears to come from CoatingVector) or
5) Bevels or miters are in place and SN.INI key
    [Picture] ShowProfileMitr is set to 1 or
6) Surface processings from the AW processing catalog are there
                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




   (FrostingSurface, CoatingSurface, AreaStripping, SandBlastingSurface, ColorinfSurface,
EnamelingSurface, SilkingSurface, HandleSurface, GroovingSurface, Masking, Stamp, Logo)



16.12.            Turning shapes
Starting with Version 13.4.50, shapes can be entered turned. Here, the following issues must be
heeded:
The turning is only available for the view in the shape/processing entry and printing. The shape
does not count as turned for the production.


                                                                                               658
The shapes are transmitted unturned to production and via the EDI interface. During export, the
structure is turned (horizontal-> vertical, vertical -> horizontal) if the shape was turned by 90 or 270
degrees.
The checking of the maximum dimension (order size, stock size) will also be turned for width and
height for the case that the structure side is turned.
For start-up, the database script 20170927a.sql must be run (note archive scripts!). In addition, the
turning of shapes in the master data on the tab 4. Documents must be activated.
Caution: The ERP Webservice and the Production manager (AWB Pro) must be up-to-date;
otherwise there may be misproduction!
The version of the ERP Webservice must be at least 13.4.689.
The Production Manager must be at least Version 13.4.692.


16.13.          Processings on shape 99
Starting with version 13.0 it is possible to add manually created SN files and template processings
to imported DXF files. At present, drill holes and edge processings are supported.
The new behavior must be activated in the company master data in tab "System":




                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




If this option is not active, the system works like before, i.e. processings that are added to the BOM
will not be transferred into the SN drawing.




                                                                                                    659
If this option is active, drill holes and edge processings are always sent to SN and then displayed in
the sketch.




For processings please note:
Edge processings: Here you can enter all edges, or none. Selection of concrete edges is not possible.
Drillings: For drillings, only dimensioning for circumscribing rectangle can be selected.


16.14.           New DXF import starting with version 6
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




There is a new dialog available for DXF files, which can be started during the shape/processing
entry. The new dialog should allow that more DXF files can be imported into the A+W CAD Designer
without manual reprocessing.

The dialog offers better possibilities for

    •   Filtering DXF data
    •   Detecting features
    •   Setting options



                                                                                                  660
There is a preview of the DXF file. It is possible to select by levels (Layer) and colors (color index).
For this, a list of the existing levels and colors is displayed. The preview shows the currently-selected
objects.




After the selection, there is a detection of the objects. Especially the automatic detection of edge
and corner cutouts has been improved. The exterior contour is taken apart into a convex base shape
(that can be cut) and additional cutouts. Cutouts that are depicted by dotted lines within the
exterior shape are recognized.

Furthermore, options for the import can be set. This especially affects processings that may not be
depicted clearly in the DXF. For holes it is possible to select whether they should be sunk. The sink
depth and angle can be specified by the user. It is also possible to make the sinking only for holes
that are depicted with several concentric circles.                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                     661
Roundings in the exterior shape are recognized as processings. A limit radius can be specified. All
roundings with larger radius are assigned to the base shape, all roundings with smaller radius are
evaluated as processings. Thus a rectangle with rounded corners can be imported as rectangle with
processing round corner or as shape 75 of the A+W shape catalog.

For cutouts, additional rounding radii and an edge quality can be added.

The new DXF dialog offers no opportunity to select and manipulate individual object, that is, to shift
or delete a particular line or sink one hole and another not. For this, it is still necessary to import
the file with the A+W CAD Designer.


16.15.          Horizontal display of the dimensioning
There are only drawing improvements in the horizontal dimensioning type of the CAD. For this, the
following
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                   662
area User of the SN.ini is configured:
AdvancedDimensionPositioning = 1

Drilling diameter and radius dimension for narrow shapesDimensions for the diameter of
drillings and dimensions that display the radii of curvature of arcs are displayed inside the outer
shape by default. This minimizes overlap with the linear position dimensions in the outer area of
the shape.For narrow shapes this concept is not always ideal. For narrow shapes, now the drilling
diameter is pulled to the outside so that overlaps are minimized. The association is indicated by a
line between drilling and dimension text. The linear position dimensions are placed appropriately
further to the outside. Radii for narrow shapes are combined if necessary so that there is no
overlap generated between the texts.

Horizontal alignment radius
Dimensions for the curvature of arcs can now be aligned horizontally. This increases legibility and
reduces overlaps. These dimensions can also be moved more freely.

Prevention of overlaps
The reduction of text overlaps has been improved. This affects the prevention of overlaps
between drilling dimensions as well as the prevention of overlaps between drilling diameters and
radii. For this, the texts are automatically pulled away from one another.

The new functionality is configured using a switch in the User area of the SN.ini:
AdvancedDimensionPositioning                                =                                1
The default value is 0, thus the program behavior does not change. With the setting
AdvancedDimensionPositioning =1 all improvements described here become active. In addition, we
point out the already-existing switch ZVMTextKeepHorizontal = 1, which forces a horizontal
alignment of labels with segments.


16.16.          Places after the decimal point for iTOE and DXF import
In order to restrict the number of places after the decimal point for DXF and iTOW, the following
value must be changed in the SN.INI
Section [Locale] that configures SN.ini :
MetricDecimalPlaces = 1
Restricts the places after the decimal point to one place


16.17.          Shape rotation in the iTOE and DXF import
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




The shape rotation of standard shapes has to be disabled with use of the iTOE since the
processing parameterization of X/Y coordinates and reference points is not adjusted and thus
would cause an incorrect calculation. Shapes with significant waste are rotated so that this is
minimal, but then they no longer arrive as standard shapes, but as free shapes. This means that
there are restrictions with regard to the processings.
Area [DXFImport] that configures SN.ini :
ConsiderRotatedShapes = 0
Restricts the rotation of the shapes




                                                                                                 663
16.18.          Case examples for mounting types in the iTOE
The storing of the iTOE rules has been expanded to include the mounting type.
For activation, the "Control of the processing mounting" must be activated in the "Company
parameters->10. System->A+W CAD Designer (Shapes)". With this, the mounting types in the iTOE
are active and the header part representatives can be queried.

                Header part representatives as commercial processing
The iTOE can now decide with its rules about where the processing should be applied. Thus, it can
be necessary that a corner cut-out is applied production-technically to the TG glass of a LAMI, but
commercially it must be calculated on the LAMI. For this, red BOM elements are now inserted;
these are only important for the CAD to include the data. They are similar to the disbanded blue
production BOMs, but have negative BOM_MASTER_IDs. They themselves cannot be changed.




Here the last rule decides about the takeover of the header part representatives if the reporting of
the CAD incl. header part representation is done, but this only happens for complex glass, LAMI
with TGH.

                Shift of the processing to sub-lites
The second case is the shift of the processing from the header part to the sub-lites, since the
processing should be calculated on the sub-lites. This is only possible if the CAD gives the Business
the corresponding degree of freedom (processing mode=3). Here, the processing, which is reported
by the iTOE on the header part is shifted to the individual lites (duplicated), the header processing
is deleted.
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 664
The priority of the rules is decisive. In the case of LAMI, the processing is shifted to the individual
lites (last rule, priority 53)
In the TGH and single lite area, by contrast, it remains on the main item. Rules 1 and 2 are also
important for the repeated call of the iTOE, for then the processing must remain on the TGH, this
rule must have a higher priority!

                CAD decides
This mode represents the previously existing mode. Here, the CAD decides where the processing is
adjusted. This corresponds to the technical circumstances.


16.19.          Processing restrictions
In A+W Business, restrictions for processings can be stored on the level of product type/product
group. These generally apply only to restrictions on annealed glass (TGH/annealed glass) since it
includes physical limit situations that are caused by the annealing. A check of the restrictions is
done only for TGH/annealed glass.
Whereby also float glass distance restrictions can very well make sense. Which restriction is
checked when can only be defined by the CAD.



16.20.          DXF import conversion of the dimensions
                                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




The DXF file includes dimensions; these must be converted into the appropriate dimension
system. This can either be done interactively on the import dialog or via a general setting in the
SN.INI. For the US customers (Imperial database), this setting is mandatory.
Area [DXFImport] of the SN.ini configured:

MeasurementsInMM = 0
0=conversion in inches
1=dimension in mm




                                                                                                     665
17.Miscellaneous
17.1. Euro conversion

With the introduction of the Euro, ALFAK2000 has to be converted to Euro as the main currency.
All prices, documents, and statistics will be converted to Euro. This can be done via module ‚EURO
Conversion'. The following section describes the necessary entries. First, we would like to describe
the two conversion modes - it is essential that these are understood because the success of the
conversion depends on this.
Convert price master data into Euro
This option is used to convert the prices that exist in home currency (e.g. DM), to Euro. Foreign
currencies will be kept.
This option is useful with regards to the deadline 01.01.2002 because prices cannot be entered in
DM as this becomes a foreign currency.
Entry in foreign currency
In this case, all price master data are kept in the original currency; only transaction data and
statistics will be converted. Every customer will be converted to input in foreign currency so that
prices can be entered in foreign currency (DM).
This option is most useful for a conversion before 01.01.2002 as nothing changes with regards to
the customers (they still get invoices in DM ).
The new function of entering foreign currency values for customers (can be set in customer master
data) allows a step-by-step introduction of the Euro and new price lists per customer.
The conversion to Euro should be done on a database copy first so that the customer or A+W can
check the effects of the Euro conversion. It is difficult to foresee all possible problems.
Attention:The database including archives must be saved prior to the actual conversion; during the
conversion, no user must access the database.
Module description:
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                666
1. Step “basic settings”:




        Fig. 299: Euro conversion 1

   •    Conversion mode: Please select a conversion mode as described above.
   •    Present home currency: This is the present currency defined in system master data.
        Attention: this will become Euro when the conversion is started once more. It must be
        reset to the original home currency, DM.
    •   Currency code for Euro: Select the existing Euro sign, or enter a new one.
    •   Euro rate: Enter the Euro rate to be used for conversion.
    •   Database server name: Enter the name of the database server to allow the program to
        search for archived databases.




                                                                                                A+W Software GmbH - Configuration A+W Business - INTERNAL




        Fig. 300: Euro conversion 2



                                                                                          667
After entering all data, use ‚Continue` to go on.
2. Step: Currency table:
You can check the currency table prior to conversion.
Afterwards, the factors are set to Euro as the home currency.
3. Step: Currency -> basic prices:




        Fig. 301: Euro conversion 3

Enter the present currency for the individual prices; this is necessary to make sure that existing Euro
price lists are not converted again. Purchase prices have to be tagged additionally in column PP
because these have to be converted also when you use option 2 “Input in FC”.
4. Step: Currency -> group prices:
See description on step 3 – this is valid for group prices too.
5. Step: Euro conversion
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                   668
Fig. 302: Euro conversion 4

You can define the individual actions to be taken (considering the settings). This allows to convert
the data step by step (e.g. without archives). For an average customer database without archives,
you should reckon with 3 hours ( 2000 orders, quotations, purchase orders).
When you start the program again, please make sure to change the settings on tab 1 as the basic
conversion to Euro has been made already.
The conversion is complete only after all products have been handled even if these are not strictly
required in case of option 2




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                669
General thoughts:
Customer forms have to be adapted after the conversion.
The following illustration shows the contents of the columns sales price, purchase price, and
foreign currency:
Version 1
Current status                              Status after conversion
Home currency customer
SA           PU           FC                      SA       PU         FC
HC           HC           HC                      Euro     Euro       HC


Foreign currency customer

SA           PU           FC                      SA       PU         FC
HC           HC           FC                      Euro     Euro       FC


The home currency (HC) will be lost!


Customer master
Input in foreign/home currency


Version 2
Current status                              Status after conversion
Home currency customer

SA           PU           FC                      SA       PU         FC
HC           HC           HC                      Euro     Euro       HC


Foreign currency customer
SA           PU           FC                      SA       PU         FC
                                                                                                A+W Software GmbH - Configuration A+W Business - INTERNAL




HC           HC           FC                      Euro     Euro       FC


The home currency (HC) will be lost!


Customer master
Input after conversion only in foreign currency




                                                                                          670
17.2. Extended CommonBase in ALFAK and ERP elements
So far, all settings for the ERP Webservice, B2B service, and BMECat master data import were
managed in the CommonBase. Aim of the development was to integrate the Commonbase switches
into ALFAK company parameters.
ERP Webservice 2011 – adoption of the existing CommonBase switches
After installing the ERP-Webservice 2011, Version PatchDay September 2010 or higher, please
proceed as follows:
 Installed module           Switch
   ALCIM Capacity           all switches for the report remain in Commonbase
 Planning 2009
 ALCIM      Capacity        the switches for the report have to be imported from CommonBase into
 Planning 2011              ALFAK company management,
                            the switches for the ALFAK database have to be kept in ALCIM
 AWPort                     the switches for the ALFAK report remain in Commonbase
 Outlook                    the switches for the integration settings have to be moved from
 Integration                Commonbase to ALFAK company management,
                            the switches for the ALFAK report remain in Commonbase
 AWRack                     all switches remain in Commonbase
 BizTalk link               the switches for the ALFAK report remain in Commonbase
Tab. 61: Procedure CommonBase

ALCIM Capacity Planning 2011
Old: Settings switch in CommonBase




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 303: New: Setting switch in ALFAK




                                                                                              671
Fig. 304: Old: Database switch in CommonBase




                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 305: New: Switch in ALCIM 1




                                               672
Fig. 306: New: Switch in ALCIM 2




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 307: Client number ALCIM

Please note: the client number has not been necessary so far. After conversion of the switches to
the ALFAK database, the number from company data is entered here; it defines the ALFAK client.




                                                                                              673
Fig. 308: Client number ALFAK

Outlook Integration:




                                              A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 309: Old: Switches in CommonBase




                                        674
The right “Read all contacts” must be set!




Fig. 310: ALCIM




                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 311: New: Switch in ALFAK



                                             675
Important:
After installing the ERP Webservice 2011, the switches for ALCIM Capacity Planning or Outlook
Integration have to be adopted from Commonbase to ALFAK company management. The programs
AWPort and the BizTalk link have no additional switches in Commonbase.
The methods for OpenTrans and BmeCat have been removed from ERP Webservice and are now
directly integrated in the programs.
B2B service:
Automatic purchasing for Dorma and the export of invoices, delivery notifications, and order
confirmations in openTrans format are now issued by the ALFAK Interface Service.Automatic
purchasing for Dorma and the export of invoices, delivery notifications, and order confirmations in
openTrans format are now issued by the ALFAK Interface Service. To activate the function, enable
the Option Interface Service handles B2B documents in the Interface Service configuration program.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 312: B2B- Service

Existing B2B services have to be uninstalled. Installing the B2B service for ALFAK anew is forbidden.
Installing the ERP Webservice only for openTrans is no longer necessary.




                                                                                                 676
Fig. 313: Old: Switches in CommonBase 1




Fig. 314: Old: Switches in CommonBase 2
                                                A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 315: Old: Switches in CommonBase 3


                                          677
Fig. 316: New: Switch in ALFAK

OpenTrans import tool
The import pool no longer uses any Commonbase switches. The connection parameters for the
ALFAK database have to be entered once, and will be saved, user-related, in the Windows
registration.
BMECat
The import of products from Dorma, Kl-Megla, and Schlechtendahl (BMECat) is a separate program
from ALFAK 4.4.276 on which can be selected from the ALFAK start menu. The settings for the
program are loaded from ALFAK company master data.
If there are several clients, please make sure that the settings for the client of the current user are
loaded. It is therefore necessary in this case to start ALFAK on a user restricted to the client.
To set up the program, the following switches have to be transferred from CommonBase to ALFAK
company master data:
1. Dorma
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL



For importing Dorma products, the following switches from Enterprise B2B have to be transferred
to ALFAK company master data. The entries in the numbered fields in the first image have to be
transferred to the numbered fields of the second image. Fields which are no longer used, can be
ignored.




                                                                                                   678
Fig. 317: BMECat 1




                                                                                              A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 318: BMECat 2

If BMECat is downloaded from the Dorma website, the data of the Dorma Webservice have to be
entered in ALFAK. These data match the data for Dorma purchase orders.




                                                                                        679
                                             Fig. 320: BMECat 4
                                                                  Fig. 319: BMECat 3




680
A+W Software GmbH - Configuration A+W Business - INTERNAL
2. Kl-Megla
For importing Kl-Megla products, the following switches from Enterprise B2B have to be transferred
to ALFAK company master data. The entries in the numbered fields in the first image have to be
transferred to the numbered fields of the second image. Fields which are no longer used, can be
ignored.




Fig. 321: Kl-Megla 1




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 322: Kl-Megla 2



                                                                                              681
3. Schlechtendahl
For importing Schlechtendahl products, the following switches from Enterprise B2B have to be
transferred to ALFAK company master data. The entries in the numbered fields in the first image
have to be transferred to the numbered fields of the second image. Fields which are no longer used,
can be ignored.




Fig. 323: Schlechtendahl 1




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 324: Schlechtendahl 2



                                                                                               682
17.3. English table views
The English table views are part of the scripts AWV_sqlbase.sql (for Unify SQLBase) and
AWV_sqlserver.sql (for Microsoft SQLServer). The two scripts are found in directory
..\\Programme\\A+W\\ALFAK 2009\\Cmd\\ of the ALFAK installation path. The corresponding view
script will be run automatically on the database when script management is executed.
In case of a database update, please note that apart from the update scripts, the view script must
be updated as well before starting the database update. Otherwise, it may happen that old views
cannot be used any longer, or SQL errors can occur.
To make sure that the database documentation matches the views and the new database structures
, these have to be updated too. The database info tool is found in directory
..\\Programme\\A+W\\ALFAK 2009\\dbinfo\\.


17.4. Convert thickness from Inch to mm

Requirements
Please run a database backup prior to the conversion; the conversion is irreversible.
Before or after the conversion, the thickness (Imperial/metric) must be manually set to „metric“ in
system parameters.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 325: Thickness conversion - Company settings

Procedure
The conversion program can be found in system utilities.



                                                                                               683
First, enter the database server name to find out which archiving databases exist. Then select the
databases to be converted.




Fig. 326: Thickness conversion– Utilities 1




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               684
Go to the second tab to view all thicknesses found in the databases. This may take some time.




Fig. 327: Thickness conversion– Utilities 2

You can now adapt the mm values and save your entries. This is done by pressing the button ‚Save`.
Use ‚Update' to search again for all thicknesses, and reject your entries. Use the ‚Delete' button to
delete the temporarily created table in which the thicknesses were saved. This should be done after
the conversion, to delete it.
After correcting the thicknesses, use button ‚Convert thickness' to perform the conversion.
The system will only convert thicknesses; they will not be recalculated based on the BOM elements.
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




17.5. Copy documents between two databases
Entry in ABCStart.ini:
[User Settings]
CopyDB= BAUMAIN;GWOMAIN
Afterwards, these databases can be selected from the combo box of the copy program. Also, the
system shows the database you are logged into.




                                                                                                 685
17.6. Spacer Text
The spacer text can be entered in the product, and refers to the standard text.
If only a number shall be transferred for the customer, the number must be entered in the standard
text.
You can of course also transfer the entire text, including dummies.
Dummies:
<pn> = Product number
<p1> = Product name 1
<p2> = Sheet structure
<g> = Gas
<cn> = Customer number
<c1> = Customer name 1
<pd> = Production date
<no> = Order number/item
<wh> = Size
<ab> = Spacer name, abbreviated
<vsg> = Laminated glass, abbreviated
<esg> = Toughened glass, abbreviated
<kp> = Customer item
<br> = Width, without leading zero or blank
<ho> = Height, without leading zero or blank
<an> = Order number, without leading zero or blank
<ps> = Item number, without leading zero or blank
<po> = Item number with leading zeros, 3digit
<ak> = Spacer code
<vs> = Laminated glass name
                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




<sn> = Key number
<gt> = Quality text


<@Formulanumber@> = execute a formula with this number = formula number


e.g. :   „<c1> <p1> <p2> <wh> <no>“
Output: John+Partner Standard IG FL4/18/ORN528 540x1030 109384/001
For P.O. transfer, there is also:
<kk> = Customer reference

                                                                                              686
17.7. Processing text
The field Description 3 is of crucial importance for processing steps at document entry. Enter a
processing text including variables. The variables change depending on the processing parameters.
See the following explanations.
The following variables are valid for the creation of processing text. The notation of the variables is
compulsory:
<%> or <5>...    Quantity (edges, drill holes, corner cut-outs, ...)
<$>     or <4>...        Main parameters (diameter, radius, width, height)
<§>    or <3>...         Supplementary parameters (which edges, corners; x, y, d in case of drilled
holes)
<=>     or <0>... calculated r. m. of processing calculated lin.m. of processing
<?>     or <1>... calculated sqm. of processing calculated sqm. of processing
<&> or <6>...    Distance of corner cut-outs
<@Formulanumber@> = execute a formula with this number = formula number
Below are some examples for the application of variables:
Description         3     in       Products         Description        in       Processing      Dialog

Item entry
1.      <%> edges [<§>] with mitre 45° polished (<=> lin.m.)                2 edges [2/3] with mitre
45° polished (2.45 lin.m.).
As from Version 4.2, the mitre angle can also be printed via description dummy <$>
2.      Sawing of <%> edges *<§>*                                  Sawing of 3 edges *2/3/4*
3.      <%> Hole(s) d = <$> mm                             2 holes, d = 20 mm
4.      <%> Hole(s) x/y/D in mm [<§>] 200, 200, 16                 2 holes x/y/D in mm [100, 100, 25-
5.      <%> x <$> mm Rounded corner [<§>]                                   4 x 15 mm Rounded
corner [1/2/3/4]
6.      <$> Corner cut-outs / <%> pcs./ [<§>]                      100 x 75 Corner cut-outs / 2 pcs.
/ [3/4]
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




17.8. Predefined password
If you do not want to preset the password in the login dialog, the following entry must be made in
abcstart.ini:
Section :       [Database] (already exists)
PresetPassword=0
This forces the user to enter his password at every login.




                                                                                                   687
17.9. Licence management

Creating a license file ( abccode.key ) and updating the user licenses
Create a new license file by means of the program „abcdongle.exe“. Before you start the program,
please make sure that there is a link with the customer dongle; otherwise, the license file cannot
be read at their end. After the program was started, you will see a list of the available ALFAK
modules and (if applicable) the number of user licenses defined in the dongle.
Now tag the modules to be released and enter the number of user licenses in field „No. of users in
key file“. Then fill in the fields „Valid until“ and „Version“. Save the license file by clicking on OK, or
use menu „Save file“.
To change an existing license file, load it into the program and amend as required. Save as described
above.
To render the changed license file valid at the customer's end, just copy the file onto the server,
and update the software on the client PC. If you want to change the number of user licenses in the
dongle as well, you have to start license management on the customer's workstation or server.
License management is part of the Utility program of ALFAK2000 but must not be started via the
ALFAK2000 start program in this case You have to start program „abcutil.exe in the program
directory of ALFAK2000. Now load the new license file and transfer the number of users from the
license file to the dongle via button „No. of users“ in the group box. After this, the computer on
which the dongle is installed (usually the NT server) must be rebooted!


17.10.           Registration and unregistration of COM objects
From version 3.1 onwards, ALFAK 2000 uses COM objects. These objects are normally registered
via setup. To be able to register them again should the registration via setup be unsuccessful, we
will describe the manual procedure below.
Manual registration / unregistration of the dongle COM object „abclogin.exe“
From version 3.1, the dongle is accessed via the COM object „abclogin.exe“. Should you get an error
message when you try to access the dongle, the reason may be an unregistered or wrongly
registered COM object. For manual registration, start the MS-DOS input command. Then switch to
the program directory of ALFAK2000 and enter:
C:\\Programme\\ALFAK2000\\Program\\German>abclogin /regserver
                                                                                                              A+W Software GmbH - Configuration A+W Business - INTERNAL



For unregistration, use the command:
C:\\Programme\\ALFAK2000\\Program\\German\\abclogin /unregserver
The COM object consists of the files .exe and abclogin.tlb which are found in the program directory
of ALFAK2000.



17.11.           Dispatch - referencing/rack allocation

Initializing the rack allocation table


                                                                                                       688
From release 3.1.067 on, rack allocations will no longer be saved with the item, but in a separate
database table (purpose: an item can be packed onto different racks). To make sure that existing
rack information is transferred to this table, you have to load the „Initialise“ function after an
update, for all customers who are using referencing!
Also, you need to make sure that order entry and production have been updated to this version.
Rack transfer in connection with referencing
The reason for this program amendment is a request by Teutoglas who split one order to several
lines, and reunite it later on.
This is a new function which is enabled by defining rack groups (attention: must be licensed) via
Production/rack management.
The rack group is preset from customer base date when a new item is entered.
Prerequisite for t he automatic allocation is that one of those rack groups is selected on item level
(tab 7), this is not a surcharge item (product type = 10), and that no manual or automatic allocation
has been made yet.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 328: Consignment

The reference dialog (Production/Dispatch) offers the new buttons Rack groups and Pass on to item
in the top right section. If no rack groups are defined, both buttons are disabled.
The item table below includes a new column, Rack group. This can be switched on or off. This way,
it is invisible for users who do not need this function.
When you select a number manager and press the button Rack groups, the rack group (see above)
will be determined for the item of the selected order; the system will then use the sorting criteria
(shipping date customer, etc.) to find out whether other items - even from older orders - match


                                                                                                 689
these, and if a rack group number has already been entered for those. If this is not the case, a new
number will be created and allocated.
Manual input and amendment of the table is possible, too. Valid are any, max. 5-digit numbers.
The last assigned number will always be proposed for the next item if no number has been entered
for this. allows to pass on the last entered number to all other items of the current order.
Based on allocation or amendment, a ‚Manual amendment flag‘ is set (from Vers. 4.1 onwards;
Vers. 4.0 only checks if there is a number over zero). These values will not be changed through
automatic allocation.
Numbers can be allocated only until the order status lies below the lock status for transfer to
production.
If there are numbers still missing, these will be allocated at transfer to production. The rack group
number is added to the interface file in Release 2.3, in record type 2, field 98 (from position 912).


17.12.   Transfer to statistics, archiving, and deletion of
   documents(old)
General
From version 3.2, the functions: transfer to statistics, archiving, and deletion of documents are
united in one COM object (ABCPROCESS32.DLL).
Registration/unregistration of this COM object is automatically done via ALFAK setup / software
update, but can be done manually should there be an error (see
section "Registration of COM objects).
Manual transfer
Nothing changes in the program operation; the documents will be processed in the background via
ABCPROCESS32.DLL.
Automatic transfer
Automatically starting the processing via program ABCEODAY.EXE is not necessary since this
module is no longer part of the version, and was replaced by a VB script or a BAT file (containing
this script):
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 690
VB-SKRIPT "AUTO_EODAY.VBS"

   '...
   sINI = "C:\WIN\ABCSTART.INI"
   sCONNECT = "INT32;DENDRES;DENDRES"
   nMANDANT = 1
   sDISPLAYNAME = "Dieter Endres"
   sADDRESS = "de@a-w.de"
   sSUBJECT = "Protokoll Statistikübergabe/Archivierung/Löschung"
   sSUPPORT_DISPLAYNAME = "Dieter Endres"
   sSUPPORT_ADDRESS = "de@a-w.de"
   sSUPPORT_SUBJECT = "Fehlermeldung Statistikübergabe/Archivierung/Löschung"
   'Art der Ausgabe:
   '1 = Outlook Express e-Mail, 2 = Textdatei, 3 = modale Meldungsbox, 4 = WORD-Datei, 5 =
   EXCEL-Datei, 6 = Outlook
   nEVENTMODE = 2
   sDATEI = "C:\PROTOKOLL.TXT"
   SDATEI_WORD = "C:\PROTOKOLL.DOC"
   sDATEI_EXCEL = "C:\PROTOKOLL.XLS"
   'soll die WORD- oder EXCEL-Datei ausgedruckt werden?

To adapt this script, just adapt the entries for
                         1.      sINI              = location of the INI file
                         2.      sCONNECT          = database, user, and login password
                         3.      nMANDANT          = 1 for single client database, otherwise client
                         4.      sDISPLAYNAME = name of recipient
                         5.      sADDRESS                  = email address of recipient
                         6.      sSUBJECT                  = email reference line
                                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL




                         7.      sSUPPORT_DISPLAYNAME               = recipient name (support)
                         8.      sSUPPORT_ADDRESS                   = email address of support
                         9.      sSUPPORT_SUBJECT                   = email reference line
                         10.     nEVENTMODE                         == report type
                         11.     sDATEI                             = file name for report 2
                         12.     sDATEI_WORD                        = file name for report 4
                         13.     sDATEI_EXCEL                       = file name for report 5
                         14.     bPRINT                             = printout of WORD/EXCEL file
to the customer environment.

                                                                                                      691
All other allocations are standard, and do not need to be changed.
Entries 4-6 identify the user to be informed about the result of the transfer/archiving by email.
Entries 7-9 name a member of the support/project team. This person will be informed about severe
problems (no database connection, error when creating or initializing the COM object).
Entry 10 nEVENTMODE defines the way in which the user is informed about the result of archiv-
ing/transfer. There are six ways of doing this:
    •    Outlook Express email
    •    Text-file
    •    Modal message box
    •    WORD document
    •    EXCEL document
    •    Outlook email
The actual processing (via function Obj.AutoTransfer ) is split onto the five document types
QUOTATION, ENQUIRY, ORDER, P.O., and CREDIT NOTE so that the transfer can be handled flexibly.
A document type can be excluded by setting an inverted comma at the start of the script line.
This script can be started via BAT file (AUTO_EODAY.BAT).
BAT-DATEI "AUTO_EODAY.BAT"

  WSCRIPT.EXE "AUTO_EODAY.VBS"


Prerequisite for using VB scripts is the installation of WINDOWS SCRIPTING HOST on the system, as
WSCRIPT.EXE in System32 directory of NT, or in the Windows directory of 9x/ME.
Reconstruct statistics from utilities
Statistics are reconstructed via COM object "ABCPROCESS32.DLL"
Error message "Error when creating the COM object (transfer to statistics)"
The system could not create an instance of the COM object "ABCPROCESS32.DLL"; please check
whether this is already/still registered and re-register is necessary.
Triggering of events
The sixth and last parameter of function "AutoTransfer" is used by the VB script to define whether
the COM object shall trigger so-called EVENTS to the loading application.
If this parameter reads TRUE, processing errors and the successful termination of the entire process
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




will be reported to the VB script.
Section "event handling" of the script defines the reaction to such an event:
Normally, a message box appears showing the error or success message.


17.13.            Archiving and deleting of documents
An order is entered; a reference P.O. is created by transfer to purchasing. The P.O. is processed and
shall be transferred to archives, to be deleted afterwards (transfer to archives: Archiving and
deletion options are set).
1. Possibility:   the order is kept only in the main database


                                                                                                    692
Result:           the P.O. will just be archived, NOT deleted.
2. Possibility:   the order is kept in the main database and in archives
Result:           the P.O. will be archived and deleted; the order will be deleted as well.
This means a process (order including reference P.O.s) will always be completely deleted if all
related documents and references have been transferred to archives.
Deletion is released by the last document transferred to archives.


17.14.            Export ALFAKTrösch Controlling

Detailed information:
\\Hausi\BUG\Kunden\SCHWABENGLAS_VERWALTUNGS_GMBH_ULM_DONAUTAL\anford
erungen+fehler\Troesch_Controlling\Installationshinweise-ALFAK-Trösch.doc

17.15.     Adapt the script for statistics and transfer to archives
   after updating to a higher ALFAK2000 version
Procedure:
VB scripts for automatic transfer to statistics and archives (AUTO_EODAY.VBS) have to be adapted
after an update to a higher ALFAK2000 version. Please check whether database, connect and Ini file
are still correct.
Also, the start of the COM objects ("ComMon32.Monitor.1" and "abcProcess32.CCTransfer") have
to be replaced by the appropriate ALFAK2000 version.
Example for an update from 3.2 to 3.4:
"abcProcess32.CCTransfer"  "abcProcess34.CCTransfer"
"ComMon32.Monitor.1"  "ComMon34.Monitor.1"


17.16.            Japanese version
Toolbar position
                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL



In ALFAK, the toolbar position can be changed by the following setting in the INI file.
Negative values will move the toolbar upwards.
[User Settings]
ToolbarShiftY = -0,5




                                                                                              693
17.17.             Changing the report fonts

Motivation
For Eastern Europe and Asia, the report fonts have to be changed; this is the only way to display
the characters correctly. So far, this meant that several hundred reports had to be changed. This
was very time-consuming.This was very time-consuming. We have now created a tool that allows
to automate this procedure.
Description
The program is found in \\Jupiter\alfak_install\Tools\abcReportFontxxx.exe.




Fig. 329: Report fonts
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL



After the directory was selected, report files will appear in the list box on the right. Tag these, and
select the new fonts. Just press Execute to change the fonts in all reports.
Please save the reports first as the originals will be changed.


17.18.             Interface demon

Ini file settings for active production time management
When the interface demon is installed and the customer uses production time management, you
should open the relevant ini file (usually, abcBatch.ini) before you start the interface demon for the
first time, and search for section [Time management].

                                                                                                   694
These parameters also control the start of the time management functions during the processing
of report files, etc.
The most important parameter is ALCIMP0. You should enter 1 there if time management ist active,
and you want to switch to the time management routines. If you enter 0, the report will not be
processed in time management (e.g. if time management is inactive). 0 is the default setting.
Parameter ALCIMP5 defines the ALCIM report status at which a completion report shall be made.
ALCIMP5 should be 700 by default.
Parameter ALCIMP6 defines the Alcim report status at which a breakage report shall be made.
ALCIMP6 should be 350 by default.
Currently, reports concerning time management are only made via STSD (completion report) and
STSB (breakage report) files.
These parameters do not distinguish STSD and STSB files. The reported ALCIM status will release
the completion and breakage messages in ALFAK.


17.19.          Script management /Update from 3.1 or 3.2 to 4.1
The two scripts dated 11.10.2001 and 3.5.2004 must not be run directly after another in case of a
database update.
After running the first script, archives must be updated before running the second one.
Otherwise, running the script dated 3.5.2004 will delete the basis (field Eil_Zuschlag) for the
archives script dated 11.10.2001.


17.20.   Script management - documentation on tables and
   columns
A characteristic of the ALF database is that after the database update, script management will check
whether there are tables or columns without documentation. If this is the case, these will be
collected in a table in a special dialog. Documentation can be added. If you want o edit just one
table, selection can be restricted accordingly. Fields without entry remain empty. All fields without
entry will remain blank.


17.21.          Changing the user registration in version 4.1
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Terminal server installations no longer allow to find out which user is running certain statements
on the database. The reason is that Alfak checks the user name and the password, but registers in
the database as user „Alfak“. The surface of SQL-Base shows the same client node and the same
user for everyone. This makes identification impossible.
Therefore, a conversion program (abcdbuserconv.exe) now enters the logical Alfak users in the
database. All new programs from Patch 4.1.120 dated 19.05.2005 will use this user (created by the
conversion program) to register at the database.
This means that you need to run the conversion program, always, before installing a new program
at a customer's!
Old programs can still be used after conversion. There is no user distinction in terminal server
installations, however.

                                                                                                 695
To convert the data, just start the program abcdbuserconv.exe. Since the program will change the
data structure, no user must be logged in.
The      program       is     found      in     the      Alfak      program       file     directory
\\jupiter\ALFAK_inst_ver\4.1.xxx\_German\Program\German\abcdbuserconv.exe . The
conversion can be done only by the system administrator. Use the OK button to create the database
users.
The users will not be converted again. The program will execute this action only once.
During conversion, abcstamm.exe must be updated because the new logic is necessary to create a
user.
In all databases with different passwords for the user SYSADM for ALFAK and for the database, the
ALFAK password for SYSADM will be changed to the physical database password. This makes it
necessary to amend the end-of-day scripts (archiving).
There is no difference between ALFAK and database password for SYSADM.
Changing the passwords for SYSADM via script is possible only with the following script.
\\Jupiter\ALFAK_Install\SQL-Skripte\Password_SYSADM.sql




17.22.          AWDoor (doorart) as from ALFAK2006
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




Installation of AWDoor is part of the standard ALFAK installation. The following files are required:
doorart_module.dll, dbxoodbc.dll, midas.dll and LicRequest.exe.
For the database connection, an ODBC DSN has to be created, with a link to the main database. The
DSN name has to be entered in company parameters.




                                                                                                 696
Fig. 330: AWDoor - Company data

All this is done by the setup during installation!




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




Licensing is done in two places. AWDoor must be activate as an A+W module in the dongle (program
77). Moreover, you have to ask the manufacturer for a license file for every terminal to be equipped
with AWDoor. Start the program LicRequest.exe on the PC, and email the resulting file to
jmarko@sgp.sk. Copy the license file to the Windows directory.




                                                                                                697
Fig. 331: AWDoor - Product management

For input, create an article of the product type 100-GGA. If this is entered in document entry,
button




Fig. 332: AWDoor - Document entry

ALT+F3 is active. From there, the user can access glass door entry.
Basis for AWDoor is a Dorma article database with AWDoor extension.




                                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 333: AWDoor – GGA entry



                                                                                            698
AWDoor data are managed via Master data/Products. You can enter technical information, with a
reference to the product supplement GGA Material. You have to create a record for every fitting in
GGA Material. This is automatically done at Dorma article import. The AWDoor extension file is
part of the Dorma article import. Updates versions are available from the manufacturer of AWDoor.
eMail contact: see above. eMail contact: see above.


17.23.           Contribution margin analysis
The contribution margin analysis allows to check and print for any period the contribution margin
of order items.
The order items can be restricted by means of various filters.
You can choose
         1. without restriction
         2. contribution margin over a maximum value
         3. contribution margin below a minimum value
         4. contribution margin over a maximum value and below a minimum value
         5. contribution margin within a user-defined area
as filters.
The individual filters can be switched after selection of items.
Minimum and maximum contribution margins are kept in master data and are defined per
customer and product group.
For customer/product group combinations that have not been defined there, the settings for
default contribution margins apply which are made in company master data, tab Calculation.


17.24.           Monitoring of changes
ALFAK now allows to monitor all amendments made in customer/supplier management, price
management, discount management, and in the order- and quotation headers.
The corresponding dialogs have been completed by the menu entries History for this purpose. You
can make the necessary settings there and view the analysis if the history has been enabled for this
dialog.
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




These settings define – for all dialog tables involved – whether the table shall be monitored not at
all, monitored completely, or by field (detailed). You can also change the table name at this point.
If monitoring has been enabled for a table, a second table shows all fields of this table. You can
now change the field names. These names will be used to create analysis later on. If the table is
monitored by field (setting detailed in table properties), another column allows to define the fields
that shall trigger the monitoring. The two Selection buttons allow to enable all columns, or none.
The key columns of the corresponding table are used to identify various amendments If the key
fields are reference fields, the column refers to shows the table this column refers to.
Column Display column allows to set for the reference table whether apart from the key value, a
name for the key value shall be shown. If this is required, the column to be displayed has to be set
in the combo box.

                                                                                                 699
When the settings have been made, you have to redefine the database triggers for monitoring. This
can be done manually (recommended) or automatically when you close the dialog. This process can
take some time.
If amendment monitoring has been enabled for a dialog, you can select menu Analysis after
starting the dialog again.
The following dialog allows to restrict the selection. Depending on the mode of the dialog to be
monitored at the time the analysis dialog is opened, you can select Current record, current
selection, or All.
The actual selection depends on the dialog to be monitored. Generally, current record always
shows the record selected in the main table of the dialog to be monitored.
Current selection shows a selection by number manager or by the criteria defined in the QBE
mode.
All shows all modified records in the selected table.
Please note: In some dialogs (discount management, price management), dialogs have different
runtime modes and will access different database tables. Both the settings and the analysis in menu
History ALWAYS refer to the currently set runtime mode. An example for this is price management
where standard prices, customer prices, customer group prices, etc. are managed.
Apart from a restriction of the selection, you can apply various filters. You can limit the analysis to
a certain employee or a certain period. You can also display all changes without the corresponding
details. To achieve this, disable the checkbox Show details.
Price management offers an additional function:
The dialog can show old prices. The tool bar will display a combo box if there is an old price for the
current record.
To use this additional function, you have to set all price tables to complete in the amendment
monitoring settings. You cannot monitor price tables by field. To use this additional function, you
have to set all price tables to complete in the amendment monitoring settings. You cannot monitor
price tables by field.
To define the settings for all available tables, we have added a new menu, Amendment
monitoring – management in Utilities -> System. This menu brings you to the settings dialog
where you will only see the tables available for monitoring.
Amendment monitoring requires the installation of the latest PTF for the corresponding database
engine.
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                   700
701
A+W Software GmbH - Configuration A+W Business - INTERNAL
17.25.            Hotkeys for Document Recording

The table below documents the hotkeys that can be used to access particular functions from the
ribbon more quickly in the document recording. Since these hotkeys change depending on the
active tab, they are grouped per active dialog (header data, items, shapes, etc.). Under the General
entry are hotkeys that are not assigned buttons on the ribbon and thus can only be reached using
the keyboard.


With active "Header data" tab:
General:
<F9> : Change to "Items" tab


"Start" ribbon:
<ESC> : Start "Close window"
<F1> : Start "Help"
<F5> : Start "First data record"
<F6> : Start "Previous data record"
<F7> : Start "Next data record"
<F8> : Start "Last data record"
<CTRL> + <N> : Start "New"
<CTRL> + <L> : Start "Delete"
<CTRL> + <S> : Start "Save"
<SHIFT> + <CTRL> + <M>: general form printing
<SHIFT> + <CTRL> + <V>: print dimensioned sketch
<SHIFT> + <CTRL> + <K>: direct printing
                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




"View" ribbon:
<SHIFT> + <CTRL> + <D> : "Display document" view
<SHIFT> + <CTRL> + <C> : "Customer info" view
<CTRL> + <B> : "Production overview" view


"Functions" ribbon:
<F11> : "Change view" functions
<SHIFT> + <CTRL> + <F12> : "Document data" functions

                                                                                                702
<SHIFT> + <CTRL> + <F11> : "Storage search" functions
<SHIFT> + <CTRL> + <A> : "Stock preview" functions
<SHIFT> + <CTRL> + <I> : "Article info" functions
<SHIFT> + <CTRL> + <W> : "Display duplicates" functions
<SHIFT> + <CTRL> + <S> : "Status change" functions
<CTRL> + <H> : "History" functions
<CTRL> + <O> : "OP query" functions
<CTRL> + <D> : "Copy document" functions
<CTRL> + <T> : "Part delivery overview" functions
<CTRL> + <G> : "Complaint overview" functions
<CTRL> + <J> : "Payment overview" functions
<CTRL> + <I> : "Order/PO info" functions
<CTRL> + <U> : "Cost and surcharge calculation" functions


"Communication" ribbon:
<CTRL> + <F> : "Fax message" communication
<CTRL> + <M> : "Post management" communication


With active "Items" tab:
General:


<F9> : Change to the "Shapes/processings' tab in the shape entry mode
<F10> : Change to the "Muntins" tab
<F11> : Change to the "Shapes/processings" tab in the processing entry mode


"Start" ribbon:
                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL



<ESC> : Start "Close window" (change to Totals tab)
<F1> : Start "Help"
<F3> : Start "Storage search“
<F5> : Start "First data record"
<F6> : Start "Previous data record"
<F7> : Start "Next data record"
<F8> : Start "Last data record"
<F12> : Start of the "Insurance prices" dialog
<CTRL> + <N> : Start "New"


                                                                              703
<CTRL> + <L> : Start "Delete"
<CTRL> + <S> : Start "Save"
<SHIFT> + <F4> : Start of the SN Editor


"View" ribbon:
<F2> : Switch the display for prices view (EK, VK, FW, Euro)
<SHIFT> + <CTRL> + <K> : "Conditions" view
<SHIFT> + <CTRL> + <D> : "Display document" view
<SHIFT> + <CTRL> + <C> : "Customer info" view




"Functions" ribbon:
<SHIFT> + <F12> : "Change blocked item" functions
<SHIFT> + <CTRL> + <S> : "Quick query" functions
<SHIFT> + <CTRL> + <R> : "Complaints" functions
<SHIFT> + <CTRL> + <V> : "Delete item specifications" functions
<SHIFT> + <CTRL> + <L> : "Delete BOM item specifications" functions
<SHIFT> + <CTRL> + <P> : "Delete item price specifications" functions
<SHIFT> + <CTRL> + <T> : "Transfer price specifications to the following items" functions
<SHIFT> + <CTRL> + <Y> : "Copy from item..." functions
<SHIFT> + <CTRL> + <F10> : "Price recorder" function
<CTRL> + <Y> : "Start price calculation" functions
<SHIFT> + <CTRL> + <F11> : "Reason for manual price specification" functions
<SHIFT> + <CTRL> + <I> : "Article info" functions
<CTRL> + <K> : "Start price calculation" functions
                                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL



"Options" ribbon:
<CTRL> + <Q> : "Quantity input for current item" options
<SHIFT> + <CTRL> + <O> : "No back calculation of the automatic surcharges" options


"Structure" ribbon:
<SHIFT> + <F1> : Structure "1st lite"
<SHIFT> + <F2> : Structure "2nd lite"
<SHIFT> + <F3> : Structure "3rd lite"
<CTRL> + <F1> : Structure coating "1st lite


                                                                                            704
<CTRL> + <F2> : Structure coating "2nd lite
<CTRL> + <F3> : Structure coating "3rd lite
<CTRL> + <Y> : Structure macro "Search"


"Communication" ribbon:
<CTRL> + <F> : "Fax message" communication
<CTRL> + <M> : "Post management" communication


With active "Shapes/processings" tab


"Start" ribbon:
<ESC> : Start "Close window" (change to 1st item tab)
<F1> : Start "Help"
<F5> : Start "First data record"
<F6> : Start "Previous data record"
<F7> : Start "Next data record"
<F8> : Start "Last data record"
<CTRL> + <N> : Start "New"
<CTRL> + <L> : Start "Delete"
<CTRL> + <S> : Start "Save"


"View" ribbon:
<F2> : Switch the display for prices view (EK, VK, FW, Euro)
<SHIFT>+<CTRL>+B : Layout Standard
<SHIFT>+<CTRL>+E : Zoom layout sketch
<SHIFT>+<CTRL>+F : Layout without BOM
                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL



<SHIFT>+<CTRL>+G : Layout BOM bottom right


With active "Muntins" tab:


"Start" ribbon:
<ESC> : Start "Close window" (change to 1st item tab)
<F1> : Start "Help"
<CTRL> + <S> : Start "Save"




                                                               705
"View" ribbon:
<F2> : Switch the display for prices view (EK, VK, FW, Euro)


"Options" ribbon:
<CTRL> + <Q> : "Drill point symmetrical" options
<CTRL> + <W> : "Field symmetrical" options
<CTRL> + <E> : "Drill point asymmetrical" options
<CTRL> + <R> : "Field asymmetrical" options



17.26.           Colored item lines in the item recording




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




The various colors of the item lines have the following meanings:
Gray = the color designates the first identification type of a group of several items.
Beige = the color designates the second identification type of a group of several items.
Orange =         the item is an alternative item for another item included in the        screen table.




For two or more groups in the screen table, the colors gray and beige are always displayed in
alternation so they are more visible.


                                                                                                   706
17.27.         Performance measurement in document entry

From A+W Business 5 SP5 Build 1343 and SP4 Build 1340, it is possible to conduct performance
measurements in document entry. A+W Business creates entries in the regular AWB Trace and for
certain actions, and shows the required time in milliseconds. To do so, for document entry simply
set the trace level to Info and then perform the action to be measured in the corresponding
program.




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




The times for the following actions are measured in document entry:
•   Start of document entry from the menu until the completion of header entry.
        o Trace: PERFORMANCE: Document entry started. [Runtime]: xxx msec



                                                                                              707
•   Change to item tab.
       o Trace: PERFORMANCE: Tab changed to items. [Starts]: x [Runtime]: xxx msec

•   Change from one item to the next. It is important to always place the mouse in the first
    editable data field and to always click in this column only (usually the product field)
        o Trace: PERFORMANCE: New line item selected. m_nDocType = 2, m_nID = 599387,
            m_nPOS_NR = 2, g_bDeadlock = 0 [Runtime]: xxx msec

•   Recalculation of the item and update of all values on the mask. (e.g. enter quantity and press
    TAB)
       o Trace: PERFORMANCE: Item refreshed. m_nDocType = 2, m_nID = 599387, m_nPOS_NR
            = 3, g_bDeadlock = 0 [Runtime]: xxx msec

•   Start shape/processing entry.
        o Trace: PERFORMANCE: Tab changed to shapes/processings. [Starts]: x [Runtime]: xxx
            msec

•   Start Georgian bar entry.
        o Trace: PERFORMANCE: Tab changed to bars. [Starts]: x [Runtime]: xxx msec

•   Finalize a document. (Recalculate special discount, update history and status)
        o Trace: PERFORMANCE: Document finalized. [Runtime]: xxx msec

•   Time for change to totals tab. This also always includes the time to finalize the document.
       o Trace: PERFORMANCE: Tab changed to totals. [Starts]: x [Runtime]: xxx msec


For analysis and a better overview, the program is used from the infrastructure services.
In order to just see the performance measurements, click the filter button in the Message column,
select the combobox "Start with" and enter "PERFORMANCE" as text. Then simply click on "Filter".
Now you can see the required time in Traces for the above actions in milliseconds. The number of
dialog starts is also shown for some entries.



                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  708
17.28.         Configuration Europool

With the setup of the Europool interface, rack data and customer data are to be sent to Europool.
For this you need formula, triggers and setup as planned task. For this you need formula, triggers
and setup as planned task.
Formulas
With all formulas, it is important that the data for the customer number and the file paths in the
formula is adjusted correspondingly to the customer system. The formulas for SQLBase and
SQLServer databases are identical. There is a
a)     formula for racks/orders
b)     formula for transfer of all customers
c)     formula for transfer of new/changed customers
Triggers
The triggers must be set up with different scripts for SQLBase and SQLServer databases. They
cannot be included in the migration, they have to be recreated via script. There are triggers for
racks (order data) and triggers for customers.
The formulas and triggers can be found in the directory of A+W Business:
Example: C:\Program Files (x86)\A+W\ALFAK 2012\Formula
Setup of customizing
Customizing for customer data should take place once a day for instance, whereby the workflow
                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL



for order data should be processed every 2.5 hours:




                                                                                              709
Miscellaneous
                                                                                 A+W Software GmbH - Configuration A+W Business - INTERNAL



          •     Adapt ftp.ftp file (login, password of rack pool, paths)




                                                                           710
           •   Adjust cmd file (paths)




The files can be found in the formula – directory of A+W Business:
6.     Path, enter where the rar.exe is in the environment variable or copy rar.exe to the Windows
       directory.
7.     Call CMD file per planned task: every x minutes




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                              711
18.Integration A+W Sharepoint DMS
18.1. Master data / utilities

The functionality must be activated at the beginning in the company master data (Master
data>Company>Company data) on the 4.Documents tab. Only then can the user execute and use
the functions described in the next section.




Fig. 334: Company management – activate archiving system

On tab 12.Print the printer for the repeated printing with respect to the document archiving must
be set.



                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                              712
Fig. 335: Company management – printer for archiving system

For the initialization of the archiving system (Utilities>System>Initialize archiving system) a program
for work preparation has been developed. The following three functionalities are supported:


1. Prepare documents:
With the Prepare documents function, it is possible to transfer all documents present in the
customer database, such as orders, invoices or credits into a transfer table. Thus it is possible, for
example, to execute database queries in A+W Sharepoint DMS. If the function was already called,
a message was output whether the user would like to prepare the documents again.


2.Activate archiving trigger
In case of a change of documents (new creation or document change), the database triggers fill the
transfer table. The triggers can be activated via the function. By default, they are deactivated via
database script. If the function was already called, the background text changes to Deactivate
archiving trigger.


3.Transfer declarations of performance
So that all declarations of performance stored in the customer system are also recognized in the
archive system, it is possible to execute Transfer declarations of performance. Thus the declarations
of performance that are defined in the database are copied to a separate directory. This separate
directory must be defined in the company data on the 4.Documents tab. However, this path must
be known to the A+W Sharepoint DMS service so that it can collect the files and transfer them to
the archiving system. The file name of the declarations of performance is adjusted for the copy
process according to the format Declaration of performance number + _ + Language identifier +
file extension (e.g. LST_0.pdf).




                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                   713
Fig. 336: Initializing archiving system

In the form management (Master data>Forms>Form management) a print string must be stored
for the document archiving on the 4.Options 1 tab per print point (AB print, invoice print, etc.).
During the activation of the document archiving, the data field can be edited and it is pre-populated
with the default:


¶@@BT@@PROJECT=AWB5DESP@@STORAGERULE=DOK_TYPE@@Idx=DOK_ID¶
¶@@OM@@Profile=AWB5OH@@Identify=DOK_ID¶


This character string is an OM command that can have the following format. However, it is also
possible to retain the predefined value. For example, an order with number 3027 must have the
following OM command:


¶@@BT@@PROJECT=AWB5DESP@@STORAGERULE=SALESCONFIRMATION@@Idx=3027¶
¶@@OM@@Profile=AWB5OH@@Identify=3027¶


The Storagerule identifies the document type that is to be archived. In the example it is an order
(Salesconfirmation). Via the order number 3027 the order to be archived is indexed. The standard
OM command contains placeholders for the Storagerule and the index value, which are replaced
appropriately in the print program (e.g. Documents>Order>Print order). Then the edited character
string is written to the report. If no placeholder is found in the print preparation, the program
assumes that the user has already permanently defined the print string in the form management.
For the archiving, A+W Sharepoint DMS and A+W Business use permanently-defined storage rules
                                                                                                in




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




cooperation.




                                                                                                 714
Fig. 337: Form management




Furthermore, it is possible to use the connection to A+W Sharepoint DMS to display information
about documents, customers, products, etc. If in A+W Business, for example, you are working on
an order that was already prepared via the program for the initialization of the archiving system
(transfer table - BW_TRANSFER contains the record), then the program is notified via shell call and
displays this document in the interface. Important for this are the parameters that are transferred.
On the one hand this must be a type parameter (e.g. Order) and on the other hand an index value.
After the call of the order that is currently in order recording, for example, the A+W Sharepoint
DMS would display in the interface. The functionality was implemented in the document recording,
partner, product and object management, and in the management of the declarations of
performance.


18.2. Form management – OM commands                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




In the form management, the standard OM commands can already be overridden. To do this, it is
only necessary to set the DOK_TYPE to the appropriate document type:
Purchase order:
¶@@BT@@PROJECT=AWB5DESP@@STORAGERULE=PURCHASEORDER@@Idx= DOK_ID ¶
¶@@OM@@Profile=AWB5OH@@Identify= DOK_ID ¶
Purchase inquiry:
¶@@BT@@PROJECT=AWB5DESP@@STORAGERULE=PURCHASEREQUEST@@Idx= DOK_ID ¶
¶@@OM@@Profile=AWB5OH@@Identify= DOK_ID ¶
Sales quotation


                                                                                                715
¶@@BT@@PROJECT=AWB5DESP@@STORAGERULE=SALESOFFER@@Idx= DOK_ID ¶
¶@@OM@@Profile=AWB5OH@@Identify= DOK_ID ¶
Sales job confirmation
¶@@BT@@PROJECT=AWB5DESP@@STORAGERULE=SALESCONFIRMATION@@Idx= DOK_ID ¶
¶@@OM@@Profile=AWB5OH@@Identify= DOK_ID ¶
Sales invoice
¶@@BT@@PROJECT=AWB5DESP@@STORAGERULE=SALESINVOICE@@Idx= DOK_ID ¶
¶@@OM@@Profile=AWB5OH@@Identify= DOK_ID ¶
Sales credit note
¶@@BT@@PROJECT=AWB5DESP@@STORAGERULE=SALESCREDITNOTE@@Idx= DOK_ID ¶
¶@@OM@@Profile=AWB5OH@@Identify= DOK_ID ¶
Sales delivery note
¶@@BT@@PROJECT=AWB5DESP@@STORAGERULE=SALESDELIVERY@@Idx= DOK_ID ¶
¶@@OM@@Profile=AWB5OH@@Identify= DOK_ID ¶




18.3. Indexing and path from registration


The path to the display - tool and the calls for the various document types (order, products, etc. pp)
can             be           configured            effective           immediately.            Under
HKEY_LOCAL_MACHINE\SOFTWARE\WOW6432Node\Albat+Wirsam\Business 6 you have to
create the new key Actiware once. In this, the absolute path is stored in the character string Path :

C:\ECM\ACTIWARE\Business Template 5\Desktop\Client\Shell.exe

The calls for the different documents also have to be set in character strings and also have to be
created once in the registry editor:
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




The value for the indexing is then attached to the character string in the program accordingly.




                                                                                                  716
19.Integration of Allgeier ECM scanview®
The connection to the Allgeier ECM System is done similar to that of the A+W Sharepoint DMS. The
output is generated via a second printing to a printer driver of the PDF files. For example, this can
be the gotomaxx PDF Mailer or the ITEKSOFT eDocPrinter PRO. Via a control line that can be
configured in the form management, it is communicated to the PDF driver in which folder the PDF
files created should be stored. This folder is monitored by the AWSOA Commercial Exchange
service. As soon as a file is stored there, the service starts its transfer of the document to the Allgeier
WebServices and removes the file if the transfer is successful.
The display of archived documents is done in the order entry via a customizing button, which
transfers the current document to the Allgeier DocumentViewer as search criterion. It is then in a
position to display all linked, archived documents and thus to provide a quick overview.


19.1. Master Data
In the company master data, on the tab 4.Documents first the archiving system must be activated
and the path to the Allgeier scanview® program entered. The DocumentViewer that is called from
the customizing for display must be present in this path.




                                                                                                              A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 338: Activation of the DMS in the master data




                                                                                                       717
Then on the tab 12.Print, the PDF printer and path for storage of the PDF files are set. Furthermore,
the option Close DMS printer after each document must be activated so that a PDF file per
document is created.




Fig. 339: Configuration of the PDF printer in the master data

In the form management, for each form that should be transferred to the DMS system, the
document archiving must be activated and the control sequence for the respective PDF printer
stored. In this control sequence, it is communicated to the PDF printer in which manner the PDF
file should be generated since this differs depending on the driver used. Placeholders can be used
in this field in order to influence the file names, for example. See the following table for the possible
                                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL



placeholders.




                                                                                                     718
  Placeholder        Description
  <<PDFDIR>>         The path in which the PDF files should be stored. This corresponds to the
                     setting in the company master data on the tab 12.Print (archive path)
  <<TYPE>>           The print point of the form:
                     100 = order confirmation
                     101 = offers
                     102 = delivery notes
                     103 = invoices
                     104 = credits
                     106 = purchase orders
                     107 = inquiries

                     For repeat printing, the value is 100 larger. The values can also be taken
                     from the combo box of the print points from the form management
  <<ID>>             The current document number. For invoices, the invoice number and for
                     delivery notes, the delivery note number.
  <<USER>>           The name of the user who executes the printing
  <<DATE>>           The current date in the format yyyyMMdd (e.g. 20170926)
  <<TIME>>           The current time in the format hhhhmmss (e.g 170453)


19.2. Connection to scanview® Webservice

The PDF files generated for the document archiving are saved in a defined directory. The directory,
as well as the connection data to the scanview® Webservice, must be stored in the A+W
Infrastructure 6 Web.


                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 340: A+W Infrastructure 6 Web


                                                                                                  719
The A+W Commercial Exchange Service monitors this directory and checks whether the PDF files
created (or changed  e.g. the file name). If files are present for processing, all necessary data for
the document (PDF file) is determined from the A+W Business database and transferred to the
scanview® Webservice for archiving in the ECM scanview® system. The connection data to the A+W
Business database must also be defined in the A+W Infrastructure 6 Web: Configuration > A+W
Business > Database connection
If the transfer was successful, the file processed is deleted from the directory. If problems occur
during the transfer, these are written in the appropriate log file (trace) of the Commercial Exchange
Service.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 341: A+W Commercial Exchange Service log configuration


19.3. Status - updating POs




                                                                                                  720
The Allgeier ECM system inserts data records into the SQL Server database belonging to the ECM
system into the table SCANVIEW_REF. This table contains information about incoming POs,
whereby three types of data records are stored. These are identified using the table column
message type (in SCANVIEW_REF):
                           1) 63 = supplier order confirmation
                           2) 97 = FinAc transfer / invoice receipt supplier
                           3) Any other status point, but only with status-increasing function
These message types are simultaneously also the corresponding status points in A+W Business. For
further processing of this data, a customizing form was created in A+W Business. It is provided with
the A+W Business Setup and is in the installation directory in the path "..\Formula".




Fig. 342: Formula udf_UpdateStatusForDMSDocument()

According to the message type (status point) 63 or 97, the status in the purchase order is set and
the history entry made. If the purchase order is not found or the minimum/lock status of the status
point hinders the status change, then there is no processing and the status of the record is set to
the value 2=flawed (in SCANVIEW_REF). Successfully processed data records receive the status
1=processed (in SCANVIEW_REF). Only data records with the initial status 0 are processed.
For the message type 63, the status of the purchase order is set and the order number supplier and
delivery date are entered. The message type 97 causes a status update of the purchase order, and
thus receives the defined user status.




                                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 343: Status assignment for status point 97

For the formula udf_UpdateStatusForDMSDocument() a workflow task must be created, which then should be processed
at a particular interval (Fig. 328).



                                                                                                            721
Fig. 344: Workflow task for udf_UpdateStatusForDMSDocument()




Fig. 345: Workflow task for udf_UpdateStatusForDMSDocument()




          Incoming invoice status paid and partially paid
The stati "paid" and "partially paid" can be implemented as customer-specific status point with
status assignment. Allgeier must then only write the status point to the table and specify the PO.
No collective invoices or POs are considered in the archive.




19.4. Display from the document entry
The display of all linked documents is done in the document entry via a Customizing button. The
formulas for this are provided with the A+W Business Setup and are in the installation directory in
the path "...\Formula".


DMS_Allgeier_Show_document_in_ScanView.txt.
The formula handles the call of the Allgeier DocumentViewer


DMS_Allgeier_Create_button.txt
This formula handles the display of the Customizing button


DMS_Allgeier_Create_button_hotkey.txt
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL



The formula handles the control of the Allgeier DocumentViewer via hotkey (10.8.1)




          Display from number manager

DMS_Allgeier_Show_document_from_numbermanager_in_ScanView.txt.
The formula handles the call of the Allgeier DocumentViewer from the number manager.




                                                                                               722
         Display from document data

DMS_Allgeier_Show_document_from_documentdata_in_ScanView.txt.
The formula handles the call of the Allgeier DocumentViewer from the document data.




                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                      723
20.SGG eCommerce
This chapter describes the connection to the SGG eCommerce System (AWDesk 364572). The
required files can be found under Formula\SGGeCommerce.


20.1. Overview
The connection is divided into three parts:
    •   Import of eCommerce EDI files
    •   Transfer of changes to customer base
    •   Transfer of order status changes and delivery date changes


20.2. Installation
An update of the entire version including ERP web service is required for the start-up.


20.3. Update database
The scripts for the database have to be executed. The following scripts have to be executed in any
event for a successful start-up:
    •   20160429a.sql
    •   20160530a.sql
    •   20160531a.sql
    •   20160531m.sql


20.4. Set-up of FTP server and web service
The connection data for the FTP server and web service have to be established under menu point
Stammdaten > Allgemein > eCommerce Login (address, user, password). The dialog should only be
made accessible to certain users via the authorization management.
                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




The Webservice serves to transfer the order status and for delivery date changes.
The FTP takes over the transfer of the customer master data changes. The services are permanently
assignment and cannot be exchanged one for another.




                                                                                               724
20.5. EDI import from an index with article referencing
For the utilisation of the architect field, the article referencing for the architect to be used has to
be entered in the program Stammdaten > B2B > Produkte.




In order for the article referencing to be used, it has to be activated in the company master data
register 7 (use architect from header for article referencing).




                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                   725
The workflow Workflow_EDIImportFromDirectory.txt has to be used for the new EDI import
functionality. Here, the following indexes are specified in addition to the standard EDI import:
SourceDir: Source index for all eCommerce EDI files
SaveDir: Backup index for all loaded eCommerce EDI files
FailDir: Index for unsuccessfully imported files
The architect number used for the import is transferred into the order during import in order to
subsequently differentiate the eCommerce orders from the other orders.


20.6. Transfer of changes to customer base
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




In order for the values to be transferred to the CU_SGG_ECOM_CUST table in case of a change to
the customer base, the trigger SQLBase KU_KUNDEN.sql or SQLServer KU_KUNDEN.sql has to be
executed, depending on the database.
In   order   for   the   changes     to    be     transferred,   the      workflow          formula
Workflow_TransferCustomerChanges.txt has to be established and activated.
If a customer with the classification eCommerce with the value of 1 hat is changed, he is transferred
to the transfer table CU_SGG_ECOM_CUST. In case of a change to an invoice address or delivery
address, the number of the main branch is written into the table. The classification eCommerce is
hereby checked for the main branch.



                                                                                                 726
The     sentences     in    this    table     are   collected     by   the     workflow     formula
Workflow_TransferCustomerChanges.txt and transferred to the employed FTP server. If the
transfer is unsuccessful, the status of the sentence in the table CU_SGG_ECOM_CUST is increased
by one. If the record has a status of 10, no further attempt for a transfer is made. The sentences
can be reactivated for the transfer by resetting the status. Successfully transferred sentences are
removed from the table. The transferred customers are issued in the result variable of the workflow
formula.
A mail dispatch of the results and/or errors can occur in the workflow formula. This should be
established particularly in the initial phase in any case. Alternative, the issues of the workflow
formula can also be saved in a file.
Reference is made to the Specification chapter 4.2.1.1 for a complete list of the transferred fields.


20.7. Transferring of order changes
The following triggers have to be installed on the database for the transfer of changes to orders:
SQLBase:

SQLBase BW_AUFTR_HIST Insert.sql
SQLBase BW_AUFTR_KOPF Delete.sql
SQLBase BW_AUFTR_KOPF Insert.sql
SQLBase BW_AUFTR_KOPF Update.sql
SQL server (Attention! History triggers different according to version):
SQLServer 2011 BW_AUFTR_HIST Insert.sql oder SQLServer B5 BW_AUFTR_HIST Insert.sql
SQLServer BW_AUFTR_KOPF Delete.sql
SQLServer BW_AUFTR_KOPF Insert.sql
SQLServer BW_AUFTR_KOPF Update.sql
These triggers enter changes to the order and the history in the transfer table
CU_SGG_ECOM_ORDER. In the triggers, the AH_ARCHITECT number is requested so only orders
from the EDI eCommerce import with a specifically defined architect number are entered in the
transfer tables. In the process, the order number, the eCommerce status and possibly a comment
is entered in the transfer table. In case of changes to the delivery data, the status 0 is entered and
the last valid eCommerce status is determined during the transfer of the changes.
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL



The trigger to enter the orders always uses the eCommerce status 10 (order established) and the
trigger for the deletion of orders always uses the eCommerce status 90 (order deleted). The trigger
for the history determines the eCommerce status depending on the executed status point. All
utilized eCommerce status allocations are available in the following table:

  WebMethods status         A+W Business status point          Comment

  10                        None                               Triggered on successful EDI Import

  20                        100,300,350                        Printing AB (Standard, Fax, Mail)

  30                        48                                 Production Feedback (Produced)

  40                        68                                 Production Feedback (Delivered)


                                                                                                   727
  90                        None                               Triggered on order delete

  99                        161, 700, 760                      Duplicate, Customer credit check failed,
                                                               Payment in advance


The sentences in this table are collected by the workflow formula WorkflowOrderChanges.txt and
transferred to the eCommerce web service together with a web service request. If the transfer is
unsuccessful, the status of the sentence in the table CU_SGG_ECOM_ORDER is increased by one. If
the record has a status of 10, no further attempt for a transfer is made. The sentences can be
reactivated for the transfer by resetting the status. Successfully transferred sentences are removed
from the table. The transferred orders are issued in the result variable of the workflow formula.
A mail dispatch of the results and/or errors can occur in the workflow formula. This should be
established particularly in the initial phase in any case. Alternative, the issues of the workflow
formula can also be saved in a file.



20.8. Management of down payments / eCommerce orders

         Credit Limit Check
For the credit limit check, a new status point "702 - Order paid but credit limit exceeded" was
added. After the check in the document entry (e.g. Documents > Order > Order) the user status of
the new status point is assigned if a customer's credit limit is exceeded, but the order is completely
paid (button next to Down Payment Total on Totals tab).
Thus after entry of a down payment, a credit limit check is performed and if necessary, the status
of the order is adjusted. Such documents can also be released with the Delete credit limit lock
function.
Furthermore, the credit limit check itself has been expanded. That is, that the totals of all down
payments made are deducted from the total of the gross orders of all a customer's orders in order
to determine whether or not the defined customer credit limit has been exceeded.

         eCommerce order reference

For eCommerce orders that are imported into the system via EDI, effective immediately, if there is
an order reference, the data field Bestelltext 2 can no longer be edited in the document entry. Users
                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




thus have no more possibility to delete or change the eCommerce order number.

         Import of eCommerce order without surcharge calculation

In the customer's B2B external interface management (Master Data > B2B > Customer > Customer)
a new option was implemented with which you can deactivate the calculation of
surcharges/discounts during the EDI import. Thus, in the EDI file, the defined price is taken over
unchanged into the document. For this, the price import must also be permitted, which can also be
set in the management program.




                                                                                                  728
20.9. eCommerce with OMS information
It is now possible to import eCommerce EDI files with OMS information.
Architect:
Since within the execution it must be decided which settings are used, the architect numbers to
99999998 are specified. For eCommerce without OMS information, the architect number 99999900
is                                      still                                       used.DSGVO

Installation:
For the new reporting, the database script 20180316a.sql must be executed. After that, on the
Master Data > General > eCommerce/OMS login dialog, the Webservice addresses with users and
passwords are entered:




The settings on the 2nd tab are used if an order with the architect number 99999998 or an
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




eCommerce or OMS should be reported.
This affects the following reporting:
    •   Report of the order status to eCommerce
    •   Report of the order status to OMS
    •   Transfer of the ASN (supplier information) to OMS
So that orders with the new architect 99999998 are transferred to the transfer table, the following
triggers must be set in the database:
    •   SQLServer B5 BW_AUFTR_HIST Insert.sql
    •   SQLServer BW_AUFTR_KOPF Delete.sql
    •   SQLServer BW_AUFTR_KOPF Insert.sql


                                                                                               729
    •   SQLServer BW_AUFTR_KOPF Update.sql
The new triggers react to both architects. The triggers can be found in the installation directory in
the subfolder Formula\SGGeCommerce.
Execution:
There have been no changes in the execution. The already-existing workflows for eCommerce or
OMS can be used.
For the reporting to eCommerce or OMS, it is then decided per architect whether the settings from
tab 1 (architect 99999900) or the settings from the tab 2 (architect 99999901) are used.
Takeover of the procurement types from the EDI file:
If in an EDI file with the architect 99999998 and the interface version starting with 2.2.32 the
procurement type of an item is set to 109 (purchase order complete), it is now taken over into the
order. In order to use the procurement type from the master data, the field must be left empty.
Status after import of orders and purchase orders
To change the status of orders and purchase orders after import, the general formula that runs
after   EDI     import      (program     point    100)     must      be     extended      with
Formula\SGGeCommerce\Customizing_EDI_AFTER_SAVE.txt.
If a request is then imported with the architect 9999999998, it automatically receives the user
status of status point 100 (request confirmed) after successful import.
After the status update, the checks for the credit limit block and the duplicate check are carried
out.
An imported purchase order with the architect 9999999998 receives the user status of status point
106 (purchase order confirmed) after successful import.
Status after order - purchase order references have been created:
If the purchase order references are created using the field POLINK_GUID after the import of an
order or purchase order, the system checks whether associated order items exist for all completely
ordered items of an order. If this is the case, the order status is first set to the user status of status
point 30 (transfer to purchase order pool) and then also to the user status of status point 670
(purchase order created). If not all completely ordered order items are included in purchase orders,
the status change does not take place. An purchase order transfer must then be carried out for the
order items that are not referenced (see next point).
Purchase order transfer for orders with POLINK_GUID:
                                                                                                             A+W Software GmbH - Configuration A+W Business - INTERNAL



If an order contains purchase order items that are linked to a purchase order via EDI
(POLINK_GUID), these items are not displayed in the purchase order transfer. If ordered items
without POLINK_GUID are included in the order, only these are displayed in the purchase order
transfer.
Note: If a purchased order item is subsequently changed in item entry, the element is displayed
when the purchase order is repeatedly transferred after leaving item entry. However, this should
not happen for eCommerce orders with OMS information, since the change would have to be made
via the EDI import.
Feedback of status changes and ASN:
The following status assignments are used for the feedback to OMS:




                                                                                                      730
  AWB status                            AWB status points                         OMS Status

      21         100, 101, 106, 107, 300, 301, 306, 307, 350, 351, 356, 357            50

      33         32, 63                                                                50

      35         34, 35                                                                50

      40         40                                                                    60

      42         42                                                                    65

      45         45                                                                    70

      50         50                                                                    75

      71         102, 302, 352                                                         90

      84         84, 8001, 8004, 8100, 8110                                            95

      85         8005, 8101                                                            95

      95         103, 104, 105, 303, 304, 305, 353, 354, 355                           98

      900        502                                                                  999


For the new status feedbacks to work, the triggers SQLServer B5 BW_AUFTR_HIST Insert.sql and
SQLServer BW_AUFTR_KOPF OMS Delete.sql must be exchanged. Feedback is then sent via the new
WebMethods Url.
No changes need to be made in A+W Business for the transfer of the ASN. Feedback is via the new
WebMethods Url.
The creation of XML data has changed for both feedbacks. The new structures can be viewed in the
trace of the Commercial.ExchangeComProxy.

           EDI Import - Purchase Orders with Order Reference
The import is performed using a workflow example (Workflow_EDIImportFromDirectory.txt).
The UDF function now imports both document types order/purchase order. For the purchase order,
field K1/2 must be filled with the value 6.
                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




udf_EDIImportFromDirectory(...)
The reference between purchase order and order is generated by the POLINK_GUID, which is
transferred via EDI import P3/8 and S1/31. The sequence of import of order/purchase order or
purchase order/order is not important.

           EDI Import - Document Cancellation
EDI field K1/3 with the value 2 triggers the EDI cancellation mode.
To cancel, only the header records are required, the document receives the assigned status, and
the document is not deleted.
There are 2 new status points to cancel an order/purchase order

                                                                                             731
    •   613 - Cancel order ( External interface )
    •   616 - Cancel purchase order ( external interface )
The status should be assigned as status 990 - Release for deletion.
The minimum and maximum status is checked.
For the cancellation of an EDI purchase order the 2 fields: K1/9 Predefined document number and
if they do not match, K5/15 eCommerce Number (SGG) used to find the document. This function is
only supported with EDI interface 2.2.032.

         EDI Import - Modification of Documents
EDI version 2.2.032 supports the updating of documents. EDI field K1/3 with the value 3 triggers
change mode.
Two new status points are required for change mode
    •   612 - Update Order ( External Interface )
    •   615 - Update purchase order ( external interface )
All items in the document are deleted and inserted with the new values. Order/purchase order
references are deleted and renewed. Order and purchase order must be sent.
The lock status of the status points is checked and an update is only possible up to this status.
All header values are updated as in a new document.




                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                    732
21.SGG OMS
21.1. Requirements

           Setup Launcher
        The Setup Launcher must be used from the Version v6. It is completely compatible
        with Version 2011, but it can install the new infrastructure.
        The old Setup Launcher must be de-installed and the packages provided must be
        copied into the installation directory.




        SetupStarter.exe must be started.

           Older ESB / infrastructure
        If an older version of the infrastructure is already installed, the installation must be
        canceled. This ESB is only compatible with Version v6.2 of the infrastructure and
        services. This can occur if components from production are installed with Version 5
        or 6.

           SQL Server instance
        The installation assumes a running SQL Server instance. SQL Server Express can be
        used.



21.2. Server Installation
                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




           Setup Packages
The following setup packages must be present in the installation directory:
    •    Java Runtime Engine 7 (32-bit)
    •    Java Runtime Engine 7 (64-bit)
    •    A+W Commercial 6 Exchange Services
    •    A+W Infrastructure 6 Collector Services
    •    A+W Infrastructure 6 Middleware
    •    A+W Infrastructure 6 Service Locator


                                                                                             733
    •   A+W Infrastructure 6 Services
    •   A+W Infrastructure 6 Web
This installs the v6 infrastructure/ESB on the computer, including the exchange service, which is
used to send the ATP query to OMS.




The following installation dialogs are displayed:




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                              734
Here the name of the computer must be specified on which the service locator is running. The
default port is 12000.




The user under whom the SOA services are running must be entered here.
This user must have read and write rights on the computer.
Now the packages are installed.
In the configuration, the SQL Server database connection for the SOA services must be entered.




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




The required tables will be created by the SOA services if necessary. An existing A+W database can
be used.




                                                                                               735
It is recommended that you use the database scripts from the A+W FTP Server.
If this is not possible, the files from the installation directory can be used, but these must then
always be updated manually.


21.3. Client Installation

         Setup Packages
The following packages must be installed on every computer:
    •   Java Runtime Engine 7 (32-bit)
    •   Java Runtime Engine 7 (64-bit)
    •   A+W Infrastructure 6 Middleware
These packages install the v6 middleware that controls the communication with the ESB.
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               736
737
A+W Software GmbH - Configuration A+W Business - INTERNAL
The following installation dialogs are displayed:




The name of the computer on which the SOA services were installed must be entered here.



21.4. Installation of the SGG ATP Call
      For the ALFAK 2011 installation, the following packages must be installed:




                                                                                                A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                          738
    The following packages must be installed:
    A+W Commercial 6 Exchange Service
    ALFAK 2011 basis (components for communication with the ICE services)
    ALFAK 2011 French (new abcstamm.exe and abcauftr.exe)
    ALFAK 2011 Server (database scripts)



21.5. Database Update
    The database must be updated. The following scripts must be executed:
    20170104a.sql
    20170104aa.sql
    20170104m.sql (20170104m_FRA.sql)
    20170105a_FRA.sql

21.6. Set-up and use of the ATP query

      Two new formulas must be created
    <INSTALLATIONDIR>\Formula\SGGATP\PositionSelection.txt
    <INSTALLATIONDIR>\Formula\SGGATP\ProcessTypeCriteria.txt




                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                            739
  Set-up of the ATP query




 1. URL, user, and password for the ATP query.
 2. Number of the ProcessTypeCriteria formula.
 3. Number of the PositionSelection formula.

  Status point for ATP query
The status point 910 must be created anew:



                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                 740
  Type
The new dialog for the ATP query can be called directly from the document entry:




                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                               741
The call can also be made automatically when leaving the item entry, if at least one
item was changed).




  Use of the dialog
If the dialog is displayed, all items that were not excluded by the PositionSelection
formula were displayed in the table. Items over 900 are automatically not displayed
on the dialog.




                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                  742
 1. The current route of the order.
 2. The current delivery date and the date of delivery are displayed here.
 3. With this option it is possible to set which order items should be updated
    with the ATP information.
 4. The ATP query is executed with this button. If the query was successful,
    button 5 is activated.
 5. After the successful ATP query, the data can be taken over into the order
    items. The latest date of the selected items is taken over as the new delivery
    date. If all items can be delivered up to the already-specified delivery date,
    then the delivery date for the order remains unchanged. After the transfer,
                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




    the dialog can no longer be canceled.
 6. The dialog is exited with this button and the status of the order updated.
 7. This button exits the dialog without taking over changes. If the dialog was
    called when exiting the item entry, the user remains in the item entry.

   Logging
The logs are stored in the following folder:
C:\ProgramData\A+W\Log\Commercial.ExchangeComProxy_*****.awtrc



                                                                                     743
A new log is begun for each call. The XML structure of the ATP query and the result
are stored in the log.




                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                744
21.7. Phase II (transfer to Purchasing and EDI export)

      Installation
    The following files must be replaced or added:
         •   Database Update
                o 20170214a.sql
         •   Workflow formulas
                o EDIFilename.txt
                o Workflow_EDISOExportToDirectory.txt
                o Workflow_EDIPOExportToDirectory.txt
         •   Programs
                o abcauftr.exe
                o abcfsref.exe
                o abcreceive45.exe
         •   Language files
                o frames.txt

      Configuration
     21.7.2.1. Database
    The database scripts must be executed in order to create the transfer table
    CU_SGG_ECOM_TRANSFER (database script 20170214a.sql)

     21.7.2.2. Formulas
    The following formulas must be created:
    EDIFilename.txt (generation      of   the   EDI   file   name   in   the   format
    <SIFNOP_OrderNumber>)
                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL



    Workflow_EDISOExportToDirectory.txt (automatic export of orders from the
    transfer table into a directory)
    Workflow_EDIPOExportToDirectory.txt (automatic export of purchase orders from
    the transfer table into a directory)




                                                                                  745
Both EDI formulas must be adjusted customer-specifically (architect and directories)

 21.7.2.3. Master data
For the export, a new customer and a new supplier must be created in order to create
the item references.
Both newly-created partners must be configured for the EDI export.
For both, the EDI version 2.2.029 must be set. The file name should be created as a
formula in the format <@FORMULANUMBER@>.ASC so that later it can be
determined by the appropriate formula.
Caution: The eCommerce supplier may not be used.
                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                 746
747
A+W Software GmbH - Configuration A+W Business - INTERNAL
                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




 21.7.2.4. Export product numbers
The item reference for the supplier and customer must be created:




                                                                    748
                                                                             A+W Software GmbH - Configuration A+W Business - INTERNAL




 21.7.2.5. Creation of the workflow
The workflows must be created for the automatic export of EDI files:




                                                                       749
                                                                                             A+W Software GmbH - Configuration A+W Business - INTERNAL




   Use
If an order confirmation is printed, the order for export is entered in the transfer table
CU_SGG_OMS_TRANSFER.
If data is written back into the items from the ATM query, during the order transfer,
this information is taken as delivery date for the order.

                                                                                       750
    At that moment, the EDI files are generated with the new workflow if the orders are
    in the correct status area.

21.8. Phase III (transfer of status changes to OMS)

      Installation
    The following packages must be installed:
         •   ALFAK 2011 Basis
         •   ALFAK 2011 French
         •   ALFAK 2011 Server
         •   Complete infrastructure and commercial (see Chapters 1-3)
    All new formulas and triggers are in the subdirectory of the ALFAK 2011 installation
    \Formula\SGGATP.

      Configuration
    The database must be brought up to the current state (all scripts including
    20170313a.sql).
    The database triggers SQLBase BW_AUFTR_HIST OMS_Insert.sql and SQLBase
    BW_AUFTR_KOPF OMS Delete.sql must be installed on the database.
    Before installation of the triggers, the architect number must be adjusted.
    The Webservice address must be entered on the eCommerce/OMS login dialog:




                                                                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




    The formula Workflow_TransferStatusToOMS.txt must be inserted into the
    database and a workflow must be created for this formula.


                                                                                     751
     If the sending system does not use the automatic export, the following line must be
     inserted into the EDI customizing:
     Set m_nAH_ARCHITECT = <OMS_ARCHITECT_NUMBER>;
     This is necessary in order to resolve the trigger in the receiving system.

       Description

     If an order with a particular architect number (defined in the database trigger) is set
     to a configured status point, an entry is made in the transfer table
     CU_SGG_OMS_TRANSFER with AKTION = 2. When deleting orders, the entry is
     written into the table with status 90.
     The periodically-running workflow task transfers all records to the OMS Webservice.
     The result can be traced in the Interface Service Monitor:




                                                                                               A+W Software GmbH - Configuration A+W Business - INTERNAL




       Status allocation
     AT the moment, the following stati are sent:


OMS Status               A+W Business Status Point      Comment

10                       610                            EDI Import

20                       100,300,350                    Print OC (standard, fax, mail)

30                       48                             Production feedback (produced)

40                       68                             Production feedback (dispatch)


                                                                                         752
 90                        None                            Order deleted

 99                        161, 700, 760                   Duplicate check, credit limit check or
                                                           payment required


      For the status 99, the remark text is also sent since this status can have several causes.

21.9. Phase IV (transfer from ASN)

         Installation
      The following packages must be installed:
           •   ALFAK 2011 Basis
           •   ALFAK 2011 French
           •   ALFAK 2011 Server
           •   Complete infrastructure and commercial (see Chapters 1-3)
      All new formulas and triggers are in the subdirectory of the ALFAK 2011 installation
      \Formula\SGGATP.

         Configuration
      The database trigger BW_AUFTR_HIST OMS_Insert.sql must be updated with the
      new version.
      The URL of the ASN Webservice must be entered on the eCommerce/OMS dialog:




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                             753
The workflow formula Workflow_TransferASNToOMS.txt must be inserted into
the database.

  Description
If a delivery note is printed, an entry is made in the table CU_SGG_OMS_TRANSFER
with AKTION = 3.
This workflow processes all records with AKTION 3 and create an ASN (Advanced
Shipping Notice) per order. If an ASN is created for a partial delivery, the order
number of the original order is sent.
The ASN is sent to the OMS Webservice.
With successful transfer, the entry is deleted from the table.
The result can be traced in the Interface Service Monitor:




                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                               754
755
A+W Software GmbH - Configuration A+W Business - INTERNAL
22.Connection to the SGG Glass4U system
A tool with the name Glass4U was created to handle the logistic process between Saint Gobain
Glass and their customers. Two interfaces were implemented to exchange data between A+W
Business and Glass4U. On the one hand for the way to Glass4U, to transfer various document-
related data. On the other hand, a feedback is sent by Glass4U to A+W Business, after the delivery
process is completed. This way, the delivery date is updated and the status of the delivery note
(order) is set to ‚delivered‘.


The database must be updated before configuration or first application. The script 20180413a.sql
must be executed.


22.1. A+W Business to Glass4U

This is how the data is transferred from A+W Business to Glass4U:


          AWSOA.Commercial.Exchange.Services
                                               Workflow_TransferDeliveryInfoToGlass4U >>>
        BusinessExchangeCom.exe
                                            udf_TransferDeliveryInfoToGlass4U (AWB database)




        AWSOA.Commercial.Exchange.ComProxy
                        TransferDeliveryInfoToGlass4U ( )


          AWSOA.Commercial.Exchange.Services
                         TransferDeliveryInfoToGlass4U( )
                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




                                Glass4U WebService
              genericFrom_ERP (string XML, string Action)
Fig. 346 – A+W Business to Glass4U




                                                                                               756
At the beginning the URL for the Glass4U Web service must be defined.

Fig. 347 – URL Glass4U Webservice




                                                                              A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                        757
With the database update (script 20180413a.sql), a new status point '920 - Glass4U transfer
performed' was added. To check whether a transfer to Glass4U is possible, the new status point
requires the necessary status assignment.
In the A+W Business installation directory (e.g. C:\Program Files (x86)\A+W\Business 6\Formula\)
there     is    a     new       subfolder       Glass4U.     It     contains   the     workflow
Workflow_TransferDeliveryInfoToGlass4U.txt for the transfer to Glass4U via the
Fig. 348 – Status point 920




                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 349 – Workflow – Formula Workflow_TransferDeliveryInfoToGlass4U




                                                                                             758
ExchangeComProxy. Now a formula must be created into which the content of the workflow text
file is copied.
The formula must now be assigned to a workflow in the Customizing program (Master data >
Company > Customizing).




Fig. 350 – Workflow Task Workflow_TransferDeliveryInfoToGlass4U




On tab 4.Autom. Process execution must be defined for the workflow task both a cyclic interfall /
a fixed time point and the thread in which the task is to run.




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 351 – Autom. process execution Glass4U




                                                                                              759
A detailed overview of the process execution can then be found on tab 5.Monitor.




Double-click on the workflow to open the corresponding trace file. The individual processes are
shown in the screen table on the right. In our example the URL of the Glass4U webservice is not
correct or not reachable.



22.2. Glass4U to ERP Webservice (A+W Business)

Here is the chart for the feedback from the Glass4U system to A+W Business



Fig. 352 - Monitor




                                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                            760
                                       Glass4U

                             Albwir.Erp.WebService
     SGGUpdateDeliveryInfo (erpSettings, deliveryInfo, result)




                                 abcprocessXXX.exe

Fig. 353 – Glass4U to AWB

For the feedback from Glass4U into the A+W business, the ERP Web service a method
'SGGUpdateDeliveryInfo' has been added. Two object structures must be included in the method,
erpSettings and deliveryInfo:

          erpSettings – Structure
erpSettings.Database                = A+W Business database
erpSettings.Server                  = Database - Server
erpSettings.User                    = Database - User                                           A+W Software GmbH - Configuration A+W Business - INTERNAL




Fig. 354 - ERP Web service SGGUpdateDeliveryInfo




erpSettings.Password                = Database – User password
erpSettings.DatabaseType            = 2 ->Sql Base, 3 -> Sql Server

                                                                                          761
erpSettings.ClientType              =2

           deliveryInfo – Structure
deliveryInfo.DeliveryDate           = actual delivery date
deliveryInfo.DeliveryNumber         = Number of delivery note
deliveryInfo.DeliverySite           = Subsidiary number (order entry)
deliveryInfo.SalesSite              = Subsidiary number (order exit)
deliveryInfo.OrderNumber            = Order number


Furthermore, a return value of result into the Web service method so that the Glass4U system
receives feedback whether the update in the A+W Business was successful or failed.


The method therefore updates the actual delivery date of the order and updates the order status
to 'Delivered' (SGG status 84).




Fig. 355 - SGGUpdateDeliveryInfo Result




           Notes / Restrictions
If a 0 is transferred in the deliveryInfo structure for the order number, then the update is carried
out in the A+W Business via the delivery note number.
The subsidiary numbers (incoming and outgoing orders) of the deliveryInfo structure are not yet
taken into account.                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                762
23.Exchange Service (Workflow Execution)
The new A+W Exchange Service replaces the A+W Business 6 Interface Service for the execution of
workflows. In contrast to the old interface service, this service offers unlimited site capability and
a multithreading execution model. Therefore, it is possible to define several thread that handle
various tasks. It is now possible to process reporting quickly without blockade by long processes.
Both cannot be operated in parallel !!! The old service must be deinstalled.


23.1. Installation
For the operation of the new service, the following components must be installed and completely
up-to-date:
    •   A+W Business 6 Basis
    •   A+W Business 6 by language
    •   A+W Commercial 6 Exchange Service
    •   All required A+W infrastructure services
The configuration of the Exchange Service must be done after installation (see 23.4)


23.2. Prerequisites
So that the new service is active, the database script 20180123a.sql must be executed. After that,
the new service can be acdtivated in the company master data (see 23.5 ).


23.3. Set-up on the infrastructure web
With the new service, it is possible to let several services for different databases run on a computer.
Decisive here is the configuration of the infrastructure web. A site must be created for each of the
databases:



                                                                                                          A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                   763
For each of the sites, the A+W Business database must be set in the database settings:




                                                                                               A+W Software GmbH - Configuration A+W Business - INTERNAL



In addition, the A+W Business user under whom the workflows are executed must be set under
Commercial > A+W Business user:




                                                                                         764
With the database and user settings, it must be possible to log in A+W Business! All entries of
workflows (e.g. history) are done with this user.




                                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                            765
23.4. Exchange Service configuration
After installation of the Exchange Service, the configuration dialog is displayed. On this dialog, you
can activate an individual exchange service for each site created in the infrastructure Web.




If no assignment is made (default), then an exchange service is isntalled and assigned to the default
site. This is the previous behavior; thus no fixed assignments must be made in single-site
installation.
In the following example, 3 Exchange Services are created:




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  766
Each of the services has as property the AW.MultiSite ID of the site from the infrastructure
configuration.
The services are always started; to end them, it is necessary to set the service to "disabled". If the
service is then stopped, it is not re-started.


23.5. Settings in A+W Business

If the service is started without activating the new service in the A+W business company data on
tab 10, it will not receive any tasks and therefore it will do nothing. So that the service is activated,
the following setting must be made:




At this point, the openTrans export can also be activated by assigning it a thread number. This
service does not run through a workflow, but rather is an integral component of the exchange
service.
For the existing workflows, the following settings must be made:




                                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL




Absolutely mandatory is the entry of a thread number. The thread number divides the different
workflows into parallel processes. The example above leads to the creation of 4 parallel executions
(4 different thread numbers). For each execution, a maximum duration can be set after whichj the
execution is stopped.



                                                                                                     767
For each cyclical workflow, a time span (from-to) can be entered in which the cyclical execution
happens. Outside of these times, the cyclical workflow is not executed. For the definition of a fixed
execution time, this setting is omitted.
Production reports:
With the exchange service, production reports are only executed as workflows. In the installation
directory, there are formulas in the "\Formula\Exchange Service" subfolder:


                Name                                  Description                                      Application
  workflow_files_op.txt                Import of open items for customer             If open items were read in automatically in
                                                                                     advance

  workflow_cleanup.txt                 Automatic deletion of old entries from        Should always be activated, the number of
                                       reporting tables (FS_POOL) and log entries    days after which deletion is done can be set.
                                       of the new monitor (FS_PROTOCOLL)             Default settings is 7 days for both. The value
                                                                                     can be changed in the formula.

  workflow_resetErrorRecords.txt       Resetting of unsuccessful bookings            For all reports

  workflow_fileless_awcapacity_stat    Fileless reporting from A+W Production        For fileless reporting from A+W Production
  us.txt                               (stati 100, 150, 200, 300, 700, 800, 900)

  workflow_fileless_awcapacity_deta    Fileless reporting from A+W Production        For fileless reporting from A+W Production
  il.txt                               (machine reports)

  workflow_fileless_awcapacity_rack.   Fileless reporting from A+W Production        For fileless reporting from A+W Production
  txt                                  (rack assignment and movement)

  workflow_fileless_stsl.txt           Fileless reporting of run settings from A+W   Use of A+W Business Pro
                                       Business Pro

  workflow_fileless_stsd.txt           Fileless reporting of completion messages     Use of A+W Business Pro or the A+W
                                       from A+W Business Pro and the A+W             Business Barcode Scanner
                                       Barcode Scanner

  workflow_fileless_stsb.txt           Fileless reporting of breakage messages       Use of A+W Business Pro or the A+W
                                       from A+W Business Pro and the A+W             Business Barcode Scanner.
                                       Barcode Scanner

  workflow_fileless_xtv.txt            Fileless reporting of stock plates and cut    For fileless reporting from A+W Production
                                       items

  workflow_files_stsl.txt              File reporting of run settings                For file reporting from A+W Production

  workflow_files_stsd.txt              File reporting of completion messages         For file reporting from A+W Production

  workflow_files_stsb.txt              File reporting of breakage messages           For file reporting from A+W Production

  workflow_files_stsp.txt              File reporting of completion messages         For file reporting from A+W Production

  workflow_files_stsg.txt              File reporting about rack assignments         For file reporting from A+W Production
                                                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL



  workflow_files_stsk.txt              File reporting of rack movements              For file reporting from A+W Production

  workflow_files_xtv.txt               File reporting from stock plate removals      For file reporting from A`W Production or
                                                                                     XOPT




                                                                                                                              768
The formulas must be entered as workflows on the Customizing dialog The settings for the reporting
are saved for the new production reporting workflows in the company master data:




If the exchange services is then restarted, all workflows with a valid thread number are then
executed in it.




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




The settings for the import of open items from the FinAc are now set in the company parameters
on tab 3.


Tips for set-up

                                                                                               769
Recommended is the combination of all production reports in a thread, since otherwise due to the
parallelism, the messages will not be processed in the correct sequence.
The resetting of records not processed correctly due to locks                          or   errors
(workflow_resetErrorRecords.txt) should be set before the processing of reports.
The deletion of old reporting records and monitor entries should be done once per day outside of
regular working hours.
Time-critical workflows (e.g. production transfer) should have their own thread.


23.6. Reworking

Monitor
In the customizing management on tab 5, the work of the services can be observed:




On the bottom left, all workflows executed are displayed. In the Time column, the start time of the
workflow is specified. The process ID specifies in which A+W Business Com object the processing is
done. If you are on the same PC with the monitor, you can open the trace file belonging to the line
with a double-click. However, this only works if the A+W Business runs on the computer on which
the Exchange Service is installed and the protocols are stored on the local hard disk.
                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL



The right side displays all messages for the selected workflow.
At the left top, you can make settings for the updating and filtering:
Update all automatically
If this option is activated, the activities (executed workflows) at the left bottom will be updated
every x seconds. With the adjacent button, an update can be done immediately. If this option is not
activated, the updating must be done with the button.
Workflow
The list of activities can be restricted to a special workflow.
FILTER



                                                                                               770
The filter can be used to display only workflows that have an entry with this term (e.g. an order
number) in the detail messages on the right side.
Display
Here it is possible to select that only workflows are displayed for which the selected type was
entered as result.
Message image:
   Workflow was started but not completed
   Workflow was executed without entering a message.
  Information
   Warning
   Error
The legend for the icons is specified below the activities table.
The data is saved in tables FS_PROTOCOLL_HEAD and FS_PROTOCOLL.


23.7. Tracing

The tracing can be activated in the A+W Protocolling Config Tool:




                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL




If the exchange service is running, the process ID can be determined in the service locator:

                                                                                               771
The associated trace is in the A+W\Log directory (last number in the file name is the process ID):




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




In the trace, the actual beginning of the processing can be detected from the following lines:




                                                                                                 772
 "Configured tasks are: <?xml version='1.0' encoding='UTF-8'?>
 <settings>
  <thread id='1'>
    <action id='8' workflow='7' maxtime='0' from='0' to='0' name='Workflow Task Update Status After Planning Error'/>
    <action id='6' workflow='4' maxtime='0' from='0' to='0' name='Workflow Task Transfer to Production'/>
    <action id='10' workflow='13' maxtime='0' from='0' to='0' name='Transfer changes to Alcim'/>
    <action id='12' workflow='16' maxtime='0' from='0' to='0' name='Workflow_UpdatePOInProduction '/>
    <action id='0' workflow='0' maxtime='0' from='0000' to='0' name='openTrans'/>
  </thread>
 <thread id='2'>
    <action id='7' workflow='11' maxtime='0' from='0' to='0' name='Workflow Task AWBPRO Archiving jobs'/>
    <action id='11' workflow='14' maxtime='0' from='0' to='0' name='Replikation Export'/>
    <action id='13' workflow='17' maxtime='0' from='0' to='0' name='EndofDay'/>
  </thread>
  <thread id='3'>
    <action id='14' workflow='19' maxtime='0' from='0' to='0' name='ALCIM Detail'/>
    <action id='15' workflow='18' maxtime='0' from='0' to='0' name='ALCIM Status'/>
  </thread>
 </settings>



These are the settings that were read from A+W Business. For each thread, a working thread is
created in which the workflows are executed one after another. Most work is done in the
BusinessCom.exe. If necessary, each working thread creates an individual BusinessCom.exe in order
to process workflows. The lines in the trace contain the process ID of the created com object:
Process id of created BusinessCom.exe is 2044
In order to see the messages for this com object, the A+W Business Trace must be activated. The
associated file in the log folder is called "A+W Business_<Datum>_<ProzessId>.awtrc“.
In this file, the detailed trace messges for the workflows executed can be viewed.




                                                                                                                              A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                                        773
24.Feedback Service (MQTT Broker API)
A MQTT-based broker should be implemented as general data interface in all A+W systems. This
will be realized on the basis of Eclipse Mosquitto. Mosquitto is a standard implementation of a
broker that can run on different platforms and is especially beloved in the IoT world. MQTT can be
implemented safely via TLS. Both client systems and A+W services are connected to this broker.
These clients send (publish) so-called TOPICS to the broker and others receive (subscribe) these
topics with defined data (payloads). The payloads are JSON data. All participants are both publishers
as well as subscribers. Return values for inquiries are returned via defined return TOPICS. The
sender must subscribe to these.
MQTT is based on QoS levels. The service works with QoS2, which means that a message within the
broker is saved temporarily. If the client goes offline, it receives the message as soon as it is back
online again. Mosquitto guarantees that a message is delivered precisely once.
The figure shows the publisher/subscriber using a temperature monitoring.




                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




The following participants log onto the broker:
- The customer with an external production control system.
- A+W Business with the commercial reporting service
- A+W Production




                                                                                                  774
                                                                                        Commercial Feedback Service




        Customer                                   Broker




                                                                                                A+W Production




24.1. Installation
For the operation of the new service, the following components must be installed and completely
up-to-date:
    •   A+W Business 6 Basis
    •   A+W Business 6 by language
    •   A+W Commercial 6 Feedback Service
    •   Eclipse Mosquitto MQTT Broker
    •   All required A+W infrastructure services
    •   The MQTT Explorer should be used as test and information tool.
        MQTT Explorer | An all-round MQTT client that provides a structured topic overview (mqtt-explorer.com)
                                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




After the installation, the configuration of the Mosquitto broker must be done; please also use the
installation instructions for the broker for this.


24.2. Configuration

         AWBusiness
In A+W Business, the switch "MQTT Broker -- Activate feedback service for MQTT" must be
activated in the company master data. Then the changes to the delivery date are forwarded to the
feedback service and thus also to the MQTT broker.




                                                                                                                 775
         Infrastructure configuration
In the infrastructure configuration, the MQQT client must be activated and configured for the
feedback service.
The host must be adjusted and the user entered with his password.
The "subscribe" entry can be made so that there is a reaction to all messages for this site that come
from the customer. For multi-sites, the site number is always important.
Example: Feedback/<Site number>/+/<Customer abbreviation>/act
How the customer sets these topics must be clarified with him.
How we can pass along the delivery date change can now be set in the next field.
Example: Feedback/<Site number>/deliverydateupdate/aw/act

                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 776
         Testing and monitoring
With the MQTT Explorer, the delivery date change can be simulated; for this, the topic listed below
must be published. The payload must be adjusted.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




TOPIC: Feedback/001/deliverydateupdate/sg4p/act
PAYLOAD:
{
  "Action": "DeliveryDateUpdate",
  "Order": "270955",
  "DeliveryDate": "2022-01-26",


                                                                                               777
    "PrimaryReason": "2- Problème Commercial",
    "SecondaryReason": "Not available",
    "Comment": "Notify to subscriber about new Delivery Date",
    "Person": "SYSADM"
}

The delivery date change can also be monitored here.


24.3. Basic knowledge
After the installation and activation of "Activate MQTT" for MQTT Commercial Feedback, the
service includes a topic "Feedback/+/+/+/act", that is, the service is subscribed to and hears every
published message that contains "Feedback/.../.../.../act", whereby the symbol "+" replaces each
word after "/".
The topic is very useful if the customer has more than one instance of the service and would like to
break down the service, e.g. in multisite mode where each site can have its own topic.
For example, a company with two locations:
      •   1724 – North Subsidiary
      •   1725 – South Subsidiary
The configuration of the feedback service for the site 1724 should look approximately like this:
- Feedback/1724/+/+/act
The instance of the service 1724 receives only the messages published for the site 1724.
The configuration of the feedback service for the site 1725 should look approximately like this:
- Feedback/1725/+/+/act
The instance of the service 1725 receives only the messages published for the site 1725.

            MQTT Topics
MQTT topics are a form of addressing that allows MQTT clients to exchange information.
MQTT topics are structured in a hierarchy similar to folders and files in a file system, whereby the
slash (/) is used as a separator.
With this system, you can create a user-friendly and self-describing name structure of your choice.
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




Topic names are:
- Capitalization (same name with capital letters is different)
"Feedback/Site/..." is different than "Feedback/Site/..."
- Use UTF-8 character strings.
- They must consist of at least one character in order to be valid.


With the exception of the $SYS topic, there is no default or default topic structure.




                                                                                                   778
This means that there are no topics that are created by default on a broker, with the exception of
the $SYS topic.
All topics are created by a subscribing or publishing client and are not permanent.
A topic only exists if a customer has subscribed to it or a broker has saved an archived or last
message for this topic.

           Subscribing to topics
A customer can subscribe to one or several topics.
When subscribing to several topics, two placeholder characters can be used.
These are:
- # (number sign) - multi-level placeholder
- + (plus sign) - placeholder for a level
Placeholders can only be used to designate a level or several levels, e.g. /site/# and not as part of
the name in order to designate several characters, e.g. sit# is not valid.
Examples for the naming of topics:
Valid topic subscriptions
Individual topic subscriptions
-/
- /Site
- Site/Room/Main light
- Site/Room/Sidelight


Using topic wildcards
Subscribing to the topic site/#
Covers
- Site/Room1/Main light
- Site/Room1/Alarm
- Site/Garage/Main light
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




- Site/Main door
- etc...


Example for a subscription to the topic Site/+/Main light
Covers
- Site/Room1/Main light
- Site/Room2/Main light
- Site/Garage/Main light
Does not cover

                                                                                                 779
- Site/Room1/Sidelight
- Site/Room2/Sidelight
Invalid topic subscriptions
- Site + ground: no topic level
- Site# ground: no topic level


24.4. Delivery date update
SG4P sends a delivery date update to the broker, which forwards it to the report service, and the
change is entered via the BusinessFedbackCOM in the FS_POOL_KOPF/FS_POOL database table;
that is, it is stored temporarily. A method udf_SGGDeliveryDateUpdate() has been developed,
which processes these entries; that is, the order is locked, the delivery date is changed, and if
necessary, the entry is made in BW_LOCK_KAPA for the late change in the production. In the
directory ….\A+W\Business 6\Formula\MQTT\ there is a template for a workflow in order to be
able to execute the delivery date update via commercial exchange service. If there is an error during
processing, it can be communicated to the user via e-mail. If, for example, the document is locked,
the data record in FS_POOL_KOPF receives the status STATUS_GESPERRT (3) and can thus be
processed again during the next run through the workflow. All other error cases run on the status
STATUS_FEHLER (2) and must be reset for renewed processing with udf_ResetErrorRecords()
.
The Exchange Service processes the late production change and creates a production transfer in
the ERP Web service The reporting is done asynchronously via the production to the ERP Web
service, but is not reported to SG4P. Problems must be processed by the user. Already at the
beginning of the change, it can happen that the order cannot be locked; then the function returns
an error and sets the status accordingly as described above.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




Furthermore, a new company option "Shift of delivery date into the past permitted" was
implemented. This is coupled to the A+W Production capacity planning. With activated option, a
change transfer is also initiated for delivery date shifts into the past.


                                                                                                 780
In order to use the same function in A+W Production, the following switch should be activated.




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 781
                                                                             Commercial Feedback Service
                       Change
                                                                                                                       AWB




                                  Broker
    SG4P             Change
                                                                               BusinessFeedbackCOM

                        Result                                                 (Syncron call with result)
                                                                                                                       AWB

                                                                                                                      COM
                                                                                                                      Proxy



                                                  AWB Change (on new Flag)
              ERPWebservice


                                                                                                                    New Flag




                                                                                    AWB Order               BW_KAPA_LOCK
       OrderXML
       (late order
         change)




                                                                              Commercial Exchange Service


                                                                                  BusinessExchangeCOM
              A+W Production                                                     (Syncron call with result)




In case of a change of the delivery date in A+W Business (order entry, document data), the Feedback
Service is informed and reports the delivery date change via the broker to the SG4P. There is no
                                                                                                                               A+W Software GmbH - Configuration A+W Business - INTERNAL




report; the change counts as accepted. At the same time, BW_KAPA_LOCK is filled with a new ID,
which causes the trade exchange service in the workflow to inform the return service about the
change of the delivery date, which forwards the change via the broker to SG4_ without processing
a result.



          Delivery date update in A+W Business
With this function, AWB informs the Feedback Service and the broker about changed delivery dates
in AWB. This only happens if the company option Dies is the method that must be called in case of
a change of the delivery date in AWB in order to report it to the broker.
This only happens if the status is greater than or equal to the defined status in the company data.


                                                                                                                       782
         MQTT Topic 4 expansion of dispatch

In the company data, on the tab 14.Dispatch, there are now two new options Topic 4 - Dispatch and
Topic 5 - Delivery, which you can activate if the Feedback Service for MQTT is activated. However,
you can only activate one of these options because the processing runs the same way. The
functionality of the processing of the data Topic 5 - Delivery was already implemented. The
processing of the dispatch data is new. This is a reporting of order data and their item quantities
and the information on which rack the order items are to be placed. If the reported item quantity
is not equal to the original quantity, a partial delivery is generated automatically and placed on the
reported rack. If the reported quantity is complete, no partial delivery has to be generated; the
order item is only assigned to the rack. To exclude surcharge items from the determination of the
item quantity, for example, a new option in the production types has been implemented, which
you can use to control this.                                                                             A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  783
784
A+W Software GmbH - Configuration A+W Business - INTERNAL
25. SGG Integration Allianz Trade
   (Euler/Hermes) Restful API

Via the AWSOA Commercial Exchange Service, a communication interface to the Alliany Trade
System (formerly Euler/Hermes) has been created using its Restful Service API in order to receive
the customer's credit insurance and update it in A+W Business.




                                                                                                    A+W Software GmbH - Configuration A+W Business - INTERNAL




                  API returns customer and cover data to be stored in database
                            (KU_KUNDEN and CU_SGG_CREDITLIMIT)




                                                                                              785
25.1. Company data
The access data for the connection to the Euler/Hermes API is stored in the company data on tab
16 Miscellaneous. Furthermore, there are 3 insurance numbers entered there, which then must be
used to determine the credit limit data via the API.




For the processing, in the beginning a workflow and its execution time must be defined. This
workflow then calls the new UDF function udf_EulerGetCovers( ), which obtains the appropriate
insurance data for the customer from the Allianz Trade API.
This data is saved in the new table CU_SGG_CREDITLIMIT.

          Formula example
! *********************************************************;
                                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL



! ** Request customer cover data via Euler API **;
! *********************************************************;
!;
! Single customer;
!udf_EulerGetCovers( DATETIME_Null, 17370);
!;
!;
! All customers without filter;
udf_EulerGetCovers( DATETIME_Null, NUMBER_Null );


                                                                                            786
!;
!;
! All customers with filter on date;
!udf_EulerGetCovers( SalDateCurrent( ), NUMBER_Null );
!;
!special date - for example request all the data before the 1st of January 2022;
!Set g_dUdv[0] = SalDateConstruct ( 2022, 1, 1, 0,0,0 );
!udf_EulerGetCovers( g_dUdv[0], NUMBER_Null );

          Territories (finan.)

The customers are divided depending on their origin (country) into different zones/territories, and
different guarantees are assigned to each territory.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                               787
25.2. Customer (financial data)
After the report from the Exchange Service and the calculation and saving of the credit limit data,
it can be read in the customer management and in some cases also processed.
Each customer in the customer management for whom data was determined via the API now has
an Euler/Hermes customer number.




On tab 7.Balance, effective immediately, just the credit limit is displayed in net and gross; there is
neither a credit limit 2 nor a balance 2.
Via the new button with the € symbol, a new dialog opens that displays the financial data that was
determined and calculated via the API. There it is possible to overwrite the calculated guarantee (in
the figure Credit insurance EH) from the API. This value is then displayed in red (manually changed).
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL



If you save the value, then the credit limit will be recalculated.




                                                                                                  788
789
A+W Software GmbH - Configuration A+W Business - INTERNAL
The data from the new credit limit dialog is also present in the credit limit analysis, which you can
reach relatively easily using the button to the left of the credit limit.
That is, if you create so-called snapshots of the customer's credit limit using the udf function
udf_TransferCreditLimit ( ), the new financial data will also be transferred.



25.3. Document entry (totals)
Precisely as in customer management, now only a credit limit and a balance value are displayed on
the Totals tab of the document entry.




                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 790
26.Smart Companion Backend Services
For instructions for the installation and configuration of the Smart Companion app, see the
appropriate installation instructions. Only the backend services will be discussed here.
Important is that the scanner is licensed in the infrastructure and that the barcodes are configured.
In A+W Business, module 18 -Stock management must be licensed.
The configuration is done in the infrastructure under A+W Production -> CIM Smart Companion




For the application, stock and inventory must be activated, depending on what should/can be put
into operation (license)
Business must be enabled as backend.
Now the configuration of the barcodes that are required for the Smart Companion Stock:
The barcodes are defined with regular expressions.
CAUTION: The barcodes must also be configured in the scanner. Please read about this in the Smart
Companion installation instructions in Chapter 2.1.2 Barcode types. Especially for code 39, the
checksum must be recognized by the scanner and removed from the input.
                                                                                                        A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                 791
8-Stock Person Barcode
^(PE[0-9]{1,10})[A-Z0-9*$%.-/+ ]{1}$
9-Stock Order Barcode
^(O[0-9]{1,8})[A-Z0-9*$%.-/+ ]{1}$
10-Stock Purchase Order Barcode
^(O[0-9]{1,8})[A-Z0-9*$%.-/+ ]{1}$
12-Stock Location Barcode
^(L[0-9]{1,10})[A-Z0-9*$%.-/+ ]{1}$
                                                                                            A+W Software GmbH - Configuration A+W Business - INTERNAL




13-Stock Article EAN Barcode
^([0-9]{13})$
14-Stock Article LP Barcode
^(LP[0-9]{1,10})[A-Z0-9*$%.-/+ ]{1}$
15-Stock Boxes Barcode
^(BO[A-Z0-9]{1,10})[A-Z0-9*$%.-/+ ]{1}$
The barcode type is CODE39 with validation and without transfer of the check digits




                                                                                      792
The installation of the services is done via the Setup Launcher; for this, the following must be
installed:
    •   A+W Commercial 6 Purchase Business Service
    •   A+W Commercial 6 Stock Business Service




Added to this is the A+W Business 6 Basis Setup, which installs the COM objects for the services.




                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                793
The system architecture looks like this:




     SMC Stock                                             ICE WS Interface


                                     Commercial Stock Service            Commercial Purchase
                                           Business                        Service Business


                                           BusinessStock                      BusinessPurchase
                                               COM
                                                                                   COM




                                                           AWB SQLServer




The IP address of the Service Locator must be entered in the Smart Companion app; communication
is done via web sockets.
The barcodes can be printed under the following modules:
1. Employee – Barcode




                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL




2. Stock location – Barcode


                                                                                                 794
3. Stock product – Barcode




4. EAN – Barcode
This is on the product; the EAN can be stored in the product, stock dimension or in the product
                                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL




variant. All levels are searched and the product is found.




                                                                                            795
26.1. Receipt of goods
The booking of the goods receipt for boxes and the ident number assignment of the boxes is
configured via the settings for the receipt of goods dialog.




The ident number assignment and generation of individual order items is only done if this property
is set for the user. If it is not set, no ident numbers will be assigned for the boxes, this is the default!
If the receipt of goods is done with ident numbers and several users assign the ident numbers, then
a different prefix per user must be set. Only this way can be it be guaranteed in multi-user operation
that the ident numbers that are displayed in the SMC are also actually booked later on. If these
were also assigned by another user, then the next free ident numbers would be assigned, and this
would not be visible to the user.



                                                                                                               A+W Software GmbH - Configuration A+W Business - INTERNAL




No box labels can be printed with Smart Companion Stock; this must be done up to the
implementation of this function in the goods receipt.




                                                                                                        796
26.2. Outgoing goods
For the outgoing goods, all orders with status limits of the status point 646 SMC - outgoing goods
complete are read whose delivery date is +- 5 days.
Only orders are displayed whose products have the product type article and boxes (40, 200) or
contain the freely definable product groups in the system parameters.
The product groups must be entered separated by commas.




If all items that correspond to the search criterion have been delivered, then the status of the order
is set to the status of the status point 646 SMC - outgoing goods complete. For the first goods
receipt, the status point 645-SMC outgoing goods partial is set. This is only entered once in the
history. The bookings are done item by item. The new status points 645 and 646 must absolutely
be assigned.


26.3. Inventory
The Smart Companion Stock supports the inventory for articles, stock dimensions, and for boxes.
For boxes, however, without change of the sheet number and storage location.
These must be changed in A+W Business if this is necessary.
The inventory must first be created in A+W Business and a setpoint determination conducted. The
creation of several open inventories is possible; however, these must be on different days.
                                                                                                         A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                  797
27.Table of Figures
Fig. 1: Company data, option CPIP creation is active ....................................................................... 18
Fig. 2: Settings dialog for importing CE master data ........................................................................ 20
Fig. 3: CPIP data in product master data .......................................................................................... 21
Fig. 4: Partner master data ............................................................................................................... 22
Fig. 5: CPIP code at item entry ......................................................................................................... 24
Fig. 6: Toughened glass search data dialog ...................................................................................... 26
Fig. 7: Laminated glass search data dialog 1 .................................................................................... 27
Fig. 8: Laminated glass search data dialog 2 .................................................................................... 27
Fig. 9: Activating sending of the declaration of performance.......................................................... 32
Fig. 10: The declarations of performance are also stored in the path to the file attachments ....... 33
Fig. 11: Management program for declarations of performance .................................................... 34
Fig. 12: Naming of the technical values ........................................................................................... 34
Fig. 13: The declaration of performance in the number ranges ...................................................... 35
Fig. 14: Settings for the B2B supplier "A+W SLT" ............................................................................. 36
Fig. 15: The item references for A+W SLT ........................................................................................ 36
Fig. 16: Declaration of performance in item recording .................................................................... 37
Fig. 17: The rules for product structure ........................................................................................... 37
Fig. 18: A+W SLT and declaration of performance on the ribbon of the item recording ................ 38
Fig. 19: The gotmaxx PDF mailer in the employee master data ...................................................... 39
Fig. 20: New sub-rights of item recording for the declaration of performance .............................. 40
Fig. 21: Customer calendar 1............................................................................................................ 46
Fig. 22: Customer calendar 2............................................................................................................ 47
Fig. 23 Company data ....................................................................................................................... 53
Fig. 24 Article import ........................................................................................................................ 55
Fig. 25 Fitting processing allocation ................................................................................................. 63
Fig. 26 Fitting entry .......................................................................................................................... 65
Fig. 27 Product search for fittings .................................................................................................... 66
Fig. 28: LeCheck - Precondition ........................................................................................................ 67
Fig. 29: LeCheck - Back cut ............................................................................................................... 68
Fig. 30: LeCheck - Sealing depth ....................................................................................................... 69
Fig. 31: LeCheck - Product management.......................................................................................... 70
Fig. 32: Invoice management with allocated orders ........................................................................ 73
Fig. 33: Creating a project in invoice management.......................................................................... 73
Fig. 34: Project totals........................................................................................................................ 75
Fig. 35 Selection ............................................................................................................................... 80
                                                                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL



Fig. 36 Company data - Allocation of the registration points .......................................................... 81
Fig. 37 - Document produced ........................................................................................................... 82
Fig. 38 - Document not produced .................................................................................................... 82
Fig. 39 Document is ready for partial delivery ................................................................................. 82
Fig. 40 - Document report complete ................................................................................................ 83
Fig. 41 Delivery note printing starts automatically .......................................................................... 84
Fig. 42 Start delivery note printing manually ................................................................................... 84
Fig. 43 Rack order assignments ........................................................................................................ 85
Fig. 44 Marking the rack-order assignments for partial delivery ..................................................... 85
Fig. 45 Overwriting header fields ..................................................................................................... 86
Fig. 46 Delivery date calculation ...................................................................................................... 87
Fig. 47 OrderXML Version ................................................................................................................ 88
Fig. 48 Delivery date calculation 2 ................................................................................................... 91

                                                                                                                                               798
Fig. 49 - Status Administration per employee (group) ..................................................................... 94
Fig. 50 - Defining status areas .......................................................................................................... 95
Fig. 51 - Manual status change not permitted ................................................................................. 95
Fig. 52: Company data: lead days for resubmission of orders ......................................................... 96
Fig. 53: Order entry presentation date ............................................................................................ 97
Fig. 54: Resubmission of orders ....................................................................................................... 97
Fig. 55: Resubmission of alternative orders ..................................................................................... 98
Fig. 56: Printing of orders ................................................................................................................. 98
Fig. 57: Number manager context menu ....................................................................................... 108
Fig. 58: Document check incl. header and item texts .................................................................... 108
Fig. 59: Item text ............................................................................................................................ 109
Fig. 60: Header text ........................................................................................................................ 109
Fig. 61: Marking the checked order items ..................................................................................... 109
Fig. 62: New order status "check performed"................................................................................ 109
Fig. 63: Customizing in table in order to reload order information ............................................... 110
Fig. 64: PDF- Mailer properties - Output ........................................................................................ 145
Fig. 65: PDF- Mailer properties - Mailer ......................................................................................... 146
Fig. 66: Portug. Certi. Company master data settings ................................................................... 148
Fig. 67: Portug. Certi. - Certification code ...................................................................................... 149
Fig. 68: Portug. Certi. – Invoice printing ......................................................................................... 150
Fig. 69: Portug. Certi. - Document lock .......................................................................................... 151
Fig. 70: Portug. Certi. - User rights- User rights ............................................................................. 151
Fig. 71: Portug. Certi. - Cancel invoice ........................................................................................... 152
Fig. 72: Portug. Certi. - SAFT-PT export .......................................................................................... 153
Fig. 73: Processes ........................................................................................................................... 275
Fig. 74: Barcode production transfer, tab Overview ...................................................................... 276
Fig. 75: Barcode production transfer, tab Details .......................................................................... 277
Fig. 76 Activating file-less reports .................................................................................................. 291
Fig. 77 Registration point overview ............................................................................................... 295
Fig. 78 HTML overview ................................................................................................................... 296
Fig. 79 Report view ......................................................................................................................... 297
Fig. 80 Capacity overview 1 ........................................................................................................... 298
Fig. 81 Capacity overview 2 ............................................................................................................ 298
Fig. 82: Document type of the work orders at order entry............................................................ 299
Fig. 83: Program „Copy documents“ with the work order as the target document ...................... 300
Fig. 84: Item selection in the copy program................................................................................... 300
Fig. 85: Supplier file for creating internal work orders .................................................................. 301
Fig. 86: Automatically created purchasing suggestion for a work order ....................................... 302
                                                                                                                                                      A+W Software GmbH - Configuration A+W Business - INTERNAL



Fig. 87: Registration point and allocated status ............................................................................. 303
Fig. 88: Registration point and status limit in company master data ............................................ 303
Fig. 89: Dialog for entering production data .................................................................................. 304
Fig. 90: Selection of data to be booked.......................................................................................... 305
Fig. 91: Company master data "Consumption of BOM elements for work orders" option ........... 306
Fig. 92: Customer-related surplus .................................................................................................. 311
Fig. 93: Surplus at item entry ......................................................................................................... 312
Fig. 94: Partial shipment > option Partial shipment quantity ........................................................ 314
Fig. 95: Partial shipment > tab Copy by item ................................................................................. 315
Fig. 96: Illustrated standard transfer process ................................................................................ 317
Fig. 97: Cancellation of transfer to production .............................................................................. 319
Fig. 98: Order transfer to capacity planning 1................................................................................ 320
Fig. 99: Order transfer to capacity planning 2................................................................................ 320

                                                                                                                                              799
Fig. 100: Illustrated process: transfer to capacity planning ........................................................... 321
Fig. 101: Automatic transfer to production ................................................................................... 322
Fig. 102 Languages ......................................................................................................................... 323
Fig. 103 Customer's language in OrderXML ................................................................................... 323
Fig. 104 File annex types ................................................................................................................ 324
Fig. 105: Production preview 1 ...................................................................................................... 332
Fig. 106: Production preview 2 ...................................................................................................... 333
Fig. 107: Definition of preview columns ........................................................................................ 333
Fig. 108: Management of other surcharges ................................................................................... 342
Fig. 109: Order entry - transport surcharge ................................................................................... 343
Fig. 110: Miscellaneous surcharges: .............................................................................................. 344
Fig. 111: Correction of original sales prices ................................................................................... 345
Fig. 112: Average cost calculation process .................................................................................... 350
Fig. 113: Product stock dimensions................................................................................................ 351
Fig. 114: Inventory management ................................................................................................... 351
Fig. 115: Price management ........................................................................................................... 351
Fig. 116: Example order.................................................................................................................. 351
Fig. 117: Shape edge surcharges .................................................................................................... 354
Fig. 118: Shape edge qualities ........................................................................................................ 355
Fig. 119: Example of the exact calculation of shape edge surcharges ........................................... 356
Fig. 120: Example of the non-exact calculation of shape edge surcharges ................................... 357
Fig. 121: Configuration special edge in A+W Production ............................................................... 358
Fig. 122: Configuration special allocation 2 ................................................................................... 359
Fig. 123: Message during transfer to production for faulty special allocation 2 ........................... 360
Fig. 124: Define rounding point ..................................................................................................... 362
Fig. 125: Rounding allocation ......................................................................................................... 363
Fig. 126: Product management - energy surcharge article ............................................................ 363
Fig. 127: Energy surcharge – Price ................................................................................................. 364
Fig. 128: Energy surcharge - company data ................................................................................... 364
Fig. 129: Energy surcharge - company data 1 ................................................................................ 365
Fig. 130: Enable energy surcharge ................................................................................................. 366
Fig. 131: Calculation after item entry............................................................................................. 367
Fig. 132: Surcharge basis ................................................................................................................ 367
Fig. 133: Recalculation of documents ............................................................................................ 368
Fig. 134: Product surcharge allocation ........................................................................................... 369
Fig. 135: Export of purchase orders ............................................................................................... 390
Fig. 136: External interface - supplier ............................................................................................ 391
Fig. 137: Product reference dialog ................................................................................................. 392
                                                                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL



Fig. 138: Export program ................................................................................................................ 392
Fig. 141: Copy external products.................................................................................................... 396
Fig. 142: Notification per employee ............................................................................................... 403
Fig. 143: Scheduling overview ........................................................................................................ 403
Fig. 144: Repurchasing QBE mode ................................................................................................. 404
Fig. 145: Repurchasing by delivery date ........................................................................................ 404
Fig. 146: Repurchasing by order..................................................................................................... 404
Fig. 147: Selection of the action ..................................................................................................... 405
148Fig. : Action complaint selected ............................................................................................... 405
Fig. 149: Target number manager .................................................................................................. 405
Fig. 150: Repurchase generated and print executed ..................................................................... 406
Fig. 151: Supply type ...................................................................................................................... 410
Fig. 152: Stockkeeping minimum surface ...................................................................................... 411

                                                                                                                                           800
Fig. 153: Stockkeeping minimum quantity ..................................................................................... 412
Fig. 154: Stock P.O. ......................................................................................................................... 412
Fig. 155: Item entry and purchasing suggestion ............................................................................ 413
Fig. 156: Stock search ..................................................................................................................... 413
Fig. 157: Receipt of goods .............................................................................................................. 414
Fig. 158: Overview of the future stock on hand ............................................................................. 415
Fig. 159: Defining the main article in stock management ............................................................. 416
Fig. 160: Document header ............................................................................................................ 417
Fig. 161: Checking the replacement time ...................................................................................... 417
Fig. 162: Delivery time shown in the supplier file .......................................................................... 418
Fig. 163: Route management and route days ................................................................................ 418
Fig. 164: Receipt of boxes .............................................................................................................. 419
Fig. 165: BOM with a complex box in product master data........................................................... 421
Fig. 166: Product type of the box in product master data. ............................................................ 421
Fig. 167: Supply type ...................................................................................................................... 421
Fig. 168: Standard sizes in product master data facilitates the input ............................................ 422
Fig. 169: Box price in price management ....................................................................................... 423
Fig. 170: Pallet of 80 boxes ............................................................................................................ 424
Fig. 171: Box of 25 sheets of picture frame glass ........................................................................... 424
Fig. 172: Pallet with boxes in stock management .......................................................................... 425
Fig. 173: Box in stock management ............................................................................................... 426
Fig. 174: The box in the pallet BOM ............................................................................................... 427
Fig. 175: The picture frame glass in the pallet BOM ...................................................................... 427
Fig. 176: Customizing- Management - 60 - Availability check ....................................................... 437
Fig. 177: Stock movement - Transfer ............................................................................................. 439
Fig. 178: Stock history .................................................................................................................... 440
Fig. 179: Stock history - Table ........................................................................................................ 440
Fig. 180: Stock history - Printout .................................................................................................... 441
Fig. 181 A+W Business database .................................................................................................... 448
Fig. 182 A+W Logistics Optimizer database ................................................................................... 448
Fig. 183 Logical user A+W Business ................................................................................................ 449
Fig. 184 Type of system used ......................................................................................................... 449
Fig. 185: Company management – activate A+W Logistics Optimizer........................................... 450
Fig. 186 Number manager – new table columns ........................................................................... 451
Fig. 187 Route management – optimized routes from A+W Logistics Optimizer .......................... 451
Fig. 188 Company data – definition of surcharges/freight revenues for the A+W Logistics
       Optimizer ............................................................................................................................. 452
Fig. 189 Multi-site option in the A+W Logistics Optimizer............................................................. 453
                                                                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL



Fig. 190 Multi-site configuration in the A+W Logistics Optimizer ................................................. 453
Fig. 191 Multi-site selection in the A+W Logistics Optimizer ......................................................... 454
Fig. 192 Multi-site display in the A+W Logistics Optimizer ............................................................ 454
Fig. 193 A+W Logistics Optimizer database for the sites ............................................................... 455
Fig. 194 Multisite configuration in the A+W Logistic Service Config Tool...................................... 456
Fig. 195 Item and rack information in the A+W Logistics Optimizer ............................................. 457
Fig. 196 A+W Smart Delivery – Login and route overview ............................................................. 458
Fig. 197 A+W Smart Delivery – Status change per route destination ............................................ 459
Fig. 198 A+W Smart Delivery – Status changes to A+W Logistics Optimizer ................................. 459
Fig. 199 Breakage source definition on the Breakage Reason dialog ............................................ 460
Fig. 200 A+W Infrastructure Web – Logistic settings ..................................................................... 463
Fig. 201: Company data with Customising enabled ....................................................................... 469
Fig. 202: Formula management ..................................................................................................... 470

                                                                                                                                             801
Fig. 203: Formula allocation via search dialog ............................................................................... 471
Fig. 204: List of allocated formulas in a dialog 1 ............................................................................ 471
Fig. 205: List of allocated formulas in a dialog 2 ............................................................................ 472
Fig. 206: Menu element for creating user-defined buttons .......................................................... 474
Fig. 207: Customizing in management of forms ............................................................................ 475
Fig. 208: Program/formula allocation ............................................................................................ 476
Fig. 209: Entry dialog with two variables of string type ................................................................. 479
Fig. 210: The Customizer at item entry .......................................................................................... 480
Fig. 211: Open formula dialog in product management ................................................................ 495
Fig. 212: Customizing P.O. transfer ................................................................................................ 497
Fig. 213: Customizing tax calculation ............................................................................................. 500
Fig. 214: Search formula in document entry .................................................................................. 501
Fig. 215: Import and export of payment information .................................................................... 503
Fig. 216: Adjusting currency identifiers.......................................................................................... 504
Fig. 217: Tax number in the company master data ....................................................................... 504
Fig. 218:Import/export of payments .............................................................................................. 505
Fig. 219: Formula dialog – Data container - creating formulas ...................................................... 507
Fig. 220: Data container selection menu ....................................................................................... 511
Fig. 221: Data container – creating a window................................................................................ 512
Fig. 222: Finance snapshot formula ............................................................................................... 529
Fig. 223: Finance snapshot Workflow ............................................................................................ 529
Fig. 224: Finance snapshot activation ............................................................................................ 530
Fig. 225: Workflow - Procedure up to the release of production .................................................. 542
Fig. 226: Workflow – Procedure after release for production ....................................................... 542
Fig. 227: Administration - Formula example .................................................................................. 544
Fig. 228: Workflow tasks - Example ............................................................................................... 545
Fig. 229: Workflow Tasks – Automatic setting ............................................................................... 546
Fig. 230: User-defined CommonBase settings ............................................................................... 547
Fig. 231: Change the blocked position ........................................................................................... 548
Fig. 232: Order entry, tab Totals .................................................................................................... 550
Fig. 233: Stock availability .............................................................................................................. 552
Fig. 234: Workflow allocate task to the new formulas ................................................................. 553
Fig. 235: Interval for workflow task ............................................................................................... 554
Fig. 236: FinAc dialog - Master data ............................................................................................... 569
Fig. 237: FinAc– Formula Management ......................................................................................... 570
Fig. 238: FinAc - Customizing.......................................................................................................... 570
Fig. 239: Basic number areas ......................................................................................................... 588
Fig. 240: Replication settings in company master data ................................................................. 589
                                                                                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL



Fig. 241: Local fields in customer management ............................................................................. 590
Fig. 242: Selecting replicated customers in customer management ............................................. 590
Fig. 243: Reception default for customers ..................................................................................... 591
Fig. 244: Management of rights ..................................................................................................... 592
Fig. 245: Entering subsidiaries (master) ......................................................................................... 593
Fig. 246: Entering subsidiaries (slave) ............................................................................................ 593
Fig. 247: Jobs for replication .......................................................................................................... 594
Fig. 248: Replication – Exclusion of tables ..................................................................................... 595
Fig. 249: Replication - Defaults....................................................................................................... 595
Fig. 250: Display of the finished replication on the ALFAK Service Monitor .................................. 596
Fig. 251: Disabling the old replication call...................................................................................... 597
Fig. 252: DBMigrationstool – Login ................................................................................................ 599
Fig. 253: Database Migration Tool ................................................................................................. 601

                                                                                                                                          802
Fig. 254: Data migration – SQL Base  SQL Server with Unicode option ..................................... 602
Fig. 255: Change monitoring initialization after migration ............................................................ 604
Fig. 256 Work types ........................................................................................................................ 606
Fig. 257: Capa- Tool 1 ..................................................................................................................... 612
Fig. 258: Capa – Start old values from ALFAK 1.............................................................................. 612
Fig. 259: Capa- Tool 2 ..................................................................................................................... 613
Fig. 260: Capa- Start old values from ALFAK 1 ............................................................................... 613
Fig. 261: Capa- Tool 3 ..................................................................................................................... 614
262Fig. : Capa- Tool 4 ..................................................................................................................... 614
Fig. 263: Capa- Tool 5 ..................................................................................................................... 615
Fig. 264: Setting for existing system in ALCIM master dataFig. : Setting for existing system in
       ALCIM master data .............................................................................................................. 616
Fig. 265: ALCIM - Processing article ............................................................................................... 616
Fig. 266: Machinery allocation ALCIM- ALFAK 1 ............................................................................ 617
Fig. 267: Machinery allocation ALCIM- ALFAK 2 ............................................................................ 617
Fig. 268: Machinery allocation ALCIM- ALFAK 3 ............................................................................ 618
Fig. 269: Machinery allocation ALCIM- ALFAK 4 ............................................................................ 618
Fig. 270: Total capacity ................................................................................................................... 621
Fig. 271: Reserved production capacity ......................................................................................... 622
Fig. 272: Completeness of barcode reading ................................................................................... 624
Fig. 273: Code39 settings ............................................................................................................... 625
Fig. 274: Enter registration point ................................................................................................... 626
Fig. 275: User management – User settings - Barcode for scanner ............................................... 627
Fig. 276: Machine allocation for registration point........................................................................ 628
Fig. 277: Barcoding – Registration via employee barcode ............................................................. 629
Fig. 278: Barcoding - Main menu ................................................................................................... 629
Fig. 279: Barcoding - Receipt of goods ........................................................................................... 630
Fig. 280 Production report menu ................................................................................................... 631
Fig. 281: Barcoding - Completion report ........................................................................................ 631
Fig. 282 BDE breakage report......................................................................................................... 632
Fig. 283: PDC – Stock movement ................................................................................................... 633
Fig. 284: PDC- Incoming stock ........................................................................................................ 633
Fig. 285: PDC - Outgoing stock ....................................................................................................... 634
Fig. 286: PDC - Select stock location .............................................................................................. 634
Fig. 287: PDC - Transferring stock item .......................................................................................... 635
Fig. 288: PDC - Successful transfer ................................................................................................. 635
Fig. 289: Barcoding - Order item information ................................................................................ 642
Fig. 290: Barcoding- Login information .......................................................................................... 643
                                                                                                                                                   A+W Software GmbH - Configuration A+W Business - INTERNAL



Fig. 291 Booking history ................................................................................................................. 647
Fig. 292: Formula management - sketches .................................................................................... 648
Fig. 293: Create SN file name ......................................................................................................... 649
Fig. 294: Assign available SN file .................................................................................................... 650
Fig. 295: SN file directory ............................................................................................................... 650
Fig. 296: SN - Shape 98 ................................................................................................................... 651
Fig. 297: SN file in product master data ......................................................................................... 653
Fig. 298: Change Template file name ............................................................................................. 654
Fig. 299: Shape sketch .................................................................................................................... 654
Fig. 300: Edit SN variables .............................................................................................................. 655
Fig. 301: Euro conversion 1 ............................................................................................................ 667
Fig. 302: Euro conversion 2 ............................................................................................................ 667
Fig. 303: Euro conversion 3 ............................................................................................................ 668

                                                                                                                                           803
Fig. 304: Euro conversion 4 ............................................................................................................ 669
Fig. 305: New: Setting switch in ALFAK .......................................................................................... 671
Fig. 306: Old: Database switch in CommonBase ............................................................................ 672
Fig. 307: New: Switch in ALCIM 1 ................................................................................................... 672
Fig. 308: New: Switch in ALCIM 2 ................................................................................................... 673
Fig. 309: Client number ALCIM....................................................................................................... 673
Fig. 310: Client number ALFAK ....................................................................................................... 674
Fig. 311: Old: Switches in CommonBase ........................................................................................ 674
Fig. 312: ALCIM............................................................................................................................... 675
Fig. 313: New: Switch in ALFAK ...................................................................................................... 675
Fig. 314: B2B- Service ..................................................................................................................... 676
Fig. 315: Old: Switches in CommonBase 1 ..................................................................................... 677
Fig. 316: Old: Switches in CommonBase 2 ..................................................................................... 677
Fig. 317: Old: Switches in CommonBase 3 ..................................................................................... 677
Fig. 318: New: Switch in ALFAK ...................................................................................................... 678
Fig. 319: BMECat 1 ......................................................................................................................... 679
Fig. 320: BMECat 2 ......................................................................................................................... 679
Fig. 321: BMECat 3 ......................................................................................................................... 680
Fig. 322: BMECat 4 ......................................................................................................................... 680
Fig. 323: Kl-Megla 1 ........................................................................................................................ 681
Fig. 324: Kl-Megla 2 ........................................................................................................................ 681
Fig. 325: Schlechtendahl 1 ............................................................................................................. 682
Fig. 326: Schlechtendahl 2 ............................................................................................................. 682
Fig. 327: Thickness conversion - Company settings ....................................................................... 683
Fig. 328: Thickness conversion– Utilities 1 ..................................................................................... 684
Fig. 329: Thickness conversion– Utilities 2 ..................................................................................... 685
Fig. 330: Consignment .................................................................................................................... 689
Fig. 331: Report fonts ..................................................................................................................... 694
Fig. 332: AWDoor - Company data ................................................................................................. 697
Fig. 333: AWDoor - Product management ..................................................................................... 698
Fig. 334: AWDoor - Document entry .............................................................................................. 698
Fig. 335: AWDoor – GGA entry....................................................................................................... 698
Fig. 336: Company management – activate archiving system ....................................................... 712
Fig. 337: Company management – printer for archiving system ................................................... 713
Fig. 338: Initializing archiving system ............................................................................................. 714
Fig. 339: Form management .......................................................................................................... 715
Fig. 340: Activation of the DMS in the master data ....................................................................... 717
Fig. 341: Configuration of the PDF printer in the master data ...................................................... 718
                                                                                                                                                     A+W Software GmbH - Configuration A+W Business - INTERNAL



Fig. 342: A+W Infrastructure 6 Web .............................................................................................. 719
Fig. 343: A+W Commercial Exchange Service log configuration .................................................... 720
Fig. 344: Formula udf_UpdateStatusForDMSDocument() ............................................................. 721
Fig. 345: Status assignment for status point 97 ............................................................................. 721
Fig. 346: Workflow task for udf_UpdateStatusForDMSDocument() ............................................. 722
Fig. 347: Workflow task for udf_UpdateStatusForDMSDocument() ............................................. 722
Fig. 348 – A+W Business to Glass4U .............................................................................................. 756
Fig. 349 – URL Glass4U Webservice ............................................................................................... 757
Fig. 350 – Status point 920 ............................................................................................................. 758
Fig. 351 – Workflow – Formula Workflow_TransferDeliveryInfoToGlass4U ................................. 758
Fig. 352 – Workflow Task Workflow_TransferDeliveryInfoToGlass4U .......................................... 759
Fig. 353 – Autom. process execution Glass4U ............................................................................... 759
Fig. 354 - Monitor ........................................................................................................................... 760

                                                                                                                                             804
Fig. 355 – Glass4U to AWB ............................................................................................................. 761
Fig. 356 - ERP Web service SGGUpdateDeliveryInfo ...................................................................... 761
Fig. 357 - SGGUpdateDeliveryInfo Result ....................................................................................... 762




                                                                                                                                              A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                                                      805
28.Table directory
Tab. 1: Rules for CPIP creation ......................................................................................................... 23
Tab. 2: Form variables ...................................................................................................................... 24
Tab. 3: Transfer to production - fields.............................................................................................. 25
Tab. 4: Construction products regulation - formula values ............................................................. 41
Tab. 5: Purchase and stock code ...................................................................................................... 50
Tab. 6: Document view - main variables ........................................................................................ 121
Tab. 7: Document view - item variables ......................................................................................... 123
Tab. 8: Document view BOM variables .......................................................................................... 124
Tab. 9: Printing of forms - header variables ................................................................................... 130
Tab. 10: Printing of forms - item variables ..................................................................................... 135
Tab. 11: Printing of forms - footer variables .................................................................................. 136
Tab. 12: Printing of forms - BOM variables .................................................................................... 139
Tab. 13: Printing of forms - BOM parameters ................................................................................ 140
Tab. 14: Printing of forms - Georgian bar parameters ................................................................... 140
Tab. 15: Printing of forms - shape parameters .............................................................................. 140
Tab. 16: Bit vectors ......................................................................................................................... 141
Tab. 17: Surcharge bits ................................................................................................................... 141
Tab. 18: BIT 2 item and BOM ......................................................................................................... 142
Tab. 19: BIT 3 item and BO M ........................................................................................................ 142
Tab. 20: Bent glass parameters ...................................................................................................... 143
Tab. 21: Status points - production ................................................................................................ 258
Tab. 22: Switch 'Transfer to production', tab 1 ............................................................................. 260
Tab. 23: Switch 'Transfer to production', tab 2 ............................................................................. 261
Tab. 24: Switch 'Transfer to production', tab 3 ............................................................................. 261
Tab. 25: Capacity lock status .......................................................................................................... 263
Tab. 26: ALCIM status ..................................................................................................................... 280
Tab. 27: Increase of status ............................................................................................................. 280
Tab. 28: AWBar............................................................................................................................... 281
Tab. 29: STSP .................................................................................................................................. 282
Tab. 30: STSL................................................................................................................................... 282
Tab. 31: STSD .................................................................................................................................. 283
Tab. 32: STSG .................................................................................................................................. 283
Tab. 33: STSK .................................................................................................................................. 284
Tab. 34: STSB .................................................................................................................................. 285
Tab. 35: POOL.DAT ......................................................................................................................... 285
                                                                                                                                                       A+W Software GmbH - Configuration A+W Business - INTERNAL



Tab. 36: AWPool status .................................................................................................................. 286
Tab. 37: XOPT ................................................................................................................................. 286
Tab. 38: FEIN.ASC ........................................................................................................................... 287
Tab. 39: PTV.................................................................................................................................... 288
Tab. 40: LAB.ASC ............................................................................................................................ 288
Tab. 41: Enterprise resource planning ........................................................................................... 289
Tab. 42: Allocation of product group and element type ................................................................ 310
Tab. 43: ALCIM element types ....................................................................................................... 310
Tab. 44: Status allocation in DEMO44 ............................................................................................ 318
Tab. 45: Available events in windows and dialogs. ........................................................................ 473
Tab. 46: Data types of the available, global variables. ................................................................... 476
Tab. 47: Globale Array variables .................................................................................................... 482
Tab. 48: Status allocation of P.O. status ........................................................................................ 498

                                                                                                                                               806
Tab. 49: Brasil. Tax rates and dependences: .................................................................................. 502
Tab. 50: Managing the production status in table BW_LOCK_KAPA ............................................. 551
Tab. 51: Customizing- Points .......................................................................................................... 567
Tab. 52: Invoice header - Variables ................................................................................................ 568
Tab. 53: Proceeds account- variables............................................................................................. 568
Tab. 54: Tax - Variables .................................................................................................................. 568
Tab. 55: Discount and external key - Variables .............................................................................. 568
Tab. 56: List to check SQLBase ....................................................................................................... 598
Tab. 57: SQLBase Performance Settings ........................................................................................ 605
Tab. 58: Status points - Capacity planning ..................................................................................... 609
Tab. 59: Capacity status ................................................................................................................. 610
Tab. 60: Customizing- Variables ..................................................................................................... 620
Tab. 61: Procedure CommonBase .................................................................................................. 671




                                                                                                                                                  A+W Software GmbH - Configuration A+W Business - INTERNAL




                                                                                                                                          807

